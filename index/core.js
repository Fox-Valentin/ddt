if (typeof I$==="undefined"){I$=(function() {
    var o = {},
        f = function() {return !1;},
        cache = {};
    var is = function(data,type){
        return o.toString.call(data)==='[object '+type+']';
    };
    return function(key,func) {
        var result = cache[key],
            isfunc = is(func,'Function');
        // func is data
        if (func!=null&&!isfunc){
            result = func;
        }
        // do function defined
        if (isfunc){
            var arr = [];
            for(var i=2,l=arguments.length;i<l;i++){
                arr.push(arguments.callee(arguments[i]));
            }
            var exports = {};
            arr.push.call(arr,exports,{},f,[]);
            var ret = func.apply(null,arr)||exports;
            if (!result||!is(ret,'Object')){
                // for non-object return
                result = ret;
            }else{
                // for namespace return
                // bad performance for-in in v8 for instance
                if (!!Object.keys){
                    for(var ls=Object.keys(ret),i=0,l=ls.length,x;i<l;i++){
                        x = ls[i];
                        result[x] = ret[x];
                    }
                }else{
                    for(var x in ret){
                        result[x] = ret[x];
                    }
                }
            }
        }
        // init data
        if (result==null){
            result = {};
        }
        cache[key] = result;
        // return
        return result;
    };
})();;}
I$(215,function (_p,_o,_f,_r){
    var _extpro = Function.prototype;
    /**
     * AOP增强操作，增强操作接受一个输入参数包含以下信息
     *
     *  | 参数名称 | 参数类型  | 参数描述 |
     *  | :--     | :--      | :-- |
     *  | args    | Array    | 函数调用时实际输入参数，各增强操作中可以改变值后将影响至后续的操作 |
     *  | value   | Variable | 输出结果 |
     *  | stopped | Boolean  | 是否结束操作，终止后续操作 |
     *
     * @method external:Function#_$aop
     * @param  {Function} arg0 - 前置操作，接受一个输入参数，见描述信息
     * @param  {Function} arg1 - 后置操作，接受一个输入参数，见描述信息
     * @return {Function}        增强后操作函数
     */
    _extpro._$aop = function(_before,_after){
        var _after = _after||_f,
            _before = _before||_f,
            _handler = this;
        return function(){
            var _event = {args:_r.slice.call(arguments,0)};
            _before(_event);
            if (!_event.stopped){
                _event.value = _handler.apply(this,_event.args);
                _after(_event);
            }
            return _event.value;
        };
    };
    /**
     * 绑定接口及参数，使其的调用对象保持一致
     *
     *  ```javascript
     *  var scope = {a:0};
     * 
     *  var func = function(a,b){
     *      // 第一个参数 ：1
     *      console.log(a);
     *      // 第二个参数 ： 2
     *      consoel.log(b);
     *      // 当前this.a ： 0
     *      console.log(this.a);
     *  };
     * 
     *  func._$bind(scope,"1")(2);
     *  ```
     *
     * @method external:Function#_$bind
     * @see    external:Function#_$bind2
     * @param  {Object} arg0 - 需要保持一致的对象，null表示window对象，此参数外的其他参数作为绑定参数
     * @return {Function}      返回绑定后的函数
     */
    _extpro._$bind = function() {
        var _args = arguments,
            _object = arguments[0],
            _function = this;
        return function(){
            // not use slice for chrome 10 beta and Array.apply for android
            var _argc = _r.slice.call(_args,1);
            _r.push.apply(_argc,arguments);
            return _function.apply(_object||null,_argc);
        };
    };
    /**
     * 绑定接口及参数，使其的调用对象保持一致，
     * 该接口与_$bind接口的差别在于绑定时参数和调用时参数的顺序不一样，
     * _$bind优先传入绑定时参数，_$bind2优先传入调用时参数
     *
     *  ```javascript
     *  var scope = {a:0};
     * 
     *  var func = function(a,b){
     *      // 第一个参数 ：2
     *      console.log(a);
     *      // 第二个参数 ： 1
     *      consoel.log(b);
     *      // 当前this.a ： 0
     *      console.log(this.a);
     *  };
     * 
     *  func._$bind(scope,"1")(2);
     *  ```
     *
     * @method external:Function#_$bind2
     * @see    external:Function#_$bind
     * @param  {Object} arg0 - 需要保持一致的对象，null表示window对象，此参数外的其他参数作为绑定参数
     * @return {Function}      返回绑定后的事件函数
     */
    _extpro._$bind2 = function() {
        var _args = arguments,
            _object = _r.shift.call(_args),
            _function = this;
        return function(){
            _r.push.apply(arguments,_args);
            return _function.apply(_object||null,arguments);
        };
    };
    // for compatiable
    var _extpro = String.prototype;
    if (!_extpro.trim){
         _extpro.trim = (function(){
            var _reg = /(?:^\s+)|(?:\s+$)/g;
            return function(){
                return this.replace(_reg,'');
            };
         })();
    }
    if (!this.console){
        this.console = {
            log:_f,
            error:_f
        };
    }

    if (CMPT){
        NEJ = this.NEJ||{};
        // copy object properties
        // only for nej compatiable
        NEJ.copy = function(a,b){
            a = a||{};
            b = b||_o;
            for(var x in b){
                if (b.hasOwnProperty(x)){
                    a[x] = b[x];
                }
            }
            return a;
        };
        // NEJ namespace
        NEJ = NEJ.copy(
            NEJ,{
                O:_o,R:_r,F:_f,
                P:function(_namespace){
                    if (!_namespace||!_namespace.length){
                        return null;
                    }
                    var _package = window;
                    for(var a=_namespace.split('.'),
                            l=a.length,i=(a[0]=='window')?1:0;i<l;
                            _package=_package[a[i]]=_package[a[i]]||{},i++);
                    return  _package;
                }
            }
        );
        
        return NEJ;
    }

    return _p;
});
I$(425,function (_p,_o,_f,_r){
    /**
     * 遍历对象
     * @param  {Object}   对象
     * @param  {Function} 迭代回调
     * @param  {Object}   回调执行对象
     * @return {String}   循环中断时的key值
     */
    _p.__forIn = function(_obj,_callback,_this){
        if (!_obj||!_callback){
            return null;
        }
        var _keys = Object.keys(_obj);
        for(var i=0,l=_keys.length,_key,_ret;i<l;i++){
            _key = _keys[i];
            _ret = _callback.call(
                _this||null,
                _obj[_key],_key,_obj
            );
            if (!!_ret){
                return _key;
            }
        }
        return null;
    };
    /**
     * 遍历列表
     * @param  {Array}    列表
     * @param  {Function} 迭代回调
     * @param  {Object}   回调执行对象
     * @return {Void}
     */
    _p.__forEach = function(_list,_callback,_this){
        _list.forEach(_callback,_this);
    };
    /**
     * 集合转数组
     * @param  {Object} 集合
     * @return {Array}  数组
     */
    _p.__col2array = function(_list){
        return _r.slice.call(_list,0);
    };
    /**
     * YYYY-MM-DDTHH:mm:ss.sssZ格式时间串转时间戳
     * @param  {String} 时间串
     * @return {Number} 时间戳
     */
    _p.__str2time = function(_str){
        return Date.parse(_str);
    };
    
    return _p;
});
I$(78,function (NEJ,_p,_o,_f,_r){
    var _platform  = this.navigator.platform,
        _useragent = this.navigator.userAgent;
    /**
     * 平台判断信息
     * 
     * ```javascript
     * NEJ.define([
     *     'base/platform'
     * ],function(_m){
     *     var _is = _m._$IS;
     *     // 是否MAC系统
     *     console.log(_is.mac);
     *     // 是否IPhone
     *     console.log(_is.iphone);
     *     // ...
     * });
     * ```
     * 
     * @const    module:base/platform._$IS
     * @see      module:base/platform._$is
     * @type     {Object}
     * @property {Boolean} mac     - 是否Mac系统
     * @property {Boolean} win     - 是否windows系统
     * @property {Boolean} linux   - 是否linux系统
     * @property {Boolean} ipad    - 是否Ipad
     * @property {Boolean} iphone  - 是否IPhone
     * @property {Boolean} android - 是否Android系统
     * @property {Boolean} ios     - 是否IOS系统
     * @property {Boolean} tablet  - 是否平板
     * @property {Boolean} desktop - 是否桌面系统
     */
    var _is = {
        mac     : _platform,
        win     : _platform,
        linux   : _platform,
        ipad    : _useragent,
        ipod    : _useragent,
        iphone  : _platform,
        android : _useragent
    };
    _p._$IS = _is;
    for(var x in _is){
        _is[x] = new RegExp(x,'i').test(_is[x]);
    }
    _is.ios = _is.ipad||_is.iphone||_is.ipod;
    _is.tablet = _is.ipad;
    _is.desktop = _is.mac||_is.win||(_is.linux&&!_is.android);
    /**
     * 判断是否指定平台
     * 
     * ```javascript
     * NEJ.define([
     *     'base/platform'
     * ],function(_m){
     *     // 是否MAC系统
     *     console.log(_m._$is('mac'));
     *     // 是否iphone
     *     console.log(_m._$is('iphone'));
     *     // ...
     * });
     * ```
     * 
     * @method module:base/platform._$is
     * @see    module:base/platform._$IS
     * @param  {String} arg0 - 平台名称
     * @return {Boolean}       是否指定平台
     */
    _p._$is = function(_platform){
        return !!_is[_platform];
    };
    // parse kernel information
    /**
     * 引擎内核信息
     * 
     * ```javascript
     * NEJ.define([
     *     'base/platform'
     * ],function(_m){
     *     var _kernel = _m._$KERNEL;
     *     // 打印平台信息
     *     console.log(_kernel.engine);
     *     console.log(_kernel.release);
     *     console.log(_kernel.browser);
     *     console.log(_kernel.version);
     * });
     * ```
     * 
     * @const    module:base/platform._$KERNEL
     * @type     {Object}
     * @property {String} engine  - 布局引擎，trident/webkit/gecko/presto...
     * @property {Number} release - 布局引擎版本
     * @property {String} browser - 浏览器名称，ie/chrome/safari/opera/firefox/maxthon...
     * @property {Number} version - 浏览器版本
     * @property {Object} prefix  - 平台前缀，html5/css3 attribute/method/constructor
     */
    var _kernel = {
        engine:'unknow',
        release:'unknow',
        browser:'unknow',
        version:'unknow',
        prefix:{css:'',pro:'',clz:''}
    };
    _p._$KERNEL  = _kernel;
    if (/msie\s+(.*?);/i.test(_useragent)||
        /trident\/.+rv:([\d\.]+)/i.test(_useragent)){
        _kernel.engine  = 'trident';
        _kernel.browser = 'ie';
        _kernel.version = RegExp.$1;
        _kernel.prefix  = {css:'ms',pro:'ms',clz:'MS',evt:'MS'};
        // 4.0-ie8 5.0-ie9 6.0-ie10 7.0-ie11
        // adjust by document mode setting in develop toolbar
        var _test = {6:'2.0',7:'3.0',8:'4.0',9:'5.0',10:'6.0',11:'7.0'};
        _kernel.release = _test[document.documentMode]||
                          _test[parseInt(_kernel.version)];
    }else if(/webkit\/?([\d.]+?)(?=\s|$)/i.test(_useragent)){
        _kernel.engine  = 'webkit';
        _kernel.release = RegExp.$1||'';
        _kernel.prefix  = {css:'webkit',pro:'webkit',clz:'WebKit'};
    }else if(/rv\:(.*?)\)\s+gecko\//i.test(_useragent)){
        _kernel.engine  = 'gecko';
        _kernel.release = RegExp.$1||'';
        _kernel.browser = 'firefox';
        _kernel.prefix  = {css:'Moz',pro:'moz',clz:'Moz'};
        if (/firefox\/(.*?)(?=\s|$)/i.test(_useragent))
            _kernel.version = RegExp.$1||'';
    }else if(/presto\/(.*?)\s/i.test(_useragent)){
        _kernel.engine  = 'presto';
        _kernel.release = RegExp.$1||'';
        _kernel.browser = 'opera';
        _kernel.prefix  = {css:'O',pro:'o',clz:'O'};
        if (/version\/(.*?)(?=\s|$)/i.test(_useragent))
            _kernel.version = RegExp.$1||'';
    }
    if (_kernel.browser=='unknow'){
        var _test = ['chrome','maxthon','safari'];
        for(var i=0,l=_test.length,_name;i<l;i++){
            _name = _test[i]=='safari'?'version':_test[i];
            if (new RegExp(_name+'/(.*?)(?=\\s|$)','i').test(_useragent)){
                _kernel.browser = _test[i];
                _kernel.version = RegExp.$1.trim();
                break;
            }
        }
    }
    /**
     * 引擎特性支持信息
     * 
     * ```javascript
     * NEJ.define([
     *     'base/platform'
     * ],function(_m){
     *     var _support = _m._$SUPPORT;
     *     // 打印平台是否支持CSS3 3D特效
     *     console.log(_support.css3d);
     * });
     * ```
     * @const    module:base/platform._$SUPPORT
     * @see      module:base/platform._$support
     * @type     {Object}
     * @property {Boolean} css3d  - 是否支持CSS3 3D
     */
    _p._$SUPPORT = {};
    /**
     * 判断平台是否支持指定特性
     * 
     * ```javascript
     * NEJ.define([
     *     'base/platform'
     * ],function(_m){
     *     // 是否支持CSS3 3D特效
     *     console.log(_m._$support('css3d'));
     * });
     * ```
     * 
     * @method module:base/platform._$support
     * @see    module:base/platform._$SUPPORT
     * @param  {String} arg0 - 特性标识
     * @return {Boolean}       是否支持指定特性
     */
    _p._$support = function(_feature){
        return !!_p._$SUPPORT[_feature];
    };
    
    if (CMPT){
        NEJ.copy(NEJ.P('nej.p'),_p);
    }
    
    return _p;
},215);
I$(216,function(_h,_m,_p,_o,_f,_r){if (_m._$KERNEL.engine==='trident'&&_m._$KERNEL.release<='4.0'){I$(426,function (){
        /**
         * 遍历对象
         * @param  {Object}   对象
         * @param  {Function} 迭代回调
         * @param  {Object}   回调执行对象
         * @return {String}   循环中断时的key值
         */
        _h.__forIn = function(_obj,_callback,_this){
            if (!_obj||!_callback){
                return;
            }
            // iterate
            var _ret;
            for(var x in _obj){
                if (!_obj.hasOwnProperty(x)) continue;
                _ret = _callback.call(_this,_obj[x],x,_obj);
                if (!!_ret){
                    return x;
                }
            }
        };
        /**
         * 遍历列表
         * @param  {Array}    列表
         * @param  {Function} 迭代回调
         * @param  {Object}   回调执行对象
         * @return {Void}
         */
        _h.__forEach = function(_list,_callback,_this){
            for(var i=0,l=_list.length;i<l;i++){
                _callback.call(_this,_list[i],i,_list);
            }
        };
        /**
         * 集合转数组
         * @param  {Object} 集合
         * @return {Array}  数组
         */
        _h.__col2array = function(_list){
            var _result = [];
            if (!!_list&&!!_list.length){
                for(var i=0,l=_list.length;i<l;i++){
                    _result.push(_list[i]);
                }
            }
            return _result;
        };
        /**
         * YYYY-MM-DDTHH:mm:ss.sssZ格式时间串转时间戳
         * @param  {String} 时间串
         * @return {Number} 时间戳
         */
        _h.__str2time = (function(){
            var _reg = /-/g;
            return function(_str){
                // only support YYYY/MM/DDTHH:mm:ss
                return Date.parse(_str.replace(_reg,'/').split('.')[0]);
            };
        })();
    });}return _h;},425,78);
I$(1,function (NEJ,_u,_p,_o,_f,_r){
    /**
     * 定义类，通过此api定义的类具有以下特性：
     *
     * * {@link external:Function#_$extend|_$extend}作为类的静态扩展方法
     * * __init作为类的初始化函数
     * * __super作为子类调用父类的同名函数
     *
     * ```javascript
     * NEJ.define([
     *     'base/klass'
     * ],function(k,p){
     *     // 定义类A
     *     p.A = k._$klass();
     *     var pro = A.prototype;
     *     // 初始化
     *     pro.__init = function(){
     *          // do init
     *     };
     *     // 类接口
     *     pro.__doSomething = function(a){
     *         // TODO something
     *     };
     * 
     *     return p;
     * });
     * ```
     * 
     * ```javascript
     * NEJ.define([
     *     'base/klass',
     *     '/path/to/class/a.js'
     * ],function(k,a,p){
     *     // 定义类B，并继承自A
     *     p.B = k._$klass();
     *     var pro = B._$extend(a.A);
     *     // 初始化
     *     pro.__init = function(){
     *         // 调用A的初始化逻辑
     *         this.__super();
     *         // TODO B的初始化逻辑
     *     };
     *     // 类接口
     *     pro.__doSomething = function(a){
     *         // 调用A的__doSomething接口
     *         this.__super(a);
     *         // TODO B的逻辑
     *     };
     * 
     *     return p;
     * });
     * ```
     * 
     * @method module:base/klass._$klass
     * @see    external:Function#_$extend
     * @return {Function} 返回定义的类
     */
    _p._$klass = (function(){
        var _isNotFunction = function(){
            return _o.toString.call(arguments[0])!=='[object Function]';
        };
        var _doFindIn = function(_method,_klass){
            while(!!_klass){
                var _pro = _klass.prototype,
                    _key = _u.__forIn(_pro,function(v){
                        return _method===v;
                    });
                if (_key!=null){
                    return {
                        name:_key,
                        klass:_klass
                    };
                }
                _klass = _klass._$super;
            }
        };
        return function(){
            // class constructor
            var _Klass = function(){
                return this.__init.apply(this,arguments);
            };
            _Klass.prototype.__init = _f;
            /**
             * 子类继承父类
             *
             * ```javascript
             * NEJ.define([
             *     'base/klass'
             * ],function(k,p){
             *     // 定义类A
             *     p.A = k._$klass();
             *     var pro = A.prototype;
             *     // 初始化
             *     pro.__init = function(){
             *          // do init
             *     };
             *     // 类接口
             *     pro.__doSomething = function(a){
             *         // TODO something
             *     };
             * 
             *     return p;
             * });
             * ```
             * 
             * ```javascript
             * NEJ.define([
             *     'base/klass',
             *     '/path/to/class/a.js'
             * ],function(k,a,p){
             *     // 定义类B，并继承自A
             *     p.B = k._$klass();
             *     var pro = B._$extend(a.A);
             *     // 初始化
             *     pro.__init = function(){
             *         // 调用A的初始化逻辑
             *         this.__super();
             *         // TODO B的初始化逻辑
             *     };
             *     // 类接口
             *     pro.__doSomething = function(a){
             *         // 调用A的__doSomething接口
             *         this.__super(a);
             *         // TODO B的逻辑
             *     };
             * 
             *     return p;
             * });
             * ```
             *
             * @method external:Function#_$extend
             * @see    module:base/klass._$klass
             * @param  {Function} arg0 - 父类
             * @param  {Boolean}  arg1 - 是否拷贝父类的静态方法，默认拷贝父类静态方法
             * @return {Object}          扩展类的prototype对象
             */
            _Klass._$extend = function(_super,_static){
                if (_isNotFunction(_super)){
                    return;
                }
                // for static method
                var _this = this;
                if (_static!==!1){
                    _u.__forIn(_super,function(v,k){
                        if (!_isNotFunction(v)){
                            _this[k] = v;
                        }
                    });
                }
                // do inherit
                this._$super = _super;
                var _parent = function(){};
                _parent.prototype = _super.prototype;
                this.prototype = new _parent();
                this.prototype.constructor = this;
                // for super method call
                var _stack = [],
                    _phash = {};
                var _doUpdateCache = function(_method,_klass){
                    var _result = _doFindIn(_method,_klass);
                    if (!_result) return;
                    // save state
                    if (_stack[_stack.length-1]!=_result.name){
                        _stack.push(_result.name);
                    }
                    _phash[_result.name] = _result.klass._$super;
                    return _result.name;
                };
                this.prototype.__super = function(){
                    var _name = _stack[_stack.length-1],
                        _method = arguments.callee.caller;
                    if (!_name){
                        _name = _doUpdateCache(_method,this.constructor);
                    }else{
                        var _parent = _phash[_name].prototype;
                        // switch caller name
                        if (!_parent.hasOwnProperty(_method)||
                            _method!=_parent[_name]){
                            _name = _doUpdateCache(_method,this.constructor);
                        }else{
                            _phash[_name] = _phash[_name]._$super;
                        }
                    }
                    // call parent method
                    var _ret = _phash[_name].prototype[_name].apply(this,arguments);
                    // exit super
                    if (_name==_stack[_stack.length-1]){
                        _stack.pop();
                        delete _phash[_name];
                    }
                    return _ret;
                };

                if (CMPT){
                    var _pro = this.prototype;
                    _pro.__supInit      = _pro.__super;
                    _pro.__supReset     = _pro.__super;
                    _pro.__supDestroy   = _pro.__super;
                    _pro.__supInitNode  = _pro.__super;
                    _pro.__supDoBuild   = _pro.__super;
                    _pro.__supOnShow    = _pro.__super;
                    _pro.__supOnHide    = _pro.__super;
                    _pro.__supOnRefresh = _pro.__super;
                    this._$supro = _super.prototype;
                }

                return this.prototype;
            };
            return _Klass;
        };
    })();

    if (CMPT){
        NEJ.C = _p._$klass;
        NEJ.copy(this.NEJ,NEJ);
    }

    return _p;
},215,216);
I$(2,function (NEJ,_h,_p,_o,_f,_r){
    /*
     * 查看数据是否指定类型
     * @param  {Variable} 数据
     * @param  {String}   类型
     * @return {Boolean}  是否指定类型
     */
    var _isTypeOf = function(_data,_type){
        try{
            _type = _type.toLowerCase();
            if (_data===null) return _type=='null';
            if (_data===undefined) return _type=='undefined';
            return _o.toString.call(_data).toLowerCase()=='[object '+_type+']';
        }catch(e){
            return !1;
        }
    };
    /**
     * 判断是否函数类型
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 返回false
     *     var is = _u._$isFunction(123);
     *     // 返回true
     *     var is = _u._$isFunction(function(){});
     * });
     * ```
     *
     * @method module:base/util._$isFunction
     * @param  {Variable} arg0 - 待检测类型的数据
     * @return {Boolean}         是否函数类型
     */
    _p._$isFunction = function(_data){
        return _isTypeOf(_data,'function');
    };
    /**
     * 判断是否字符串
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 返回false
     *     var is = _u._$isString(123);
     *     // 返回true
     *     var is = _u._$isString("123");
     * });
     * ```
     *
     * @method module:base/util._$isString
     * @param  {Variable} arg0 - 待检测类型的数据
     * @return {Boolean}         是否字符串
     */
    _p._$isString = function(_data){
        return _isTypeOf(_data,'string');
    };
    /**
     * 判断是否数字
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 返回false
     *     var is = _u._$isNumber("123");
     *     // 返回true
     *     var is = _u._$isNumber(123);
     *     var is = _u._$isNumber(-123);
     *     var is = _u._$isNumber(Number.MAX_VALUE);
     * });
     * ```
     *
     * @method module:base/util._$isNumber
     * @param  {Variable} arg0 - 待检测类型的数据
     * @return {Boolean}         是否数值类型
     */
    _p._$isNumber = function(_data){
        return _isTypeOf(_data,'number');
    };
    /**
     * 判断是否布尔值
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 返回false
     *     var is = _u._$isBoolean(0);
     *     // 返回true
     *     var is = _u._$isBoolean(false);
     * });
     * ```
     *
     * @method module:base/util._$isBoolean
     * @param  {Variable} arg0 - 待检测类型的数据
     * @return {Boolean}         是否布尔值
     */
    _p._$isBoolean = function(_data){
        return _isTypeOf(_data,'boolean');
    };
    /**
     * 判断是否日期
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 返回false
     *     var is = _u._$isDate(0);
     *     // 返回true
     *     var is = _u._$isDate(new Date());
     * });
     * ```
     *
     * @method module:base/util._$isDate
     * @param  {Variable} arg0 - 待检测类型的数据
     * @return {Boolean}         是否日期
     */
    _p._$isDate = function(_data){
        return _isTypeOf(_data,'date');
    };
    /**
     * 判断是否数组
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 返回false
     *     var is = _u._$isArray(0);
     *     // 返回true
     *     var is = _u._$isArray([1,2]);
     * });
     * ```
     *
     * @method module:base/util._$isArray
     * @param  {Variable} arg0 - 待检测类型的数据
     * @return {Boolean}         是否数组
     */
    _p._$isArray = function(_data){
        return _isTypeOf(_data,'array');
    };
    /**
     * 判断是否对象
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 返回false
     *     var is = _u._$isObject(function(){});
     *     // 返回true
     *     var is = _u._$isObject({});
     *     var is = _u._$isObject({a:"a"});
     * });
     * ```
     *
     * @method module:base/util._$isObject
     * @param  {Variable} arg0 - 待检测类型的数据
     * @return {Boolean}         是否对象
     */
    _p._$isObject = function(_data){
        return _isTypeOf(_data,'object');
    };
    /**
     * 计算字符串长度，中文算两个字符
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 字符串长度为5
     *     var len = _u._$length('你i他');
     * });
     * ```
     *
     * @method module:base/util._$length
     * @param  {String} arg0 - 待计算长度字符串
     * @return {Number}        字符串长度
     */
    _p._$length = (function(){
        var _reg = /[^\x00-\xff]/g;
        return function(_content){
            return (''+(_content||'')).replace(_reg,'**').length;
        };
    })();
    /**
     * 遍历对象
     * 
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *       var obj = {a:{id:1,name:'a'},b:{id:2,name:'b'},...};
     * 
     *       // 遍历对象    
     *       _u._$loop(obj,function(_item,_key){
     *           // TODO
     *       });
     * 
     *       // 从对象里查找id为2的元素，如果有返回KEY，没有返回null
     *       var key = _u._$loop(obj,function(_item){
     *           return _item.id==2;
     *       });
     * });
     * ```
     * 
     * @method module:base/util._$loop
     * @see    module:base/util._$forIn
     * @param  {Object}   arg0 - 对象
     * @param  {Function} arg1 - 回调，如果返回true，则中断遍历
     * @param  {Object}   arg2 - 回调函数调用时this对象
     * @return {String}          返回中断时的标识，没有中断则统一返回null
     */
    _p._$loop = function(_obj,_callback,_this){
        if (_p._$isObject(_obj)&&
            _p._$isFunction(_callback)){
            return _h.__forIn.apply(_h,arguments);
        }
        return null;
    };
    /**
     * 线性查找指定项
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     var list = ["你","我","他"];
     *     // 返回下标1
     *     var index = _u._$indexOf(list,"我");
     *     // 没有找到，返回-1
     *     var index = _u._$indexOf(list,"他们");
     *     // 如果第二个参数是过滤接口，根据接口的规则查找
     *     // 以下规则排除第一个下标
     *     var index = _u._$indexOf(list,function(_item,_index,_list){
     *           return _item==='他';
     *     });
     * });
     * ```
     *
     * @method module:base/util._$indexOf
     * @param  {Array}    arg0 - 待搜索列表
     * @param  {Variable} arg1 - 指定项，如果为function则表示过滤接口
     * @return {Number}          给定项所在的位置索引，以0开始，没有项返回-1
     */
    _p._$indexOf = function(_list,_item){
        var _filter = _p._$isFunction(_item) ? _item
                    : function(_value){return _value===_item;},
            _index  = _p._$forIn(_list,_filter);
        return _index!=null?_index:-1;
    };
    /**
     * 二分法查找指定项
     * 
     * 验证函数输入输出说明
     * 
     * |      | 类型          | 结果说明 |
     * | :--  | :--      | :-- |
     * | 输入  | Variable | 中间项元素 |
     * | 输出  | Number   | < 0  目标元素在低位区间 |
     * |      |          | = 0  匹配到目标元素 |
     * |      |          | > 0  目标元素在高位区间 |
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 二分查找id为2的项的索引值
     *     var list = [{id:1,name:'aaa'},{id:2,name:'bbbb'},...];
     *     var index = _u._$binSearch(list,function(_item){
     *         return _item.id-2;
     *     });
     * });
     * ```
     *
     * @method module:base/util._$binSearch
     * @param  {Array}    arg0 - 待查找列表
     * @param  {Function} arg1 - 验证函数
     * @return {Number}          找到匹配项索引，找不到返回-1
     */
    _p._$binSearch = (function(){
        var _docheck;
        // do binary search
        var _doSearch = function(_list,_low,_high){
            if (_low>_high) return -1;
            var _middle = Math.ceil((_low+_high)/2),
                _result = _docheck(_list[_middle],_middle,_list);
            if (_result==0)
                return _middle;
            if (_result<0)
                return _doSearch(_list,_low,_middle-1);
            return _doSearch(_list,_middle+1,_high);
        };
        return function(_list,_check){
            _docheck = _check||_f;
            return _doSearch(_list,0,_list.length-1);
        };
    })();
    /**
     * 逆序遍历列表，支持中断
     * 
     * 回调函数输入输出说明
     * 
     * |      | 类型          | 说明 |
     * | :--  | :--      | :-- |
     * | 输入  | Variable | 值 |
     * |      | Number   | 下标 |
     * |      | Array    | 列表对象 |
     * | 输出  | Boolean  | 是否匹配 |
     * 
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 删除id为3的项，并退出循环
     *     var list = [{id:1,name:'aaa'},{id:2,name:'bbbb'},...];
     *     _u._$reverseEach(list,function(_item,_index,_list){
     *         if (_item.id==3){
     *             _list.splice(_index,1);
     *             return !0;
     *         }
     *     });
     * });
     * ```
     *
     * @method module:base/util._$reverseEach
     * @see    module:base/util._$forEach
     * @param  {Array}    arg0 - 列表
     * @param  {Function} arg1 - 回调，如果返回true，则中断遍历
     * @param  {Object}   arg2 - 回调函数调用时this对象
     * @return {Number}          返回遍历中断时的索引值，没有中断则返回null
     */
    _p._$reverseEach = function(_list,_callback,_this){
        if (!!_list&&!!_list.length&&_p._$isFunction(_callback)){
            for(var i=_list.length-1;i>=0;i--){
                if (!!_callback.call(_this,_list[i],i,_list)){
                    return i;
                }
            }
        }
        return null;
    };
    /**
     * 正序遍历列表，不支持中断
     * 
     * 回调函数输入输出说明
     * 
     * |      | 类型          | 说明 |
     * | :--  | :--      | :-- |
     * | 输入  | Variable | 值 |
     * |      | Number   | 下标 |
     * |      | Array    | 列表对象 |
     * | 输出  | Boolean  | 是否匹配 |
     * 
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     var list = [1,2,3];
     *     _u._$forEach(list,function(_item,_index,_list){
     *         // TODO somthing
     *     });
     * });
     * ```
     *
     * @method module:base/util._$forEach
     * @see    module:base/util._$reverseEach
     * @param  {Array}    arg0 - 列表
     * @param  {Function} arg1 - 回调，如果返回true，则中断遍历
     * @param  {Object}   arg2 - 回调函数调用时this对象
     * @return {Void}
     */
    _p._$forEach = function(_list,_callback,_this){
        if (!!_list&&!!_list.length&&
            _p._$isFunction(_callback)){
            if (!_list.forEach){
                _p._$forIn.apply(_p,arguments);
            }else{
                _h.__forEach(_list,_callback,_this);
            }
        }
    };
    /**
     * 遍历列表或对象，如果带length属性，则作为数组遍历，如果要遍历带length属性的对象用_$loop接口，支持中断退出
     *
     * 回调函数输入输出说明
     * 
     * |      | 类型          | 说明 |
     * | :--  | :--      | :-- |
     * | 输入  | Variable | 值 |
     * |      | Number   | 下标 |
     * |      | Object_Array | 列表或者集合对象 |
     * | 输出  | Boolean  | 是否匹配 |
     * 
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *       // 从有序列表里查找id为2的元素，如果有则返回索引，没有返回null
     *       var list = [{id:1,name:'a'},{id:2,name:'b'},...];
     *       var index = _u._$forIn(list,function(_item){
     *           return _item.id==2;
     *       });
     *
     *       // 从对象里查找id为2的元素，如果有返回KEY，没有返回null
     *       var obj = {a:{id:1,name:'a'},b:{id:2,name:'b'},...};
     *       var key = _u._$forIn(obj,function(_item){
     *           return _item.id==2;
     *       });
     * });
     * ```
     *
     * @method module:base/util._$forIn
     * @param  {Object|Array} arg0 - 列表或者对象
     * @param  {Function}     arg1 - 回调，如果返回true，则中断遍历
     * @param  {Object}       arg2 - 回调函数调用时this对象
     * @return {String|Number}       返回中断时的索引或者标识，没有中断则统一返回null
     */
    _p._$forIn = function(_list,_callback,_this){
        if (!_list||!_p._$isFunction(_callback)){
            return null;
        }
        if (_p._$isNumber(_list.length)){
            // list see as array
            for(var i=0,l=_list.length;i<l;i++){
                if (!!_callback.call(_this,_list[i],i,_list)){
                    return i;
                }
            }
        }else if (_p._$isObject(_list)){
            // list is object
            return _p._$loop(_list,_callback,_this);
        }
        return null;
    };
    /**
     * 编码字符串，
     * 编码规则对象中r正则表达式参数提取字符串需要编码的内容，
     * 然后使用编码规则对象中的映射表进行替换
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 把字符串99999根据规则9替换成t，结果：ttttt
     *     var str = _u._$encode({r:/\d/g,'9':'t'},'99999');
     * });
     * ```
     *
     * @method module:base/util._$encode
     * @param  {Object} arg0 - 编码规则
     * @param  {String} arg1 - 待编码的字串
     * @return {String}        编码后的字串
     */
    _p._$encode = function(_map,_content){
        _content = ''+_content;
        if (!_map||!_content){
            return _content||'';
        }
        return _content.replace(_map.r,function($1){
            var _result = _map[!_map.i?$1.toLowerCase():$1];
            return _result!=null?_result:$1;
        });
    };
    /**
     * 编码html代码，'<' -> '&amp;lt;'
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 编码，结果：&amp;lt;a&amp;gt;util&amp;lt;/a&amp;gt;&amp;amp;
     *     var str = _u._$escape('<a>util</a>&');
     * });
     * ```
     *
     * @method module:base/util._$escape
     * @see    module:base/util._$unescape
     * @param  {String} arg0 - 待编码串
     * @return {String}        编码后的串
     */
    _p._$escape = (function(){
        var _reg = /<br\/?>$/,
            _map = {
                r:/\<|\>|\&|\r|\n|\s|\'|\"/g,
                '<':'&lt;','>':'&gt;','&':'&amp;',' ':'&nbsp;',
                '"':'&quot;',"'":'&#39;','\n':'<br/>','\r':''
            };
        return function(_content){
            _content = _p._$encode(_map,_content);
            return _content.replace(_reg,'<br/><br/>');
        };
    })();
    /**
     * 反编码html代码，'&amp;lt;' -> '<' 
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 反编码，结果：<&a>util</a>
     *     var str = _u._$unescape('&amp;lt;&amp;amp;a&amp;gt;util&amp;lt;/a&amp;gt;');
     * });
     * ```
     *
     * @method module:base/util._$unescape
     * @see    module:base/util._$escape
     * @param  {String} arg0 - 待反编码串
     * @return {String}        反编码后的串
     */
    _p._$unescape = (function(){
        var _map = {r:/\&(?:lt|gt|amp|nbsp|#39|quot)\;|\<br\/\>/gi,'&lt;':'<','&gt;':'>','&amp;':'&','&nbsp;':' ','&#39;':"'",'&quot;':'"','<br/>':'\n'};
        return function(_content){
            return _p._$encode(_map,_content);
        };
    })();
    /**
     * 格式化时间，yyyy|yy|MM|cM|eM|M|dd|d|HH|H|mm|ms|ss|m|s|w
     *
     * 各标识说明：
     * 
     * | 标识  | 说明 |
     * | :--  | :-- |
     * | yyyy | 四位年份，如2001 |
     * | yy   | 两位年费，如01 |
     * | MM   | 两位月份，如08 |
     * | M    | 一位月份，如8 |
     * | dd   | 两位日期，如09 |
     * | d    | 一位日期，如9 |
     * | HH   | 两位小时，如07 |
     * | H    | 一位小时，如7 |
     * | mm   | 两位分钟，如03 |
     * | m    | 一位分钟，如3 |
     * | ss   | 两位秒数，如09 |
     * | s    | 一位秒数，如9 |
     * | ms   | 毫秒数，如234 |
     * | w    | 中文星期几，如一 |
     * | ct   | 12小时制中文后缀，上午/下午 |
     * | et   | 12小时制英文后缀，A.M./P.M. |
     * | cM   | 中文月份，如三 |
     * | eM   | 英文月份，如Mar |
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 根据格式输出时间，比如:2012-01-11,连接符可自定义
     *     var str = _u._$format(new Date(),'yyyy-MM-dd');
     * });
     * ```
     *
     * @method module:base/util._$format
     * @param  {Number|String|Date} arg0 - 时间
     * @param  {String}             arg1 - 格式
     * @return {String}                    指定格式的时间串
     */
    _p._$format = (function(){
        var _map = {i:!0,r:/\byyyy|yy|MM|cM|eM|M|dd|d|HH|H|mm|ms|ss|m|s|w|ct|et\b/g},
            _12cc = ['上午','下午'],
            _12ec = ['A.M.','P.M.'],
            _week = ['日','一','二','三','四','五','六'],
            _cmon = ['一','二','三','四','五','六','七','八','九','十','十一','十二'],
            _emon = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sept','Oct','Nov','Dec'];
        var _fmtnmb = function(_number){
            _number = parseInt(_number)||0;
            return (_number<10?'0':'')+_number;
        };
        var _fmtclc = function(_hour){
            return _hour<12?0:1;
        };
        return function(_time,_format,_12time){
            if (!_time||!_format)
                return '';
            _time = _p._$var2date(_time);
            _map.yyyy = _time.getFullYear();
            _map.yy   = (''+_map.yyyy).substr(2);
            _map.M    = _time.getMonth()+1;
            _map.MM   = _fmtnmb(_map.M);
            _map.eM   = _emon[_map.M-1];
            _map.cM   = _cmon[_map.M-1];
            _map.d    = _time.getDate();
            _map.dd   = _fmtnmb(_map.d);
            _map.H    = _time.getHours();
            _map.HH   = _fmtnmb(_map.H);
            _map.m    = _time.getMinutes();
            _map.mm   = _fmtnmb(_map.m);
            _map.s    = _time.getSeconds();
            _map.ss   = _fmtnmb(_map.s);
            _map.ms   = _time.getMilliseconds();
            _map.w    = _week[_time.getDay()];
            var _cc   = _fmtclc(_map.H);
            _map.ct   = _12cc[_cc];
            _map.et   = _12ec[_cc];
            if (!!_12time){
                _map.H = _map.H%12;
            }
            return _p._$encode(_map,_format);
        };
    })();
    /**
     * 日期字符串转日期对象
     * 
     * 字符串日期格式同ECMA规范定义：YYYY-MM-DDTHH:mm:ss.sssZ
     * 
     * 各标识说明：
     * 
     * | 标识 | 说明 |
     * | :--  | :-- |
     * | YYYY | 四位年份，0000-9999，如2001 |
     * | -    | 年月日分隔符 |
     * | MM   | 两位月份，01-12，如03 |
     * | DD   | 两位日期，01-31，如07 |
     * | T    | 时间起始标识 |
     * | HH   | 两位小时，00-24，如05 |
     * | :    | 时分秒分隔符 |
     * | mm   | 两位分钟，00-59，如30 |
     * | ss   | 两位秒数，00-59，如08 |
     * | .    | 秒/毫秒分隔符 |
     * | sss  | 三位毫秒数，000-999，如004 |
     * | Z    | 时区偏移 |
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 输入YYYY-MM-DDTHH:mm:ss.sssZ格式字符串，生成日期对象
     *     var date = _u._$var2date('2013-07-29T13:12:45.300');
     *
     *     // 输入YYYY-MM-DDTHH:mm:ss格式字符串，生成日期对象
     *     var date = _u._$var2date('2013-07-29T13:12:45');
     *
     *     // 输入YYYY-MM-DD格式字符串，生成日期对象
     *     var date = _u._$var2date('2013-07-29');
     * });
     * ```
     *
     * @method module:base/util._$var2date
     * @param  {String} arg0 - 日期串
     * @return {Date}          日期对象
     */
    _p._$var2date = function(_time){
        var _date = _time;
        if (_p._$isString(_time)){
            _date = new Date(
                _h.__str2time(_time)
            );
        }
        if (!_p._$isDate(_date)){
            _date = new Date(_time);
        }
        return _date;
    };
    /**
     * 浮点数值保留指定位数小数点
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 保留2位小数，返回3.14
     *     var value = _u._$fixed(3.14159,2);
     * });
     * ```
     *
     * @method module:base/util._$fixed
     * @param  {Float}  arg0 - 浮点数
     * @param  {Number} arg1 - 小数位
     * @return {Number}        浮点数
     */
    _p._$fixed = function(_float,_fraction){
        return parseFloat(new Number(_float).toFixed(_fraction));
    };
    /**
     * 相对路径转绝对路径
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 相对路径../a/b.html转绝对路径http://a.b.com:8010/a/b.html
     *     var url = _u._$absolute(
     *         '../a/b.html',
     *         'http://a.b.com:8010/z/'
     *     );
     * });
     * ```
     * 
     * @method module:base/util._$absolute
     * @param  {String} arg0 - 相对路径
     * @param  {String} arg1 - 绝对路径ROOT，必须以http://开始，默认为location目录
     * @return {String}        绝对路径地址
     */
    _p._$absolute = (function(){
        var _reg0 = /([^\/:])\/.*$/,
            _reg1 = /\/[^\/]+$/,
            _reg2 = /[#\?]/,
            _base = location.href.split(/[?#]/)[0],
            _anchor = document.createElement('a');
        var _isAbsolute = function(_uri){
            return (_uri||'').indexOf('://')>0;
        };
        var _doFormat = function(_uri){
            return (_uri||'').split(_reg2)[0]
                             .replace(_reg1,'/');
        };
        var _doMergeURI = function(_uri,_root){
            // for /a/b/c
            if (_uri.indexOf('/')==0)
                return _root.replace(_reg0,'$1')+_uri;
            // for a/b or ./a/b or ../a/b
            return _doFormat(_root)+_uri;
        };
        _base = _doFormat(_base);
        return function(_uri,_root){
            _uri = (_uri||'').trim();
            if (!_isAbsolute(_root))
                _root = _base;
            if (!_uri) return _root;
            if (_isAbsolute(_uri))
                return _uri;
            _uri = _doMergeURI(_uri,_root);
            _anchor.href = _uri;
            _uri = _anchor.href;
            return _isAbsolute(_uri) ? _uri :
                   _anchor.getAttribute('href',4); // ie6/7
        };
    })();
    /**
     * 从URL地址中提取源信息
     * 
     * * http://a.b.com:8080/a/b/ -> http://a.b.com:8080
     * * /a/b -> 
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 提取url地址的源信息
     *     // 返回http://a.b.com:8080
     *     var origin = _u._$url2origin("http://a.b.com:8080/a/b/");
     * });
     * ```
     *
     * @method module:base/util._$url2origin
     * @param  {String} arg0 - URL地址
     * @return {String}        源信息
     */
    _p._$url2origin = (function(){
        var _reg = /^([\w]+?:\/\/.*?(?=\/|$))/i;
        return function(_url){
            if (_reg.test(_url||''))
                return RegExp.$1.toLowerCase();
            return '';
        };
    })();
    /**
     * key-value字符串转对象
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     var str = "abc=abc,123=123";
     *     // 返回对象{abc:"abc",123:"123"}
     *     var obj = _u._$string2object(_str,",");
     * });
     * ```
     *
     * @method module:base/util._$string2object
     * @see    module:base/util._$object2string
     * @param  {String}        arg0 - 待处理数据
     * @param  {String|RegExp} arg1 - 分隔符
     * @return {Object}               转换后对象
     */
    _p._$string2object = function(_string,_split){
        var _obj = {};
        _p._$forEach(
            (_string||'').split(_split),
            function(_name){
                var _brr = _name.split('=');
                if (!_brr||!_brr.length) return;
                var _key = _brr.shift();
                if (!_key) return;
                _obj[decodeURIComponent(_key)] =
                     decodeURIComponent(_brr.join('='));
            }
        );
        return _obj;
    };
    /**
     * key-value对象转成key=value对后用分隔符join
     * 
     * 对象中不同类型的取值规则如下：
     * 
     * | 类型            |  取值规则 |
     * | :--       | :-- |
     * | Function  |  过滤掉，不输出 |
     * | Date      |  转成时间戳，getTime取值 |
     * | Array     |  值用逗号分隔，如[1,2,3] -> 1,2,3 |
     * | Object    |  使用JSON转成字符串 |
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 返回字符串 abc=abc,123=123
     *     var obj = {
     *         abc:"abc",
     *         123:"123"
     *     };
     *     var str = _u._$object2string(obj);
     *
     *     // 返回字符串
     *     // a=1871406603152186&b=1,2,3&d={"a":"a","b":"b"}&e=e&f=1&g=true
     *     var obj = {
     *         a:new Date,
     *         b:[1,2,3],
     *         c:function(){},
     *         d:{a:'a',b:'b'},
     *         e:'e',
     *         f:1,
     *         g:true
     *     };
     *     var str = _u._$object2string(obj,'&');
     * });
     * ```
     *
     * @method module:base/util._$object2string
     * @see    module:base/util._$string2object
     * @param  {Object}  arg0 - 对象
     * @param  {String}  arg1 - 分隔符，默认为逗号
     * @param  {Boolean} arg2 - 是否编码
     * @return {String}         key-value串
     */
    _p._$object2string = function(_object,_split,_encode){
        if (!_object) return '';
        var _arr = [];
        _p._$loop(
            _object,function(_value,_key){
                if (_p._$isFunction(_value)){
                    return;
                }
                if (_p._$isDate(_value)){
                    _value = _value.getTime();
                }else if(_p._$isArray(_value)){
                    _value = _value.join(',');
                }else if(_p._$isObject(_value)){
                    _value = JSON.stringify(_value);
                }
                if (!!_encode){
                    _value = encodeURIComponent(_value);
                }
                _arr.push(encodeURIComponent(_key)+'='+_value);
            }
        );
        return _arr.join(_split||',');
    };
    /**
     * 查询串转对象
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 返回对象{abc:"abc",123:"123"}
     *     var obj = _u._$query2object("abc=abc&123=123");
     * });
     * ```
     *
     * @method module:base/util._$query2object
     * @see    module:base/util._$object2query
     * @see    module:base/util._$string2object
     * @param  {String} arg0 - 查询串
     * @return {Object}        转换出来的对象
     */
    _p._$query2object = function(_query){
        return _p._$string2object(_query,'&');
    };
    /**
     * 对象转查询串
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 返回对象123=123&abc=abc
     *     var query = _u._$object2query({abc:"abc",123:"123"});
     * });
     * ```
     *
     * @method module:base/util._$object2query
     * @see    module:base/util._$query2object
     * @see    module:base/util._$object2string
     * @param  {Object} arg0 - 对象
     * @return {String}        查询串
     */
    _p._$object2query = function(_object){
        return _p._$object2string(_object,'&',!0);
    };
    /**
     * 集合转数组，集合具有length属性
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 返回数组['1','2','3']
     *     var map = {0:'0',1:'1',2:'2',length:3};
     *     var arr = _u._$object2array(map);
     *
     *     // 多用于对节点集合的转换
     *     var nodes = document.body.childNodes;
     *     var arr = _u._$object2array(nodes);
     * });
     * ```
     *
     * @method module:base/util._$object2array
     * @see    module:base/util._$array2object
     * @param  {Object} arg0 - 集合，必须有length属性
     * @return {Array}         数组
     */
    _p._$object2array = function(_object){
        return _h.__col2array(_object);
    };
    /**
     * 数组转对象，将列表中元素按照指定KEY组成对象<br/>
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 输出结果为 {2:{id:2,name:'b'},...}
     *     var arr = [{id:1,name:'a'},{id:2,name:'b'},...];
     *     var obj = _u._$array2object(
     *         arr,function(_item){
     *             // 过滤name为a的项
     *             if (_item.name=='a'){
     *                 return;
     *             }
     *             // 组对象的KEY用每项的id
     *             return _item.id;
     *         }
     *     );
     *
     *     // 默认使用每项的值组对象
     *     var brr = ['a','b','c',...];
     *     // 输出 {a:'a',b:'b',c:'c',...}
     *     var obj = _u._$array2object(brr);
     * });
     * ```
     *
     * @method module:base/util._$array2object
     * @see    module:base/util._$object2array
     * @param  {Array}    arg0 - 列表
     * @param  {Function} arg1 - 过滤函数，返回每一项的KEY，没有返回则过滤当前项
     * @return {Object}   对象
     */
    _p._$array2object = function(_list,_filter){
        var _result = {};
        _p._$forEach(
            _list,function(_item){
                var _key = _item;
                if (!!_filter){
                    _key = _filter(_item);
                }
                if (_key!=null){
                    _result[_key] = _item;
                }
            }
        );
        return _result;
    };
    /**
     * 格式化数字为指定位数，不足位数前面用0补足
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 2    -> 002
     *     // 22   -> 022
     *     // 222  -> 222
     *     // 2222 -> 2222
     *     var str = _u._$number2string(2,3);
     * });
     * ```
     *
     * @method module:base/util._$number2string
     * @param  {Number} arg0 - 数值
     * @param  {Number} arg1 - 位数，至少1位
     * @return {String}        格式化后字符串
     */
    _p._$number2string = function(_number,_limit){
        var _len1 = (''+_number).length,
            _len2 = Math.max(1,parseInt(_limit)||0),
            _delta = _len2-_len1;
        if (_delta>0){
            _number = new Array(_delta+1).join('0')+_number;
        }
        return ''+_number;
    };
    /**
     * 安全删除属性，
     * 部分浏览器（如低版本IE）禁止直接delete节点上的属性
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 节点上保存的数据
     *     _node.data = {a:'aaaaa',b:'bbbbb'};
     *     _node.test = 'aaaaa';
     *
     *     // 删除单个属性
     *     _u._$safeDelete(_node,'test');
     *     // 批量删除
     *     _u._$safeDelete(_node,['test','data']);
     * });
     * ```
     *
     * @method module:base/util._$safeDelete
     * @param  {Object}       arg0 - 对象
     * @param  {String|Array} arg1 - 属性
     * @return {Void}
     */
    _p._$safeDelete = function(_object,_name){
        if (!_p._$isArray(_name)){
            try{
                delete _object[_name];
            }catch(e){
                _object[_name] = undefined;
            }
        }else{
            _p._$forEach(
                _name,function(_item){
                    _p._$safeDelete(_object,_item);
                }
            );
        }
    };
    /**
     * 随机一个字符串
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 可能返回"13d1r1dt2"
     *     var seed = _u._$randString(9);
     * });
     * ```
     *
     * @method module:base/util._$randString
     * @param  {String} arg0 - 字符串长度
     * @return {String}        随机字符串
     */
    _p._$randString = (function(){
        var _chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz';
        return function(_length){
            _length = _length||10;
            var _result = [];
            for(var i=0,_rnum;i<_length;++i){
                _rnum = Math.floor(Math.random()*_chars.length);
                _result.push(_chars.charAt(_rnum));
            }
            return _result.join('');
        };
    })();
    /**
     * 随机生成一个给定范围的整数
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 可能返回3
     *     var seed = _u._$randNumber(0,9);
     * });
     * ```
     * 
     * @method module:base/util._$randNumber
     * @see    module:base/util._$randNumberString
     * @param  {Number} arg0 - 小区间，包含
     * @param  {Number} arg1 - 大区间，不包含
     * @return {Number}        随机整数
     */
    _p._$randNumber = function(_min,_max){
        return Math.floor(Math.random()*(_max-_min)+_min);
    };
    /**
     * 随机生成一个全部为数字的字符串
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 可能返回123456789
     *     var seed = _u._$randNumberString(9);
     * });
     * ```
     *
     * @deprecated
     * @method module:base/util._$randNumberString
     * @see    module:base/util._$randNumber
     * @see    module:base/util._$uniqueID
     * @param  {Number} arg0 - 随机字符串的长度[1,30]
     * @return {String}        随机生成的字符串
     */
    _p._$randNumberString = function(_length){
        _length = Math.max(0,Math.min(_length||8,30));
        var _min = Math.pow(10,_length-1),_max = _min*10;
        return _p._$randNumber(_min,_max).toString();
    };
    /**
     * 生成系统中的唯一标识，每次调用均生成一个新的标识
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_p){
     *    // 可能返回123456789
     *    var _id1 = _p._$uniqueID(),
     *        _id2 = _p._$uniqueID();
     *    // _id1 != _id2
     * });
     * ```
     *
     * @method module:base/util._$uniqueID
     * @return {String} 唯一标识
     */
    _p._$uniqueID = (function(){
        var _seed = +new Date;
        return function(){
            return ''+(_seed++);
        };
    })();
    /**
     * 读取上下文中指定名字空间的值
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     var obj = {
     *         a:{
     *             b:{
     *                 c:{
     *                     d:'ddddd'
     *                 }
     *             }
     *         }
     *     };
     *     // 输出 ddddd
     *     var value = _u._$query(obj,'a.b.c.d');
     *     // 输出 undefined
     *     var value = _u._$query(null,'a.b.c.d');
     * });
     * ```
     *
     * @method module:base/util._$query
     * @param  {Object} arg0 - 上下文
     * @param  {String} arg1 - 名字空间
     * @return {Varaible}      查询到的值
     */
    _p._$query = function(_context,_namespace){
        _context = _context||_o;
        var _arr = (_namespace||'').split('.');
        for(var i=0,l=_arr.length;i<l;i++){
            _context = _context[_arr[i]];
            if (!_context) break;
        }
        return _context;
    };
    /**
     * 合并数据，同名属性右侧覆盖左侧，
     * 最后一个如果是函数则用做数据过滤，
     * 第一个参数作为合并数据结果集对象，如果为空则新建对象
     * 
     * 过滤接口输入输出说明
     * 
     * |      | 类型          | 说明 |
     * | :--  | :--      | :-- |
     * | 输入  | Variable | 值 |
     * |      | String   | 键 |
     * | 输出  | Boolean  | 是否过滤 |
     * 
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 合并多个数据至obj0中
     *     var obj0 = {a:0,b:1},
     *         obj1 = {a:"a",b:"b",c:"c"},
     *         obj2 = {c:"c",d:"d",e:"f"},
     *         ... ;
     *     var obj = _u._$merge(obj0,obj1,obj2,...);
     *
     *     // 带过滤接口合并
     *     // 阻止a属性的覆盖
     *     var obj = _u._$merge(
     *         obj0,obj1,obj2,...,
     *         function(_value,_key){
     *             return _key=='a';
     *         }
     *     );
     * });
     * ```
     *
     * @method module:base/util._$merge
     * @see    module:base/util._$fetch
     * @param  {Object}   arg0 - 原始对象
     * @param  {Object}   arg1 - 待拷贝对象
     * @param  {Function} arg2 - 过滤接口
     * @return {Object}          拷贝后对象
     */
    _p._$merge = function(){
        var _last = arguments.length-1,
            _filter = arguments[_last];
        // check filter function for last args
        if (_p._$isFunction(_filter)){
            _last -= 1;
        }else{
            _filter = _f;
        }
        // args0 as result
        var _result = arguments[0]||{};
        // merge
        for(var i=1;i<=_last;i++){
            _p._$loop(arguments[i],function(v,k){
                if (!_filter(v,k)){
                    _result[k] = v;
                }
            });
        }
        return _result;
    };
    /**
     * 根据原始对象属性，从目标对象提取非空值
     *
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     var obj0 = {a:0,b:1},
     *         obj1 = {a:"a",b:"b",c:"c"};
     *     // 根据obj0的属性,从obj1拷贝非null属性到obj0中
     *     // 结果是obj0.a = "a",obj.b = "b",没有拷贝c属性;
     *     var obj = _u._$fetch(obj0,obj1);
     * });
     * ```
     *
     * @method module:base/util._$fetch
     * @see    module:base/util._$merge
     * @param  {Object} arg0 - 原始对象
     * @param  {Object} arg1 - 目标对象
     * @return {Object}        合并后的对象
     */
    _p._$fetch = function(_object,_config){
        if (!!_config){
            _p._$loop(_object,function(v,k,m){
                var _value = _config[k];
                if (_value!=null){
                    m[k] = _value;
                }
            });
        }
        return _object;
    };
    /**
     * 判断对象自生是否包含元素
     * 
     * ```javascript
     * NEJ.define([
     *     'base/util'
     * ],function(_u){
     *     // 判断空对象是否有属性
     *     // 输出 false
     *     var has = _u._$hasProperty({});
     *       
     *     // 判断非空对象是否有属性
     *     // 输出 true
     *     var has = _u._$hasProperty({a:'a',b:'b',c:'c'});
     *       
     *     // 判断空数组是否有属性
     *     // 输出 false
     *     var has = _u._$hasProperty([]);
     *       
     *     // 判断非空数组是否有属性
     *     // 输出 true
     *     var has = _u._$hasProperty([1,2,3]);
     * });
     * ```
     * 
     * @method module:base/util._$hasProperty
     * @param  {Object|Array} arg0 - 对象
     * @return {Boolean}             是否有元素
     */
    _p._$hasProperty = function(_obj){
        // for null
        if (!_obj){
            return !1;
        }
        // for object with length
        if (_obj.length!=null){
            return _obj.length>0;
        }
        // for object
        var _length = 0;
        _p._$loop(_obj,function(){
            _length++;
            return _length>0;
        });
        return _length>0;
    };
    
    if (CMPT){
        NEJ.Q  = _p._$query;
        NEJ.X  = _p._$merge;
        NEJ.EX = _p._$fetch;
        NEJ.copy(this.NEJ,NEJ);
        NEJ.copy(NEJ.P('nej.u'),_p);
    }

    return _p;
},215,216);
I$(610,function (NEJ,_u,_p,_o,_f,_r){
    var _cache = {};
    /*
     * URL地址转源信息
     * http://a.b.com:8080/a/bc/ -> http://a.b.com:8080
     * @param  {String} URL地址
     * @return {String} 源信息
     */
    _p.__url2host = (function(){
        var _reg = /^([\w]+?:\/\/.*?(?=\/|$))/i;
        return function(_url){
            _url = _url||'';
            if (_reg.test(_url))
                return RegExp.$1;
            return location.protocol+'//'+location.host;
        };
    })();
    /**
     * 设置NEJ配置信息
     * @param  {String}   配置标识
     * @param  {Variable} 配置信息
     * @return {Void}
     */
    _p.__set = function(_key,_value){
        _cache[_key] = _value;
    };
    /**
     * 获取NEJ配置信息
     * @param  {String}   配置标识
     * @return {Variable} 配置信息
     */
    _p.__get = function(_key){
        return _cache[_key];
    };

    // init
    /*
     * 初始化配置信息
     * @param  {Object} 配置信息
     * @return {Void}
     */
    var _doInit = (function(){
        var _conf = {
            'portrait':{name:'portrait',dft:'portrait/'},
            'ajax.swf':{name:'ajax',dft:'nej_proxy_flash.swf'},
            'chart.swf':{name:'chart',dft:'nej_flex_chart.swf'},
            'audio.swf':{name:'audio',dft:'nej_player_audio.swf'},
            'video.swf':{name:'video',dft:'nej_player_video.swf'},
            'clipboard.swf':{name:'clipboard',dft:'nej_clipboard.swf'},
            'upload.image.swf':{name:'uploadimage',dft:'nej_upload_image.swf'}
        };
        var _doInitProxy = function(_list){
            var _map = {};
            if (!_list||!_list.length){
                return _map;
            }
            for(var i=0,l=_list.length,_path;i<l;i++){
                _path = _list[i];
                if (_path.indexOf('://')>0)
                    _map[_p.__url2host(_path)] = _path;
            }
            return _map;
        };
        return function(_config){
            // check path config
            _p.__set('root',_config.root||'/res/');
            var _root = _p.__get('root');
            _u._$loop(_conf,function(v,k,m){
                _p.__set(k,_config[v.name]||(_root+v.dft));
            });
            // csrf config
            var _csrf = _config.p_csrf;
            if (_csrf===!0){
                _csrf = {
                    cookie:'AntiCSRF',
                    param:'AntiCSRF'
                };
            }
            _csrf = _csrf || _o;
            _p.__set('csrf',{
                param:_csrf.param||'',
                cookie:_csrf.cookie||''
            });
            // ajax by frame proxy
            _p.__set('frames',_doInitProxy(_config.p_frame));
            // ajax by flash proxy
            _p.__set('flashs',_doInitProxy(_config.p_flash));
        };
    })();
    _doInit(this.NEJ_CONF||_o);

    return _p;
},215,2);
I$(534,function(_h,_m,_p,_o,_f,_r){if (_m._$KERNEL.engine==='trident'){I$(611,function (){
        _h.__set(
            'storage.swf',
            (this.NEJ_CONF||_o).storage||
            (_h.__get('root')+'nej_storage.swf')
        );
    });}
if (_m._$KERNEL.engine==='trident'&&_m._$KERNEL.release<='3.0'){I$(612,function (){
        _h.__set(
            'blank.png',
            (this.NEJ_CONF||_o).blank||
            (_h.__get('root')+'nej_blank.gif')
        );
    });}return _h;},610,78);
I$(377,function (NEJ,_h,_p,_o,_f,_r){
    /**
     * 取Frame跨域Ajax代理文件，通过NEJ_CONF的p_frame配置给定域名的代理文件地址
     *
     * @method module:base/config._$getFrameProxy
     * @see    module:base/config._$get
     * @param  {String} arg0 - 请求地址或者域名
     * @return {String}        代理文件地址
     */
    _p._$getFrameProxy = function(_url){
        var _host = _h.__url2host(_url);
        return _p._$get('frames')[_host]||
              (_host+'/res/nej_proxy_frame.html');
    };
    /**
     * 取Flash跨域Ajax配置文件，通过NEJ_CONF的p_flash配置给定域名的代理文件地址
     *
     * @method module:base/config._$getFlashProxy
     * @see    module:base/config._$get
     * @param  {String} arg0 - 请求地址或者域名
     * @return {String}        代理文件地址
     */
    _p._$getFlashProxy = function(_url){
        return _p._$get('flashs')[_h.__url2host(_url)];
    };
    /**
     * 获取NEJ配置信息，通过NEJ_CONF配置相关信息
     *
     * ```javascript
     *  window.NEJ_CONF = {
     *      // resource root
     *      // defalut value -> '/res/'
     *      root : '/nej/'
     *      // blank image for ie6-ie7
     *      // default value -> $root+'nej_blank.gif'
     *      blank : '/res/nej_blank.gif'
     *      // localstorage flash
     *      // default value -> $root+'nej_storage.swf'
     *      storage : '/res/nej_storage.swf'
     *      // audio player flash
     *      // default value -> $root+'nej_player_audio.swf'
     *      audio : '/res/nej_player_audio.swf'
     *      // video player flash
     *      // default value -> $root+'nej_player_video.swf'
     *      video : '/res/nej_player_video.swf'
     *      // clipboard flash
     *      // default value -> $root+'nej_clipboard.swf'
     *      clipboard : '/res/nej_clipboard.swf'
     *      // https request proxy
     *      // default value -> $root+'nej_proxy_flash.swf'
     *      ajax : '/res/nej_proxy_flash.swf'
     *      // portrait root
     *      // default value -> $root+'portrait/'
     *      portrait : '/res/portrait/'
     *      // cross domain xhr request for ie6-ie9
     *      // if path not start with http[s]://
     *      // will use /res/nej_proxy_frame.html as default
     *      p_frame:['http://c.d.com/html/nej_proxy_frame.html']
     *      // flash crossdomain.xml file path
     *      // default value -> http://a.b.com/crossdomain.xml
     *      p_flash:['http://a.b.com/proxy/crossdomain.xml']
     *      // CSRF cookie name and parameter name
     *      // set p_csrf:true to use URS config {cookie:'AntiCSRF',param:'AntiCSRF'}
     *      // default value -> {cookie:'',param:''}
     *      p_csrf:{cookie:'AntiCSRF',param:'AntiCSRF'}
     *  };
     * ```
     *
     * 配置标识支持
     *
     * | 标识                          | 说明 |
     * | :--              | :-- |
     * | portrait         | 表情根路径 |
     * | blank.png        | 空白图片文件地址 |
     * | ajax.swf         | Ajax代理Flash文件地址 |
     * | chart.swf        | 图标Flash文件地址 |
     * | audio.swf        | 实现Audio功能的Flash文件地址 |
     * | video.swf        | 实现Video功能的Flash文件地址 |
     * | clipboard.swf    | 实现剪切板功能的Flash文件地址 |
     * | upload.image.swf | 实现图片上传功能的Flash文件地址 |
     * | storage.swf      | 实现本地存储功能的Flash文件地址 |
     *
     * @method module:base/config._$get
     * @param  {String}   arg0 - 配置标识
     * @return {Variable}        配置信息
     */
    _p._$get = function(_key){
        return _h.__get(_key);
    };

    if (CMPT){
        NEJ.copy(NEJ.P('nej.c'),_p);
    }

    return _p;
},215,534);
I$(227,function (NEJ,_c,_p,_o,_f,_r){
    var _seed = +new Date;
    /**
     * 找不到指定内容的错误码
     *
     * @const {Number} module:base/constant._$CODE_NOTFUND
     */
    _p._$CODE_NOTFUND = 10000-_seed;
    /**
     * 需要指定的参数未指定的错误码
     *
     * @const {Number} module:base/constant._$CODE_NOTASGN
     */
    _p._$CODE_NOTASGN = 10001-_seed;
    /**
     * 不支持操作的错误码
     *
     * @const {Number} module:base/constant._$CODE_NOTSPOT
     */
    _p._$CODE_NOTSPOT = 10002-_seed;
    /**
     * 操作超时的错误码
     *
     * @const {Number} module:base/constant._$CODE_TIMEOUT
     */
    _p._$CODE_TIMEOUT = 10003-_seed;
    /**
     * 字符串作为脚本执行异常的错误码
     *
     * @const {Number} module:base/constant._$CODE_ERREVAL
     */
    _p._$CODE_ERREVAL = 10004-_seed;
    /**
     * 回调执行异常的错误码
     *
     * @const {Number} module:base/constant._$CODE_ERRCABK
     */
    _p._$CODE_ERRCABK = 10005-_seed;
    /**
     * 服务器返回异常的错误码
     *
     * @const {Number} module:base/constant._$CODE_ERRSERV
     */
    _p._$CODE_ERRSERV = 10006-_seed;
    /**
     * 异常终止的错误码
     *
     * @const {Number} module:base/constant._$CODE_ERRABRT
     */
    _p._$CODE_ERRABRT = 10007-_seed;
    /**
     * 请求头content-type统一名称
     *
     * @const {Number} module:base/constant._$HEAD_CT
     */
    _p._$HEAD_CT      = 'Content-Type';
    /**
     * 文本请求头content-type值
     *
     * @const {String} module:base/constant._$HEAD_CT_PLAN
     */
    _p._$HEAD_CT_PLAN = 'text/plain';
    /**
     * 文件请求头content-type值
     *
     * @const {String} module:base/constant._$HEAD_CT_FILE
     */
    _p._$HEAD_CT_FILE = 'multipart/form-data';
    /**
     * 表单请求头content-type值
     *
     * @const {String} module:base/constant._$HEAD_CT_FORM
     */
    _p._$HEAD_CT_FORM = 'application/x-www-form-urlencoded';
    /**
     * 空图片BASE64编码地址，低版本浏览器使用图片地址
     *
     * @const {String} module:base/constant._$BLANK_IMAGE
     */
    _p._$BLANK_IMAGE  = _c._$get('blank.png')||'data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==';

    if (CMPT){
        NEJ.copy(NEJ.P('nej.g'),_p);
    }

    return _p;
},215,377);
I$(217,function (_u,_p){
    var _cache = {};
    /**
     * 添加可链式调用的接口
     *
     * 添加可链式接口
     * ```javascript
     * NEJ.define([
     *     'base/chain'
     * ],function(_l){
     *     var _map = {};
     *
     *      _map._$api1 = function(){
     *          // TODO
     *      }
     *      
     *      _map._$api2 = function(){
     *          // TODO
     *      }
     * 
     *     _l._$merge(_map);
     * });
     * ```
     *
     * 使用链式调用接口
     * ```javascript
     * NEJ.define([
     *     '/path/to/api.js',
     *     'util/chain/chainable'
     * ],function(_x,$){
     *     // 使用链式调用api
     *     $('body > p')._$api1()._$api2();
     * });
     * ```
     * 
     * @method module:base/chain._$merge
     * @param  {Object} arg0 - 接口集合
     * @return {Void}
     */
    _p._$merge = function(_map){
        _u._$merge(_cache,_map);
    };
    /**
     * 导出链式接口列表
     * 
     * @method module:base/chain._$dump
     * @return {Object} 链式接口列表
     */
    _p._$dump = function(){
        return _cache;
    };
    /**
     * 清除链式列表
     * 
     * @method module:base/chain._$clear
     * @return {Void}
     */
    _p._$clear = function(){
        _cache = {};
    };
    
    return _p;
},2);
I$(439,function (_u,_m,_p,_o,_f,_r){
    /**
     * 从DocumentFragment中取指定ID的节点
     * @param  {Document} 文档对象
     * @param  {String}   节点标识
     * @return {Node}     指定标识的节点
     */
    _p.__getElementById = function(_fragment,_id){
        if (!!_fragment.getElementById){
            return _fragment.getElementById(''+_id);
        }
        try{
            return _fragment.querySelector('#'+_id);
        }catch(e){
            return null;
        }
    };
    /**
     * 取节点的子节点列表
     * @param  {Node}  节点ID或者对象
     * @return {Array} 子节点列表
     */
    _p.__getChildren = function(_element){
        return _u._$object2array(_element.children);
    };
    /**
     * 根据类名取节点列表
     * @param  {Node}   节点ID或者对象
     * @param  {String} 类名
     * @return {Array}  节点列表
     */
    _p.__getElementsByClassName = function(_element,_class){
        return _u._$object2array(_element.getElementsByClassName(_class));
    };
    /**
     * 取下一个兄弟节点
     * @param  {Node}  节点对象
     * @return {Node}  节点
     */
    _p.__nextSibling = function(_element){
        return _element.nextElementSibling;
    };
    /**
     * 取上一个兄弟节点
     * @param  {Node}  节点对象
     * @return {Node}  节点
     */
    _p.__previousSibling = function(_element){
        return _element.previousElementSibling;
    };
    /**
     * 设置、获取数据
     * @param {Node}     节点
     * @param {String}   标识
     * @param {Variable} 值
     */
    _p.__dataset = function(_element,_name,_value){
        _element.dataset = _element.dataset||{};
        if (_value!==undefined){
            _element.dataset[_name] = _value;
        }
        return _element.dataset[_name];
    };
    /**
     * 取节点属性值
     * @param  {Node}   节点
     * @param  {String} 属性名
     * @return {String} 属性值
     */
    _p.__getAttribute = function(_element,_name){
        return _element.getAttribute(_name);
    };
    /**
     * 将dom节点转为xml串
     * @param  {Node}   节点
     * @return {String} XML代码
     */
    _p.__serializeDOM2XML = function(_dom){
        return new XMLSerializer().serializeToString(_dom)||'';
    };
    /**
     * 将xml转为dom节点
     * @param  {String} XML代码
     * @return {Node}   节点
     */
    _p.__parseDOMFromXML = function(_xml){
        var _root = new DOMParser()
                       .parseFromString(_xml,'text/xml')
                       .documentElement;
        return _root.nodeName=='parsererror'?null:_root;
    };
    /**
     * 节点占全屏
     * @param  {Node}   节点
     * @param  {Object} 视窗模型
     * @return {Void}
     */
    _p.__fullScreen = function(){
        // use css fixed position
    };
    /**
     * 为节点增加用于盖select/flash等控件的层
     * @param  {Node} 节点
     * @return {Void}
     */
    _p.__mask = function(){
        // do nothing
    };
    /**
     * 去除用于盖select/flash等控件的层
     * @param  {Node} 节点
     * @return {Void}
     */
    _p.__unmask = function(){
        // do nothing
    };
    // variables
    var _ospt = _m._$SUPPORT,
        _opfx = _m._$KERNEL.prefix;
    /**
     * 指定名称是否在配置表中
     * @param  {String}  名称
     * @param  {Object}  配置表
     * @return {Boolean} 是否命中
     */
    _p.__isMatchedName = (function(){
        var _reg = /^([a-z]+?)[A-Z]/;
        return function(_name,_map){
            return !!(_map[_name]||(_reg.test(_name)&&_map[RegExp.$1]));
        };
    })();
    /**
     * 样式名称做前缀增强
     * @param  {String}  名称
     * @return {Boolean} 是否需要前缀增强
     */
    _p.__isNeedPrefixed = (function(){
        var _pmap = _u._$array2object([
            'animation','transform','transition',
            'appearance','userSelect','box','flex','column'
        ]);
        return function(_name){
            return _p.__isMatchedName(_name,_pmap);
        };
    })();
    /**
     * 格式化样式属性名称
     * border-width -> borderWidth
     * @param  {String} 样式样式名
     * @return {String} 格式化后样式名
     */
    _p.__fmtStyleName = (function(){
        var _reg = /-([a-z])/g;
        return function(_name){
            _name = _name||'';
            return _name.replace(_reg,function($1,$2){
                return $2.toUpperCase();
            });
        };
    })();
    /**
     * 针对样式名称做格式化及前缀增强
     * @param  {String} 样式名
     * @return {String} 增强后的样式名
     */
    _p.__getStyleName = (function(){
        var _reg = /^[a-z]/,
            _prefix = _opfx.css||'';
        return function(_name){
            _name = _p.__fmtStyleName(_name);
            if (!_p.__isNeedPrefixed(_name)){
                return _name;
            }
            // add prefix
            // userSelect -> webkitUserSelect
            return _prefix+_name.replace(_reg,function($1){
                return $1.toUpperCase();
            });
        };
    })();
    /**
     * 取样式值
     * @param  {String|Node} 节点
     * @param  {String}      样式名称
     * @return {Variable}    样式值
     */
    _p.__getStyleValue = function(_element,_name){
        var _current = window.getComputedStyle(_element,null);
        return _current[_p.__getStyleName(_name)]||'';
    };
    /**
     * 设置样式
     * @param  {String|Node} 节点
     * @param  {String}      样式名称
     * @param  {String}      样式值
     * @return {Void}
     */
    _p.__setStyleValue = function(_element,_name,_value){
        _element.style[_p.__getStyleName(_name)] = _value;
    };
    /**
     * 取样式变换矩阵对象
     * @param  {String}    变换信息
     * @return {CSSMatrix} 变换矩阵对象
     */
    _p.__getCSSMatrix = (function(){
        var _reg0 = /\((.*?)\)/,
            _reg1 = /\s*,\s*/,
            _klss = ['CSSMatrix',_opfx.clz+'CSSMatrix'],
            _list = ['m11','m12','m21','m22','m41','m42'];
        // matrix(1,2,3,4,5,6)
        // -> {m11:1,m12:2,m21:3,m22:4,m41:5,m42:6}
        var _doParse = function(_matrix){
            var _obj = {};
            if (_reg0.test(_matrix||'')){
                // 11,12,21,22,41,42
                _u._$forEach(
                    RegExp.$1.split(_reg1),
                    function(_value,_index){
                        _obj[_list[_index]] = _value;
                    }
                );
            }
            return _obj;
        };
        return function(_matrix){
            var _mtrx;
            _u._$forIn(_klss,function(_name){
                if (!!this[_name]){
                    _mtrx = new this[_name](_matrix||'');
                    return !0;
                }
            });
            return !_mtrx?_doParse(_matrix):_mtrx;
        };
    })();
    /**
     * 注入样式
     * @param  {Node}   样式节点
     * @param  {String} 样式内容
     * @return {Void}
     */
    _p.__injectCSSText = function(_style,_css){
        _style.textContent = _css;
    };
    /**
     * 对样式进行预处理
     * @param  {String} 待处理样式内容
     * @return {String} 处理后样式内容
     */
    _p.__processCSSText = (function(){
        var _reg0 = /\$<(.*?)>/gi,
            _reg1 = /\{(.*?)\}/g,
            _pfx = '-'+_opfx.css.toLowerCase()+'-',
            _2dmap = {
                scale:'scale({x|1},{y|1})',
                rotate:'rotate({a})',
                translate:'translate({x},{y})',
                matrix:'matrix({m11},{m12},{m21},{m22},{m41},{m42})'
            },
            _3dmap  = {
                scale:'scale3d({x|1},{y|1},{z|1})',
                rotate:'rotate3d({x},{y},{z},{a})',
                translate:'translate3d({x},{y},{z})',
                matrix:'matrix3d({m11},{m12},{m13},{m14},{m21},{m22},{m23},{m24},{m31},{m32},{m33|1},{m34},{m41},{m42},{m43},{m44|1})'
            };
        // merge template and data
        var _getTransformValue = function(_tpl,_map){
            _map = _map||_o;
            return _tpl.replace(_reg1,function($1,$2){
                var _arr = $2.split('|');
                return _map[_arr[0]]||_arr[1]||'0';
            });
        };
        // process transform value
        _p.__processTransformValue = function(_name,_data){
            var _tpl = (!_ospt.css3d?_2dmap:_3dmap)[_name.trim()];
            if (!!_tpl){
                return _getTransformValue(_tpl,_data);
            }
            return '';
        };
        return function(_css){
            if (!_css.replace){
                return _css;
            }
            return _css.replace(_reg0,function($1,$2){
                // prefix for css3
                if ($2==='vendor'){
                    return _pfx;
                }
                // parse 3D value
                var _arr = ($2||'').split('|');
                return _p.__processTransformValue(
                    _arr[0],_u._$query2object(_arr[1])
                )||$1;
            });
        };
    })();
    /**
     * 追加CSS规则
     * @param  {Node}    样式节点
     * @param  {String}  单条样式规则
     * @return {CSSRule} 样式规则对象
     */
    _p.__appendCSSText = function(_element,_css){
        var _sheet = _element.sheet,
            _length = _sheet.cssRules.length;
        _sheet.insertRule(_css,_length);
        return _sheet.cssRules[_length];
    };
    /**
     * 取待验证的样式列表
     * @param  {String} 样式，多个以空格分隔
     * @return {Array}  样式列表
     */
    _p.__getClassList = (function(){
        var _reg = /\s+/;
        return function(_class){
            _class = (_class||'').trim();
            return !!_class?_class.split(_reg):null;
        };
    })();
    /**
     * 操作样式
     * @param  {Node}   节点
     * @param  {String} 操作
     * @param  {String} 样式
     * @return {Void}
     */
    _p.__processClassName = function(_element,_type,_class){
        if (_type=='replace'){
            _p.__processClassName(
                _element,'remove',_class
            );
            _p.__processClassName(
                _element,'add',arguments[3]
            );
            return;
        }
        _u._$forEach(
            _p.__getClassList(_class),
            function(_clazz){
                _element.classList[_type](_clazz);
            }
        );
    };
    /**
     * 检测节点是否包含指定样式，多个样式用空格分隔，检测时包含其中之一即表示包含
     * @param  {Node}    节点ID或者对象
     * @param  {String}  样式串
     * @return {Boolean} 是否含指定样式
     */
    _p.__hasClassName = function(_element,_class){
        var _list = _element.classList;
        if (!_list||!_list.length){
            return !1;
        }
        return _u._$indexOf(
            _p.__getClassList(_class),
            function(_clazz){
                return _list.contains(_clazz);
            }
        )>=0;
    };
    // for init
    (function(){
        if (!_ospt.css3d){
            var _matrix = _p.__getCSSMatrix();
            _ospt.css3d = !!_matrix&&_matrix.m41!=null;
        }
    })();

    return _p;
},2,78);
I$(228,function(_h,_m,_u,_p,_o,_f,_r){if (_m._$KERNEL.engine==='trident'){I$(440,function (){
        /**
         * 取节点的子节点列表
         * @param  {Node} _element 节点ID或者对象
         * @return {Array}         子节点列表
         */
        _h.__getChildren = _h.__getChildren._$aop(
            function(_event){
                var _element = _event.args[0];
                if (!!_element.children) return;
                // hack children
                _event.stopped = !0;
                var _result = [];
                _u._$forEach(
                    _element.childNodes,
                    function(_node){
                        if (_node.nodeType==1){
                            _result.push(_node);
                        }
                    }
                );
                _event.value = _result;
            }
        );
    });}
if (_m._$KERNEL.engine==='trident'&&_m._$KERNEL.release<='6.0'){I$(441,function (){
        /**
         * 设置、获取数据
         * @param {Node}     节点
         * @param {String}   标识
         * @param {Variable} 值
         */
        _h.__dataset = (function(){
            var _dataset = {},
                _tag = 'data-',
                _reg = /\-(.{1})/gi;
            // init element dataset
            var _init = function(_element){
                var _id = _element.id;
                if (!!_dataset[_id]) return;
                var _map = {};
                _u._$forEach(
                    _element.attributes,
                    function(_node){
                        var _key  = _node.nodeName;
                        if (_key.indexOf(_tag)!=0) return;
                        _key = _key.replace(_tag,'')
                                   .replace(_reg,function($1,$2){
                                        return $2.toUpperCase();
                                   });
                        _map[_key] = _node.nodeValue||'';
                    }
                );
                _dataset[_id] = _map;
            };
            return function(_element,_key,_value){
                _init(_element);
                var _set = _dataset[_element.id];
                if (_value!==undefined){
                    _set[_key] = _value;
                }
                return _set[_key];
            };
        })();
    });}
if (_m._$KERNEL.engine==='trident'&&_m._$KERNEL.release<='5.0'){I$(442,function (){
        // cache background image
        try{document.execCommand('BackgroundImageCache',!1,!0);}catch(e){}
        /**
         * 注入样式
         * @param  {Node}   样式节点
         * @param  {String} 样式内容
         * @return {Void}
         */
        _h.__injectCSSText = (function(){
            var _max = 30;
            return _h.__injectCSSText._$aop(function(_event){
                var _element = _event.args[0];
                if (!_element.styleSheet) return;
                _event.stopped = !0;
                var _css = _event.args[1];
                // ie9- has 31 style/link limitation
                var _list = document.styleSheets;
                if (_list.length>_max){
                    // bad performance
                    _element = _list[_max];
                    _css = _element.cssText + _css;
                }else{
                    _element = _element.styleSheet;
                }
                _element.cssText = _css;
            });
        })();
        /**
         * 取待验证的样式正则表达式
         * @param  {String} 样式，多个以空格分隔
         * @return {RegExp} 正则表达式
         */
        _h.__getClassRegExp = (function(){
            var _reg = /\s+/g;
            return function(_class){
                _class = (_class||'').trim().replace(_reg,'|');
                return !_class?null:new RegExp('(\\s|^)(?:'+_class+')(?=\\s|$)','g');
            };
        })();
        /**
         * 操作样式
         * @param  {Node}   节点
         * @param  {String} 操作
         * @param  {String} 样式
         * @return {Void}
         */
        _h.__processClassName = function(_element,_type,_class){
            _class = _class||'';
            var _name = _element.className||'',
                _xreg = _h.__getClassRegExp(
                    _class+' '+(arguments[3]||'')
                );
            // remove all calss
            var _result = _name;
            if (!!_xreg){
                _result = _result.replace(_xreg,'');
            }
            // parse added class
            switch(_type){
                case 'remove':
                    _class = '';
                break;
                case 'replace':
                    _class = arguments[3]||'';
                break;
            }
            // generate class result
            _result = (_result+' '+_class).trim();
            if (_name!=_result){
                _element.className = _result;
            }
        };
        /**
         * 检测节点是否包含指定样式，多个样式用空格分隔，检测时包含其中之一即表示包含
         * @param  {Node}    节点ID或者对象
         * @param  {String}  样式串
         * @return {Boolean} 是否含指定样式
         */
        _h.__hasClassName = function(_element,_class){
            var _xreg = _h.__getClassRegExp(_class);
            if (!!_xreg){
                return _xreg.test(_element.className||'');
            }
            return !1;
        };
    });}
if (_m._$KERNEL.engine==='trident'&&_m._$KERNEL.release<='4.0'){I$(443,function (){
        /**
         * 根据类名取节点列表
         * @param  {Node}   节点ID或者对象
         * @param  {String} 类名
         * @return {Array}  节点列表
         */
        _h.__getElementsByClassName = function(_element,_class){
            var _result = [],
                _regexp = new RegExp('(\\s|^)(?:'+_class.replace(/\s+/g,'|')+')(?=\\s|$)');
            _u._$forEach(
                _element.getElementsByTagName('*'),
                function(_node){
                    if (_regexp.test(_node.className)){
                        _result.push(_node);
                    }
                }
            );
            return _result;
        };
        /**
         * 取下一个兄弟节点
         * @param  {Node}  节点对象
         * @return {Node}  节点
         */
        _h.__nextSibling = function(_element){
            while(_element=_element.nextSibling){
                if (_element.nodeType==1){
                    return _element;
                }
            }
        };
        /**
         * 取上一个兄弟节点
         * @param  {Node}  节点对象
         * @return {Node}  节点
         */
        _h.__previousSibling = function(_element){
            while(_element=_element.previousSibling){
                if (_element.nodeType==1){
                    return _element;
                }
            }
        };
        /**
         * 将dom节点转为xml串
         * @param  {Node}   节点
         * @return {String} XML代码
         */
        _h.__serializeDOM2XML = function(_dom){
            return ('xml' in _dom)?_dom.xml:_dom.outerHTML;
        };
        /**
         * 将xml转为dom节点
         * @param  {String} XML代码
         * @return {Node}   节点
         */
        _h.__parseDOMFromXML = (function(){
            // http://blogs.msdn.com/b/xmlteam/archive/2006/10/23/using-the-right-version-of-msxml-in-internet-explorer.aspx
            var _msxml = [
                'Msxml2.DOMDocument.6.0',
                'Msxml2.DOMDocument.3.0'
            ];
            var _getParser = function(){
                try{
                    for(var i=0,l=_msxml.length;i<l;i++){
                        return new ActiveXObject(_msxml[i]);
                    }
                }catch(ex){
                    return null;
                }
            };
            return function(_xml){
                var _parser = _getParser();
                if (!!_parser&&
                      _parser.loadXML(_xml)&&
                     !_parser.parseError.errorCode){
                    return _parser.documentElement;
                }
                return null;
            };
        })();
        /**
         * 取样式值
         * @param  {String|Node} 节点
         * @param  {String}      样式名称
         * @return {Variable}    样式值
         */
        _h.__getStyleValue = (function(){
            var _reg0 = /opacity\s*=\s*([\d]+)/i;
            var _fmap = {
                // get opacity from filter:alpha(opacity=50)
                opacity:function(_style){
                    var _result = 0;
                    if (_reg0.test(_style.filter||'')){
                        _result = parseFloat(RegExp.$1)/100;
                    }
                    return _result;
                }
            };
            return function(_element,_name){
                var _current = _element.currentStyle,
                    _func = _fmap[_name];
                if (!!_func){
                    return _func(_current);
                }
                return _current[_h.__getStyleName(_name)]||'';
            };
        })();
        /**
         * 设置样式
         * @param  {String|Node} 节点
         * @param  {String}      样式名称
         * @param  {String}      样式值
         * @return {Void}
         */
        _h.__setStyleValue = (function(){
            var _fmap = {
                // opacity -> filter:alpha(opacity=50)
                opacity:function(_element,_value){
                    _element.style.filter = 'alpha(opacity='+_value*100+')';
                }
            };
            return function(_element,_name,_value){
                var _func = _fmap[_name];
                if (!!_func){
                    _func(_element,_value);
                }else{
                    _element.style[_h.__getStyleName(_name)] = _value;
                }
            };
        })();
        /**
         * 追加CSS规则
         * @param  {Node}    样式节点
         * @param  {String}  单条样式规则
         * @return {CSSRule} 样式规则对象
         */
        _h.__appendCSSText = function(_element,_css){
            var _sheet = _element.styleSheet,
                _length = _sheet.rules.length,
                _arr = _css.split(/[\{\}]/);
            _sheet.addRule(_arr[0],_arr[1],_length);
            return _sheet.rules[_length];
        };
     });}
if (_m._$KERNEL.engine==='trident'&&_m._$KERNEL.release<='3.0'){I$(444,function (){
        /**
         * 取节点属性值
         * @param  {Node}   节点
         * @param  {String} 属性名
         * @return {String} 属性值
         */
        _h.__getAttribute =
        _h.__getAttribute._$aop(null,function(_event){
            // fix ie7 maxlength default value 2147483647
            var _args = _event.args;
            if (_args[1]=='maxlength'&&
                _event.value==2147483647){
                _event.value = null;
            }
        });
    });}
if (_m._$KERNEL.engine==='trident'&&_m._$KERNEL.release<='2.0'){I$(445,function (){
        /**
         * 节点占全屏
         * @param  {Node}   节点
         * @param  {Object} 视窗模型
         * @return {Void}
         */
        _h.__fullScreen = function(_element,_viewport){
            var _style = _element.style;
            _style.width = _viewport.scrollWidth+'px';
            _style.height = _viewport.scrollHeight+'px';
        };
        /**
         * 为节点增加用于盖select/flash等控件的层
         * @param  {Node} 节点
         * @return {Void}
         */
        _h.__mask = (function(){
            var _cache = {};
            // remove mask
            _h.__unmask = function(_element){
                var _id = _element.id,
                    _mask = _cache[_id];
                if (!!_mask){
                    delete _cache[_id];
                    _mask.parentNode.removeChild(_mask);
                }
            };
            // append mask
            return function(_element){
                var _id = _element.id,
                    _mask = _cache[_id];
                // create mask
                if (!_mask){
                    _mask = document.createElement('iframe');
                    _mask.style.position = 'absolute';
                    _cache[_id] = _mask;
                }
                // sync mask size
                var _style1 = _mask.style,
                    _style0 = _element.style;
                _style1.top = (parseInt(_style0.top)||0)+'px';
                _style1.left = (parseInt(_style0.left)||0)+'px';
                _style1.width = _element.offsetWidth+'px';
                _style1.height = _element.offsetHeight+'px';
                _element.insertAdjacentElement('beforeBegin',_mask);
                return _mask;
            };
        })();
    });}
if (_m._$KERNEL.engine==='gecko'){I$(446,function (){
        if (!_m._$SUPPORT.css3d){
            _m._$SUPPORT.css3d = 'MozPerspective' in document.body.style;
        }
        if (!('insertAdjacentElement' in document.body)){
            HTMLElement.prototype.insertAdjacentElement = function(_where,_element){
                if (!_where||!_element) return;
                switch(_where){
                    case 'beforeEnd'  :
                        this.appendChild(_element);
                    return;
                    case 'beforeBegin':
                        this.parentNode.insertBefore(_element,this);
                    return;
                    case 'afterBegin' :
                        !this.firstChild
                        ?this.appendChild(_element)
                        :this.insertBefore(_element,this.firstChild);
                    return;
                    case 'afterEnd'   :
                        !this.nextSibling
                        ?this.parentNode.appendChild(_element)
                        :this.parentNode.insertBefore(_element,this.nextSibling);
                    return;
                }
            };
        }
        if (!('innerText' in document.body)){
            HTMLElement.prototype['__defineGetter__']("innerText",function(){return this.textContent;});
            HTMLElement.prototype['__defineSetter__']("innerText",function(_content){this.textContent = _content;});
        }
    });}return _h;},439,78,2);
I$(4,function (NEJ,_g,_u,_v,_x,_h,_p,_o,_f,_r){
    // variables
    var _y = {},     // chainable methods
        _cspol,      // css text pool
        _empol = {}, // elements without id property, eg. document,window
        _dirty = {}, // temporary element with id
        _fragment = document.createDocumentFragment(); // node in memory
    // init
    if (!document.head){
         document.head = document.getElementsByTagName('head')[0]||document.body;
    }
    /**
     * 为节点设置一个唯一的标识
     *
     * 结构举例
     * ```html
     *    <div id="abc">aaaaa</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 如果有id，返回原来的id,否则返回auto-id-12345678(8位随机字符串)
     *       var _id = _e._$id(_node||"abc");
     *   });
     * ```
     *
     * @method module:base/element._$id
     * @param  {String|Node} arg0 - 节点标识或者对象
     * @return {String}             节点标识
     */
    /**
     * @method CHAINABLE._$id
     * @see module:base/element._$id
     */
    _p._$id =
    _y._$id = function(_element){
        _element = _p._$get(_element);
        if (!_element) return;
        var _id = !!_element.id ? _element.id
                : 'auto-id-'+_u._$uniqueID();
        if (!('id' in _element)){
            _empol[_id] = _element;
        }
        _element.id = _id;
        // check if element can be getted
        if (!_p._$get(_id)){
            _dirty[_id] = _element;
        }
        return _id;
    };
    /**
     * 根据标识取节点对象，包括在内存中的节点
     *
     * 结构举例
     * ```html
     *   <div id="abc">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 先根据id从内存中取，再从页面取
     *       var _node = _e._$get("abc");
     *   });
     * ```
     *
     * @method module:base/element._$get
     * @param  {String|Node} arg0 - 节点标识或者对象
     * @return {Node}               节点对象
     */
    _p._$get = function(_element){
        // for document/window
        var _node = _empol[''+_element];
        if (!!_node){
            return _node;
        }
        // element is node
        if (!_u._$isString(_element)&&
            !_u._$isNumber(_element)){
            return _element;
        }
        // element is id
        // check node in page first
        var _node = document.getElementById(_element);
        if (!_node){
            _node = _h.__getElementById(_fragment,_element);
        }
        // remove dirty element
        if (!!_node){
            delete _dirty[_element];
        }
        return _node||_dirty[_element];
    };
    /**
     * 取节点的子节点列表
     *
     * 结构举例
     * ```html
     *   <div id="abc">
     *       <p>1</p>
     *       <p><span>2</span></p>
     *       <p>3</p>
     *   </div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 取直接的3个子节点(p标签)
     *       var _childs = _e._$getChildren('abc');
     *
     *       // 使用类名过滤，去带a或者b样式类的子节点
     *       var _childs = _e._$getChildren('abc','a b');
     *   });
     * ```
     *
     * @method module:base/element._$getChildren
     * @param  {String|Node} arg0 - 节点标识或者对象
     * @param  {String}      arg1 - 样式标识
     * @return {Array}              子节点列表
     */
    /**
     * @method CHAINABLE._$getChildren
     * @see module:base/element._$getChildren
     */
    _p._$getChildren =
    _y._$getChildren = function(_element,_clazz){
        _element = _p._$get(_element);
        if (!_element) return null;
        var _list = _h.__getChildren(_element);
        if (!!_clazz){
            _u._$reverseEach(
                _list,function(_node,_index,_list){
                    if (!_p._$hasClassName(_node,_clazz)){
                        _list.splice(_index,1);
                    }
                }
            );
        }
        return _list;
    };
    /**
     * 根据类名取节点列表
     *
     * 结构举例
     * ```html
     *   <div id="abc">
     *     <p class="item">1</p>
     *     <div><p class="item">2</p></div>
     *     <p class="item">3</p>
     *   </div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 获取abc节点下样式带有"item"的节点列表,如果没有父节点，返回null
     *       var _list = _e._$getByClassName('abc','item');
     *   });
     * ```
     *
     * @method module:base/element._$getByClassName
     * @param  {String|Node} arg0 - 节点标识或者对象
     * @param  {String}      arg1 - 类名
     * @return {Array}              节点列表
     */
    /**
     * @method CHAINABLE._$getByClassName
     * @see module:base/element._$getByClassName
     */
    _p._$getByClassName =
    _y._$getByClassName = function(_element,_class){
        _element = _p._$get(_element);
        return !_element ? null :
                _h.__getElementsByClassName(
                    _element,_class.trim()
                );
    };
    /**
     * 根据从兄弟节点中搜索符合条件的节点
     *
     * 结构举例
     * ```html
     *   <div>
     *     <p class="item" id="a1">1</p>
     *     <p class="item" id="a2">2</p>
     *     <p class="item" id="a3">3</p>
     *   </div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 取a2的后一个兄弟节点a3
     *       var _node = _e._$getSibling('a2');
     *
     *       // 取a2的前一个兄弟节点a1
     *       var _node = _e._$getSibling('a2',{backward:true});
     *
     *       // 过滤搜索，从a2向后搜索找id为a4的节点
     *       var _node = _e._$getSibling('a2',function(_element){
     *           return _element.id=='a4'
     *       });
     *
     *       // 过滤搜索，从a2向前搜索找id为a0的节点
     *       var _node = _e._$getSibling('a2',{
     *           backward:true,
     *           filter:function(_element){
     *               return _element.id=='a0'
     *           }
     *       });
     *   });
     * ```
     *
     * @method   module:base/element._$getSibling
     * @param    {String|Node}     arg0     - 节点标识或者对象
     * @param    {Function|Object} arg1     - 如果是函数则表示过滤器，否则为配置信息
     * @property {Boolean}         backward - 是否后向搜索，默认前向搜索
     * @property {Function}        filter   - 节点过滤器，返回true表示需要返回的节点，找到第一个即返回
     * @return   {Node}                       符合条件的节点
     */
    /**
     * @method CHAINABLE._$getSibling
     * @see module:base/element._$getSibling
     */
    _p._$getSibling =
    _y._$getSibling = (function(){
        var _doFilter = function(){
            return !0;
        };
        return function(_element,_filter){
            _element = _p._$get(_element);
            if (!_element){
                return null;
            }
            var _conf = {
                backward:!1,
                filter:_doFilter
            };
            if (_u._$isFunction(_filter)){
                _conf.filter = _filter;
            }else{
                _conf = _u._$fetch(_conf,_filter);
            }
            var _next = _conf.backward
                      ? _h.__previousSibling
                      : _h.__nextSibling;
            while(_element=_next(_element)){
                if (_conf.filter(_element)){
                    break;
                }
            }
            return _element;
        };
    })();
    /**
     * 取节点所在的滚动容器，
     * 从当前节点开始往上遍历，直到出现滚动条的节点
     *
     * 结构举例
     * ```html
     *   <div id="efg">
     *     <div id="abc">123</div>
     *   </div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 加入efg节点出现滚动条，则这里找到的是efg节点
     *       var _sbody = _e._$getScrollViewPort('abc');
     *
     *       // 不带任何参数取页面滚动条所在节点
     *       var _sbody = _e._$getScrollViewPort();
     *   });
     * ```
     *
     * @method module:base/element._$getScrollViewPort
     * @param  {String|Node} arg0 - 节点标识或者对象
     * @return {Node}               视窗节点
     */
    _p._$getScrollViewPort = function(_element){
        _element = _p._$get(_element);
        if (!!_element){
            _element = _element.parentNode;
            while(!!_element){
                if (_element.scrollHeight>
                    _element.clientHeight){
                    break;
                }
                _element = _element.parentNode;
            }
            if (!!_element){
                return _element;
            }
        }
        var _tmp1 = document.body.scrollHeight,
            _tmp2 = document.documentElement.scrollHeight;
        return _tmp2>=_tmp1?document.documentElement:document.body;
    };
    /**
     * 盒模型结构
     *
     * @typedef  {Object} module:base/element~BoxModel
     * @property {Number} scrollTop    - 滚动垂直偏移
     * @property {Number} scrollLeft   - 滚动水平偏移
     * @property {Number} clientWidth  - 页面可视宽度
     * @property {Number} clientHeight - 页面可视高度
     * @property {Number} scrollWidth  - 页面滚动宽度
     * @property {Number} scrollHeight - 页面滚动高度
     */
    /**
     * 取页面盒信息，返回盒信息内容：
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 返回信息见说明
     *       var _box = _e._$getPageBox();
     *   });
     * ```
     *
     * @method module:base/element._$getPageBox
     * @param  {Document} arg0 - 文档对象
     * @return {module:base/element~BoxModel} 盒信息
     */
    _p._$getPageBox = (function(){
        // get min value but not zero
        var _getClientBox = function(_list){
            var _result = 0;
            _u._$forEach(
                _list,function(_size){
                    if (!_size) return;
                    if (!_result){
                        _result = _size;
                    }else{
                        _result = Math.min(_result,_size);
                    }
                }
            );
            return _result;
        };
        var _farr = [
            {
                main:'scroll',
                sub:['Top','Left'],
                func:function(_key,_body0,_body1){
                    return Math.max(
                        _body0['scroll'+_key],
                        _body1['scroll'+_key]
                    );
                }
            },
            {
                main:'client',
                sub:['Width','Height'],
                func:function(_key,_body0,_body1){
                    return _getClientBox([
                        _body0['client'+_key],
                        _body0['offset'+_key],
                        _body1['client'+_key],
                        _body1['offset'+_key]
                    ]);
                }
            },
            {
                main:'scroll',
                sub:['Width','Height'],
                func:function(_key,_body0,_body1,_result){
                    return Math.max(
                        _result['client'+_key],
                        _body0['scroll'+_key],
                        _body1['scroll'+_key]
                    );
                }
            }
        ];
        return function(_document){
            var _result = {},
                _doc   = _document||document,
                _body0 = _doc.body,
                _body1 = _doc.documentElement;
            _u._$forEach(
                _farr,function(_item){
                    var _main = _item.main;
                    _u._$forEach(
                        _item.sub,function(_key){
                            _result[_main+_key] = _item.func(
                                _key,_body0,_body1,_result
                            );
                        }
                    );
                }
            );
            return _result;
        };
    })();
    /**
     * 按比例将给定大小缩放至限制区域内
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 限制区域大小 100*10
     *       var _limit = {width:100,height:10};
     *
     *       // 给定200*10的大小，由于宽度超出，缩放后为{width:100,height:5}
     *       var _box = _e._$getMaxBox({width:200,height:10},_limit);
     *
     *       // 给定100*20的大小，由于高度超出，缩放后为{width:50,height:10}
     *       var _box = _e._$getMaxBox({width:100,height:20},_limit);
     *
     *       // 给定 50*5，没有超出限制，返回{width:50,height:5}
     *       var _box = _e._$getMaxBox({width:50,height:5},_limit);
     *   });
     * ```
     *
     * @method   module:base/element._$getMaxBox
     * @param    {module:base/element~SizeModel} arg0 - 原始大小
     * @param    {module:base/element~SizeModel} arg1 - 最大限制大小
     * @return   {module:base/element~SizeModel}        按比例计算出的最大值信息
     */
    _p._$getMaxBox = function(_org,_max){
        var _result = _u._$merge({},_org),
            _mrto = _max.width/_max.height,
            _orto = _org.width/_org.height;
        // height overflow
        if (_mrto>_orto&&
            _org.height>_max.height){
            _result.height = _max.height;
            _result.width = _result.height*_orto;
        }
        // width overflow
        if (_mrto<_orto&&
            _org.width>_max.width){
            _result.width = _max.width;
            _result.height = _result.width/_orto;
        }
        return _result;
    };
    /**
     * 滚动到指定节点
     *
     * 结构举例
     * ```html
     *   <div id="a" style="padding:5px 0 0 10px;"></div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 滚动到页面上a这节点的位置
     *       _e._$scrollTo('a');
     *   });
     * ```
     *
     * @method module:base/element._$scrollTo
     * @param  {Node|String} arg0 - 节点
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$scrollTo
     * @see module:base/element._$scrollTo
     */
    _p._$scrollTo =
    _y._$scrollTo = function(_element){
        var _offset = _p._$offset(_element);
        window.scrollTo(_offset.x,_offset.y);
    };
    /**
     * 大小信息对象
     * @typedef  {Object} module:base/element~SizeModel
     * @property {Number} width  - 宽度
     * @property {Number} height - 高度
     */
    /**
     * 位置信息对象
     * @typedef  {Object} module:base/element~PositionModel
     * @property {Number} top  - 垂直位置
     * @property {Number} left - 水平位置
     */
    /**
     * 计算在容器中对齐时的位置信息
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 容器大小
     *       var _box = {width:100,height:40};
     *
     *       // 默认居中对齐返回 {top:15,left:40}
     *       var _pos = _e._$align(_box,{width:20,height:10});
     *
     *       // 左下对齐返回 {top:30,left:0}
     *       var _pos = _e._$align(_box,{width:20,height:10},'left bottom');
     *   });
     * ```
     *
     * @method module:base/element._$align
     * @param  {module:base/element~SizeModel} arg0 - 容器大小
     * @param  {module:base/element~SizeModel} arg1 - 原始大小
     * @param  {String} arg2 - 对齐方式，水平+空格+垂直，如left top，默认为 center middle，
     *                         水平：left/center/right，
     *                         垂直：top/middle/bottom
     * @return {module:base/element~PositionModel} 位置信息
     */
    _p._$align = (function(){
        var _reg = /\s+/;
        var _fmap = {
            left:function(){
                return 0;
            },
            center:function(_box,_org){
                return (_box.width-_org.width)/2;
            },
            right:function(_box,_org){
                return _box.width-_org.width;
            },
            top:function(){
                return 0;
            },
            middle:function(_box,_org){
                return (_box.height-_org.height)/2;
            },
            bottom:function(_box,_org){
                return _box.height-_org.height;
            }
        };
        return function(_box,_org,_align){
            var _result = {},
                _arr  = (_align||'').split(_reg),
                _top  = _fmap[_arr[1]]||_fmap.middle,
                _left = _fmap[_arr[0]]||_fmap.center;
            _result.top = _top(_box,_org);
            _result.left = _left(_box,_org);
            return _result;
        };
    })();
    /**
     * 计算两个节点之间的偏移量
     *
     * 结构举例
     * ```html
     *   <div id="a" style="position:relative;padding:5px 0 0 10px;">
     *     <span id="b">123</span>
     *   </div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 计算节点b到节点a(外层需要定位属性)的距离，如果没有指定节点，默认计算的根节点
     *       // _result : {x:10,y:5}
     *       var _result = _e._$offset('b','a');
     *   });
     * ```
     *
     * @method module:base/element._$offset
     * @param  {String|Node} arg0 - 起始节点
     * @param  {String|Node} arg1 - 结束节点，没有该参数则计算到根节点
     * @return {Object}             偏移量，如{x:234,y:987}
     */
    /**
     * @method CHAINABLE._$offset
     * @see module:base/element._$offset
     */
    _p._$offset =
    _y._$offset = (function(){
        var _isRoot = function(_element){
            return _element==document.body||
                   _element==document.documentElement;
        };
        return function(_from,_to){
            _from = _p._$get(_from);
            if (!_from){
                return null;
            }
            _to = _p._$get(_to)||null;
            var _node = _from,
                _result = {x:0,y:0},
                _isroot,_delta,_border;
            while(!!_node&&_node!=_to){
                _isroot = _isRoot(_node)||_node==_from;
                _delta = _isroot?0:_node.scrollLeft;
                _border = parseInt(_p._$getStyle(_node,'borderLeftWidth'))||0;
                _result.x += _node.offsetLeft+_border-_delta;
                _delta = _isroot?0:_node.scrollTop;
                _border = parseInt(_p._$getStyle(_node,'borderTopWidth'))||0;
                _result.y += _node.offsetTop+_border-_delta;
                _node = _node.offsetParent;
            }
            return _result;
        };
    })();
    /**
     * 节点占全屏
     *
     * @method module:base/element._$fullScreen
     * @param  {Node} arg0 - 节点
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$fullScreen
     * @see module:base/element._$fullScreen
     */
    _p._$fullScreen =
    _y._$fullScreen = function(_element){
        _element = _p._$get(_element);
        if (!!_element){
            _h.__fullScreen(
                _element,
                _p._$getPageBox()
            );
        }
    };
    /**
     * 为节点增加用于盖select/flash等控件的层
     *
     * @method module:base/element._$mask
     * @see    module:base/element._$unmask
     * @param  {Node} arg0 - 节点
     * @return {Node}        盖层节点
     */
    /**
     * @method CHAINABLE._$mask
     * @see module:base/element._$mask
     */
    _p._$mask =
    _y._$mask = function(_element){
        _element = _p._$get(_element);
        if (!!_element){
            _p._$id(_element);
            return _h.__mask(_element);
        }
        return null;
    };
    /**
     * 为节点移除用于盖select/flash等控件的层
     *
     * @method module:base/element._$unmask
     * @see    module:base/element._$mask
     * @param  {Node} arg0 - 节点
     * @return {Node}        盖层节点
     */
    /**
     * @method CHAINABLE._$unmask
     * @see module:base/element._$unmask
     */
    _p._$unmask =
    _y._$unmask = function(_element){
        _element = _p._$get(_element);
        if (!!_element){
            _p._$id(_element);
            return _h.__unmask(_element);
        }
        return null;
    };
    /**
     * 创建节点，使用该接口创建的结构后续可通过_$get接口根据ID取到节点
     *
     * 结构举例
     * ```javascript
     *   <div id="abc">1</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 创建一个节点，挂到body上
     *       _e._$create("div","m-body",document.body);
     *
     *       // 创建一个节点挂到id是abc的节点上
     *       // 结果：<div id="abc">1<p class="m-list"></p></div>
     *       _e._$create("p","m-list","abc");
     * 
     *       // 创建一个节点放在内存中
     *       var _node = _e._$create('div');
     *       _node.innerHTML = '<p id="a">aaaaaa</p><p id="b">bbbbbb</p>';
     *       // 后续可以通过id取id为a的节点
     *       var _pa = _e._$get('a');
     *   });
     * ```
     *
     * @method module:base/element._$create
     * @param  {String}      arg0 - 标签
     * @param  {String}      arg1 - 样式
     * @param  {String|Node} arg2 - 父节点标识或者对象
     * @return {Node}               节点
     */
    _p._$create = (function(){
        var _map = {
            a:{href:'#',hideFocus:!0},
            style:{type:'text/css'},
            link:{type:'text/css',rel:'stylesheet'},
            iframe:{frameBorder:0},
            script:{defer:!0,type:'text/javascript'}
        };
        return function(_tag,_class,_parent){
            var _element = document.createElement(_tag),
                _config = _map[_tag.toLowerCase()];
            _u._$merge(_element,_config);
            if (!!_class) _element.className = _class;
            _parent = _p._$get(_parent);
            if (!!_parent){
                _parent.appendChild(_element);
            }else{
                // append to documentfragment for get by id
                if (!_config){
                    _fragment.appendChild(_element);
                }
            }
            return _element;
        };
    })();
    /**
     * 创建可交互框架
     *
     * 结构举例
     * ```html
     *   <div id="frameCnt"></div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *      var _xFrame = _e._$createXFrame({
     *          src:'http://www.baidu.com',
     *          name:'百度',
     *          parent:'frameCnt',
     *          visible:false,
     *          onload:function(){
     *              // 加载frame成功后，name设置成功，为百度
     *              // 加载frame成功后，显示效果正确，display:none
     *          }
     *      });
     *   });
     * ```
     *
     * @method   module:base/element._$createXFrame
     * @param    {Object}               arg0    - 可选配置参数
     * @property {String}               src     - 框架地址
     * @property {String}               name    - 框架名称
     * @property {String|Node|Function} parent  - 父节点或者框架加入父容器的执行函数
     * @property {Boolean}              visible - 是否可见
     * @property {Function}             onload  - 框架载入回调
     * @return {Node}                             框架节点
     */
    _p._$createXFrame = (function(){
        var _getFrameSrc = function(){
            if (location.hostname==document.domain){
                return 'about:blank';
            }
            return 'javascript:(function(){document.open();document.domain="'+document.domain+'";document.close();})();';
        };
        var _getFrameWithName = function(_name){
            _name = _name.trim();
            if (!_name){
                return _p._$create('iframe');
            }
            // pass name to frame
            var _iframe;
            try{
                _iframe = document.createElement(
                          '<iframe name="'+_name+'"></iframe>');
                _iframe.frameBorder = 0;
            }catch(e){
                _iframe = _p._$create('iframe');
                _iframe.name = _name;
            }
            return _iframe;
        };
        return function(_options){
            _options = _options||_o;
            var _iframe = _getFrameWithName(_options.name||'');
            if (!_options.visible){
                _iframe.style.display = 'none';
            }
            if (_u._$isFunction(_options.onload)){
                _v._$addEvent(_iframe,'load',function(_event){
                    if (!_iframe.src) return;
                    _v._$clearEvent(_iframe,'load');
                    _options.onload(_event);
                });
            }
            // will trigger onload
            var _parent = _options.parent;
            if (_u._$isFunction(_parent)){
                try{_parent(_iframe);}catch(e){}
            }else{
                (_p._$get(_parent)||document.body).appendChild(_iframe);
            }
            // ensure trigger onload async
            var _src = _options.src||_getFrameSrc();
            window.setTimeout(function(){
                _iframe.src = _src;
            },0);
            return _iframe;
        };
    })();
    /**
     * 删除节点
     *
     * 结构举例
     * ```html
     *   <div id="abc">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 移除节点前先清理节点上的事件
     *       _e._$remove('abc',false);
     *       // 移除节点前不清理节点上的事件
     *       _e._$remove('abc',true);
     *   });
     * ```
     *
     * @method module:base/element._$remove
     * @see    module:base/element._$removeByEC
     * @param  {String|Node} arg0 - 节点标识或者对象
     * @param  {Boolean}     arg1 - 是否禁止事件清理
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$remove
     * @see module:base/element._$remove
     */
    _p._$remove =
    _y._$remove = (function(){
        var _fmap = {
            img:function(_node){
                _node.src = _g._$BLANK_IMAGE;
            },
            iframe:function(_node){
                _node.src = 'about:blank';
            }
        };
        var _doClear = function(_node,_tag){
            if (!_tag){
                var _xtag = (_node.tagName||'').toLowerCase(),
                    _func = _fmap[_xtag];
                if (!!_func){
                    _func(_node);
                }
                return;
            }
            if (!!_node.getElementsByTagName){
                _u._$forEach(
                    _node.getElementsByTagName(_tag),
                    _doClear
                );
            }
        };
        return function(_element){
            _element = _p._$get(_element);
            if (!!_element){
                // clear events
                if (!arguments[1]){
                    _v._$clearEvent(_element);
                }
                // clear elements
                _doClear(_element);
                _doClear(_element,'img');
                _doClear(_element,'iframe');
                // remove node
                if (!!_element.parentNode){
                    _element.parentNode.removeChild(_element);
                }
            }
        };
    })();
    /**
     * 节点移至内存
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 先生成一个节点加到body下
     *       var _node = _e._$create('div','js-div',document.body);
     *       // 把节点移动到内存中
     *       _e._$removeByEC(_node);
     *       // 从body上没有取到节点,结果为[]
     *       _e._$getByClassName(document.body,'js-div');
     *   });
     * ```
     *
     * @method module:base/element._$removeByEC
     * @see    module:base/element._$remove
     * @param  {String|Node} arg0 - 节点标识或者对象
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$removeByEC
     * @see module:base/element._$removeByEC
     */
    _p._$removeByEC =
    _y._$removeByEC = function(_element){
        _element = _p._$get(_element);
        if (!!_element){
            try{
                _fragment.appendChild(_element);
            }catch(ex){
                // ignore
                console.error(ex);
            }
        }
    };
    /**
     * 清除所有子节点
     *
     * 结构举例
     * ```html
     *   <ul id="abc">
     *     <li>aaaaaaaaaaaaa</li>
     *     <li>bbbbbbbbbbbbb</li>
     *     <li>ccccccccccccc</li>
     *   </ul>
     *
     *   <table id="efg">
     *     <tr><td>1111</td><td>1111</td></tr>
     *     <tr><td>2222</td><td>2222</td></tr>
     *     <tr><td>3333</td><td>3333</td></tr>
     *   </table>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 清除ul下的子节点
     *       _e._$clearChildren('abc');
     *
     *       // 清除table下的子节点
     *       _e._$clearChildren('efg');
     *   });
     * ```
     *
     * @method module:base/element._$clearChildren
     * @see    module:base/element._$remove
     * @param  {String|Node} arg0 - 容器节点
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$clearChildren
     * @see module:base/element._$clearChildren
     */
    _p._$clearChildren =
    _y._$clearChildren = function(_element){
        _element = _p._$get(_element);
        if (!!_element){
            _u._$reverseEach(
                _element.childNodes,
                function(_node){
                    _p._$remove(_node);
                }
            );
        }
    };
    /**
     * 内联元素增加定位封装
     *
     * 结构举例
     * ```html
     *   <input type="text" id="abc"/>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 包装定位的span
     *       _e._$wrapInline('abc');
     *   });
     * ```
     *
     * 生成结构如下
     * ```html
     *   <span style="position:relative;zoom:1">
     *     <input type="text" id="abc"/>
     *     <!-- 此api返回以下这个节点 -->
     *     <span style="position:absolute;top:0;left:0;"></span>
     *   </span>
     * ```
     *
     * 应用举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 返回容器的样式名称
     *       // 通过这个样式名称可以取到一个绝对定位的样式名 class+'-show'
     *       var _node = _e._$wrapInline('abc',{
     *           tag:'label',
     *           clazz:'js-xxx'
     *       });
     *       // 可以在返回的节点里添加想要显示的结构
     *       _node.innerHTML = '<span>aaa</span><span>aaa</span>';
     *   });
     * ```
     *
     * @method   module:base/element._$wrapInline
     * @param    {String|Node}  arg0  - 内联节点
     * @param    {Object}       arg1  - 绝对定位节点配置信息
     * @property {String}       tag   - 标记名称，默认span
     * @property {String}       nid   - 节点识别样式名，这个会被添加到样式中作为标识
     * @property {String}       clazz - 样式名称
     * @return   {Node}                 绝对定位的节点
     */
    /**
     * @method CHAINABLE._$wrapInline
     * @see module:base/element._$wrapInline
     */
    _p._$wrapInline =
    _y._$wrapInline = (function(){
        var _clazz,
            _reg0 = /\s+/;
        var _doInitStyle = function(){
            if (!!_clazz) return;
            _clazz = _p._$pushCSSText('.#<uispace>{position:relative;zoom:1;}.#<uispace>-show{position:absolute;top:0;left:100%;cursor:text;white-space:nowrap;overflow:hidden;}');
            _p._$dumpCSSText();
        };
        return function(_element,_options){
            _element = _p._$get(_element);
            if (!_element){
                return null;
            }
            // init style
            _doInitStyle();
            _options = _options||_o;
            // check relative parent
            var _parent = _element.parentNode;
            if (!_p._$hasClassName(_parent,_clazz)){
                // build wrapper box
                _parent = _p._$create('span',_clazz);
                _element.insertAdjacentElement('beforeBegin',_parent);
                _parent.appendChild(_element);
            }
            // check absolute node
            var _nid = _options.nid||'',
                _node = _p._$getByClassName(
                    _parent,_nid||
                   (_clazz+'-show')
                )[0];
            if (!_node){
                var _klass = ((_options.clazz||'')+' '+_nid).trim();
                _klass = _clazz+'-show'+(!_klass?'':' ')+_klass;
                _node = _p._$create(_options.tag||'span',_klass);
                _parent.appendChild(_node);
            }
            // append class to parent node
            var _klass = _options.clazz;
            if (!!_klass){
                _klass = (_klass||'').trim().split(_reg0)[0]+'-parent';
                _p._$addClassName(_parent,_klass);
            }
            return _node;
        };
    })();
    /**
     * 设置或者获取指定标识的数据
     *
     * 结构举例
     * ```html
     *   <div id="abc">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 设置值操作
     *       // <div id="abc" data-img="http://a.b.com/a.png">123</div>
     *       // 返回value值: http://a.b.com/a.png
     *       var _src = _e._$dataset('abc','img','http://a.b.com/a.png');
     *       // 取值操作
     *       var _src = _e._$dataset('abc','img');
     * 
     *       // 批量设置
     *       var _map = _e._$dataset('abc',{
     *           a:'aaaaa',
     *           b:'bbbbbbbb',
     *           c:'ccccccccc'
     *       });
     * 
     *       // 批量取值
     *       // 返回：{a:'aaaaa',b:'bbbbbbbb',c:'ccccccccc'}
     *       var _map = _e._$dataset('abc',['a','b','c']);
     *   });
     * ```
     *
     * @method module:base/element._$dataset
     * @see    module:base/element._$attr
     * @param  {String}              arg0 - 数据标识
     * @param  {String|Object|Array} arg1 - 属性名
     * @return {String|Object}              数据值
     */
    /**
     * @method CHAINABLE._$dataset
     * @see module:base/element._$dataset
     */
    _p._$dataset =
    _y._$dataset = function(_element,_key,_value){
        // check element
        var _id = _p._$id(_element);
        if (!_id){
            return null;
        }
        // check single key-value
        if (_u._$isString(_key)){
            return _h.__dataset(
                _p._$get(_element),
                _key,_value
            );
        }
        // check map set
        // ignore argument _value
        if (_u._$isObject(_key)){
            var _ret = {};
            _u._$forIn(_key,function(_v,_k){
                _ret[_k] = _p._$dataset(_id,_k,_v);
            });
            return _ret;
        }
        // check array get
        // ignore argument _value
        if (_u._$isArray(_key)){
            var _ret = {};
            _u._$forEach(_key,function(_k){
                _ret[_k] = _p._$dataset(_id,_k);
            });
            return _ret;
        }
        return null;
    };
    /**
     * 取某个节点的属性值
     *
     * 结构举例
     * ```html
     *   <div id="abc">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 设置成 <div id="abc" data-img="http://a.b.com/a.png">123</div>
     *       // 返回value值: http://a.b.com/a.png
     *       var _src = _e._$attr('abc','data-img','http://a.b.com/a.png');
     *
     *       // 如果设置了img的值返回data-img，否则放回空字符串
     *       var _src = _e._$attr('abc','data-img');
     *   });
     * ```
     *
     * @method module:base/element._$attr
     * @see    module:base/element._$dataset
     * @param  {String|Node} arg0 - 节点标识或者对象
     * @param  {String}      arg1 - 属性名称
     * @param  {String}      arg2 - 属性值，如果没有设置此参数则表示取值
     * @return {String}             属性值
     */
    /**
     * @method CHAINABLE._$attr
     * @see module:base/element._$attr
     */
    _p._$attr =
    _y._$attr = function(_element,_name,_value){
        _element = _p._$get(_element);
        if (!_element){
            return '';
        }
        if (_value!==undefined&&!!_element.setAttribute){
            _element.setAttribute(_name,_value);
        }
        return _h.__getAttribute(_element,_name);
    };
    /**
     * html代码转节点对象，
     * 如果转换出来的节点数量超过[包含]2个，
     * 则最外面增加一个容器节点，即返回的始终是一个节点
     *
     * 结构举例
     * ```html
     *   <div id="abc">
     *     <span>123</span>
     *   </div>
     * ```
     *
     * 代码举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       var _node = _e._$html2node('<div>1</div><div><span>2</span></div>');
     *   });
     * ```
     *
     * 返回结果
     * ```html
     *   <div> <!-- 返回此节点 -->
     *     <div>1</div>
     *     <div><span>2</span></div>
     *   </div>
     * ```
     *
     * @method module:base/element._$html2node
     * @param  {String} arg0 - 代码
     * @return {Node}          节点
     */
    _p._$html2node = (function(){
        var _reg = /<(.*?)(?=\s|>)/i, // first tag name
            _tmap = {li:'ul',tr:'tbody',td:'tr',th:'tr',option:'select'};
        return function(_html){
            var _tag;
            if (_reg.test(_html)){
                _tag = _tmap[(RegExp.$1||'').toLowerCase()]||'';
            }
            var _div = _p._$create(_tag||'div');
            _div.innerHTML = _html;
            var _list = _p._$getChildren(_div);
            return _list.length>1?_div:_list[0];
        };
    })();
    /**
     * 将dom节点转为xml串
     *
     * 结构举例
     * ```html
     *   <div id="abc">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_p){
     *       // 生成<div id="abc">123</div>字符串
     *       var _xml = _p._$dom2xml('abc'));
     *   });
     * ```
     *
     * @see    module:base/element._$xml2dom
     * @method module:base/element._$dom2xml
     * @param  {String|Node} arg0 - 节点
     * @return {String}             XML代码
     */
    /**
     * @method CHAINABLE._$dom2xml
     * @see module:base/element._$dom2xml
     */
    _p._$dom2xml =
    _y._$dom2xml = function(_element){
        _element = _p._$get(_element);
        return !_element?'':_h.__serializeDOM2XML(_element);
    };
    /**
     * 将xml转为dom节点
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 生成<div id="abc">123</div>节点
     *       var _node = _e._$xml2dom('<div id="abc">123</div>');
     *   });
     * ```
     *
     * @method module:base/element._$xml2dom
     * @see    module:base/element._$dom2xml
     * @param  {String} arg0 - xml文本
     * @return {Node}          DOM节点
     */
    _p._$xml2dom = function(_xml){
        _xml = (_xml||'').trim();
        return !_xml?null:_h.__parseDOMFromXML(_xml);
    };
    /**
     * dom节点转对象，多用于XML DOM转数据对象
     *
     * 结构举例
     * ```html
     *   <div id="abc">123</div>
     *
     *   <div id="efg">
     *     <p>aaaa</p>
     *     <span>bbbb</span>
     *   </div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_p){
     *       // 返回对象{div:'123'}
     *       var _obj = _p._$dom2object('abc');
     *
     *       // 返回对象{div:{p:'aaaa',span:'bbbb'}}
     *       var _obj = _p._$dom2object('efg');
     *   });
     * ```
     *
     * @method module:base/element._$dom2object
     * @see    module:base/element._$xml2object
     * @param  {String|Node} arg0 - 节点
     * @return {Object}             转换完成的对象
     */
    /**
     * @method CHAINABLE._$dom2object
     * @see module:base/element._$dom2object
     */
    _p._$dom2object =
    _y._$dom2object = function(_dom,_obj){
         _obj = _obj||{};
         _dom = _p._$get(_dom);
         if (!_dom) return _obj;
        var _name = _dom.tagName.toLowerCase(),
            _list = _p._$getChildren(_dom);
        if (!_list||!_list.length){
            _obj[_name] = _dom.textContent||_dom.text||'';
            return _obj;
        }
        var _tmp = {};
        _obj[_name] = _tmp;
        _u._$forEach(
            _list,function(_node){
                _p._$dom2object(_node,_tmp);
            }
        );
        return _obj;
    };
    /**
     * XML转对象
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 返回 {user:{id:'1',username:'aaa',password:'123456'}}
     *       var _obj = _e._$xml2object('\
     *           <?xml version="1.0" encoding="utf-8" ?>\
     *           <user>\
     *             <id>1</id>\
     *             <username>aaa</username>\
     *             <password>123456</password>\
     *           </user>\
     *       ');
     *   });
     * ```
     *
     * @method module:base/element._$xml2object
     * @see    module:base/element._$dom2object
     * @param  {String} arg0 - xml代码
     * @return {Object}        对象
     */
    _p._$xml2object = function(_xml){
        try{
            return _p._$dom2object(_p._$xml2dom(_xml));
        }catch(ex){
            return null;
        }
    };
    /**
     * 文本转指定类型的数据
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 转成dom节点
     *       var _dom = _e._$text2type('<div id="abc">123</div>',"xml");
     *       // 转成json字符串
     *       var _json = _e._$text2type('{"a":"aaaaaaaaaaaaa"}',"json");
     *       // 原样返回
     *       var _text = _e._$text2type('<div id="abc">123</div>');
     *   });
     * ```
     *
     * @method module:base/element._$text2type
     * @param  {String} arg0 - 文本内容
     * @param  {String} arg1 - 类型，如xml/json/text
     * @return {Variable}      指定类型的数据
     */
    _p._$text2type = (function(){
        var _fmap = {
            xml:function(_text){
                return _p._$xml2dom(_text);
            },
            json:function(_text){
                try{
                    return JSON.parse(_text);
                }catch(ex){
                    return null;
                }
            },
            dft:function(_text){
                return _text;
            }
        };
        return function(_text,_type){
            _type = (_type||'').toLowerCase();
            return (_fmap[_type]||_fmap.dft)(_text||'');
        };
    })();
    /**
     * 批量设置节点样式
     *
     * 结构举例
     * ```html
     *   <div id="abc">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       _e._$style('abc',{color:'red',width:'100px'});
     *   });
     * ```
     *
     * 输出结果
     * ```html
     *   <div id="abc" style="color:red;width:100px;">123</div>
     * ```
     *
     * @method module:base/element._$style
     * @see    module:base/element._$setStyle
     * @param  {String|Node} arg0 - 节点
     * @param  {Object}      arg1 - 样式信息{color:'red',width:'100px'}
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$style
     * @see module:base/element._$style
     */
    _p._$style =
    _y._$style = function(_element,_map){
        _element = _p._$get(_element);
        if (!!_element){
            _u._$loop(_map,function(_value,_name){
                _p._$setStyle(_element,_name,_value);
            });
        }
    };
    /**
     * 设置单个样式
     *
     * 结构举例
     * ```html
     *   <div id="abc">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       _e._$setStyle('abc','color','red');
     *   });
     * ```
     *
     * 输出结果
     * ```html
     *   <div id="abc" style="color:red;">123</div>
     * ```
     *
     * @method module:base/element._$setStyle
     * @see    module:base/element._$getStyle
     * @param  {String|Node} arg0 - 节点
     * @param  {String}      arg1 - 样式名称
     * @param  {String}      arg2 - 样式值
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$setStyle
     * @see module:base/element._$setStyle
     */
    _p._$setStyle =
    _y._$setStyle = function(_element,_name,_value){
        _element = _p._$get(_element);
        if (!!_element){
            _h.__setStyleValue(
                _element,_name,
                _h.__processCSSText(_value)
            );
        }
    };
    /**
     * 取样式值
     *
     * 结构举例
     * ```html
     *   <div id="abc" style="color:red;">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 返回节点的颜色值red（高版本浏览器返回rgb值），如果没有返回空字符串
     *       var _value = _e._$getStyle('abc','color');
     *   });
     * ```
     *
     * @method module:base/element._$getStyle
     * @see    module:base/element._$setStyle
     * @param  {String|Node} arg0 - 节点
     * @param  {String}      arg1 - 样式名称
     * @return {String}             样式值
     */
    /**
     * @method CHAINABLE._$getStyle
     * @see module:base/element._$getStyle
     */
    _p._$getStyle =
    _y._$getStyle = function(_element,_name){
        _element = _p._$get(_element);
        return !_element ? '' :
                _h.__getStyleValue(
                    _element,_name
                );
    };
    /**
     * 页面注入脚本
     *
     * 结构举例
     * ```html
     *   <div id="abc">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 注入脚本，全局执行环境
     *       _e._$addScript('\
     *           document.getElementById("abc").style.color = "green"\
     *       ');
     *   });
     * ```
     *
     * 输出结果
     * ```html
     *   <div id="abc" style="color:green;">123</div>
     * ```
     *
     * @method module:base/element._$addScript
     * @param  {String} arg0 - 脚本内容
     * @return {Void}
     */
    _p._$addScript = function(_script){
        try{
            _script = _script.trim();
            if (!!_script){
                return (new Function(_script))();
            }
        }catch(ex){
            // ignore
            console.error(ex.message);
            console.error(ex.stack);
        }
    };
    /**
     * 注入页面内联样式，
     * 样式支持前缀标记$&lt;vendor&gt; ，
     * 如下样式值支持3D/2D切换，优先选用3D，格式：$&lt;NAME|VALUE&gt;
     *
     * * NAME支持：scale/rotate/translate/matrix
     * * VALUE格式：x=1&y=2&z=3&a=30
     *
     *
     * 范例如$&lt;scale|a=30&gt;，各名称支持的参数列表
     *
     * | 名称              | 参数 |
     * | :--        | :-- |
     * | scale      | x,y,z |
     * | rotate     | x,y,z,a |
     * | translate  | x,y,z |
     * | matrix     | m11,m12,m13,m14,m21,m22,m23,m24,m31,m32,m33,m34,m41,m42,m43,m44 |
     *
     *
     * 结构举例
     * ```html
     *   <html>
     *    <head>
     *        <title>test</title>
     *    </head>
     *   </html>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 注入样式
     *       _e._$addStyle('body{font-size:20px}');
     *
     *       // 注入样式支持变量
     *       _e._$addStyle('\
     *           .a{$<vendor>transform-origin:0 0;}\
     *           .b{$<vendor>transform:$<translate|x=0&y=1&z=1>}\
     *       ');
     *   });
     * ```
     *
     * 输出结果
     * ```html
     *   <html>
     *    <head>
     *        <title>test</title>
     *        <style>body{font-size:20px;}</style>
     *        <style>
     *           .a{-webkit-transform-origin:0 0;}\
     *           .b{-webkit-transform:translate3d(0,1,1);}\
     *        </style>
     *    </head>
     *   </html>
     * ```
     *
     * @method module:base/element._$addStyle
     * @param  {String} arg0 - 样式内容
     * @return {Node}          样式节点
     */
    _p._$addStyle = (function(){
        var _reg = /[\s\r\n]+/gi;
        return function(_css){
            _css = (_css||'').replace(_reg,' ').trim();
            var _node = null;
            if (!!_css){
                _node = _p._$create('style');
                document.head.appendChild(_node);
                _h.__injectCSSText(
                    _node,_h.__processCSSText(_css)
                );
            }
            return _node;
        };
    })();
    /**
     * 缓存待激活样式
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 设置样式到缓存中，自动生成样式名，返回自动生成的类名#<class>
     *       var _class = _e._$pushCSSText('.#<uispace>{width:300px;}');
     *
     *       // 把缓存中的样式内联到页面
     *       _e._$dumpCSSText();
     *   });
     * ```
     *
     * @method module:base/element._$pushCSSText
     * @see    module:base/element._$dumpCSSText
     * @param  {String} arg0 - 样式
     * @return {String}        样式标识
     */
    _p._$pushCSSText = (function(){
        var _reg = /#<(.*?)>/g,
            _seed = +new Date;
        return function(_css,_data){
            if (!_cspol){
                _cspol = [];
            }
            var _class = 'auto-'+_u._$uniqueID(),
                _dmap = _u._$merge({uispace:_class},_data);
            _cspol.push(
                _css.replace(_reg,function($1,$2){
                    return _dmap[$2]||$1;
                })
            );
            return _class;
        };
    })();
    /**
     * 激活缓存中的样式
     *
     * 结构举例
     * ```html
     *   <div id="abc" class="item">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 设置样式.item{width:300px;}到缓存中
     *       _e._$pushCSSText('.item{width:300px;}');
     *
     *       // 把缓存中的样式内联到页面
     *       _e._$dumpCSSText();
     *   });
     * ```
     *
     * @method module:base/element._$dumpCSSText
     * @see    module:base/element._$pushCSSText
     * @return {Void}
     */
    _p._$dumpCSSText = function(){
        if (!!_cspol){
            _p._$addStyle(_cspol.join(' '));
            _cspol = null;
        }
    };
    /**
     * 追加CSS规则
     *
     * 结构举例
     * ```html
     *   <style id="abc"></style>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 设置样式.item{width:300px;}到缓存中
     *       _e._$appendCSSText('node-id','.item{width:300px;}');
     *   });
     * ```
     *
     * @method module:base/element._$appendCSSText
     * @see    module:base/element._$addStyle
     * @param  {Node}   arg0 - 样式节点
     * @param  {String} arg1 - 单条样式规则
     * @return {CSSRule}       样式规则对象
     */
    /**
     * @method CHAINABLE._$appendCSSText
     * @see module:base/element._$appendCSSText
     */
    _p._$appendCSSText =
    _y._$appendCSSText = function(_element,_css){
        _element = _p._$get(_element);
        return !_element ? null :
                _h.__appendCSSText(
                    _element,
                    _h.__processCSSText(_css)
                );
    };
    /**
     * 新增样式类，多个样式用空格分开
     *
     * 结构举例
     * ```html
     *   <div id="abc">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 添加样式 fc01 fc03
     *       _e._$addClassName('abc','fc01 fc03');
     *   });
     * ```
     *
     * 输出结果
     * ```html
     *   <div id="abc" class="fc01 fc03">123</div>
     * ```
     *
     * @method module:base/element._$addClassName
     * @see    module:base/element._$delClassName
     * @see    module:base/element._$replaceClassName
     * @param  {String|Node} arg0 - 要操作的节点标识或者节点对象
     * @param  {String}      arg1 - 要新增的样式类名称
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$addClassName
     * @see module:base/element._$addClassName
     */
    _p._$addClassName =
    _y._$addClassName = function(_element,_class){
        _element = _p._$get(_element);
        if (!!_element){
            _h.__processClassName(
                _element,'add',_class
            );
        }
    };
    /**
     * 删除样式类，多个样式用空格分开
     *
     * 结构举例
     * ```html
     *   <div id="abc" class="fc01 fc03">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 删除fc02 fc03样式名
     *       _e._$delClassName('abc','fc02 fc03');
     *   });
     * ```
     *
     * 输出结果
     * ```html
     *   <div id="abc" class="fc01">123</div>
     * ```
     *
     * @method module:base/element._$delClassName
     * @see    module:base/element._$addClassName
     * @see    module:base/element._$replaceClassName
     * @param  {String|Node} arg0 - 要操作的节点标识或者节点对象
     * @param  {String}      arg1 - 要删除的样式类名称
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$delClassName
     * @see module:base/element._$delClassName
     */
    _p._$delClassName =
    _y._$delClassName = function(_element,_class){
        _element = _p._$get(_element);
        if (!!_element){
            _h.__processClassName(
                _element,'remove',_class
            );
        }
    };
    /**
     * 替换节点的样式类名称，多个样式用空格分隔，
     * 操作过程为先删除待删样式，再添加待添样式，因此不需要删除样式存在才添加样式
     *
     * 结构举例
     * ```html
     *   <div id="abc" class="fc01 fc03">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 替换fc02为fc05
     *       // 这里不需要fc02存在
     *       _e._$replaceClassName('abc','fc02','fc05');
     *   });
     * ```
     *
     * 输出结果
     * ```html
     *   <div id="abc" class="fc01 fc03 fc05">123</div>
     * ```
     *
     * @method module:base/element._$replaceClassName
     * @see    module:base/element._$addClassName
     * @see    module:base/element._$delClassName
     * @param  {String|Node} arg0 - 要操作的节点标识或者节点对象
     * @param  {String}      arg1 - 要删除的样式类名称
     * @param  {String}      arg2 - 要新增的样式类名称
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$replaceClassName
     * @see module:base/element._$replaceClassName
     */
    _p._$replaceClassName =
    _y._$replaceClassName = function(_element,_del,_add){
        _element = _p._$get(_element);
        if (!!_element){
            _h.__processClassName(
                _element,'replace',
                _del,_add
            );
        }
    };
    /**
     * 检测节点是否包含指定样式，多个样式用空格分隔，检测时包含其中之一即表示包含
     *
     * 结构举例
     * ```html
     *   <div id="abc" class="fc01 fc03">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 如果有fc01样式返回true，否则返回false
     *       _e._$hasClassName('abc',"fc01");
     *   });
     * ```
     *
     * @method module:base/element._$hasClassName
     * @param  {String|Node} arg0 - 节点标识或者对象
     * @param  {String}      arg1 - 样式串
     * @return {Boolean}            是否含指定样式
     */
    /**
     * @method CHAINABLE._$hasClassName
     * @see module:base/element._$hasClassName
     */
    _p._$hasClassName =
    _y._$hasClassName = function(_element,_class){
        _element = _p._$get(_element);
        if (!!_element){
            return _h.__hasClassName(_element,_class);
        }
        return !1;
    };
    /**
     * 取样式变换矩阵对象
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 生成下面矩阵的对象
     *       // |a:1,b:0,c:0,d:1,e:0:f:0|
     *       // |m11:1,m12:0,m13:0,m14:0|
     *       // |m21:0,m22:1,m23:0,m24:0|
     *       // |m31:0,m32:0,m33:1,m34:0|
     *       // |m41:0,m42:0,m43:0,m44:1|
     *       var _matrix = _e._$matrix("matrix(1,0,0,1,0,0)");
     *   });
     * ```
     *
     * @method module:base/element._$matrix
     * @param  {String} arg0 - 变化信息
     * @return {CSSMatrix}     变换矩阵对象
     */
    _p._$matrix = function(_matrix){
        _matrix = (_matrix||'').trim();
        return _h.__getCSSMatrix(_matrix);
    };
    /**
     * 设置3D变换，对于不支持3D的系统自动切换为2D变换
     *
     * 结构举例
     * ```html
     *   <div id="abc"></div>
     * ```
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/element'
     *   ],function(_e){
     *       // 进行css3d变换，对应css样式为-webkit-transform:rotate3d( 2, 1, 1, -75deg);
     *       _e._$css3d('abc','rotate',{x:2,y:1,z:1,a:'-75deg'});
     *   });
     * ```
     *
     * @method module:base/element._$css3d
     * @see    module:base/element._$addStyle
     * @param  {String|Node} arg0 - 节点标识或者对象
     * @param  {String}      arg1 - 变换类型，matrix/translate/scale/rotate
     * @param  {Object}      arg2 - 变换值，{x:1,y:2,z:3,a:'30deg'}
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$css3d
     * @see module:base/element._$css3d
     */
    _p._$css3d =
    _y._$css3d = function(_element,_name,_map){
        _element = _p._$get(_element);
        if (!!_element){
            var _value = _h.__processTransformValue(_name,_map);
            if (!!_value){
                _p._$setStyle(_element,'transform',_value);
            }
        }
    };
    // for chainable
    _x._$merge(_y);

    if (CMPT){
        NEJ.copy(NEJ.P('nej.e'),_p);
    }

    return _p;
},215,227,2,3,217,228);
I$(427,function (_u,_m,_p,_o,_f,_r){
    /**
     * 验证事件信息
     * @param  {Node}     节点
     * @param  {String}   事件类型
     * @param  {Function} 处理函数
     * @return {Object}   验证后事件信息 type/handler
     */
    _p.__checkEvent = (function(){
            // need change event name
        var _tmap = {
                touchstart:'mousedown',
                touchmove:'mousemove',
                touchend:'mouseup'
            },
            // need prefix
            _pfix = _m._$KERNEL.prefix,
            _emap = {
                transitionend:'TransitionEnd',
                animationend:'AnimationEnd',
                animationstart:'AnimationStart',
                animationiteration:'AnimationIteration',
                visibilitychange:'visibilitychange'
            };
        var _fmap = {
            enter:function(_element,_type,_handler){
                var _result = {
                    type:'keypress'
                };
                if (!!_handler){
                    _result.handler = function(_event){
                        if (_event.keyCode===13){
                            _handler.call(_element,_event);
                        }
                    };
                }
                return _result;
            }
        };
        var _doPrefix = function(_name){
            return (_pfix.evt||_pfix.pro)+_name;
        };
        return function(_element,_type,_handler){
            var _result = {
                type:_type,
                handler:_handler
            };
            if (!(('on'+_type) in _element)){
                // check name convert
                var _name = _tmap[_type];
                if (!!_name){
                    _result.type = _name;
                    return _result;
                }
                // check prefix complete
                var _name = _emap[_type];
                if (!!_name){
                    _result.type = _doPrefix(_name);
                    return _result;
                }
                // check event update
                var _func = _fmap[_type];
                if (!!_func){
                    return _func.apply(null,arguments);
                }
            }
            return _result;
        };
    })();
    /**
     * 添加事件
     * @param  {Node}     节点
     * @param  {String}   事件
     * @param  {Function} 处理函数
     * @param  {Boolean}  是否捕捉阶段
     * @return {Void}
     */
    _p.__addEvent = function(){
        var _args = arguments;
        if (DEBUG){
            if (!(('on'+_args[1]) in _args[0])){
                console.log('not support event['+_args[1]+'] for '+_args[0]);
            }
        }
        _args[0].addEventListener(
            _args[1],_args[2],_args[3]
        );
    };
    /**
     * 删除事件
     * @param  {Node}     节点
     * @param  {String}   事件
     * @param  {Function} 处理函数
     * @param  {Boolean}  是否捕捉阶段
     * @return {Void}
     */
    _p.__delEvent = function(){
        var _args = arguments;
        _args[0].removeEventListener(
            _args[1],_args[2],_args[3]
        );
    };
    /**
     * 触发对象的某个事件
     * @param  {String|Node} 节点ID或者对象
     * @param  {String}      鼠标事件类型
     * @return {Void}
     */
    _p.__dispatchEvent = function(_element,_type,_options){
        var _event = document.createEvent('Event');
        _event.initEvent(_type,!0,!0);
        _u._$merge(_event,_options);
        _element.dispatchEvent(_event);
    };
    
    return _p;
},2,78);
I$(218,function(b1482406244018,_h,_u,_p,_o,_f,_r){if (b1482406244018._$KERNEL.engine==='trident'&&b1482406244018._$KERNEL.release>='6.0'){I$(428,function (){
        /**
         * 验证事件信息
         * @param  {Node}     节点
         * @param  {String}   事件类型
         * @param  {Function} 处理函数
         * @return {Object}   验证后事件信息 type/handler
         */
        _h.__checkEvent = (function(){
            var _emap = {
                touchcancel:'MSPointerCancel',
                touchstart:'MSPointerDown',
                touchmove:'MSPointerMove',
                touchend:'MSPointerUp'
            };
            return _h.__checkEvent._$aop(function(_event){
                var _args = _event.args;
                // check event convert
                var _name = _emap[_args[1]];
                if (!!_name){
                    _event.stopped = !0;
                    _event.value = {
                        type:_name,
                        handler:_args[2]
                    };
                }
            });
        })();
    });}
if (b1482406244018._$KERNEL.engine==='trident'&&b1482406244018._$KERNEL.release=='5.0'){I$(429,function (){
        /**
         * 验证事件信息
         * @param  {Node}     节点
         * @param  {String}   事件类型
         * @param  {Function} 处理函数
         * @return {Object}   验证后事件信息 type/handler
         */
        _h.__checkEvent = (function(){
            var _vmap = {};
            var _fmap = {
                input:function(_element,_type,_handler){
                    // for check type only
                    if (!_handler){
                        return {type:_type};
                    }
                    // fix input backspace/delete/ctrl+x bug
                    return {
                        type:_type,
                        handler:function(_event){
                            var _id = _element.id;
                            _vmap[_id] = _element.value;
                            _handler.call(_element,_event);
                        },
                        link:[[
                            document,'selectionchange',
                            function(_event){
                                var _id = _element.id;
                                if (_element!=document.activeElement){
                                    delete _vmap[_id];
                                    return;
                                }
                                if (_vmap[_id]!==_element.value){
                                    _vmap[_id] = _element.value;
                                    _handler.call(_element,_event);
                                }
                            }
                        ]]
                    };
                }
            };
            return _h.__checkEvent._$aop(function(_event){
                var _args = _event.args;
                // check event update
                var _func = _fmap[_args[1]];
                if (!!_func){
                    _event.stopped = !0;
                    _event.value = _func.apply(null,_args);
                }
            });
        })();
    });}
if (b1482406244018._$KERNEL.engine==='trident'&&b1482406244018._$KERNEL.release>='5.0'){I$(430,function (){
        // must use attach/detach for event
        var _attached = {
            'propertychange':1
        };
        /**
         * 添加事件
         * @param  {Node}     节点
         * @param  {String}   事件
         * @param  {Function} 处理函数
         * @param  {Boolean}  是否捕捉阶段
         * @return {Void}
         */
        _h.__addEvent = 
        _h.__addEvent._$aop(function(_event){
            var _args = _event.args;
            if (_attached[_args[1]]!=null&&!!_args[0].attachEvent){
                _event.stopped = !0;
                _args[0].attachEvent('on'+_args[1],_args[2]);
            }
        });
        /**
         * 删除事件
         * @param  {Node}     节点
         * @param  {String}   事件
         * @param  {Function} 处理函数
         * @param  {Boolean}  是否捕捉阶段
         * @return {Void}
         */
        _h.__delEvent = 
        _h.__delEvent._$aop(function(_event){
            var _args = _event.args,
                _alias = _attached[_args[1]];
            if (_attached[_args[1]]!=null&&!!_args[0].detachEvent){
                _event.stopped = !0;
                _args[0].detachEvent('on'+_args[1],_args[2]);
            }
        });
    });}
if (b1482406244018._$KERNEL.engine==='trident'&&b1482406244018._$KERNEL.release<='4.0'){I$(431,function (){
        /**
         * 验证事件信息
         * @param  {Node}     节点
         * @param  {String}   事件类型
         * @param  {Function} 处理函数
         * @return {Object}   验证后事件信息 type/handler
         */
        _h.__checkEvent = (function(){
            var _lmap = {};
            var _fmap = {
                input:function(_element,_type,_handler){
                    var _result = {
                        type:'propertychange'
                    };
                    if (!!_handler){
                        _result.handler = function(_event){
                            // for input.value or textarea.value
                            if (('value' in _element)&&
                                _event.propertyName=='value'){
                                var _id = _element.id;
                                // lock cycle trigger
                                if (!!_lmap[_id]){
                                    return;
                                }
                                _lmap[_id] = !0;
                                _handler.call(_element,_event);
                                delete _lmap[_id];
                            }
                        };
                    }
                    return _result;
                },
                load:function(_element,_type,_handler){
                    var _result = {
                        type:'readystatechange'
                    };
                    if (!!_handler){
                        _result.handler = function(_event){
                            if (_element.readyState=='loaded'||
                                _element.readyState=='complete'){
                                _handler.call(_element,_event);
                            }
                        };
                    }
                    return _result;
                }
            };
            return _h.__checkEvent._$aop(function(_event){
                var _args = _event.args;
                // check event update
                var _func = _fmap[_args[1]];
                if (!!_func){
                    _event.stopped = !0;
                    _event.value = _func.apply(null,_args);
                }
                // use element for this in handler
                if (!!_args[2]){
                    _args[2] = _args[2]._$bind(_args[0]);
                }
            });
        })();
        /**
         * 添加事件
         * @param  {Node}     节点
         * @param  {String}   事件
         * @param  {Function} 处理函数
         * @param  {Boolean}  是否捕捉阶段
         * @return {Void}
         */
        _h.__addEvent = function(){
            var _args = arguments;
            if (DEBUG){
                if (!(('on'+_args[1]) in _args[0])){
                    console.log('not support event['+_args[1]+'] for '+_args[0]);
                }
            }
            _args[0].attachEvent('on'+_args[1],_args[2]);
        };
        /**
         * 删除事件
         * @param  {Node}     节点
         * @param  {String}   事件
         * @param  {Function} 处理函数
         * @param  {Boolean}  是否捕捉阶段
         * @return {Void}
         */
        _h.__delEvent = function(){
            var _args = arguments;
            _args[0].detachEvent('on'+_args[1],_args[2]);
        };
        /**
         * 触发对象的某个事件
         * @param  {String|Node} 节点ID或者对象
         * @param  {String}      鼠标事件类型
         * @return {Void}
         */
        _h.__dispatchEvent = (function(){
            var _omap = {
                propertychange:{propertyName:'value'}
            };
            return function(_element,_type,_options){
                var _event = document.createEventObject();
                try{
                    _u._$merge(_event,_omap[_type],_options);
                    _element.fireEvent('on'+_type,_event);
                }catch(ex){
                    // ignore unrecognized event name
                    console.error(ex.message);
                    console.error(ex.stack);
                }
            };
        })();
    });}
if (b1482406244018._$KERNEL.engine==='gecko'){I$(432,function (){
        /**
         * 验证事件信息
         * @param  {Node}     节点
         * @param  {String}   事件类型
         * @param  {Function} 处理函数
         * @return {Object}   验证后事件信息 type/handler
         */
        _h.__checkEvent = (function(){
            var _nreg = /^(?:transitionend|animationend|animationstart|animationiteration)$/i;
            var _fmap = {
                mousewheel:function(_element,_type,_handler){
                    var _result = {
                        type:'MozMousePixelScroll'
                    };
                    if (!!_handler){
                        _result.handler = function(_event){
                            var _delta = _event.detail;
                            _event.wheelDelta = -_delta;
                            _event.wheelDeltaY = -_delta;
                            _event.wheelDeltaX = 0;
                            _handler.call(_element,_event);
                        };
                    }
                    return _result;
                }
            };
            return _h.__checkEvent._$aop(function(_event){
                var _args = _event.args;
                // check animation event
                if (_nreg.test(_args[1])){
                    _event.stopped = !0;
                    _event.value = {
                        type:_args[1],
                        handler:_args[2]
                    };
                }
                // check event update
                var _func = _fmap[_args[1]];
                if (!!_func){
                    _event.stopped = !0;
                    _event.value = _func.apply(null,_args);
                }
            });
        })();
    });}return _h;},78,427,2);
I$(3,function (NEJ,_e,_u,_x,_h,_p,_o,_f,_r){
    // {id:{type:[{type:'click',func:function,sfun:function,capt:true},...]}}
    // id   - element id
    // type - event name, no on prefix
    // func - event after wrapper
    // capt - capture flag
    // sfun - event before wrapper
    // link - events link to this event [[element,type,handler,capture],...]
    var _xcache = {},
        _y = {}; // chainable methods
    /*
     * 取事件类型列表
     * @param  {String} 事件类型
     * @return {Array}  事件列表
     */
    var _getTypeList = (function(){
        var _reg = /[\s,;]+/;
        return function(_type){
            var _type = (_type||'').trim().toLowerCase();
            return !_type?null:_type.split(_reg);
        };
    })();
    /*
     * 取鼠标相对于BODY的偏移
     * @param  {Event}  事件对象
     * @param  {String} 类型，X/Y
     * @param  {String} 滚动偏移名称，Left/Top
     * @return {Void}
     */
    var _getClientOffset = function(_event,_type,_name){
        var _key1 = 'page'+_type;
        return _event[_key1]!=null?_event[_key1]:(
            _event['client'+_type]+
            _e._$getPageBox()['scroll'+_name]
        );
    };
    /*
     * 取鼠标相对于页面的偏移
     * @param  {Event}  事件对象
     * @param  {String} 类型，X/Y
     * @param  {String} 滚动偏移名称，Left/Top
     * @return {Void}
     */
    var _getPageOffset = function(_event,_type,_name){
        var _key3 = 'scroll'+_name;
            _node = _p._$getElement(_event),
            _xret = _getClientOffset(_event,_type,_name);
        while(!!_node&&
                _node!=document.body&&
                _node!=document.documentElement){
            _xret += _node[_key3]||0;
            _node = _node.parentNode;
        }
        return _xret;
    };
    /*
     * 格式化添加删除事件接口参数
     * @param  {String|Node} 节点ID或者对象
     * @param  {String}      事件类型，不带on前缀，不区分大小写，多个事件用空格分隔
     * @param  {Function}    事件处理函数
     * @param  {Boolean}     是否捕获阶段事件，IE低版本浏览器忽略此参数
     * return  {Object}      格式化后参数
     */
    var _doFormatArgs = function(_element,_type,_handler,_capture){
        var _result = {};
        // check element
        _element = _e._$get(_element);
        if (!_element){
            return null;
        }
        _e._$id(_element);
        _result.element = _element;
        // check event handler
        if (!_u._$isFunction(_handler)){
            return null;
        }
        _result.handler = _handler;
        // check type
        var _type = _getTypeList(_type);
        if (!_type){
            return null;
        }
        // save info
        _result.type = _type;
        _result.capture = !!_capture;
        return _result;
    };
    /**
     * 节点添加事件，
     * 支持添加自定义事件，
     * 对于自定义事件的实现逻辑由其他模块负责实现
     *
     * 结构举例
     * ```html
     *   <div id="abc">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/event'
     *   ],function(_v){
     *       // 添加系统预定义事件
     *       _v._$addEvent(
     *           'abc','mouseover',function(_event){
     *               // TODO something
     *           },false
     *       );
     *
     *       // 添加自定义事件，回车事件
     *       _v._$addEvent(
     *           'abc','enter',function(_event){
     *               // TODO something
     *           },false
     *       );
     *
     *       // 添加多个事件，用空格分隔
     *       _v._$addEvent(
     *           'abc','mouseover click mousedown',
     *           function(_event){
     *               // TODO something
     *           },false
     *       );
     *   });
     * ```
     *
     * 带自定义事件的类构造或者对象
     * ```javascript
     * NEJ.define([
     *     'base/klass',
     *     'base/event',
     *     'util/event',
     *     'util/event/event'
     * ],function(_k,_v,_t0,_t1,_p){
     *     // 定义类
     *     _p._$$Klass = _k._$klass();
     *     var _pro = _p._$$Klass._$extend(_t0._$$EventTarget);
     *     
     *     // TODO
     *     
     *     // 添加自定义事件支持
     *     // 对节点的事件同样支持此自定义事件
     *     _t1._$$CustomEvent._$allocate({
     *         element:_p._$$Klass,
     *         event:['ok','fail']
     *     });
     * 
     *     // 使用事件接口添加/删除/调度事件
     *     var _handler = function(_event){
     *         // TODO
     *     };
     *     _v._$addEvent(_p._$$Klass,'ok',_handler);
     *     _v._$delEvent(_p._$$Klass,'ok',_handler);
     * });
     * ```
     * 
     * @method module:base/event._$addEvent
     * @see    module:base/event._$delEvent
     * @param  {String|Node|Object} arg0 - 节点或者类构造或者对象
     * @param  {String}      arg1 - 事件类型，不带on前缀，不区分大小写，多个事件用空格分隔
     * @param  {Function}    arg2 - 事件处理函数
     * @param  {Boolean}     arg3 - 是否捕获阶段事件，IE低版本浏览器忽略此参数
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$addEvent
     * @see module:base/event._$addEvent
     */
    _p._$addEvent = 
    _y._$addEvent = (function(){
        // cache event
        // type/handler/link
        var _doCacheEvent = function(_type,_source,_real){
            var _id = _e._$id(_source.element),
                _cch_id = _xcache[_id]||{},
                _cch_tp = _cch_id[_type]||[];
            _cch_tp.push({
                type:_real.type||_type,
                func:_real.handler||_source.handler,
                sfun:_source.handler,
                capt:_source.capture,
                link:_real.link
            });
            _cch_id[_type] = _cch_tp;
            _xcache[_id] = _cch_id;
        };
        return function(){
            var _args = _doFormatArgs.apply(null,arguments);
            if (!_args) return;
            _u._$forEach(
                _args.type,function(_name){
                    var _argc = _h.__checkEvent(
                        _args.element,
                        _name,_args.handler
                    );
                    // add event
                    _h.__addEvent(
                        _args.element,_argc.type,
                        _argc.handler,_args.capture
                    );
                    // add event link
                    _u._$forIn(
                        _argc.link,function(_item){
                            _item[3] = !!_item[3];
                            _h.__addEvent.apply(_h,_item);
                            _item[0] = _e._$id(_item[0]);
                        }
                    );
                    // cache event
                    _doCacheEvent(_name,_args,_argc);
                }
            );
        };
    })();
    /**
     * 节点删除事件，输入参数必须保证与添加接口_$addEvent输入参数完全一致
     *
     * 结构举例
     * ```html
     *   <div id="abc">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/event'
     *   ],function(_v){
     *       // 事件回调业务逻辑
     *       var _doCallback = function(_event){
     *           // TODO something
     *           alert('0');
     *       };
     *
     *       // 添加事件
     *       _v._$addEvent('abc','mouseover',_doCallback,false);
     *       // 删除事件，这里参数必须保持完全一致
     *       _v._$delEvent('abc','mouseover',_doCallback,false);
     *
     *       // 比如以下方式虽然回调的业务逻辑一致，但是无法删除之前添加的事件
     *       _v._$delEvent(
     *           'abc',"mouseover",function(_event){
     *               // TODO something
     *               alert('0');
     *           },false
     *       );
     *
     *       // 删除多个事件
     *       _v._$delEvent(
     *           'abc','mouseover click mouseup',
     *           _doCallback,false
     *       );
     *   });
     * ```
     *
     * @method module:base/event._$delEvent
     * @see    module:base/event._$addEvent
     * @param  {String|Node} arg0 - 节点ID或者对象
     * @param  {String}      arg1 - 事件类型，不带on前缀，不区分大小写，多个事件用空格分隔
     * @param  {Function}    arg2 - 事件处理函数
     * @param  {Boolean}     arg3 - 是否捕获阶段事件
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$delEvent
     * @see module:base/event._$delEvent
     */
    _p._$delEvent = 
    _y._$delEvent = (function(){
        var _unCacheEvent = function(_type,_conf){
            var _id = _e._$id(_conf.element),
                _cch_id = _xcache[_id]||_o,
                _cch_tp = _cch_id[_type],
                _index = _u._$indexOf(
                    _cch_tp,function(_item){
                        // check handler and capture
                        return _item.sfun===_conf.handler&&
                               _item.capt===_conf.capture;
                    }
                );
            // check result
            var _result = null;
            if (_index>=0){
                var _item = _cch_tp.splice(_index,1)[0];
                _result = [[
                    _conf.element,_item.type,
                    _item.func,_conf.capture
                ]];
                if (!!_item.link){
                    _result.push.apply(_result,_item.link);
                }
                // clear cache
                if (!_cch_tp.length){
                    delete _cch_id[_type];
                }
                if (!_u._$hasProperty(_cch_id)){
                    delete _xcache[_id];
                }
            }
            return _result;
        };
        return function(){
            var _args = _doFormatArgs.apply(null,arguments);
            if (!_args) return;
            _u._$forEach(
                _args.type,function(_name){
                    _u._$forEach(
                        _unCacheEvent(_name,_args),
                        function(_item){
                            _h.__delEvent.apply(_h,_item);
                        }
                    );
                }
            );
        };
    })();
    /**
     * 清除节点事件
     *
     * 结构举例
     * ```html
     *   <div id="abc">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/event'
     *   ],function(_v){
     *       // 添加事件
     *       _v._$addEvent(
     *           'abc','mouseover',function(_event){
     *               // TODO something
     *           }
     *       );
     *       _v._$addEvent(
     *           'abc','mouseover',function(_event){
     *               // TODO something
     *           },true
     *       );
     *       _v._$addEvent(
     *           'abc','custom',function(_event){
     *               // TODO something
     *           }
     *       );
     *
     *       // 清除节点所有事件，包括两个mouseover事件和一个custom事件
     *       _v._$clearEvent('abc');
     *
     *       // 清除节点指定类型事件，只清除两个mouseover事件
     *       _v._$clearEvent('abc','mouseover');
     *
     *       // 清除多个事件，用空格分隔
     *       _v._$clearEvent('abc','mouseover custom');
     *   });
     * ```
     *
     * @method module:base/event._$clearEvent
     * @see    module:base/event._$delEvent
     * @param  {String|Node} arg0 - 节点ID或者对象
     * @param  {String}      arg1 - 事件类型，不带on前缀，不区分大小写，多个事件用空格分隔
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$clearEvent
     * @see module:base/event._$clearEvent
     */
    _p._$clearEvent = 
    _y._$clearEvent = (function(){
        var _doClearEvent = function(_id,_name,_list){
            _u._$reverseEach(
                _list,function(_item){
                    _p._$delEvent(
                        _id,_name,_item.sfun,_item.capt
                    );
                }
            );
        };
        return function(_element,_type){
            var _id = _e._$id(_element);
            if (!_id) return;
            var _cch_id = _xcache[_id];
            if (!!_cch_id){
                _type = _getTypeList(_type);
                if (!!_type){
                    // clear event by type
                    _u._$forEach(
                        _type,function(_name){
                            _doClearEvent(_id,_name,_cch_id[_name]);
                        }
                    );
                }else{
                    // clear all event
                    _u._$loop(
                        _cch_id,function(_value,_name){
                            _p._$clearEvent(_element,_name);
                        }
                    );
                }
            }
        };
    })();
    /**
     * 触发对象的某个事件，注：对于IE浏览器该接口节点事件有以下限制
     *
     * * 捕获阶段支持需要浏览器IE9+
     * * 节点上自定义事件支持需要浏览器IE9+
     *
     *
     * 结构举例
     * ```html
     *   <div id="abc">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/event'
     *   ],function(_v){
     *       // 注册鼠标事件
     *       _v._$addEvent(
     *           'abc','click',function(_event){
     *               // 获取鼠标事件触发的垂直位置
     *               var _y = _v._$pageY(_event);
     *           }
     *       );
     *       // 触发鼠标事件
     *       _v._$dispatchEvent('abc','click');
     *
     *       // 注册自定义事件
     *       _v._$addEvent(
     *           'abc','ok',function(_event){
     *               // TODO something
     *           }
     *       );
     *       // 触发自定义事件
     *       _v._$dispatchEvent('abc','ok');
     *   });
     * ```
     *
     * @method module:base/event._$dispatchEvent
     * @param  {String|Node} arg0 - 节点ID或者对象
     * @param  {String}      arg1 - 鼠标事件类型，不区分大小写，多个事件用空格分隔
     * @param  {Object}      arg2 - 传递的参数信息
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$dispatchEvent
     * @see module:base/event._$dispatchEvent
     */
    _p._$dispatchEvent = 
    _y._$dispatchEvent = function(_element,_type,_options){
        var _element = _e._$get(_element);
        if (!!_element){
            _u._$forEach(
                _getTypeList(_type),function(_name){
                    var _result = _h.__checkEvent(
                        _element,_name
                    );
                    _h.__dispatchEvent(
                        _element,_result.type,_options
                    );
                }
            );
        }
    };
    /**
     * 获取触发事件的节点，可以传入过滤接口来遍历父节点找到符合条件的节点
     *
     * 结构举例
     * ```html
     *   <div id="a">
     *     <p>
     *       <span id="b">123</span>
     *       <span link="a">123</span>
     *       <span class="a link">123</span>
     *       <span data-link="a">123</span>
     *       <label>aaaaa</label>
     *     </p>
     *   </div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/event'
     *   ],function(_v){
     *       // 取事件触发节点
     *       _v._$addEvent(
     *           'b','click',function(_event){
     *               // id为b的节点
     *               var _node = _v._$getElement(_event);
     *               // TODO something
     *           }
     *       );
     *
     *       // 事件触发，取id是a的节点
     *       _v._$addEvent(
     *           'b','click',function(_event){
     *               // id为a的节点
     *               var _node = _v._$getElement(
     *                   _event,function(_element){
     *                       return _element.id=='a';
     *                   }
     *               );
     *               // TODO something
     *
     *               // class含link或者属性含link或者data-link的节点
     *               var _node = _v._$getElement(_event,'link');
     *
     *               // 仅匹配class即 class="link xx xxx"
     *               var _node = _v._$getElement(_event,'c:link');
     *
     *               // 仅匹配dataset即 data-link="aaaa"
     *               var _node = _v._$getElement(_event,'d:link');
     *
     *               // 仅匹配attributer即 link="aaa"
     *               var _node = _v._$getElement(_event,'a:link');
     *
     *               // 仅匹配tag即 <label>
     *               var _node = _v._$getElement(_event,'t:label');
     *           }
     *       );
     *   });
     * ```
     *
     * @method module:base/event._$getElement
     * @param  {Event}    arg0 - 事件对象
     * @param  {Function} arg1 - 过滤接口
     * @return {Node}            符合条件的节点
     */
    _p._$getElement = (function(){
        // element filter
        var _exmap;
        var _doFilter = function(_name,_element){
            var _arr = _name.split(':');
            if (_arr.length>1){
                if (!_exmap){
                    _exmap = {
                        a:_e._$attr,
                        d:_e._$dataset,
                        c:_e._$hasClassName,
                        t:function(n,v){return (n.tagName||'').toLowerCase()===v;}
                    };
                }
                var _check = _exmap[_arr[0]];
                if (!!_check){
                    return !!_check(_element,_arr[1]);
                }
                _name = _arr[1];
            }
            return !!_e._$attr(_element,_name)||
                   !!_e._$dataset(_element,_name)||
                     _e._$hasClassName(_element,_name);
        };
        return function(_event){
            if (!_event) return null;
            var _element = _event.target||
                           _event.srcElement,
                _filter = arguments[1];
            if (!_filter){
                return _element;
            }
            if (_u._$isString(_filter)){
                _filter = _doFilter._$bind(null,_filter);
            }
            if (_u._$isFunction(_filter)){
                while(_element){
                    if (!!_filter(_element)){
                        return _element;
                    }
                    _element = _element.parentNode;
                }
                return null;
            }
            return _element;
        };
    })();
    /**
     * 阻止事件，包括默认事件和传递事件
     *
     * 结构举例
     * ```html
     *   <div id="a">
     *     <a href="xxx.html" id="b">123</a>
     *   </div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/event'
     *   ],function(_v){
     *       // 事件回调中阻止事件冒泡
     *       _v._$addEvent(
     *           'b','click',function(_event){
     *               // 阻止事件继续传播
     *               // 阻止链接打开的默认事件
     *               _v._$stop(_event);
     *           }
     *       );
     *
     *       // a节点上的点击事件不会触发
     *       _v._$addEvent(
     *           'a','click',function(_event){
     *               alert(0);
     *               // TODO something
     *           }
     *       );
     *   });
     * ```
     *
     * @method module:base/event._$stop
     * @see    module:base/event._$stopBubble
     * @see    module:base/event._$stopDefault
     * @param  {Event} arg0 - 要阻止的事件对象
     * @return {Void}
     */
    _p._$stop = function(_event){
        _p._$stopBubble(_event);
        _p._$stopDefault(_event);
    };
    /**
     * 阻止事件的冒泡传递
     *
     * 结构举例
     * ```html
     *   <div id="a">
     *     <a href="xxx.html" id="b">123</a>
     *   </div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/event'
     *   ],function(_v){
     *       // 事件回调中阻止事件冒泡
     *       _v._$addEvent(
     *           'b','click',function(_event){
     *               // 阻止事件继续传播
     *               // 链接仍然会被打开
     *               _v._$stopBubble(_event);
     *           }
     *       );
     *
     *       // a节点上的点击事件不会触发
     *       _v._$addEvent(
     *           'a','click',function(_event){
     *               alert(0);
     *               // TODO something
     *           }
     *       );
     *   });
     * ```
     *
     * @see    module:base/event._$stop}
     * @method module:base/event._$stopBubble
     * @param  {Event} arg0 - 要阻止的事件对象
     * @return {Void}
     */
    _p._$stopBubble = function(_event){
        if (!!_event){
            !!_event.stopPropagation
            ? _event.stopPropagation()
            : _event.cancelBubble = !0;
        }
    };
    /**
     * 阻止标签的默认事件
     *
     * 结构举例
     * ```html
     *   <div id="a">
     *     <a href="xxx.html" id="b">123</a>
     *   </div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/event'
     *   ],function(_v){
     *       // 事件回调中阻止链接默认事件
     *       _v._$addEvent(
     *           'b','click',function(_event){
     *               // 阻止链接打开页面的默认行为
     *               _v._$stopDefault(_event);
     *           }
     *       );
     *
     *       // a节点上的点击事件仍然会触发
     *       _v._$addEvent(
     *           'a','click',function(_event){
     *               alert(0);
     *               // TODO something
     *           }
     *       );
     *   });
     * ```
     *
     * @method module:base/event._$stopDefault
     * @see    module:base/event._$stop
     * @param  {Event} arg0 - 要阻止的事件对象
     * @return {Void}
     */
    _p._$stopDefault = function(_event) {
        if (!!_event){
            !!_event.preventDefault
            ? _event.preventDefault()
            : _event.returnValue = !1;
        }
    };
    /**
     * 取事件相对于页面的位置
     *
     * 结构举例
     * ```html
     *   <div id="abc" style="width:100%;height:100%;">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/event'
     *   ],function(_v){
     *       // 回调中取鼠标位置
     *       _v._$addEvent(
     *           'abc','click',function(_event){
     *               // 获取鼠标事件触发的水平、垂直位置
     *               var _pos = _v._$page(_event);
     *           }
     *       );
     *   });
     * ```
     *
     * @method module:base/event._$page
     * @see    module:base/event._$pageX
     * @see    module:base/event._$pageY
     * @param  {Event}  arg0 - 事件对象
     * @return {Object}        位置信息，{x:10,y:10}
     */
    _p._$page = function(_event){
        return {
            x:_p._$pageX(_event),
            y:_p._$pageY(_event)
        };
    };
    /**
     * 取事件相对于页面左侧的位置，累加所有内部滚动高度
     *
     * 结构举例
     * ```html
     *   <div id="abc" style="width:100%;height:100%;">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/event'
     *   ],function(_v){
     *       // 回调中取鼠标位置
     *       _p._$addEvent(
     *           'abc','click',function(_event){
     *               // 获取鼠标事件触发的水平位置
     *               var _x = _v._$pageX(_event);
     *           }
     *       );
     *   });
     * ```
     *
     * @method module:base/event._$pageX
     * @see    module:base/event._$clientX
     * @param  {Event}  arg0 - 事件对象
     * @return {Number}        水平位置
     */
    _p._$pageX = function(_event){
        return _getPageOffset(_event,'X','Left');
    };
    /**
     * 取事件相对于页面顶部的位置，累加所有内部滚动高度
     *
     * 结构举例
     * ```html
     *   <div id="abc" style="width:100%;height:100%;">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/event'
     *   ],function(_v){
     *       // 回调中取鼠标位置
     *       _v._$addEvent(
     *           'abc','click',function(_event){
     *               // 获取鼠标事件触发的垂直位置
     *               var _y = _v._$pageY(_event);
     *           }
     *       );
     *   });
     * ```
     *
     * @method module:base/event._$pageY
     * @see    module:base/event._$clientY
     * @param  {Event}  arg0 - 事件对象
     * @return {Number}        垂直位置
     */
    _p._$pageY = function(_event){
        return _getPageOffset(_event,'Y','Top');
    };
    /**
     * 取事件相对于页面左侧的位置，仅累加页面滚动高度
     *
     * 结构举例
     * ```html
     *   <div id="abc" style="width:100%;height:100%;">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/event'
     *   ],function(_v){
     *       // 回调中取鼠标位置
     *       _p._$addEvent(
     *           'abc','click',function(_event){
     *               // 获取鼠标事件触发的水平位置
     *               var _x = _v._$clientX(_event);
     *           }
     *       );
     *   });
     * ```
     *
     * @method module:base/event._$clientX
     * @see    module:base/event._$pageX
     * @param  {Event}  arg0 - 事件对象
     * @return {Number}        水平位置
     */
    _p._$clientX = function(_event){
        return _getClientOffset(_event,'X','Left');
    };
    /**
     * 取事件相对于页面顶部的位置，仅累加页面滚动高度
     *
     * 结构举例
     * ```html
     *   <div id="abc" style="width:100%;height:100%;">123</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'base/event'
     *   ],function(_v){
     *       // 回调中取鼠标位置
     *       _v._$addEvent(
     *           'abc','click',function(_event){
     *               // 获取鼠标事件触发的垂直位置
     *               var _y = _v._$pageY(_event);
     *           }
     *       );
     *   });
     * ```
     *
     * @method module:base/event._$clientY
     * @see    module:base/event._$pageY
     * @param  {Event}  arg0 - 事件对象
     * @return {Number}        垂直位置
     */
    _p._$clientY = function(_event){
        return _getClientOffset(_event,'Y','Top');
    };
    
    // for chainable method
    _x._$merge(_y);
    
    if (CMPT){
        NEJ.copy(NEJ.P('nej.v'),_p);
    }

    return _p;
},215,4,2,217,218);
I$(23,function (NEJ,_k,_v,_u,_p,_o,_f,_r){
    var _pro;
    /**
     * 控件基类，主要实现以下功能：
     * * 对事件驱动编程模型的支持
     * * 对控件通用行为及业务逻辑的抽象
     * 
     * ```javascript
     *   NEJ.define([
     *       'base/klass',
     *       'util/event'
     *   ],function(_k,_t,_p,_o,_f,_r){
     *       // 自定义一个控件及使用、回收的流程
     *       var _pro;
     *   
     *       // 第一步
     *       // 定义控件类，从父类继承
     *       _p._$$Widget = _k._$klass();
     *       _pro = _p._$$Widget._$extend(_t._$$EventTarget);
     *   
     *       // 第二步
     *       // 重写控件初始化业务逻辑
     *       _pro.__init = function(_options){
     *           // _options - 配置参数信息
     *           //            初始化时一般不对该参数做处理
     *           // 调用父类初始化业务逻辑
     *           this.__super(_options);
     *           // TODO something
     *       };
     *   
     *       // 第三步
     *       // 重写控件重置业务逻辑
     *       _pro.__reset = function(_options){
     *           // _options - 配置参数信息
     *           //            此处重置控件配置信息
     *           // 调用父类重置业务逻辑
     *           this.__super(_options);
     *           // TODO something
     *       };
     *   
     *       // 第四步
     *       // 重写控件回收业务逻辑
     *       _pro.__destroy = function __destroy(){
     *           // 调用父类回收业务逻辑
     *           this.__super();
     *           // TODO something
     *       };
     *   
     *       // 第五步
     *       // 使用控件
     *       var _widget = _p._$$Widget._$allocate({
     *           a:'aaaaaaaaaaa',
     *           b:'bbbbbbbbbbbbb',
     *           c:'ccccccccccccccc'
     *       });
     *   
     *       // 第六步
     *       // 回收控件
     *       _widget = _widget._$recycle();
     *       // 也可以使用以下方式回收，建议使用上面的回收方式
     *       _widget = _p._$$Widget._$recycle(_widget);
     *   });
     * ```
     * 
     * @class module:util/event._$$EventTarget
     * @param {Object} config - 配置参数，根据控件实际情况提供配置参数支持
     */
    /** 
     * 控件回收前触发事件，控件在具体实现时如需触发回收前的事件
     * 
     * ```javascript
     *   // 重写控件回收业务逻辑触发onbeforerecycle事件
     *   _pro.__destroy = function(){
     *       this._$dispatchEvent('onbeforerecycle');
     *       // 调用父类回收业务逻辑
     *       this.__super();
     *       // TODO something
     *   };
     * 
     *   // 监测onbeforerecycle事件
     *   var _widget = _p._$$Widget._$allocate({
     *       onbeforerecycle:function(_event){
     *           // TODO something
     *       }
     *   });
     * ```
     * 
     * @event module:util/event._$$EventTarget#onbeforerecycle
     * @param {Object} event - 事件触发信息
     */
    /**
     * 控件回收后触发事件，控件在具体实现时如需触发回收后的事件
     * 
     * ```javascript
     *   // 重写控件回收业务逻辑触发onbeforerecycle事件
     *   _pro.__destroy = function(){
     *       // 调用父类回收业务逻辑
     *       this.__super();
     *       // TODO something
     *       this._$dispatchEvent('onaftercycle');
     *   };
     *   
     *   // 监测onaftercycle事件
     *   var _widget = _p._$$Widget._$allocate({
     *       onaftercycle:function(_event){
     *           // TODO something
     *       }
     *   });
     * ```
     * 
     * @event module:util/event._$$EventTarget#onaftercycle
     * @param {Object} event - 事件触发信息
     */
    _p._$$EventTarget = _k._$klass();
    _pro = _p._$$EventTarget.prototype;
    /**
     * 控件分配，NEJ框架提供的所有控件统一使用分配和回收机制，
     * 分配空间时会优先考虑使用前面回收的同种控件，只有在没有可用控件的情况下才会实例化新的控件
     * 
     * ```javascript
     *   // 分配一个控件
     *   var _widget = _p._$$Widget._$allocate({
     *       conf0:'aaaaaaa',
     *       conf1:'bbbbbbbbbbbbb',
     *       onxxx:function(){
     *           // TODO something
     *       }
     *   });
     * ```
     * 
     * @method module:util/event._$$EventTarget._$allocate
     * @see    module:util/event._$$EventTarget._$getInstance
     * @see    module:util/event._$$EventTarget._$getInstanceWithReset
     * @param  {Object}  arg0 - 配置参数，根据控件实际情况提供配置参数支持
     * @return {module:util/event._$$EventTarget} 控件实例
     */
    _p._$$EventTarget._$allocate = function(_options){
        _options = _options||{};
        var _instance = !!this.__pool
                        &&this.__pool.shift();
        if (!_instance){
            _instance = new this(_options);
            this.__inst__ = (this.__inst__||0)+1;
        }
        // reset instance, flag first
        _instance.__reset(_options);
        return _instance;
    };
    /**
     * 控件回收，NEJ框架提供的所有控件统一使用分配和回收机制，
     * 如果提供的实例非当前类的实例则自动调整为输入实例的类来回收此实例
     * 
     * ```javascript
     *   // 回收前面分配的实例有两种方式
     *   // 如果不能确定实例的构造类，则可以直接使用实例的回收接口
     *   _widget._$recycle();
     *   // 如果可以确定实例的构造类，则可以使用构造类的静态回收接口
     *   _p._$$Widget._$recycle(_widget);
     *   // 如果回收多个实例则使用构造类的静态回收接口
     *   _p._$$Widget._$recycle([_widget0,_widget1]);
     * ```
     * 
     * @method module:util/event._$$EventTarget._$recycle
     * @param  {module:util/event._$$EventTarget|module:util/event._$$EventTarget[]} arg0 - 待回收实例或者实例列表
     * @return {Void}
     */
    _p._$$EventTarget._$recycle = (function(){
        var _doRecycle = function(_item,_index,_list){
            _item._$recycle();
            _list.splice(_index,1);
        };
        return function(_instance){
            if (!_instance) return null;
            if (!_u._$isArray(_instance)){
                // instance is not instanceof class
                if (!(_instance instanceof this)){
                    // use constructor recycle instance
                    var _class = _instance.constructor;
                    if (!!_class._$recycle){
                        _class._$recycle(_instance);
                    }
                    return null;
                }
                // delete singleton instance
                if (_instance==this.__instance){
                    delete this.__instance;
                }
                if (_instance==this.__inctanse){
                    delete this.__inctanse;
                }
                // do recycle
                _instance.__destroy();
                // recycle instance
                if (!this.__pool){
                    this.__pool = [];
                } 
                if (_u._$indexOf(this.__pool,_instance)<0){
                    this.__pool.push(_instance);
                }
                return null;
            }
            // recycle instance array
            _u._$reverseEach(_instance,_doRecycle,this);
        };
    })();
    /**
     * 取控件实例（单例），如果控件指明了为单例模式，
     * 则项目中使用该控件时统一使用此接口获取控件实例，使用方式同_$allocate
     * 
     * ```javascript
     *   // 取控件单例，确保在第一次取单例时输入所有配置参数
     *   var _widget = _p._$$Widget._$getInstance({
     *       conf0:'aaaaaaa',
     *       conf1:'bbbbbbbbbbbbb',
     *       onxxx:function(){
     *           // TODO something
     *       }
     *   });
     *   
     *   // 后续取单例忽略配置参数
     *   var _widget1 = _p._$$Widget._$getInstance({
     *       conf0:'bbbbb'  // <-- 如果单例已生成，则这里的配置信息不会生效
     *   });
     * 
     *   // 等价于如下调用
     *   var _widget2 = _p._$$Widget._$getInstance();
     * ```
     * 
     * @method module:util/event._$$EventTarget._$getInstance
     * @see    module:util/event._$$EventTarget._$getInstanceWithReset
     * @see    module:util/event._$$EventTarget._$allocate
     * @param  {Object}  arg0 - 配置参数，根据控件实际情况提供配置参数支持
     * @return {module:util/event._$$EventTarget} 控件实例
     */
    _p._$$EventTarget._$getInstance = function(_options){
        if (!this.__instance){
            this.__instance = this._$allocate(_options);
        }
        return this.__instance;
    };
    /**
     * 取控件实例（单例），如果控件指明了为单例模式，
     * 则项目中使用该控件时统一使用此接口获取控件实例，使用方式同_$getInstance，
     * 该接口同_$getInstance接口的主要区别在于输入的配置参数是否在每次调用接口时都重置
     * 
     * ```javascript
     *   // 取控件单例，确保在第一次取单例时输入所有配置参数
     *   var _widget = _p._$$Widget._$getInstanceWithReset({
     *       conf0:'aaaaaaa',
     *       conf1:'bbbbbbbbbbbbb',
     *       onxxx:function(){
     *           // TODO something
     *       }
     *   });
     *   
     *   // 后续取单例使用新的配置参数
     *   var _widget1 = _p._$$Widget._$getInstanceWithReset({
     *       conf0:'bbbbb'  // <-- 如果单例已生成，则重置这里的配置信息
     *   });
     * ```
     * 
     * @method module:util/event._$$EventTarget._$getInstanceWithReset
     * @see    module:util/event._$$EventTarget._$getInstance
     * @see    module:util/event._$$EventTarget._$allocate
     * @param  {Object}  arg0 - 配置参数，根据控件实际情况提供配置参数支持
     * @param  {Boolean} arg1 - 是否需要先清理已有实例
     * @return {module:util/event._$$EventTarget} 控件实例
     */
    _p._$$EventTarget._$getInstanceWithReset = function(_options,_clear){
        // clear instance
        if (!!_clear&&!!this.__inctanse){
            this.__inctanse._$recycle();
            delete this.__inctanse;
        }
        // allocate instance
        if (!this.__inctanse){
            this.__inctanse = this._$allocate(_options);
        }else{
            this.__inctanse.__reset(_options);
        }
        return this.__inctanse;
    };
    /**
     * 控件初始化，
     * 子类可重写此接口业务逻辑，
     * 子类可通过调用__super接口调用父类的初始化业务逻辑
     * 
     * ```javascript
     *   // 子类控件初始化业务逻辑
     *   _pro.__init = function(){
     *       // 调用父类控件初始化
     *       this.__super();
     *       // TODO something
     *   };
     * ```
     * 
     * @protected
     * @method module:util/event._$$EventTarget#__init
     * @return {Void}
     */
    _pro.__init = function(){
        this.__events = {};
        this.__events_dom = {};
        this.id = _u._$uniqueID();
    };
    /**
     * 控件重置，此接口用来接收控件配置参数的处理，
     * 控件基类已处理以下业务逻辑：
     * 
     * * 缓存通过配置参数输入的回调事件
     * 
     * 子类重写此接口业务逻辑来处理具体控件对配置参数的处理，
     * 子类通过调用__super接口调用父类的重置业务逻辑
     * 
     * ```javascript
     *   // 子类控件重置业务逻辑
     *   _pro.__reset = function(_options){
     *       // 调用父类控件重置逻辑
     *       this.__super(_options);
     *       // TODO something
     *   };
     * ```
     * 
     * @protected
     * @method module:util/event._$$EventTarget#__reset
     * @param  {Object} arg0 - 配置参数，根据控件实际情况提供配置参数支持
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this._$batEvent(_options);
    };
    /**
     * 控件销毁，当控件在回收时会调用此接口，基类已处理以下业务逻辑：
     * 
     * * 通过配置参数输入的事件回调的清理
     * * 通过__doInitDomEvent接口添加的DOM事件的清理
     * 
     * 一般情况下控件还需回收通过重置接口__reset产生的数据，
     * 子类可重写此接口业务逻辑来触发onbeforerecycle和onafterrecycle事件，
     * 子类可通过调用__super接口调用父类的销毁业务逻辑
     * 
     * ```javascript
     *   // 子类重写控件销毁逻辑
     *   _pro.__destroy = function(){
     *       // 触发回收之前事件
     *       this._$dispatchEvent('onbeforerecycle');
     *       // 调用父类清理逻辑，如果有触发回收之后事件则以下业务逻辑需在触发回收之后事件后面调用
     *       //this.__super();
     *       // 清理本控件的数据
     *       delete this.__conf0;
     *       this.__widget2 = this.__widget2._$recycle();
     *       // 触发回收之后事件，确保在onafterrecycle事件被清理前触发
     *       this._$dispatchEvent('onafterrecycle');
     *       this.__super();
     *   };
     * ```
     * 
     * @protected
     * @method module:util/event._$$EventTarget#__destroy
     * @return {Void}
     */
    _pro.__destroy = function(){
        this._$clearEvent();
        this.__doClearDomEvent();
    };
    /**
     * 初始化事件，
     * 重置接口__reset中需要通过_$addEvent接口添加的事件，
     * 使用此接口添加可以在回收时自动被清理
     * 
     * ```javascript
     *   // 子类重置接口添加节点事件
     *   _pro.__reset = function(_options){
     *       this.__super(_options);
     *       // 添加DOM事件或者自定义事件
     *       this.__doInitDomEvent([
     *           [document,'click',this.__onDocClick._$bind(this)],
     *           [window,'ok',this.__onWindowOK._$bind(this)]
     *       ]);
     *   };
     * ```
     * 
     * @protected
     * @method module:util/event._$$EventTarget#__doInitDomEvent
     * @see    module:util/event._$$EventTarget#__doClearDomEvent
     * @param  {Array} arg0 - 待添加的事件配置列表 
     * @return {Void}
     */
    _pro.__doInitDomEvent = (function(){
        var _doAttach = function(_args){
            if (!_args||_args.length<3) return;
            this.__events_dom['de-'+_u._$uniqueID()] = _args;
            _v._$addEvent.apply(_v,_args);
        };
        return function(_list){
            _u._$forEach(_list,_doAttach,this);
        };
    })();
    /**
     * 清除DOM事件，_$recycle接口会自动调用来清理这种DOM事件
     * 
     * ```javascript
     *   // 子类重置接口清理节点事件
     *   _pro.__destroy = function(_options){
     *       this.__doClearDomEvent();
     *       this.__super(_options);
     *   };
     * ```
     * 
     * @protected
     * @method module:util/event._$$EventTarget#__doClearDomEvent
     * @see    module:util/event._$$EventTarget#__doInitDomEvent
     * @return {Void}
     */
    _pro.__doClearDomEvent = (function(){
        var _doRemoveEvent = function(_args,_key,_map){
            delete _map[_key];
            _v._$delEvent.apply(_v,_args);
        };
        return function(){
            _u._$loop(this.__events_dom,_doRemoveEvent);
        };
    })();
    /**
     * 清理所有组合的控件
     * 
     * ```javascript
     *   // 子类重置接口清理组件
     *   _pro.__destroy = function(_options){
     *       this.__doClearComponent(function(_inst){
     *           // 不回收_p._$$Widget2控件实例
     *           return _inst instanceof _p._$$Widget2;
     *       });
     *       this.__super(_options);
     *   };
     * ```
     * 
     * @protected
     * @method module:util/event._$$EventTarget#__doClearComponent
     * @param  {Function} arg0 - 过滤接口，返回true表示不清理该控件
     * @return {Void}
     */
    _pro.__doClearComponent = function(_filter){
        _filter = _filter||_f;
        _u._$loop(this,function(_inst,_key,_map){
            if (!!_inst&&!!_inst._$recycle&&!_filter(_inst)){
                delete _map[_key];
                _inst._$recycle();
            }
        });
    };
    /**
     * 回收控件，通过实例的构造类来回收当前实例
     * 
     * ```javascript
     *   // 通过实例的接口回收当前实例
     *   _widget._$recycle();
     * ```
     * 
     * @method module:util/event._$$EventTarget#_$recycle
     * @see    module:util/event._$$EventTarget#_$allocate
     * @return {Void}
     */
    _pro._$recycle = function(){
        this.constructor._$recycle(this);
    };
    /**
     * 判断是否有注册事件回调
     * 
     * ```javascript
     *   // 分配实例
     *   var _widget = _p._$$Widget._$allocate({
     *       onok:function(){
     *           // TODO
     *       }
     *   });
     *   // 判断控件实例是否注册有onok事件回调
     *   _widget._$hasEvent('onok');
     * ```
     * 
     * @method module:util/event._$$EventTarget#_$hasEvent
     * @param  {String} arg0 - 事件类型
     * @return {Boolean}       是否注册了事件回调
     */
    _pro._$hasEvent = function(_type){
        var _type = (_type||'').toLowerCase(),
            _event = this.__events[_type];
        return !!_event&&_event!==_f;
    };
    /**
     * 删除单个事件回调
     * 
     * ```javascript
     *   var _handler = function(){
     *       // TODO
     *   };
     *   // 分配实例
     *   var _widget = _p._$$Widget._$allocate({
     *       onok:_handler
     *   });
     *   // 删除onok事件回调
     *   _widget._$delEvent('onok',_handler);
     * ```
     * 
     * @method module:util/event._$$EventTarget#_$delEvent
     * @param  {String}   arg0 - 事件类型
     * @param  {Function} arg1 - 事件处理函数
     * @return {Void}
     */
    _pro._$delEvent = function(_type,_event){
        var _type = (_type||'').toLowerCase(),
            _events = this.__events[_type];
        if (!_u._$isArray(_events)){
            if (_events==_event){
                delete this.__events[_type];
            }
            return;
        }
        // batch remove
        _u._$reverseEach(
            _events,function(_func,_index,_list){
                if (_func==_event){
                    _list.splice(_index,1);
                }
            }
        );
        if (!_events.length){
            delete this.__events[_type];
        }
    };
    /**
     * 重置事件，覆盖原有事件
     * 
     * ```javascript
     *   // 分配实例
     *   var _widget = _p._$$Widget._$allocate();
     *   // 设置控件事件回调
     *   _widget._$setEvent('onok',function(){
     *       // TODO something
     *   });
     *   _widget._$setEvent('oncancel',function(){
     *       // TODO something
     *   });
     * ```
     * 
     * @method module:util/event._$$EventTarget#_$setEvent
     * @param  {String}   arg0 - 事件类型，大小写不敏感
     * @param  {Function} arg1 - 事件处理函数
     * @return {Void}
     */
    _pro._$setEvent = function(_type,_event){
        if (!!_type&&_u._$isFunction(_event)){
            this.__events[_type.toLowerCase()] = _event;
        }
    };
    /**
     * 批量添加事件
     * 
     * ```javascript
     *   // 分配实例
     *   var _widget = _p._$$Widget._$allocate();
     *   // 批量设置控件事件回调
     *   _widget._$batEvent({
     *       onok:function(){
     *           // TODO something
     *       },
     *       oncancel:function(){
     *           // TODO something
     *       }
     *   });
     * ```
     * 
     * @method module:util/event._$$EventTarget#_$batEvent
     * @see    module:util/event._$$EventTarget#_$setEvent
     * @param  {Object} arg0 - 事件集合,{type:function}
     * @return {Void}
     */
    _pro._$batEvent = (function(){
        var _doSetEvent = function(_event,_type){
            this._$setEvent(_type,_event);
        };
        return function(_events){
            _u._$loop(_events,_doSetEvent,this);
        };
    })();
    /**
     * 清除事件，没有指定类型则清除所有事件
     * 
     * ```javascript
     *   // 分配实例
     *   var _widget = _p._$$Widget._$allocate({
     *       onok:function(){
     *           // TODO something
     *       }
     *   });
     *   // 清除onok事件回调
     *   _widget._$clearEvent('onok');
     *   // 清除所有时间回调
     *   _widget._$clearEvent();
     * ```
     * 
     * @method module:util/event._$$EventTarget#_$clearEvent
     * @param  {String} arg0 - 事件类型
     * @return {Void}
     */
    _pro._$clearEvent = (function(){
        var _doClearEvent = function(_event,_type){
            this._$clearEvent(_type);
        };
        return function(_type){
            var _type = (_type||'').toLowerCase();
            if (!!_type){
                delete this.__events[_type];
            }else{
                _u._$loop(this.__events,_doClearEvent,this);
            }
        };
    })();
    /**
     * 追加事件，通过此接口可以对同一个事件添加多个回调函数
     * 
     * ```javascript
     *   // 分配实例
     *   var _widget = _p._$$Widget._$allocate({
     *       onok:function(){
     *           // TODO something
     *       }
     *   });
     *   // 追加事件回调
     *   _widget._$addEvent({
     *       onok:function(){
     *           // TODO something
     *       }
     *   });
     * ```
     * 
     * @method module:util/event._$$EventTarget#_$addEvent
     * @param  {String}   arg0 - 事件类型
     * @param  {Function} arg1 - 事件处理函数
     * @return {Void}
     */
    _pro._$addEvent = function(_type,_event){
        // check type and event
        if (!_type||!_u._$isFunction(_event)){
            return;
        }
        // cache event
        _type = _type.toLowerCase();
        var _events = this.__events[_type];
        if (!_events){
            this.__events[_type] = _event;
            return;
        }
        if (!_u._$isArray(_events)){
            this.__events[_type] = [_events];
        }
        this.__events[_type].push(_event);
    };
    /**
     * 调用事件，一般在控件实现的具体业务逻辑中使用
     * 
     * ```javascript
     *   // 分配实例
     *   var _widget = _p._$$Widget._$allocate({
     *       onok:function(){
     *           // TODO something
     *       }
     *   });
     *   // 触发控件onok事件
     *   _widget._$dispatchEvent('onok');
     *   
     *   // 在控件实现的业务逻辑中使用
     *   _pro.__doSomething = function(){
     *       // TODO something
     *       // 触发onok事件
     *       this._$dispatchEvent('onok');
     *   };
     * ```
     * 
     * @method module:util/event._$$EventTarget#_$dispatchEvent
     * @param  {String}   arg0 - 事件类型，不区分大小写
     * @param  {Variable} arg1 - 事件可接受参数，具体看调用时的业务逻辑
     * @return {Void}
     */
    _pro._$dispatchEvent = function(_type){
        var _type = (_type||'').toLowerCase(),
            _event = this.__events[_type];
        if (!_event) return;
        var _args = _r.slice.call(arguments,1);
        // single event
        if (!_u._$isArray(_event)){
            _event.apply(this,_args);
            return;
        }
        // event list
        _u._$forEach(
            _event,function(_handler){
                if (DEBUG){
                    _handler.apply(this,_args);
                }else{
                    try{
                        _handler.apply(this,_args);
                    }catch(ex){
                        // ignore
                        console.error(ex.message);
                        console.error(ex.stack);
                    }
                }
            },this
        );
    };
    
    if (CMPT){
        _p._$$Event = _p._$$EventTarget;
        NEJ.copy(NEJ.P('nej.ut'),_p);
    }
    
    return _p;
},215,1,3,2);
I$(11,function (NEJ,_u,_p,_o,_f,_r){
    /**
     * 设置或者获取cookie
     *
     * * 没有输入第二个参数则表示返回已有cookie
     * * 如果cookie值为空字符串则表示删除cookie
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'util/cookie'
     *   ],function(_j){
     *       // 设置cookie的name=abc
     *       var _cookie = _j._$cookie('name','abc');
     *       _j._$cookie('name',{value:'abc'});
     *
     *       // 设置路径，domain(如果domain不同域，cookie设置不会成功),设置过期时间1天;
     *       var _cookie = _j._$cookie('name',{
     *           value:'abc',
     *           path:'/a/',
     *           domain:'www.163.com',
     *           expires:1
     *       });
     *
     *       // 删除cookie
     *       _j._$cookie('name','');
     *       _j._$cookie('name',{expires:-1});
     *   });
     * ```
     *
     * @method   module:util/cache/cookie._$cookie
     * @param    {String}        arg0    - cookie名称
     * @param    {String|Object} arg1    - cookie值，如果有其他配置信息输入对象，已处理属性包括
     * @property {String}        value   - cookie值
     * @property {String}        path    - 路径
     * @property {String}        domain  - 域名，当前域或者当前域的父域
     * @property {Number}        expires - 过期时间偏移，单位天，负值表示删除cookie
     * @return   {String}                  cookie值
     */
    _p._$cookie = (function(){
        var _date = new Date(),
            _crut = +_date,   // current time milliseconds
            _days = 86400000; // milliseconds of one day
        var _getcookie = function(_name){
            var _cookie = document.cookie,
                _search = '\\b'+_name+'=',
                _index1 = _cookie.search(_search);
            if (_index1<0) return '';
            _index1 += _search.length-2;
            var _index2 = _cookie.indexOf(';',_index1);
            if (_index2<0) _index2 = _cookie.length;
            return _cookie.substring(_index1,_index2)||'';
        };
        return function(_name,_data){
            if (_data===undefined){
                return _getcookie(_name);
            }
            if (_u._$isString(_data)){
                if (!!_data){
                    document.cookie = _name+'='+_data+';';
                    return _data;
                }
                _data = {expires:-100};
            }
            _data = _data||_o;
            var _cookie = _name+'='+(_data.value||'')+';';
            delete _data.value;
            if (_data.expires!==undefined){
                _date.setTime(_crut+_data.expires*_days);
                _data.expires = _date.toGMTString();
            }
            _cookie += _u._$object2string(_data,';');
            //console.log(_cookie);
            document.cookie = _cookie;
        };
    })();

    if (CMPT){
        NEJ.copy(NEJ.P('nej.j'),_p);
    }

    return _p;
},215,2);
/**
@author	leeluolee
@version	0.3.1
@homepage	http://regularjs.github.io
*/
;(function(){
'use strict';

/**
 * Require the given path.
 *
 * @param {String} path
 * @return {Object} exports
 * @api public
 */

function require(path, parent, orig) {
  var resolved = require.resolve(path);

  // lookup failed
  if (null == resolved) {
    throwError()
    return
  }

  var module = require.modules[resolved];

  // perform real require()
  // by invoking the module's
  // registered function
  if (!module._resolving && !module.exports) {
    var mod = {};
    mod.exports = {};
    mod.client = mod.component = true;
    module._resolving = true;
    module.call(this, mod.exports, require.relative(resolved), mod);
    delete module._resolving;
    module.exports = mod.exports;
  }

  function throwError () {
    orig = orig || path;
    parent = parent || 'root';
    var err = new Error('Failed to require "' + orig + '" from "' + parent + '"');
    err.path = orig;
    err.parent = parent;
    err.require = true;
    throw err;
  }

  return module.exports;
}

/**
 * Registered modules.
 */

require.modules = {};

/**
 * Registered aliases.
 */

require.aliases = {};

/**
 * Resolve `path`.
 *
 * Lookup:
 *
 *   - PATH/index.js
 *   - PATH.js
 *   - PATH
 *
 * @param {String} path
 * @return {String} path or null
 * @api private
 */

require.exts = [
    '',
    '.js',
    '.json',
    '/index.js',
    '/index.json'
 ];

require.resolve = function(path) {
  if (path.charAt(0) === '/') path = path.slice(1);

  for (var i = 0; i < 5; i++) {
    var fullPath = path + require.exts[i];
    if (require.modules.hasOwnProperty(fullPath)) return fullPath;
    if (require.aliases.hasOwnProperty(fullPath)) return require.aliases[fullPath];
  }
};

/**
 * Normalize `path` relative to the current path.
 *
 * @param {String} curr
 * @param {String} path
 * @return {String}
 * @api private
 */

require.normalize = function(curr, path) {

  var segs = [];

  if ('.' != path.charAt(0)) return path;

  curr = curr.split('/');
  path = path.split('/');

  for (var i = 0; i < path.length; ++i) {
    if ('..' === path[i]) {
      curr.pop();
    } else if ('.' != path[i] && '' != path[i]) {
      segs.push(path[i]);
    }
  }
  return curr.concat(segs).join('/');
};

/**
 * Register module at `path` with callback `definition`.
 *
 * @param {String} path
 * @param {Function} definition
 * @api private
 */

require.register = function(path, definition) {
  require.modules[path] = definition;
};

/**
 * Alias a module definition.
 *
 * @param {String} from
 * @param {String} to
 * @api private
 */

require.alias = function(from, to) {
  if (!require.modules.hasOwnProperty(from)) {
    throwError()
    return
  }
  require.aliases[to] = from;

  function throwError () {
    throw new Error('Failed to alias "' + from + '", it does not exist');
  }
};

/**
 * Return a require function relative to the `parent` path.
 *
 * @param {String} parent
 * @return {Function}
 * @api private
 */

require.relative = function(parent) {
  var p = require.normalize(parent, '..');

  /**
   * The relative require() itself.
   */

  function localRequire(path) {
    var resolved = localRequire.resolve(path);
    return require(resolved, parent, path);
  }

  /**
   * Resolve relative to the parent.
   */

  localRequire.resolve = function(path) {
    var c = path.charAt(0);
    if ('/' === c) return path.slice(1);
    if ('.' === c) return require.normalize(p, path);

    // resolve deps by returning
    // the dep in the nearest "deps"
    // directory
    var segs = parent.split('/');
    var i = segs.length;
    while (i--) {
      if (segs[i] === 'deps') {
        break;
      }
    }
    path = segs.slice(0, i + 2).join('/') + '/deps/' + path;
    return path;
  };

  /**
   * Check if module is defined at `path`.
   */

  localRequire.exists = function(path) {
    return require.modules.hasOwnProperty(localRequire.resolve(path));
  };

  return localRequire;
};
require.register("regularjs/src/Regular.js", function(exports, require, module){

var env = require('./env.js');
var Lexer = require("./parser/Lexer.js");
var Parser = require("./parser/Parser.js");
var config = require("./config.js");
var _ = require('./util');
var extend = require('./helper/extend.js');
if(env.browser){
var combine = require('./helper/combine.js');
var dom = require("./dom.js");
var walkers = require('./walkers.js');
var Group = require('./group.js');
}
var events = require('./helper/event.js');
var Watcher = require('./helper/watcher.js');
var parse = require('./helper/parse.js');
var filter = require('./helper/filter.js');
var doc = typeof document==='undefined'? {} : document;


/**
* `Regular` is regularjs's NameSpace and BaseClass. Every Component is inherited from it
* 
* @class Regular
* @module Regular
* @constructor
* @param {Object} options specification of the component
*/
var Regular = function(options){
  var prevRunning = env.isRunning;
  env.isRunning = true;
  var node, template;

  options = options || {};
  options.data = options.data || {};
  options.computed = options.computed || {};
  options.events = options.events || {};
  if(this.data) _.extend(options.data, this.data);
  if(this.computed) _.extend(options.computed, this.computed);
  if(this.events) _.extend(options.events, this.events);

  _.extend(this, options, true);
  if(this.$parent){
     this.$parent._append(this);
  }
  this._children = [];
  this.$refs = {};

  template = this.template;

  // template is a string (len < 16). we will find it container first
  if((typeof template === 'string' && template.length < 16) && (node = dom.find(template))) {
    template = node.innerHTML;
  }
  // if template is a xml
  if(template && template.nodeType) template = template.innerHTML;
  if(typeof template === 'string') this.template = new Parser(template).parse();

  this.computed = handleComputed(this.computed);
  this.$root = this.$root || this;
  // if have events
  if(this.events){
    this.$on(this.events);
  }
  if(this.$body){
    this._getTransclude = function(){
      var ctx = this.$parent || this;
      if(this.$body) return ctx.$compile(this.$body, {namespace: options.namespace, outer: this, extra: options.extra})
    }
  }
  this.$emit("$config");
  this.config && this.config(this.data);
  // handle computed
  if(template){
    this.group = this.$compile(this.template, {namespace: options.namespace});
    combine.node(this);
  }


  if(!this.$parent) this.$update();
  this.$ready = true;
  this.$emit("$init");
  if( this.init ) this.init(this.data);

  // @TODO: remove, maybe , there is no need to update after init; 
  // if(this.$root === this) this.$update();
  env.isRunning = prevRunning;

  // children is not required;
}


walkers && (walkers.Regular = Regular);


// description
// -------------------------
// 1. Regular and derived Class use same filter
_.extend(Regular, {
  // private data stuff
  _directives: { __regexp__:[] },
  _plugins: {},
  _protoInheritCache: [ 'directive', 'use'] ,
  __after__: function(supr, o) {

    var template;
    this.__after__ = supr.__after__;

    // use name make the component global.
    if(o.name) Regular.component(o.name, this);
    // this.prototype.template = dom.initTemplate(o)
    if(template = o.template){
      var node, name;
      if( typeof template === 'string' && template.length < 16 && ( node = dom.find( template )) ){
        template = node.innerHTML;
        if(name = dom.attr(node, 'name')) Regular.component(name, this);
      }

      if(template.nodeType) template = template.innerHTML;

      if(typeof template === 'string'){
        this.prototype.template = new Parser(template).parse();
      }
    }

    if(o.computed) this.prototype.computed = handleComputed(o.computed);
    // inherit directive and other config from supr
    Regular._inheritConfig(this, supr);

  },
  /**
   * Define a directive
   *
   * @method directive
   * @return {Object} Copy of ...
   */  
  directive: function(name, cfg){

    if(_.typeOf(name) === "object"){
      for(var k in name){
        if(name.hasOwnProperty(k)) this.directive(k, name[k]);
      }
      return this;
    }
    var type = _.typeOf(name);
    var directives = this._directives, directive;
    if(cfg == null){
      if( type === "string" && (directive = directives[name]) ) return directive;
      else{
        var regexp = directives.__regexp__;
        for(var i = 0, len = regexp.length; i < len ; i++){
          directive = regexp[i];
          var test = directive.regexp.test(name);
          if(test) return directive;
        }
      }
      return undefined;
    }
    if(typeof cfg === 'function') cfg = { link: cfg } 
    if(type === 'string') directives[name] = cfg;
    else if(type === 'regexp'){
      cfg.regexp = name;
      directives.__regexp__.push(cfg)
    }
    return this
  },
  plugin: function(name, fn){
    var plugins = this._plugins;
    if(fn == null) return plugins[name];
    plugins[name] = fn;
    return this;
  },
  use: function(fn){
    if(typeof fn === "string") fn = Regular.plugin(fn);
    if(typeof fn !== "function") return this;
    fn(this, Regular);
    return this;
  },
  // config the Regularjs's global
  config: function(name, value){
    var needGenLexer = false;
    if(typeof name === "object"){
      for(var i in name){
        // if you config
        if( i ==="END" || i==='BEGIN' )  needGenLexer = true;
        config[i] = name[i];
      }
    }
    if(needGenLexer) Lexer.setup();
  },
  expression: parse.expression,
  Parser: Parser,
  Lexer: Lexer,
  _addProtoInheritCache: function(name, transform){
    if( Array.isArray( name ) ){
      return name.forEach(Regular._addProtoInheritCache);
    }
    var cacheKey = "_" + name + "s"
    Regular._protoInheritCache.push(name)
    Regular[cacheKey] = {};
    if(Regular[name]) return;
    Regular[name] = function(key, cfg){
      var cache = this[cacheKey];

      if(typeof key === "object"){
        for(var i in key){
          if(key.hasOwnProperty(i)) this[name](i, key[i]);
        }
        return this;
      }
      if(cfg == null) return cache[key];
      cache[key] = transform? transform(cfg) : cfg;
      return this;
    }
  },
  _inheritConfig: function(self, supr){

    // prototype inherit some Regular property
    // so every Component will have own container to serve directive, filter etc..
    var defs = Regular._protoInheritCache;
    var keys = _.slice(defs);
    keys.forEach(function(key){
      self[key] = supr[key];
      var cacheKey = '_' + key + 's';
      if(supr[cacheKey]) self[cacheKey] = _.createObject(supr[cacheKey]);
    })
    return self;
  }

});

extend(Regular);

Regular._addProtoInheritCache("component")

Regular._addProtoInheritCache("filter", function(cfg){
  return typeof cfg === "function"? {get: cfg}: cfg;
})


events.mixTo(Regular);
Watcher.mixTo(Regular);

Regular.implement({
  init: function(){},
  config: function(){},
  destroy: function(){
    // destroy event wont propgation;
    this.$emit("$destroy");
    this.group && this.group.destroy(true);
    this.group = null;
    this.parentNode = null;
    this._watchers = null;
    this._children = [];
    var parent = this.$parent;
    if(parent){
      var index = parent._children.indexOf(this);
      parent._children.splice(index,1);
    }
    this.$parent = null;
    this.$root = null;
    this._handles = null;
    this.$refs = null;
  },

  /**
   * compile a block ast ; return a group;
   * @param  {Array} parsed ast
   * @param  {[type]} record
   * @return {[type]}
   */
  $compile: function(ast, options){
    options = options || {};
    if(typeof ast === 'string'){
      ast = new Parser(ast).parse()
    }
    var preExt = this.__ext__,
      record = options.record, 
      records;

    if(options.extra) this.__ext__ = options.extra;

    if(record) this._record();
    var group = this._walk(ast, options);
    if(record){
      records = this._release();
      var self = this;
      if(records.length){
        // auto destroy all wather;
        group.ondestroy = function(){ self.$unwatch(records); }
      }
    }
    if(options.extra) this.__ext__ = preExt;
    return group;
  },


  /**
   * create two-way binding with another component;
   * *warn*: 
   *   expr1 and expr2 must can operate set&get, for example: the 'a.b' or 'a[b + 1]' is set-able, but 'a.b + 1' is not, 
   *   beacuse Regular dont know how to inverse set through the expression;
   *   
   *   if before $bind, two component's state is not sync, the component(passed param) will sync with the called component;
   *
   * *example: *
   *
   * ```javascript
   * // in this example, we need to link two pager component
   * var pager = new Pager({}) // pager compoennt
   * var pager2 = new Pager({}) // another pager component
   * pager.$bind(pager2, 'current'); // two way bind throw two component
   * pager.$bind(pager2, 'total');   // 
   * // or just
   * pager.$bind(pager2, {"current": "current", "total": "total"}) 
   * ```
   * 
   * @param  {Regular} component the
   * @param  {String|Expression} expr1     required, self expr1 to operate binding
   * @param  {String|Expression} expr2     optional, other component's expr to bind with, if not passed, the expr2 will use the expr1;
   * @return          this;
   */
  $bind: function(component, expr1, expr2){
    var type = _.typeOf(expr1);
    if( expr1.type === 'expression' || type === 'string' ){
      this._bind(component, expr1, expr2)
    }else if( type === "array" ){ // multiply same path binding through array
      for(var i = 0, len = expr1.length; i < len; i++){
        this._bind(component, expr1[i]);
      }
    }else if(type === "object"){
      for(var i in expr1) if(expr1.hasOwnProperty(i)){
        this._bind(component, i, expr1[i]);
      }
    }
    // digest
    component.$update();
    return this;
  },
  /**
   * unbind one component( see $bind also)
   *
   * unbind will unbind all relation between two component
   * 
   * @param  {Regular} component [description]
   * @return {This}    this
   */
  $unbind: function(){
    // todo
  },
  $inject: function(node, position, options){
    var fragment = combine.node(this);

    if(node === false) {
      if(!this._fragContainer)  this._fragContainer = dom.fragment();
      return this.$inject(this._fragContainer);
    }
    if(typeof node === 'string') node = dom.find(node);
    if(!node) throw 'injected node is not found';
    if(!fragment) return this;
    dom.inject(fragment, node, position);
    this.$emit("$inject", node);
    this.parentNode = Array.isArray(fragment)? fragment[0].parentNode: fragment.parentNode;
    return this;
  },
  $mute: function(isMute){

    isMute = !!isMute;

    var needupdate = isMute === false && this._mute;

    this._mute = !!isMute;

    if(needupdate) this.$update();
    return this;
  },
  // private bind logic
  _bind: function(component, expr1, expr2){

    var self = this;
    // basic binding

    if(!component || !(component instanceof Regular)) throw "$bind() should pass Regular component as first argument";
    if(!expr1) throw "$bind() should  pass as least one expression to bind";

    if(!expr2) expr2 = expr1;

    expr1 = parse.expression( expr1 );
    expr2 = parse.expression( expr2 );

    // set is need to operate setting ;
    if(expr2.set){
      var wid1 = this.$watch( expr1, function(value){
        component.$update(expr2, value)
      });
      component.$on('$destroy', function(){
        self.$unwatch(wid1)
      })
    }
    if(expr1.set){
      var wid2 = component.$watch(expr2, function(value){
        self.$update(expr1, value)
      });
      // when brother destroy, we unlink this watcher
      this.$on('$destroy', component.$unwatch.bind(component,wid2))
    }
    // sync the component's state to called's state
    expr2.set(component, expr1.get(this));
  },
  _walk: function(ast, arg1){
    if( _.typeOf(ast) === 'array' ){
      var res = [];

      for(var i = 0, len = ast.length; i < len; i++){
        res.push( this._walk(ast[i], arg1) );
      }

      return new Group(res);
    }
    if(typeof ast === 'string') return doc.createTextNode(ast)
    return walkers[ast.type || "default"].call(this, ast, arg1);
  },
  _append: function(component){
    this._children.push(component);
    component.$parent = this;
  },
  _handleEvent: function(elem, type, value, attrs){
    var Component = this.constructor,
      fire = typeof value !== "function"? _.handleEvent.call( this, value, type ) : value,
      handler = Component.event(type), destroy;

    if ( handler ) {
      destroy = handler.call(this, elem, fire, attrs);
    } else {
      dom.on(elem, type, fire);
    }
    return handler ? destroy : function() {
      dom.off(elem, type, fire);
    }
  },
  // 1. 用来处理exprBody -> Function
  // 2. list里的循环
  _touchExpr: function(expr){
    var  rawget, ext = this.__ext__, touched = {};
    if(expr.type !== 'expression' || expr.touched) return expr;
    rawget = expr.get || (expr.get = new Function(_.ctxName, _.extName , _.prefix+ "return (" + expr.body + ")"));
    touched.get = !ext? rawget: function(context){
      return rawget(context, ext)
    }

    if(expr.setbody && !expr.set){
      var setbody = expr.setbody;
      expr.set = function(ctx, value, ext){
        expr.set = new Function(_.ctxName, _.setName , _.extName, _.prefix + setbody);          
        return expr.set(ctx, value, ext);
      }
      expr.setbody = null;
    }
    if(expr.set){
      touched.set = !ext? expr.set : function(ctx, value){
        return expr.set(ctx, value, ext);
      }
    }
    _.extend(touched, {
      type: 'expression',
      touched: true,
      once: expr.once || expr.constant
    })
    return touched
  },
  // find filter
  _f_: function(name){
    var Component = this.constructor;
    var filter = Component.filter(name);
    if(!filter) throw 'filter ' + name + ' is undefined';
    return filter;
  },
  // simple accessor get
  _sg_:function(path, defaults, ext){
    if(typeof ext !== 'undefined'){
      // if(path === "demos")  debugger
      var computed = this.computed,
        computedProperty = computed[path];
      if(computedProperty){
        if(computedProperty.type==='expression' && !computedProperty.get) this._touchExpr(computedProperty);
        if(computedProperty.get)  return computedProperty.get(this);
        else _.log("the computed '" + path + "' don't define the get function,  get data."+path + " altnately", "error")
      }
  }
    if(typeof defaults === "undefined" || typeof path == "undefined" ) return undefined;
    return (ext && typeof ext[path] !== 'undefined')? ext[path]: defaults[path];

  },
  // simple accessor set
  _ss_:function(path, value, data , op, computed){
    var computed = this.computed,
      op = op || "=", prev, 
      computedProperty = computed? computed[path]:null;

    if(op !== '='){
      prev = computedProperty? computedProperty.get(this): data[path];
      switch(op){
        case "+=":
          value = prev + value;
          break;
        case "-=":
          value = prev - value;
          break;
        case "*=":
          value = prev * value;
          break;
        case "/=":
          value = prev / value;
          break;
        case "%=":
          value = prev % value;
          break;
      }
    }
    if(computedProperty) {
      if(computedProperty.set) return computedProperty.set(this, value);
      else _.log("the computed '" + path + "' don't define the set function,  assign data."+path + " altnately", "error" )
    }
    data[path] = value;
    return value;
  }
});

Regular.prototype.inject = function(){
  _.log("use $inject instead of inject", "error");
  return this.$inject.apply(this, arguments);
}


// only one builtin filter

Regular.filter(filter);

module.exports = Regular;



var handleComputed = (function(){
  // wrap the computed getter;
  function wrapGet(get){
    return function(context){
      return get.call(context, context.data );
    }
  }
  // wrap the computed setter;
  function wrapSet(set){
    return function(context, value){
      set.call( context, value, context.data );
      return value;
    }
  }

  return function(computed){
    if(!computed) return;
    var parsedComputed = {}, handle, pair, type;
    for(var i in computed){
      handle = computed[i]
      type = typeof handle;

      if(handle.type === 'expression'){
        parsedComputed[i] = handle;
        continue;
      }
      if( type === "string" ){
        parsedComputed[i] = parse.expression(handle)
      }else{
        pair = parsedComputed[i] = {type: 'expression'};
        if(type === "function" ){
          pair.get = wrapGet(handle);
        }else{
          if(handle.get) pair.get = wrapGet(handle.get);
          if(handle.set) pair.set = wrapSet(handle.set);
        }
      } 
    }
    return parsedComputed;
  }
})();

});
require.register("regularjs/src/util.js", function(exports, require, module){
require('./helper/shim.js');
var _  = module.exports;
var entities = require('./helper/entities.js');
var slice = [].slice;
var o2str = ({}).toString;
var win = typeof window !=='undefined'? window: global;


_.noop = function(){};
_.uid = (function(){
  var _uid=0;
  return function(){
    return _uid++;
  }
})();

_.varName = 'd';
_.setName = 'p_';
_.ctxName = 'c';
_.extName = 'e';

_.rWord = /^[\$\w]+$/;
_.rSimpleAccessor = /^[\$\w]+(\.[\$\w]+)*$/;

_.nextTick = typeof setImmediate === 'function'? 
  setImmediate.bind(win) : 
  function(callback) {
    setTimeout(callback, 0) 
  }



_.prefix = "var " + _.varName + "=" + _.ctxName + ".data;" +  _.extName  + "=" + _.extName + "||'';";


_.slice = function(obj, start, end){
  var res = [];
  for(var i = start || 0, len = end || obj.length; i < len; i++){
    var item = obj[i];
    res.push(item)
  }
  return res;
}

_.typeOf = function (o) {
  return o == null ? String(o) : o2str.call(o).slice(8, -1).toLowerCase();
}


_.extend = function( o1, o2, override ){
  if(_.typeOf(override) === 'array'){
   for(var i = 0, len = override.length; i < len; i++ ){
    var key = override[i];
    o1[key] = o2[key];
   } 
  }else{
    for(var i in o2){
      if( typeof o1[i] === "undefined" || override === true ){
        o1[i] = o2[i]
      }
    }
  }
  return o1;
}

_.makePredicate = function makePredicate(words, prefix) {
    if (typeof words === "string") {
        words = words.split(" ");
    }
    var f = "",
    cats = [];
    out: for (var i = 0; i < words.length; ++i) {
        for (var j = 0; j < cats.length; ++j){
          if (cats[j][0].length === words[i].length) {
              cats[j].push(words[i]);
              continue out;
          }
        }
        cats.push([words[i]]);
    }
    function compareTo(arr) {
        if (arr.length === 1) return f += "return str === '" + arr[0] + "';";
        f += "switch(str){";
        for (var i = 0; i < arr.length; ++i){
           f += "case '" + arr[i] + "':";
        }
        f += "return true}return false;";
    }

    // When there are more than three length categories, an outer
    // switch first dispatches on the lengths, to save on comparisons.
    if (cats.length > 3) {
        cats.sort(function(a, b) {
            return b.length - a.length;
        });
        f += "switch(str.length){";
        for (var i = 0; i < cats.length; ++i) {
            var cat = cats[i];
            f += "case " + cat[0].length + ":";
            compareTo(cat);
        }
        f += "}";

        // Otherwise, simply generate a flat `switch` statement.
    } else {
        compareTo(words);
    }
    return new Function("str", f);
}


_.trackErrorPos = (function (){
  // linebreak
  var lb = /\r\n|[\n\r\u2028\u2029]/g;
  function findLine(lines, pos){
    var tmpLen = 0;
    for(var i = 0,len = lines.length; i < len; i++){
      var lineLen = (lines[i] || "").length;
      if(tmpLen + lineLen > pos) return {num: i, line: lines[i], start: pos - tmpLen};
      // 1 is for the linebreak
      tmpLen = tmpLen + lineLen + 1;
    }
    
  }
  return function(input, pos){
    if(pos > input.length-1) pos = input.length-1;
    lb.lastIndex = 0;
    var lines = input.split(lb);
    var line = findLine(lines,pos);
    var len = line.line.length;

    var min = line.start - 10;
    if(min < 0) min = 0;

    var max = line.start + 10;
    if(max > len) max = len;

    var remain = line.line.slice(min, max);
    var prefix = (line.num+1) + "> " + (min > 0? "..." : "")
    var postfix = max < len ? "...": "";

    return prefix + remain + postfix + "\n" + new Array(line.start + prefix.length + 1).join(" ") + "^";
  }
})();


var ignoredRef = /\((\?\!|\?\:|\?\=)/g;
_.findSubCapture = function (regStr) {
  var left = 0,
    right = 0,
    len = regStr.length,
    ignored = regStr.match(ignoredRef); // ignored uncapture
  if(ignored) ignored = ignored.length
  else ignored = 0;
  for (; len--;) {
    var letter = regStr.charAt(len);
    if (len === 0 || regStr.charAt(len - 1) !== "\\" ) { 
      if (letter === "(") left++;
      if (letter === ")") right++;
    }
  }
  if (left !== right) throw "RegExp: "+ regStr + "'s bracket is not marched";
  else return left - ignored;
};


_.escapeRegExp = function( str){// Credit: XRegExp 0.6.1 (c) 2007-2008 Steven Levithan <http://stevenlevithan.com/regex/xregexp/> MIT License
  return str.replace(/[-[\]{}()*+?.\\^$|,#\s]/g, function(match){
    return '\\' + match;
  });
};


var rEntity = new RegExp("&(" + Object.keys(entities).join('|') + ');', 'gi');

_.convertEntity = function(chr){

  return ("" + chr).replace(rEntity, function(all, capture){
    return String.fromCharCode(entities[capture])
  });

}


// simple get accessor

_.createObject = function(o, props){
    function Foo() {}
    Foo.prototype = o;
    var res = new Foo;
    if(props) _.extend(res, props);
    return res;
}

_.createProto = function(fn, o){
    function Foo() { this.constructor = fn;}
    Foo.prototype = o;
    return (fn.prototype = new Foo());
}


/**
clone
*/
_.clone = function clone(obj){
    var type = _.typeOf(obj);
    if(type === 'array'){
      var cloned = [];
      for(var i=0,len = obj.length; i< len;i++){
        cloned[i] = obj[i]
      }
      return cloned;
    }
    if(type === 'object'){
      var cloned = {};
      for(var i in obj) if(obj.hasOwnProperty(i)){
        cloned[i] = obj[i];
      }
      return cloned;
    }
    return obj;
  }


_.equals = function(now, old){
  if( Array.isArray(now) ){
    var splices = ld(now, old||[]);
    return splices;
  }
  var type = typeof now;
  if(type === 'number' && typeof old === 'number'&& isNaN(now) && isNaN(old)) return true
  return now === old;
}


//Levenshtein_distance
//=================================================
//1. http://en.wikipedia.org/wiki/Levenshtein_distance
//2. github.com:polymer/observe-js

var ld = (function(){
  function equals(a,b){
    return a === b;
  }
  function ld(array1, array2){
    var n = array1.length;
    var m = array2.length;
    var matrix = [];
    for(var i = 0; i <= n; i++){
      matrix.push([i]);
    }
    for(var j=1;j<=m;j++){
      matrix[0][j]=j;
    }
    for(var i = 1; i <= n; i++){
      for(var j = 1; j <= m; j++){
        if(equals(array1[i-1], array2[j-1])){
          matrix[i][j] = matrix[i-1][j-1];
        }else{
          matrix[i][j] = Math.min(
            matrix[i-1][j]+1, //delete
            matrix[i][j-1]+1//add
            )
        }
      }
    }
    return matrix;
  }
  function whole(arr2, arr1) {
      var matrix = ld(arr1, arr2)
      var n = arr1.length;
      var i = n;
      var m = arr2.length;
      var j = m;
      var edits = [];
      var current = matrix[i][j];
      while(i>0 || j>0){
      // the last line
        if (i === 0) {
          edits.unshift(3);
          j--;
          continue;
        }
        // the last col
        if (j === 0) {
          edits.unshift(2);
          i--;
          continue;
        }
        var northWest = matrix[i - 1][j - 1];
        var west = matrix[i - 1][j];
        var north = matrix[i][j - 1];

        var min = Math.min(north, west, northWest);

        if (min === west) {
          edits.unshift(2); //delete
          i--;
          current = west;
        } else if (min === northWest ) {
          if (northWest === current) {
            edits.unshift(0); //no change
          } else {
            edits.unshift(1); //update
            current = northWest;
          }
          i--;
          j--;
        } else {
          edits.unshift(3); //add
          j--;
          current = north;
        }
      }
      var LEAVE = 0;
      var ADD = 3;
      var DELELE = 2;
      var UPDATE = 1;
      var n = 0;m=0;
      var steps = [];
      var step = {index: null, add:0, removed:[]};

      for(var i=0;i<edits.length;i++){
        if(edits[i] > 0 ){ // NOT LEAVE
          if(step.index === null){
            step.index = m;
          }
        } else { //LEAVE
          if(step.index != null){
            steps.push(step)
            step = {index: null, add:0, removed:[]};
          }
        }
        switch(edits[i]){
          case LEAVE:
            n++;
            m++;
            break;
          case ADD:
            step.add++;
            m++;
            break;
          case DELELE:
            step.removed.push(arr1[n])
            n++;
            break;
          case UPDATE:
            step.add++;
            step.removed.push(arr1[n])
            n++;
            m++;
            break;
        }
      }
      if(step.index != null){
        steps.push(step)
      }
      return steps
    }
    return whole;
  })();



_.throttle = function throttle(func, wait){
  var wait = wait || 100;
  var context, args, result;
  var timeout = null;
  var previous = 0;
  var later = function() {
    previous = +new Date;
    timeout = null;
    result = func.apply(context, args);
    context = args = null;
  };
  return function() {
    var now = + new Date;
    var remaining = wait - (now - previous);
    context = this;
    args = arguments;
    if (remaining <= 0 || remaining > wait) {
      clearTimeout(timeout);
      timeout = null;
      previous = now;
      result = func.apply(context, args);
      context = args = null;
    } else if (!timeout) {
      timeout = setTimeout(later, remaining);
    }
    return result;
  };
};

// hogan escape
// ==============
_.escape = (function(){
  var rAmp = /&/g,
      rLt = /</g,
      rGt = />/g,
      rApos = /\'/g,
      rQuot = /\"/g,
      hChars = /[&<>\"\']/;

  return function(str) {
    return hChars.test(str) ?
      str
        .replace(rAmp, '&amp;')
        .replace(rLt, '&lt;')
        .replace(rGt, '&gt;')
        .replace(rApos, '&#39;')
        .replace(rQuot, '&quot;') :
      str;
  }
})();

_.cache = function(max){
  max = max || 1000;
  var keys = [],
      cache = {};
  return {
    set: function(key, value) {
      if (keys.length > this.max) {
        cache[keys.shift()] = undefined;
      }
      // 
      if(cache[key] === undefined){
        keys.push(key);
      }
      cache[key] = value;
      return value;
    },
    get: function(key) {
      if (key === undefined) return cache;
      return cache[key];
    },
    max: max,
    len:function(){
      return keys.length;
    }
  };
}

// // setup the raw Expression
// _.touchExpression = function(expr){
//   if(expr.type === 'expression'){
//   }
//   return expr;
// }


// handle the same logic on component's `on-*` and element's `on-*`
// return the fire object
_.handleEvent = function(value, type ){
  var self = this, evaluate;
  if(value.type === 'expression'){ // if is expression, go evaluated way
    evaluate = value.get;
  }
  if(evaluate){
    return function fire(obj){
      self.data.$event = obj;
      var res = evaluate(self);
      if(res === false && obj && obj.preventDefault) obj.preventDefault();
      self.data.$event = undefined;
      self.$update();
    }
  }else{
    return function fire(){
      var args = slice.call(arguments)      
      args.unshift(value);
      self.$emit.apply(self, args);
      self.$update();
    }
  }
}

// only call once
_.once = function(fn){
  var time = 0;
  return function(){
    if( time++ === 0) fn.apply(this, arguments);
  }
}



_.log = function(msg, type){
  if(typeof console !== "undefined")  console[type || "log"](msg);
}




//http://www.w3.org/html/wg/drafts/html/master/single-page.html#void-elements
_.isVoidTag = _.makePredicate("area base br col embed hr img input keygen link menuitem meta param source track wbr r-content");
_.isBooleanAttr = _.makePredicate('selected checked disabled readOnly required open autofocus controls autoplay compact loop defer multiple');

_.isFalse - function(){return false}
_.isTrue - function(){return true}


_.assert = function(test, msg){
  if(!test) throw msg;
}


});
require.register("regularjs/src/walkers.js", function(exports, require, module){
var node = require("./parser/node.js");
var dom = require("./dom.js");
var animate = require("./helper/animate.js");
var Group = require('./group.js');
var _ = require('./util');
var combine = require('./helper/combine.js');

var walkers = module.exports = {};

walkers.list = function(ast, options){

  var Regular = walkers.Regular;  
  var placeholder = document.createComment("Regular list"),
    namespace = options.namespace,
    extra = options.extra;
  var self = this;
  var group = new Group();
  group.push(placeholder);
  var indexName = ast.variable + '_index';
  var variable = ast.variable;

  function update(newValue, splices){
    if(!newValue) {
      newValue = [];
      splices = _.equals(newValue, splices);
    }
    
    if(!splices || !splices.length) return;
    var cur = placeholder;
    var m = 0, len = newValue.length,
      mIndex = splices[0].index;

    for(var i = 0; i < splices.length; i++){ //init
      var splice = splices[i];
      var index = splice.index; // beacuse we use a comment for placeholder

      for(var k = m; k < index; k++){ // no change
        var sect = group.get( k + 1 );
        sect.data[indexName] = k;
      }
      for(var j = 0, jlen = splice.removed.length; j< jlen; j++){ //removed
        var removed = group.children.splice( index + 1, 1)[0];
        removed.destroy(true);
      }

      for(var o = index; o < index + splice.add; o++){ //add
        // prototype inherit
        var item = newValue[o];
        var data = {};
        data[indexName] = o;
        data[variable] = item;

        _.extend(data, extra);
        var section = self.$compile(ast.body, {
          extra: data,
          namespace:namespace,
          record: true,
          outer: options.outer
        })
        section.data = data;
        // autolink
        var insert =  combine.last(group.get(o));
        if(insert.parentNode){
          animate.inject(combine.node(section),insert, 'after');
        }
        // insert.parentNode.insertBefore(combine.node(section), insert.nextSibling);
        group.children.splice( o + 1 , 0, section);
      }
      m = index + splice.add - splice.removed.length;
      m  = m < 0? 0 : m;

    }
    if(m < len){
      for(var i = m; i < len; i++){
        var pair = group.get(i + 1);
        pair.data[indexName] = i;
      }
    }
  }

  this.$watch(ast.sequence, update, { init: true });
  return group;
}
// {#include }
walkers.template = function(ast, options){
  var content = ast.content, compiled;
  var placeholder = document.createComment('inlcude');
  var compiled, namespace = options.namespace, extra = options.extra;
  // var fragment = dom.fragment();
  // fragment.appendChild(placeholder);
  var group = new Group();
  group.push(placeholder);
  if(content){
    var self = this;
    this.$watch(content, function(value){
      if( compiled = group.get(1)){
        compiled.destroy(true); 
        group.children.pop();
      }
      group.push( compiled =  self.$compile(value, {record: true, outer: options.outer,namespace: namespace, extra: extra}) ); 
      if(placeholder.parentNode) animate.inject(combine.node(compiled), placeholder, 'before')
    }, {
      init: true
    });
  }
  return group;
};


// how to resolve this problem
var ii = 0;
walkers['if'] = function(ast, options){
  var self = this, consequent, alternate, extra = options.extra;
  if(options && options.element){ // attribute inteplation
    var update = function(nvalue){
      if(!!nvalue){
        if(alternate) combine.destroy(alternate)
        if(ast.consequent) consequent = self.$compile(ast.consequent, {record: true, element: options.element , extra:extra});
      }else{
        if(consequent) combine.destroy(consequent)
        if(ast.alternate) alternate = self.$compile(ast.alternate, {record: true, element: options.element, extra: extra});
      }
    }
    this.$watch(ast.test, update, { force: true });
    return {
      destroy: function(){
        if(consequent) combine.destroy(consequent);
        else if(alternate) combine.destroy(alternate);
      }
    }
  }

  var test, consequent, alternate, node;
  var placeholder = document.createComment("Regular if" + ii++);
  var group = new Group();
  group.push(placeholder);
  var preValue = null, namespace= options.namespace;


  var update = function (nvalue, old){
    var value = !!nvalue;
    if(value === preValue) return;
    preValue = value;
    if(group.children[1]){
      group.children[1].destroy(true);
      group.children.pop();
    }
    if(value){ //true
      if(ast.consequent && ast.consequent.length){
        consequent = self.$compile( ast.consequent , {record:true, outer: options.outer,namespace: namespace, extra:extra })
        // placeholder.parentNode && placeholder.parentNode.insertBefore( node, placeholder );
        group.push(consequent);
        if(placeholder.parentNode){
          animate.inject(combine.node(consequent), placeholder, 'before');
        }
      }
    }else{ //false
      if(ast.alternate && ast.alternate.length){
        alternate = self.$compile(ast.alternate, {record:true, outer: options.outer,namespace: namespace, extra:extra});
        group.push(alternate);
        if(placeholder.parentNode){
          animate.inject(combine.node(alternate), placeholder, 'before');
        }
      }
    }
  }
  this.$watch(ast.test, update, {force: true, init: true});

  return group;
}


walkers.expression = function(ast, options){
  var node = document.createTextNode("");
  this.$watch(ast, function(newval){
    dom.text(node, "" + (newval == null? "": "" + newval) );
  })
  return node;
}
walkers.text = function(ast, options){
  var node = document.createTextNode(_.convertEntity(ast.text));
  return node;
}



var eventReg = /^on-(.+)$/

/**
 * walkers element (contains component)
 */
walkers.element = function(ast, options){
  var attrs = ast.attrs, 
    component, self = this,
    Constructor=this.constructor,
    children = ast.children,
    namespace = options.namespace, ref, group, 
    extra = options.extra,
    isolate = 0,
    Component = Constructor.component(ast.tag);


  if(ast.tag === 'svg') namespace = "svg";




  if(Component){
    var data = {},events;
    for(var i = 0, len = attrs.length; i < len; i++){
      var attr = attrs[i];
      var value = this._touchExpr(attr.value || "");
      
      var name = attr.name;
      var etest = name.match(eventReg);
      // bind event proxy
      if(etest){
        events = events || {};
        events[etest[1]] = _.handleEvent.call(this, value, etest[1]);
        continue;
      }

      if(value.type !== 'expression'){
        data[attr.name] = value;
      }else{
        data[attr.name] = value.get(self); 
      }
      if( attr.name === 'ref'  && value != null){
        ref = value.type === 'expression'? value.get(self): value;
      }
      if( attr.name === 'isolate'){
        // 1: stop: composite -> parent
        // 2. stop: composite <- parent
        // 3. stop 1 and 2: composite <-> parent
        // 0. stop nothing (defualt)
        isolate = value.type === 'expression'? value.get(self): parseInt(value || 3, 10);
        data.isolate = isolate;
      }


    }

    var config = { 
      data: data, 
      events: events, 
      $parent: this,
      $outer: options.outer,
      namespace: namespace, 
      $root: this.$root,
      $body: ast.children
    }

    var component = new Component(config);
    if(ref &&  self.$refs) self.$refs[ref] = component;
    for(var i = 0, len = attrs.length; i < len; i++){
      var attr = attrs[i];
      var value = attr.value||"";
      if(value.type === 'expression' && attr.name.indexOf('on-')===-1){
        value = self._touchExpr(value);
        // use bit operate to control scope
        if( !(isolate & 2) ) 
          this.$watch(value, component.$update.bind(component, attr.name))
        if( value.set && !(isolate & 1 ) ) 
          // sync the data. it force the component don't trigger attr.name's first dirty echeck
          component.$watch(attr.name, self.$update.bind(self, value), {sync: true});
      }
    }
    if(ref){
      component.$on('destroy', function(){
        if(self.$refs) self.$refs[ref] = null;
      })
    }
    return component;
  }
  else if( ast.tag === 'r-content' && this._getTransclude ){
    return this._getTransclude();
  }
  
  if(children && children.length){
    group = this.$compile(children, {outer: options.outer,namespace: namespace, extra: extra });
  }

  var element = dom.create(ast.tag, namespace, attrs);
  // context element

  var child;

  if(group && !_.isVoidTag(ast.tag)){
    dom.inject( combine.node(group) , element)
  }

  // sort before
  attrs.sort(function(a1, a2){
    var d1 = Constructor.directive(a1.name),
      d2 = Constructor.directive(a2.name);
    if(d1 && d2) return (d2.priority || 1) - (d1.priority || 1);
    if(d1) return 1;
    if(d2) return -1;
    if(a2.name === "type") return 1;
    return -1;
  })
  // may distinct with if else
  var destroies = walkAttributes.call(this, attrs, element, destroies);



  var res  = {
    type: "element",
    group: group,
    node: function(){
      return element;
    },
    last: function(){
      return element;
    },
    destroy: function(first){
      if( first ){
        animate.remove( element, group? group.destroy.bind( group ): _.noop );
      }else if(group) {
        group.destroy();
      }
      // destroy ref
      if( destroies.length ) {
        destroies.forEach(function( destroy ){
          if( destroy ){
            if( typeof destroy.destroy === 'function' ){
              destroy.destroy()
            }else{
              destroy();
            }
          }
        })
      }
    }
  }
  return res;
}

function walkAttributes(attrs, element){
  var bindings = []
  for(var i = 0, len = attrs.length; i < len; i++){
    var binding = this._walk(attrs[i], {element: element, fromElement: true, attrs: attrs})
    if(binding) bindings.push(binding);
  }
  return bindings;
}

walkers.attribute = function(ast ,options){
  var attr = ast;
  var Component = this.constructor;
  var self = this;
  var element = options.element;
  var name = attr.name,
    value = attr.value || "", directive = Component.directive(name);

  value = this._touchExpr(value);


  if(directive && directive.link){
    var binding = directive.link.call(self, element, value, name, options.attrs);
    if(typeof binding === 'function') binding = {destroy: binding}; 
    return binding;
  }else{
    if( name === 'ref'  && value != null && options.fromElement){
      var ref = value.type === 'expression'? value.get(self): value;
      var refs = this.$refs;
      if(refs){
        refs[ref] = element
        return {
          destroy: function(){
            refs[ref] = null;
          }
        }
      }
    }
    if(value.type === 'expression' ){

      this.$watch(value, function(nvalue, old){
        dom.attr(element, name, nvalue);
      }, {init: true});
    }else{
      if(_.isBooleanAttr(name)){
        dom.attr(element, name, true);
      }else{
        dom.attr(element, name, value);
      }
    }
    if(!options.fromElement){
      return {
        destroy: function(){
          dom.attr(element, name, null);
        }
      }
    }
  }

}


});
require.register("regularjs/src/env.js", function(exports, require, module){
// some fixture test;
// ---------------
var _ = require('./util');
exports.svg = (function(){
  return typeof document !== "undefined" && document.implementation.hasFeature( "http://www.w3.org/TR/SVG11/feature#BasicStructure", "1.1" );
})();


exports.browser = typeof document !== "undefined" && document.nodeType;
// whether have component in initializing
exports.exprCache = _.cache(1000);
exports.isRunning = false;

});
require.register("regularjs/src/index.js", function(exports, require, module){
var env =  require("./env.js");
var config = require("./config"); 
var Regular = module.exports = require("./Regular.js");
var Parser = Regular.Parser;
var Lexer = Regular.Lexer;

if(env.browser){
    require("./directive/base.js");
    require("./directive/animation.js");
    require("./module/timeout.js");
    Regular.dom = require("./dom.js");
}
Regular.env = env;
Regular.util = require("./util.js");
Regular.parse = function(str, options){
  options = options || {};

  if(options.BEGIN || options.END){
    if(options.BEGIN) config.BEGIN = options.BEGIN;
    if(options.END) config.END = options.END;
    Lexer.setup();
  }
  var ast = new Parser(str).parse();
  return !options.stringify? ast : JSON.stringify(ast);
}


});
require.register("regularjs/src/dom.js", function(exports, require, module){

// thanks for angular && mootools for some concise&cross-platform  implemention
// =====================================

// The MIT License
// Copyright (c) 2010-2014 Google, Inc. http://angularjs.org

// ---
// license: MIT-style license. http://mootools.net


var dom = module.exports;
var env = require("./env.js");
var _ = require("./util");
var tNode = document.createElement('div')
var addEvent, removeEvent;
var noop = function(){}

var namespaces = {
  html: "http://www.w3.org/1999/xhtml",
  svg: "http://www.w3.org/2000/svg"
}

dom.body = document.body;

dom.doc = document;

// camelCase
function camelCase(str){
  return ("" + str).replace(/-\D/g, function(match){
    return match.charAt(1).toUpperCase();
  });
}


dom.tNode = tNode;

if(tNode.addEventListener){
  addEvent = function(node, type, fn) {
    node.addEventListener(type, fn, false);
  }
  removeEvent = function(node, type, fn) {
    node.removeEventListener(type, fn, false) 
  }
}else{
  addEvent = function(node, type, fn) {
    node.attachEvent('on' + type, fn);
  }
  removeEvent = function(node, type, fn) {
    node.detachEvent('on' + type, fn); 
  }
}


dom.msie = parseInt((/msie (\d+)/.exec(navigator.userAgent.toLowerCase()) || [])[1]);
if (isNaN(dom.msie)) {
  dom.msie = parseInt((/trident\/.*; rv:(\d+)/.exec(navigator.userAgent.toLowerCase()) || [])[1]);
}

dom.find = function(sl){
  if(document.querySelector) {
    try{
      return document.querySelector(sl);
    }catch(e){

    }
  }
  if(sl.indexOf('#')!==-1) return document.getElementById( sl.slice(1) );
}

dom.inject = function(node, refer, position){

  position = position || 'bottom';

  if(Array.isArray(node)){
    var tmp = node;
    node = dom.fragment();
    for(var i = 0,len = tmp.length; i < len ;i++){
      node.appendChild(tmp[i]);
    }
  }

  var firstChild, next;
  switch(position){
    case 'bottom':
      refer.appendChild( node );
      break;
    case 'top':
      if( firstChild = refer.firstChild ){
        refer.insertBefore( node, refer.firstChild );
      }else{
        refer.appendChild( node );
      }
      break;
    case 'after':
      if( next = refer.nextSibling ){
        next.parentNode.insertBefore( node, next );
      }else{
        refer.parentNode.appendChild( node );
      }
      break;
    case 'before':
      refer.parentNode.insertBefore( node, refer );
  }
}


dom.id = function(id){
  return document.getElementById(id);
}

// createElement 
dom.create = function(type, ns, attrs){
  if(ns === 'svg'){
    if(!env.svg) throw Error('the env need svg support')
    ns = namespaces.svg;
  }
  return !ns? document.createElement(type): document.createElementNS(ns, type);
}

// documentFragment
dom.fragment = function(){
  return document.createDocumentFragment();
}



var specialAttr = {
  'class': function(node, value){
    ('className' in node && (node.namespaceURI === namespaces.html || !node.namespaceURI)) ?
      node.className = (value || '') : node.setAttribute('class', value);
  },
  'for': function(node, value){
    ('htmlFor' in node) ? node.htmlFor = value : node.setAttribute('for', value);
  },
  'style': function(node, value){
    (node.style) ? node.style.cssText = value : node.setAttribute('style', value);
  },
  'value': function(node, value){
    node.value = (value != null) ? value : '';
  }
}


// attribute Setter & Getter
dom.attr = function(node, name, value){
  if (_.isBooleanAttr(name)) {
    if (typeof value !== 'undefined') {
      if (!!value) {
        node[name] = true;
        node.setAttribute(name, name);
        // lt ie7 . the javascript checked setting is in valid
        //http://bytes.com/topic/javascript/insights/799167-browser-quirk-dynamically-appended-checked-checkbox-does-not-appear-checked-ie
        if(dom.msie && dom.msie <=7 ) node.defaultChecked = true
      } else {
        node[name] = false;
        node.removeAttribute(name);
      }
    } else {
      return (node[name] ||
               (node.attributes.getNamedItem(name)|| noop).specified) ? name : undefined;
    }
  } else if (typeof (value) !== 'undefined') {
    // if in specialAttr;
    if(specialAttr[name]) specialAttr[name](node, value);
    else if(value === null) node.removeAttribute(name)
    else node.setAttribute(name, value);
  } else if (node.getAttribute) {
    // the extra argument "2" is to get the right thing for a.href in IE, see jQuery code
    // some elements (e.g. Document) don't have get attribute, so return undefined
    var ret = node.getAttribute(name, 2);
    // normalize non-existing attributes to undefined (as jQuery)
    return ret === null ? undefined : ret;
  }
}


dom.on = function(node, type, handler){
  var types = type.split(' ');
  handler.real = function(ev){
    var $event = new Event(ev);
    $event.origin = node;
    handler.call(node, $event);
  }
  types.forEach(function(type){
    type = fixEventName(node, type);
    addEvent(node, type, handler.real);
  });
}
dom.off = function(node, type, handler){
  var types = type.split(' ');
  handler = handler.real || handler;
  types.forEach(function(type){
    type = fixEventName(node, type);
    removeEvent(node, type, handler);
  })
}


dom.text = (function (){
  var map = {};
  if (dom.msie && dom.msie < 9) {
    map[1] = 'innerText';    
    map[3] = 'nodeValue';    
  } else {
    map[1] = map[3] = 'textContent';
  }
  
  return function (node, value) {
    var textProp = map[node.nodeType];
    if (value == null) {
      return textProp ? node[textProp] : '';
    }
    node[textProp] = value;
  }
})();


dom.html = function( node, html ){
  if(typeof html === "undefined"){
    return node.innerHTML;
  }else{
    node.innerHTML = html;
  }
}

dom.replace = function(node, replaced){
  if(replaced.parentNode) replaced.parentNode.replaceChild(node, replaced);
}

dom.remove = function(node){
  if(node.parentNode) node.parentNode.removeChild(node);
}

// css Settle & Getter from angular
// =================================
// it isnt computed style 
dom.css = function(node, name, value){
  if( _.typeOf(name) === "object" ){
    for(var i in name){
      if( name.hasOwnProperty(i) ){
        dom.css( node, i, name[i] );
      }
    }
    return;
  }
  if ( typeof value !== "undefined" ) {

    name = camelCase(name);
    if(name) node.style[name] = value;

  } else {

    var val;
    if (dom.msie <= 8) {
      // this is some IE specific weirdness that jQuery 1.6.4 does not sure why
      val = node.currentStyle && node.currentStyle[name];
      if (val === '') val = 'auto';
    }
    val = val || node.style[name];
    if (dom.msie <= 8) {
      val = val === '' ? undefined : val;
    }
    return  val;
  }
}

dom.addClass = function(node, className){
  var current = node.className || "";
  if ((" " + current + " ").indexOf(" " + className + " ") === -1) {
    node.className = current? ( current + " " + className ) : className;
  }
}

dom.delClass = function(node, className){
  var current = node.className || "";
  node.className = (" " + current + " ").replace(" " + className + " ", " ").trim();
}

dom.hasClass = function(node, className){
  var current = node.className || "";
  return (" " + current + " ").indexOf(" " + className + " ") !== -1;
}



// simple Event wrap

//http://stackoverflow.com/questions/11068196/ie8-ie7-onchange-event-is-emited-only-after-repeated-selection
function fixEventName(elem, name){
  return (name === 'change'  &&  dom.msie < 9 && 
      (elem && elem.tagName && elem.tagName.toLowerCase()==='input' && 
        (elem.type === 'checkbox' || elem.type === 'radio')
      )
    )? 'click': name;
}

var rMouseEvent = /^(?:click|dblclick|contextmenu|DOMMouseScroll|mouse(?:\w+))$/
var doc = document;
doc = (!doc.compatMode || doc.compatMode === 'CSS1Compat') ? doc.documentElement : doc.body;
function Event(ev){
  ev = ev || window.event;
  if(ev._fixed) return ev;
  this.event = ev;
  this.target = ev.target || ev.srcElement;

  var type = this.type = ev.type;
  var button = this.button = ev.button;

  // if is mouse event patch pageX
  if(rMouseEvent.test(type)){ //fix pageX
    this.pageX = (ev.pageX != null) ? ev.pageX : ev.clientX + doc.scrollLeft;
    this.pageY = (ev.pageX != null) ? ev.pageY : ev.clientY + doc.scrollTop;
    if (type === 'mouseover' || type === 'mouseout'){// fix relatedTarget
      var related = ev.relatedTarget || ev[(type === 'mouseover' ? 'from' : 'to') + 'Element'];
      while (related && related.nodeType === 3) related = related.parentNode;
      this.relatedTarget = related;
    }
  }
  // if is mousescroll
  if (type === 'DOMMouseScroll' || type === 'mousewheel'){
    // ff ev.detail: 3    other ev.wheelDelta: -120
    this.wheelDelta = (ev.wheelDelta) ? ev.wheelDelta / 120 : -(ev.detail || 0) / 3;
  }
  
  // fix which
  this.which = ev.which || ev.keyCode;
  if( !this.which && button !== undefined){
    // http://api.jquery.com/event.which/ use which
    this.which = ( button & 1 ? 1 : ( button & 2 ? 3 : ( button & 4 ? 2 : 0 ) ) );
  }
  this._fixed = true;
}

_.extend(Event.prototype, {
  immediateStop: _.isFalse,
  stop: function(){
    this.preventDefault().stopPropagation();
  },
  preventDefault: function(){
    if (this.event.preventDefault) this.event.preventDefault();
    else this.event.returnValue = false;
    return this;
  },
  stopPropagation: function(){
    if (this.event.stopPropagation) this.event.stopPropagation();
    else this.event.cancelBubble = true;
    return this;
  },
  stopImmediatePropagation: function(){
    if(this.event.stopImmediatePropagation) this.event.stopImmediatePropagation();
  }
})


dom.nextFrame = (function(){
    var request = window.requestAnimationFrame ||
                  window.webkitRequestAnimationFrame ||
                  window.mozRequestAnimationFrame|| 
                  function(callback){
                    setTimeout(callback, 16)
                  }

    var cancel = window.cancelAnimationFrame ||
                 window.webkitCancelAnimationFrame ||
                 window.mozCancelAnimationFrame ||
                 window.webkitCancelRequestAnimationFrame ||
                 function(tid){
                    clearTimeout(tid)
                 }
  
  return function(callback){
    var id = request(callback);
    return function(){ cancel(id); }
  }
})();

// 3ks for angular's raf  service
var k;
dom.nextReflow = function(callback){
  dom.nextFrame(function(){
    k = document.body.offsetWidth;
    callback();
  })
}




});
require.register("regularjs/src/group.js", function(exports, require, module){
var _ = require('./util');
var combine = require('./helper/combine')

function Group(list){
  this.children = list || [];
}


_.extend(Group.prototype, {
  destroy: function(first){
    combine.destroy(this.children, first);
    if(this.ondestroy) this.ondestroy();
    this.children = null;
  },
  get: function(i){
    return this.children[i]
  },
  push: function(item){
    this.children.push( item );
  }

})



module.exports = Group;



});
require.register("regularjs/src/config.js", function(exports, require, module){

module.exports = {
'BEGIN': '{',
'END': '}'
}
});
require.register("regularjs/src/parser/Lexer.js", function(exports, require, module){
var _ = require("../util.js");
var config = require("../config.js");

// some custom tag  will conflict with the Lexer progress
var conflictTag = {"}": "{", "]": "["}, map1, map2;
// some macro for lexer
var macro = {
  'NAME': /(?:[:_A-Za-z][-\.:_0-9A-Za-z]*)/,
  'IDENT': /[\$_A-Za-z][_0-9A-Za-z\$]*/,
  'SPACE': /[\r\n\f ]/
}


var test = /a|(b)/.exec("a");
var testSubCapure = test && test[1] === undefined? 
  function(str){ return str !== undefined }
  :function(str){return !!str};

function wrapHander(handler){
  return function(all){
    return {type: handler, value: all }
  }
}

function Lexer(input, opts){
  if(conflictTag[config.END]){
    this.markStart = conflictTag[config.END];
    this.markEnd = config.END;
  }

  this.input = (input||"").trim();
  this.opts = opts || {};
  this.map = this.opts.mode !== 2?  map1: map2;
  this.states = ["INIT"];
  if(opts && opts.expression){
     this.states.push("JST");
     this.expression = true;
  }
}

var lo = Lexer.prototype


lo.lex = function(str){
  str = (str || this.input).trim();
  var tokens = [], split, test,mlen, token, state;
  this.input = str, 
  this.marks = 0;
  // init the pos index
  this.index=0;
  var i = 0;
  while(str){
    i++
    state = this.state();
    split = this.map[state] 
    test = split.TRUNK.exec(str);
    if(!test){
      this.error('Unrecoginized Token');
    }
    mlen = test[0].length;
    str = str.slice(mlen)
    token = this._process.call(this, test, split, str)
    if(token) tokens.push(token)
    this.index += mlen;
    // if(state == 'TAG' || state == 'JST') str = this.skipspace(str);
  }

  tokens.push({type: 'EOF'});

  return tokens;
}

lo.error = function(msg){
  throw "Parse Error: " + msg +  ':\n' + _.trackErrorPos(this.input, this.index);
}

lo._process = function(args, split,str){
  // console.log(args.join(","), this.state())
  var links = split.links, marched = false, token;

  for(var len = links.length, i=0;i<len ;i++){
    var link = links[i],
      handler = link[2],
      index = link[0];
    // if(args[6] === '>' && index === 6) console.log('haha')
    if(testSubCapure(args[index])) {
      marched = true;
      if(handler){
        token = handler.apply(this, args.slice(index, index + link[1]))
        if(token)  token.pos = this.index;
      }
      break;
    }
  }
  if(!marched){ // in ie lt8 . sub capture is "" but ont 
    switch(str.charAt(0)){
      case "<":
        this.enter("TAG");
        break;
      default:
        this.enter("JST");
        break;
    }
  }
  return token;
}
lo.enter = function(state){
  this.states.push(state)
  return this;
}

lo.state = function(){
  var states = this.states;
  return states[states.length-1];
}

lo.leave = function(state){
  var states = this.states;
  if(!state || states[states.length-1] === state) states.pop()
}


Lexer.setup = function(){
  macro.END = config.END;
  macro.BEGIN = config.BEGIN;
  //
  map1 = genMap([
    // INIT
    rules.ENTER_JST,
    rules.ENTER_TAG,
    rules.TEXT,

    //TAG
    rules.TAG_NAME,
    rules.TAG_OPEN,
    rules.TAG_CLOSE,
    rules.TAG_PUNCHOR,
    rules.TAG_ENTER_JST,
    rules.TAG_UNQ_VALUE,
    rules.TAG_STRING,
    rules.TAG_SPACE,
    rules.TAG_COMMENT,

    // JST
    rules.JST_OPEN,
    rules.JST_CLOSE,
    rules.JST_COMMENT,
    rules.JST_EXPR_OPEN,
    rules.JST_IDENT,
    rules.JST_SPACE,
    rules.JST_LEAVE,
    rules.JST_NUMBER,
    rules.JST_PUNCHOR,
    rules.JST_STRING,
    rules.JST_COMMENT
    ])

  // ignored the tag-relative token
  map2 = genMap([
    // INIT no < restrict
    rules.ENTER_JST2,
    rules.TEXT,
    // JST
    rules.JST_COMMENT,
    rules.JST_OPEN,
    rules.JST_CLOSE,
    rules.JST_EXPR_OPEN,
    rules.JST_IDENT,
    rules.JST_SPACE,
    rules.JST_LEAVE,
    rules.JST_NUMBER,
    rules.JST_PUNCHOR,
    rules.JST_STRING,
    rules.JST_COMMENT
    ])
}


function genMap(rules){
  var rule, map = {}, sign;
  for(var i = 0, len = rules.length; i < len ; i++){
    rule = rules[i];
    sign = rule[2] || 'INIT';
    ( map[sign] || (map[sign] = {rules:[], links:[]}) ).rules.push(rule);
  }
  return setup(map);
}

function setup(map){
  var split, rules, trunks, handler, reg, retain, rule;
  function replaceFn(all, one){
    return typeof macro[one] === 'string'? 
      _.escapeRegExp(macro[one]) 
      : String(macro[one]).slice(1,-1);
  }

  for(var i in map){

    split = map[i];
    split.curIndex = 1;
    rules = split.rules;
    trunks = [];

    for(var j = 0,len = rules.length; j<len; j++){
      rule = rules[j]; 
      reg = rule[0];
      handler = rule[1];

      if(typeof handler === 'string'){
        handler = wrapHander(handler);
      }
      if(_.typeOf(reg) === 'regexp') reg = reg.toString().slice(1, -1);

      reg = reg.replace(/\{(\w+)\}/g, replaceFn)
      retain = _.findSubCapture(reg) + 1; 
      split.links.push([split.curIndex, retain, handler]); 
      split.curIndex += retain;
      trunks.push(reg);
    }
    split.TRUNK = new RegExp("^(?:(" + trunks.join(")|(") + "))")
  }
  return map;
}

var rules = {

  // 1. INIT
  // ---------------

  // mode1's JST ENTER RULE
  ENTER_JST: [/[^\x00<]*?(?={BEGIN})/, function(all){
    this.enter('JST');
    if(all) return {type: 'TEXT', value: all}
  }],

  // mode2's JST ENTER RULE
  ENTER_JST2: [/[^\x00]*?(?={BEGIN})/, function(all){
    this.enter('JST');
    if(all) return {type: 'TEXT', value: all}
  }],

  ENTER_TAG: [/[^\x00<>]*?(?=<)/, function(all){ 
    this.enter('TAG');
    if(all) return {type: 'TEXT', value: all}
  }],

  TEXT: [/[^\x00]+/, 'TEXT'],

  // 2. TAG
  // --------------------
  TAG_NAME: [/{NAME}/, 'NAME', 'TAG'],
  TAG_UNQ_VALUE: [/[^\{}&"'=><`\r\n\f ]+/, 'UNQ', 'TAG'],

  TAG_OPEN: [/<({NAME})\s*/, function(all, one){
    return {type: 'TAG_OPEN', value: one}
  }, 'TAG'],
  TAG_CLOSE: [/<\/({NAME})[\r\n\f ]*>/, function(all, one){
    this.leave();
    return {type: 'TAG_CLOSE', value: one }
  }, 'TAG'],

    // mode2's JST ENTER RULE
  TAG_ENTER_JST: [/(?={BEGIN})/, function(){
    this.enter('JST');
  }, 'TAG'],


  TAG_PUNCHOR: [/[\>\/=&]/, function(all){
    if(all === '>') this.leave();
    return {type: all, value: all }
  }, 'TAG'],
  TAG_STRING:  [ /'([^']*)'|"([^"]*)"/, function(all, one, two){ //"'
    var value = one || two || "";

    return {type: 'STRING', value: value}
  }, 'TAG'],

  TAG_SPACE: [/{SPACE}+/, null, 'TAG'],
  TAG_COMMENT: [/<\!--([^\x00]*?)--\>/, null ,'TAG'],

  // 3. JST
  // -------------------

  JST_OPEN: ['{BEGIN}#{SPACE}*({IDENT})', function(all, name){
    return {
      type: 'OPEN',
      value: name
    }
  }, 'JST'],
  JST_LEAVE: [/{END}/, function(all){
    if(this.markEnd === all && this.expression) return {type: this.markEnd, value: this.markEnd};
    if(!this.markEnd || !this.marks ){
      this.firstEnterStart = false;
      this.leave('JST');
      return {type: 'END'}
    }else{
      this.marks--;
      return {type: this.markEnd, value: this.markEnd}
    }
  }, 'JST'],
  JST_CLOSE: [/{BEGIN}\s*\/({IDENT})\s*{END}/, function(all, one){
    this.leave('JST');
    return {
      type: 'CLOSE',
      value: one
    }
  }, 'JST'],
  JST_COMMENT: [/{BEGIN}\!([^\x00]*?)\!{END}/, function(){
    this.leave();
  }, 'JST'],
  JST_EXPR_OPEN: ['{BEGIN}',function(all, one){
    if(all === this.markStart){
      if(this.expression) return { type: this.markStart, value: this.markStart };
      if(this.firstEnterStart || this.marks){
        this.marks++
        this.firstEnterStart = false;
        return { type: this.markStart, value: this.markStart };
      }else{
        this.firstEnterStart = true;
      }
    }
    return {
      type: 'EXPR_OPEN',
      escape: false
    }

  }, 'JST'],
  JST_IDENT: ['{IDENT}', 'IDENT', 'JST'],
  JST_SPACE: [/[ \r\n\f]+/, null, 'JST'],
  JST_PUNCHOR: [/[=!]?==|[-=><+*\/%\!]?\=|\|\||&&|\@\(|\.\.|[<\>\[\]\(\)\-\|\{}\+\*\/%?:\.!,]/, function(all){
    return { type: all, value: all }
  },'JST'],

  JST_STRING:  [ /'([^']*)'|"([^"]*)"/, function(all, one, two){ //"'
    return {type: 'STRING', value: one || two || ""}
  }, 'JST'],
  JST_NUMBER: [/(?:[0-9]*\.[0-9]+|[0-9]+)(e\d+)?/, function(all){
    return {type: 'NUMBER', value: parseFloat(all, 10)};
  }, 'JST']
}


// setup when first config
Lexer.setup();



module.exports = Lexer;

});
require.register("regularjs/src/parser/node.js", function(exports, require, module){
module.exports = {
  element: function(name, attrs, children){
    return {
      type: 'element',
      tag: name,
      attrs: attrs,
      children: children
    }
  },
  attribute: function(name, value){
    return {
      type: 'attribute',
      name: name,
      value: value
    }
  },
  "if": function(test, consequent, alternate){
    return {
      type: 'if',
      test: test,
      consequent: consequent,
      alternate: alternate
    }
  },
  list: function(sequence, variable, body){
    return {
      type: 'list',
      sequence: sequence,
      variable: variable,
      body: body
    }
  },
  expression: function( body, setbody, constant ){
    return {
      type: "expression",
      body: body,
      constant: constant || false,
      setbody: setbody || false
    }
  },
  text: function(text){
    return {
      type: "text",
      text: text
    }
  },
  template: function(template){
    return {
      type: 'template',
      content: template
    }
  }
}

});
require.register("regularjs/src/parser/Parser.js", function(exports, require, module){
var _ = require("../util.js");

var config = require("../config.js");
var node = require("./node.js");
var Lexer = require("./Lexer.js");
var varName = _.varName;
var ctxName = _.ctxName;
var extName = _.extName;
var isPath = _.makePredicate("STRING IDENT NUMBER");
var isKeyWord = _.makePredicate("true false undefined null this Array Date JSON Math NaN RegExp decodeURI decodeURIComponent encodeURI encodeURIComponent parseFloat parseInt Object");




function Parser(input, opts){
  opts = opts || {};

  this.input = input;
  this.tokens = new Lexer(input, opts).lex();
  this.pos = 0;
  this.noComputed =  opts.noComputed;
  this.length = this.tokens.length;
}


var op = Parser.prototype;


op.parse = function(){
  this.pos = 0;
  var res= this.program();
  if(this.ll().type === 'TAG_CLOSE'){
    this.error("You may got a unclosed Tag")
  }
  return res;
}

op.ll =  function(k){
  k = k || 1;
  if(k < 0) k = k + 1;
  var pos = this.pos + k - 1;
  if(pos > this.length - 1){
      return this.tokens[this.length-1];
  }
  return this.tokens[pos];
}
  // lookahead
op.la = function(k){
  return (this.ll(k) || '').type;
}

op.match = function(type, value){
  var ll;
  if(!(ll = this.eat(type, value))){
    ll  = this.ll();
    this.error('expect [' + type + (value == null? '':':'+ value) + ']" -> got "[' + ll.type + (value==null? '':':'+ll.value) + ']', ll.pos)
  }else{
    return ll;
  }
}

op.error = function(msg, pos){
  msg =  "Parse Error: " + msg +  ':\n' + _.trackErrorPos(this.input, typeof pos === 'number'? pos: this.ll().pos||0);
  throw new Error(msg);
}

op.next = function(k){
  k = k || 1;
  this.pos += k;
}
op.eat = function(type, value){
  var ll = this.ll();
  if(typeof type !== 'string'){
    for(var len = type.length ; len--;){
      if(ll.type === type[len]) {
        this.next();
        return ll;
      }
    }
  }else{
    if( ll.type === type && (typeof value === 'undefined' || ll.value === value) ){
       this.next();
       return ll;
    }
  }
  return false;
}

// program
//  :EOF
//  | (statement)* EOF
op.program = function(){
  var statements = [],  ll = this.ll();
  while(ll.type !== 'EOF' && ll.type !=='TAG_CLOSE'){

    statements.push(this.statement());
    ll = this.ll();
  }
  // if(ll.type === 'TAG_CLOSE') this.error("You may have unmatched Tag")
  return statements;
}

// statement
//  : xml
//  | jst
//  | text
op.statement = function(){
  var ll = this.ll();
  switch(ll.type){
    case 'NAME':
    case 'TEXT':
      var text = ll.value;
      this.next();
      while(ll = this.eat(['NAME', 'TEXT'])){
        text += ll.value;
      }
      return node.text(text);
    case 'TAG_OPEN':
      return this.xml();
    case 'OPEN': 
      return this.directive();
    case 'EXPR_OPEN':
      return this.interplation();
    case 'PART_OPEN':
      return this.template();
    default:
      this.error('Unexpected token: '+ this.la())
  }
}

// xml 
// stag statement* TAG_CLOSE?(if self-closed tag)
op.xml = function(){
  var name, attrs, children, selfClosed;
  name = this.match('TAG_OPEN').value;
  attrs = this.attrs();
  selfClosed = this.eat('/')
  this.match('>');
  if( !selfClosed && !_.isVoidTag(name) ){
    children = this.program();
    if(!this.eat('TAG_CLOSE', name)) this.error('expect </'+name+'> got'+ 'no matched closeTag')
  }
  return node.element(name, attrs, children);
}

// xentity
//  -rule(wrap attribute)
//  -attribute
//
// __example__
//  name = 1 |  
//  ng-hide |
//  on-click={{}} | 
//  {{#if name}}on-click={{xx}}{{#else}}on-tap={{}}{{/if}}

op.xentity = function(ll){
  var name = ll.value, value;
  if(ll.type === 'NAME'){
    if( this.eat("=") ) value = this.attvalue();
    return node.attribute( name, value );
  }else{
    if( name !== 'if') this.error("current version. ONLY RULE #if #else #elseif is valid in tag, the rule #" + name + ' is invalid');
    return this['if'](true);
  }

}

// stag     ::=    '<' Name (S attr)* S? '>'  
// attr    ::=     Name Eq attvalue
op.attrs = function(isAttribute){
  var eat
  if(!isAttribute){
    eat = ["NAME", "OPEN"]
  }else{
    eat = ["NAME"]
  }

  var attrs = [], ll;
  while (ll = this.eat(eat)){
    attrs.push(this.xentity( ll ))
  }
  return attrs;
}

// attvalue
//  : STRING  
//  | NAME
op.attvalue = function(){
  var ll = this.ll();
  switch(ll.type){
    case "NAME":
    case "UNQ":
    case "STRING":
      this.next();
      var value = ll.value;
      if(~value.indexOf(config.BEGIN) && ~value.indexOf(config.END)){
        var constant = true;
        var parsed = new Parser(value, { mode: 2 }).parse();
        if(parsed.length === 1 && parsed[0].type === 'expression') return parsed[0];
        var body = [];
        parsed.forEach(function(item){
          if(!item.constant) constant=false;
          // silent the mutiple inteplation
            body.push(item.body || "'" + item.text.replace(/'/g, "\\'") + "'");        
        });
        body = "[" + body.join(",") + "].join('')";
        value = node.expression(body, null, constant);
      }
      return value;
    case "EXPR_OPEN":
      return this.interplation();
    default:
      this.error('Unexpected token: '+ this.la())
  }
}


// {{#}}
op.directive = function(){
  var name = this.ll().value;
  this.next();
  if(typeof this[name] === 'function'){
    return this[name]()
  }else{
    this.error('Undefined directive['+ name +']');
  }
}

// {{}}
op.interplation = function(){
  this.match('EXPR_OPEN');
  var res = this.expression(true);
  this.match('END');
  return res;
}

// {{~}}
op.include = function(){
  var content = this.expression();
  this.match('END');
  return node.template(content);
}

// {{#if}}
op["if"] = function(tag){
  var test = this.expression();
  var consequent = [], alternate=[];

  var container = consequent;
  var statement = !tag? "statement" : "attrs";

  this.match('END');

  var ll, close;
  while( ! (close = this.eat('CLOSE')) ){
    ll = this.ll();
    if( ll.type === 'OPEN' ){
      switch( ll.value ){
        case 'else':
          container = alternate;
          this.next();
          this.match( 'END' );
          break;
        case 'elseif':
          this.next();
          alternate.push( this["if"](tag) );
          return node['if']( test, consequent, alternate );
        default:
          container.push( this[statement](true) );
      }
    }else{
      container.push(this[statement](true));
    }
  }
  // if statement not matched
  if(close.value !== "if") this.error('Unmatched if directive')
  return node["if"](test, consequent, alternate);
}


// @mark   mustache syntax have natrure dis, canot with expression
// {{#list}}
op.list = function(){
  // sequence can be a list or hash
  var sequence = this.expression(), variable, ll;
  var consequent = [], alternate=[];
  var container = consequent;

  this.match('IDENT', 'as');

  variable = this.match('IDENT').value;

  this.match('END');

  while( !(ll = this.eat('CLOSE')) ){
    if(this.eat('OPEN', 'else')){
      container =  alternate;
      this.match('END');
    }else{
      container.push(this.statement());
    }
  }
  if(ll.value !== 'list') this.error('expect ' + 'list got ' + '/' + ll.value + ' ', ll.pos );
  return node.list(sequence, variable, consequent, alternate);
}


op.expression = function(){
  var expression;
  if(this.eat('@(')){ //once bind
    expression = this.expr();
    expression.once = true;
    this.match(')')
  }else{
    expression = this.expr();
  }
  return expression;
}

op.expr = function(){
  this.depend = [];

  var buffer = this.filter()

  var body = buffer.get || buffer;
  var setbody = buffer.set;
  return node.expression(body, setbody, !this.depend.length);
}


// filter
// assign ('|' filtername[':' args]) * 
op.filter = function(){
  var left = this.assign();
  var ll = this.eat('|');
  var buffer = [], setBuffer, prefix,
    attr = "t", 
    set = left.set, get, 
    tmp = "";

  if(ll){
    if(set) setBuffer = [];

    prefix = "(function(" + attr + "){";

    do{
      tmp = attr + " = " + ctxName + "._f_('" + this.match('IDENT').value+ "' ).get.call( "+_.ctxName +"," + attr ;
      if(this.eat(':')){
        tmp +=", "+ this.arguments("|").join(",") + ");"
      }else{
        tmp += ');'
      }
      buffer.push(tmp);
      setBuffer && setBuffer.unshift( tmp.replace(" ).get.call", " ).set.call") );

    }while(ll = this.eat('|'));
    buffer.push("return " + attr );
    setBuffer && setBuffer.push("return " + attr);

    get =  prefix + buffer.join("") + "})("+left.get+")";
    // we call back to value.
    if(setBuffer){
      // change _ss__(name, _p_) to _s__(name, filterFn(_p_));
      set = set.replace(_.setName, 
        prefix + setBuffer.join("") + "})("+　_.setName　+")" );

    }
    // the set function is depend on the filter definition. if it have set method, the set will work
    return this.getset(get, set);
  }
  return left;
}

// assign
// left-hand-expr = condition
op.assign = function(){
  var left = this.condition(), ll;
  if(ll = this.eat(['=', '+=', '-=', '*=', '/=', '%='])){
    if(!left.set) this.error('invalid lefthand expression in assignment expression');
    return this.getset( left.set.replace( "," + _.setName, "," + this.condition().get ).replace("'='", "'"+ll.type+"'"), left.set);
    // return this.getset('(' + left.get + ll.type  + this.condition().get + ')', left.set);
  }
  return left;
}

// or
// or ? assign : assign
op.condition = function(){

  var test = this.or();
  if(this.eat('?')){
    return this.getset([test.get + "?", 
      this.assign().get, 
      this.match(":").type, 
      this.assign().get].join(""));
  }

  return test;
}

// and
// and && or
op.or = function(){

  var left = this.and();

  if(this.eat('||')){
    return this.getset(left.get + '||' + this.or().get);
  }

  return left;
}
// equal
// equal && and
op.and = function(){

  var left = this.equal();

  if(this.eat('&&')){
    return this.getset(left.get + '&&' + this.and().get);
  }
  return left;
}
// relation
// 
// equal == relation
// equal != relation
// equal === relation
// equal !== relation
op.equal = function(){
  var left = this.relation(), ll;
  // @perf;
  if( ll = this.eat(['==','!=', '===', '!=='])){
    return this.getset(left.get + ll.type + this.equal().get);
  }
  return left
}
// relation < additive
// relation > additive
// relation <= additive
// relation >= additive
// relation in additive
op.relation = function(){
  var left = this.additive(), ll;
  // @perf
  if(ll = (this.eat(['<', '>', '>=', '<=']) || this.eat('IDENT', 'in') )){
    return this.getset(left.get + ll.value + this.relation().get);
  }
  return left
}
// additive :
// multive
// additive + multive
// additive - multive
op.additive = function(){
  var left = this.multive() ,ll;
  if(ll= this.eat(['+','-']) ){
    return this.getset(left.get + ll.value + this.additive().get);
  }
  return left
}
// multive :
// unary
// multive * unary
// multive / unary
// multive % unary
op.multive = function(){
  var left = this.range() ,ll;
  if( ll = this.eat(['*', '/' ,'%']) ){
    return this.getset(left.get + ll.type + this.multive().get);
  }
  return left;
}

op.range = function(){
  var left = this.unary(), ll, right;

  if(ll = this.eat('..')){
    right = this.unary();
    var body = 
      "(function(start,end){var res = [],step=end>start?1:-1; for(var i = start; end>start?i <= end: i>=end; i=i+step){res.push(i); } return res })("+left.get+","+right.get+")"
    return this.getset(body);
  }

  return left;
}



// lefthand
// + unary
// - unary
// ~ unary
// ! unary
op.unary = function(){
  var ll;
  if(ll = this.eat(['+','-','~', '!'])){
    return this.getset('(' + ll.type + this.unary().get + ')') ;
  }else{
    return this.member()
  }
}

// call[lefthand] :
// member args
// member [ expression ]
// member . ident  

op.member = function(base, last, pathes, prevBase){
  var ll, path, extValue;


  var onlySimpleAccessor = false;
  if(!base){ //first
    path = this.primary();
    var type = typeof path;
    if(type === 'string'){ 
      pathes = [];
      pathes.push( path );
      last = path;
      extValue = extName + "." + path
      base = ctxName + "._sg_('" + path + "', " + varName + ", " + extName + ")";
      onlySimpleAccessor = true;
    }else{ //Primative Type
      if(path.get === 'this'){
        base = ctxName;
        pathes = ['this'];
      }else{
        pathes = null;
        base = path.get;
      }
    }
  }else{ // not first enter
    if(typeof last === 'string' && isPath( last) ){ // is valid path
      pathes.push(last);
    }else{
      if(pathes && pathes.length) this.depend.push(pathes);
      pathes = null;
    }
  }
  if(ll = this.eat(['[', '.', '('])){
    switch(ll.type){
      case '.':
          // member(object, property, computed)
        var tmpName = this.match('IDENT').value;
        prevBase = base;
        if( this.la() !== "(" ){ 
          base = ctxName + "._sg_('" + tmpName + "', " + base + ")";
        }else{
          base += "['" + tmpName + "']";
        }
        return this.member( base, tmpName, pathes,  prevBase);
      case '[':
          // member(object, property, computed)
        path = this.assign();
        prevBase = base;
        if( this.la() !== "(" ){ 
        // means function call, we need throw undefined error when call function
        // and confirm that the function call wont lose its context
          base = ctxName + "._sg_(" + path.get + ", " + base + ")";
        }else{
          base += "[" + path.get + "]";
        }
        this.match(']')
        return this.member(base, path, pathes, prevBase);
      case '(':
        // call(callee, args)
        var args = this.arguments().join(',');
        base =  base+"(" + args +")";
        this.match(')')
        return this.member(base, null, pathes);
    }
  }
  if( pathes && pathes.length ) this.depend.push( pathes );
  var res =  {get: base};
  if(last){
    res.set = ctxName + "._ss_(" + 
        (last.get? last.get : "'"+ last + "'") + 
        ","+ _.setName + ","+ 
        (prevBase?prevBase:_.varName) + 
        ", '=', "+ ( onlySimpleAccessor? 1 : 0 ) + ")";
  
  }
  return res;
}

/**
 * 
 */
op.arguments = function(end){
  end = end || ')'
  var args = [];
  do{
    if(this.la() !== end){
      args.push(this.assign().get)
    }
  }while( this.eat(','));
  return args
}


// primary :
// this 
// ident
// literal
// array
// object
// ( expression )

op.primary = function(){
  var ll = this.ll();
  switch(ll.type){
    case "{":
      return this.object();
    case "[":
      return this.array();
    case "(":
      return this.paren();
    // literal or ident
    case 'STRING':
      this.next();
      return this.getset("'" + ll.value + "'")
    case 'NUMBER':
      this.next();
      return this.getset(""+ll.value);
    case "IDENT":
      this.next();
      if(isKeyWord(ll.value)){
        return this.getset( ll.value );
      }
      return ll.value;
    default: 
      this.error('Unexpected Token: ' + ll.type);
  }
}

// object
//  {propAssign [, propAssign] * [,]}

// propAssign
//  prop : assign

// prop
//  STRING
//  IDENT
//  NUMBER

op.object = function(){
  var code = [this.match('{').type];

  var ll = this.eat( ['STRING', 'IDENT', 'NUMBER'] );
  while(ll){
    code.push("'" + ll.value + "'" + this.match(':').type);
    var get = this.assign().get;
    code.push(get);
    ll = null;
    if(this.eat(",") && (ll = this.eat(['STRING', 'IDENT', 'NUMBER'])) ) code.push(",");
  }
  code.push(this.match('}').type);
  return {get: code.join("")}
}

// array
// [ assign[,assign]*]
op.array = function(){
  var code = [this.match('[').type], item;
  if( this.eat("]") ){

     code.push("]");
  } else {
    while(item = this.assign()){
      code.push(item.get);
      if(this.eat(',')) code.push(",");
      else break;
    }
    code.push(this.match(']').type);
  }
  return {get: code.join("")};
}

// '(' expression ')'
op.paren = function(){
  this.match('(');
  var res = this.filter()
  res.get = '(' + res.get + ')';
  this.match(')');
  return res;
}

op.getset = function(get, set){
  return {
    get: get,
    set: set
  }
}



module.exports = Parser;

});
require.register("regularjs/src/helper/extend.js", function(exports, require, module){
// (c) 2010-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
// Backbone may be freely distributed under the MIT license.
// For all details and documentation:
// http://backbonejs.org

// klass: a classical JS OOP façade
// https://github.com/ded/klass
// License MIT (c) Dustin Diaz 2014
  
// inspired by backbone's extend and klass
var _ = require("../util.js"),
  fnTest = /xy/.test(function(){"xy";}) ? /\bsupr\b/:/.*/,
  isFn = function(o){return typeof o === "function"};


function wrap(k, fn, supro) {
  return function () {
    var tmp = this.supr;
    this.supr = supro[k];
    var ret = fn.apply(this, arguments);
    this.supr = tmp;
    return ret;
  }
}

function process( what, o, supro ) {
  for ( var k in o ) {
    if (o.hasOwnProperty(k)) {

      what[k] = isFn( o[k] ) && isFn( supro[k] ) && 
        fnTest.test( o[k] ) ? wrap(k, o[k], supro) : o[k];
    }
  }
}

// if the property is ["events", "data", "computed"] , we should merge them
var merged = ["events", "data", "computed"], mlen = merged.length;
module.exports = function extend(o){
  o = o || {};
  var supr = this, proto,
    supro = supr && supr.prototype || {};

  if(typeof o === 'function'){
    proto = o.prototype;
    o.implement = implement;
    o.extend = extend;
    return o;
  } 
  
  function fn() {
    supr.apply(this, arguments);
  }

  proto = _.createProto(fn, supro);

  function implement(o){
    // we need merge the merged property
    var len = mlen;
    for(;len--;){
      var prop = merged[len];
      if(o.hasOwnProperty(prop) && proto.hasOwnProperty(prop)){
        _.extend(proto[prop], o[prop], true) 
        delete o[prop];
      }
    }


    process(proto, o, supro); 
    return this;
  }



  fn.implement = implement
  fn.implement(o)
  if(supr.__after__) supr.__after__.call(fn, supr, o);
  fn.extend = extend;
  return fn;
}


});
require.register("regularjs/src/helper/shim.js", function(exports, require, module){
// shim for es5
var slice = [].slice;
var tstr = ({}).toString;

function extend(o1, o2 ){
  for(var i in o2) if( o1[i] === undefined){
    o1[i] = o2[i]
  }
}

// String proto ;
extend(String.prototype, {
  trim: function(){
    return this.replace(/^\s+|\s+$/g, '');
  }
});


// Array proto;
extend(Array.prototype, {
  indexOf: function(obj, from){
    from = from || 0;
    for (var i = from, len = this.length; i < len; i++) {
      if (this[i] === obj) return i;
    }
    return -1;
  },
  forEach: function(callback, context){
    for (var i = 0, len = this.length; i < len; i++) {
      callback.call(context, this[i], i, this);
    }
  },
  filter: function(callback, context){
    var res = [];
    for (var i = 0, length = this.length; i < length; i++) {
      var pass = callback.call(context, this[i], i, this);
      if(pass) res.push(this[i]);
    }
    return res;
  },
  map: function(callback, context){
    var res = [];
    for (var i = 0, length = this.length; i < length; i++) {
      res.push(callback.call(context, this[i], i, this));
    }
    return res;
  }
});

// Function proto;
extend(Function.prototype, {
  bind: function(context){
    var fn = this;
    var preArgs = slice.call(arguments, 1);
    return function(){
      var args = preArgs.concat(slice.call(arguments));
      return fn.apply(context, args);
    }
  }
})

// Object
extend(Object, {
  keys: function(obj){
    var keys = [];
    for(var i in obj) if(obj.hasOwnProperty(i)){
      keys.push(i);
    }
    return keys;
  } 
})

// Date
extend(Date, {
  now: function(){
    return +new Date;
  }
})
// Array
extend(Array, {
  isArray: function(arr){
    return tstr.call(arr) === "[object Array]";
  }
})

});
require.register("regularjs/src/helper/parse.js", function(exports, require, module){
var exprCache = require('../env').exprCache;
var _ = require("../util");
var Parser = require("../parser/Parser.js");
module.exports = {
  expression: function(expr, simple){
    // @TODO cache
    if( typeof expr === 'string' && ( expr = expr.trim() ) ){
      expr = exprCache.get( expr ) || exprCache.set( expr, new Parser( expr, { mode: 2, expression: true } ).expression() )
    }
    if(expr) return expr;
  },
  parse: function(template){
    return new Parser(template).parse();
  }
}


});
require.register("regularjs/src/helper/watcher.js", function(exports, require, module){
var _ = require('../util.js');
var parseExpression = require('./parse.js').expression;


function Watcher(){}

var methods = {
  $watch: function(expr, fn, options){
    var get, once, test, rlen, extra = this.__ext__; //records length
    if(!this._watchers) this._watchers = [];

    options = options || {};
    if(options === true){
       options = { deep: true }
    }
    var uid = _.uid('w_');
    if(Array.isArray(expr)){
      var tests = [];
      for(var i = 0,len = expr.length; i < len; i++){
          tests.push(this.$expression(expr[i]).get)
      }
      var prev = [];
      test = function(context){
        var equal = true;
        for(var i =0, len = tests.length; i < len; i++){
          var splice = tests[i](context, extra);
          if(!_.equals(splice, prev[i])){
             equal = false;
             prev[i] = _.clone(splice);
          }
        }
        return equal? false: prev;
      }
    }else{
      expr = this._touchExpr( parseExpression(expr) );
      get = expr.get;
      once = expr.once;
    }

    var watcher = {
      id: uid, 
      get: get, 
      fn: fn, 
      once: once, 
      force: options.force,
      test: test,
      deep: options.deep,
      last: options.sync? get(this): undefined
    }
    
    this._watchers.push( watcher );

    rlen = this._records && this._records.length;
    if(rlen) this._records[rlen-1].push(uid)
    // init state.
    if(options.init === true){
      this.$phase = 'digest';
      this._checkSingleWatch( watcher, this._watchers.length-1 );
      this.$phase = null;
    }
    return watcher;
  },
  $unwatch: function(uid){
    uid = uid.uid || uid;
    if(!this._watchers) this._watchers = [];
    if(Array.isArray(uid)){
      for(var i =0, len = uid.length; i < len; i++){
        this.$unwatch(uid[i]);
      }
    }else{
      var watchers = this._watchers, watcher, wlen;
      if(!uid || !watchers || !(wlen = watchers.length)) return;
      for(;wlen--;){
        watcher = watchers[wlen];
        if(watcher && watcher.id === uid ){
          watchers.splice(wlen, 1);
        }
      }
    }
  },
  $expression: function(value){
    return this._touchExpr(parseExpression(value))
  },
  /**
   * the whole digest loop ,just like angular, it just a dirty-check loop;
   * @param  {String} path  now regular process a pure dirty-check loop, but in parse phase, 
   *                  Regular's parser extract the dependencies, in future maybe it will change to dirty-check combine with path-aware update;
   * @return {Void}   
   */

  $digest: function(){
    if(this.$phase === 'digest' || this._mute) return;
    this.$phase = 'digest';
    var dirty = false, n =0;
    while(dirty = this._digest()){

      if((++n) > 20){ // max loop
        throw 'there may a circular dependencies reaches' 
      }
    }
    if( n > 0 && this.$emit) this.$emit("$update");
    this.$phase = null;
  },
  // private digest logic
  _digest: function(){
    // if(this.context) return this.context.$digest();
    // if(this.$emit) this.$emit('digest');
    var watchers = this._watchers;
    var dirty = false, children, watcher, watcherDirty;
    if(watchers && watchers.length){
      for(var i = 0, len = watchers.length;i < len; i++){
        watcher = watchers[i];
        watcherDirty = this._checkSingleWatch(watcher, i);
        if(watcherDirty) dirty = true;
      }
    }
    // check children's dirty.
    children = this._children;
    if(children && children.length){
      for(var m = 0, mlen = children.length; m < mlen; m++){
        if(children[m]._digest()) dirty = true;
      }
    }
    return dirty;
  },
  // check a single one watcher 
  _checkSingleWatch: function(watcher, i){
    var dirty = false;
    if(!watcher) return;
    if(watcher.test) { //multi 
      var result = watcher.test(this);
      if(result){
        dirty = true;
        watcher.fn.apply(this, result)
      }
    }else{

      var now = watcher.get(this);
      var last = watcher.last;
      var eq = true;

      if(_.typeOf( now ) === 'object' && watcher.deep){
        if(!watcher.last){
           eq = false;
         }else{
          for(var j in now){
            if(watcher.last[j] !== now[j]){
              eq = false;
              break;
            }
          }
          if(eq !== false){
            for(var n in last){
              if(last[n] !== now[n]){
                eq = false;
                break;
              }
            }
          }
        }
      }else{
        eq = _.equals(now, watcher.last);
      }
      if(eq === false || watcher.force){ // in some case. if undefined, we must force digest.
        eq = false;
        watcher.force = null;
        dirty = true;
        watcher.fn.call(this, now, watcher.last);
        if(typeof now !== 'object'|| watcher.deep){
          watcher.last = _.clone(now);
        }else{
          watcher.last = now;
        }
      }else{ // if eq == true
        if( _.typeOf(eq) === 'array' && eq.length ){
          watcher.last = _.clone(now);
          watcher.fn.call(this, now, eq);
          dirty = true;
        }else{
          eq = true;
        }
      }
      // @TODO
      if(dirty && watcher.once) this._watchers.splice(i, 1);

      return dirty;
    }
  },

  /**
   * **tips**: whatever param you passed in $update, after the function called, dirty-check(digest) phase will enter;
   * 
   * @param  {Function|String|Expression} path  
   * @param  {Whatever} value optional, when path is Function, the value is ignored
   * @return {this}     this 
   */
  $set: function(path, value){
    if(path != null){
      var type = _.typeOf(path);
      if( type === 'string' || path.type === 'expression' ){
        path = this.$expression(path);
        path.set(this, value);
      }else if(type === 'function'){
        path.call(this, this.data);
      }else{
        for(var i in path) {
          this.$set(i, path[i])
        }
      }
    }
  },
  $get: function(expr)  {
    return this.$expression(expr).get(this);
  },
  $update: function(){
    this.$set.apply(this, arguments);
    var rootParent = this;

    do{
      if(rootParent.data.isolate || !rootParent.$parent) break;
      rootParent = rootParent.$parent;
    } while(rootParent)

    rootParent.$digest();
  },
  // auto collect watchers for logic-control.
  _record: function(){
    if(!this._records) this._records = [];
    this._records.push([]);
  },
  _release: function(){
    return this._records.pop();
  }
}


_.extend(Watcher.prototype, methods)


Watcher.mixTo = function(obj){
  obj = typeof obj === "function" ? obj.prototype : obj;
  return _.extend(obj, methods)
}

module.exports = Watcher;
});
require.register("regularjs/src/helper/event.js", function(exports, require, module){
// simplest event emitter 60 lines
// ===============================
var slice = [].slice, _ = require("../util.js");
var API = {
    $on: function(event, fn) {
        if(typeof event === "object"){
            for (var i in event) {
                this.$on(i, event[i]);
            }
        }else{
            // @patch: for list
            var context = this;
            var handles = context._handles || (context._handles = {}),
                calls = handles[event] || (handles[event] = []);
            calls.push(fn);
        }
        return this;
    },
    $off: function(event, fn) {
        var context = this;
        if(!context._handles) return;
        if(!event) this._handles = {};
        var handles = context._handles,
            calls;

        if (calls = handles[event]) {
            if (!fn) {
                handles[event] = [];
                return context;
            }
            for (var i = 0, len = calls.length; i < len; i++) {
                if (fn === calls[i]) {
                    calls.splice(i, 1);
                    return context;
                }
            }
        }
        return context;
    },
    // bubble event
    $emit: function(event){
        // @patch: for list
        var context = this;
        var handles = context._handles, calls, args, type;
        if(!event) return;
        var args = slice.call(arguments, 1);
        var type = event;

        if(!handles) return context;
        if(calls = handles[type.slice(1)]){
            for (var j = 0, len = calls.length; j < len; j++) {
                calls[j].apply(context, args)
            }
        }
        if (!(calls = handles[type])) return context;
        for (var i = 0, len = calls.length; i < len; i++) {
            calls[i].apply(context, args)
        }
        // if(calls.length) context.$update();
        return context;
    },
    // capture  event
    $broadcast: function(){
        
    }
}
// container class
function Event() {
  if (arguments.length) this.$on.apply(this, arguments);
}
_.extend(Event.prototype, API)

Event.mixTo = function(obj){
  obj = typeof obj === "function" ? obj.prototype : obj;
  _.extend(obj, API)
}
module.exports = Event;
});
require.register("regularjs/src/helper/animate.js", function(exports, require, module){
var _ = require("../util");
var dom  = require("../dom.js");
var animate = {};
var env = require("../env.js");


var 
  transitionEnd = 'transitionend', 
  animationEnd = 'animationend', 
  transitionProperty = 'transition', 
  animationProperty = 'animation';

if(!('ontransitionend' in window)){
  if('onwebkittransitionend' in window) {
    
    // Chrome/Saf (+ Mobile Saf)/Android
    transitionEnd += ' webkitTransitionEnd';
    transitionProperty = 'webkitTransition'
  } else if('onotransitionend' in dom.tNode || navigator.appName === 'Opera') {

    // Opera
    transitionEnd += ' oTransitionEnd';
    transitionProperty = 'oTransition';
  }
}
if(!('onanimationend' in window)){
  if ('onwebkitanimationend' in window){
    // Chrome/Saf (+ Mobile Saf)/Android
    animationEnd += ' webkitAnimationEnd';
    animationProperty = 'webkitAnimation';

  }else if ('onoanimationend' in dom.tNode){
    // Opera
    animationEnd += ' oAnimationEnd';
    animationProperty = 'oAnimation';
  }
}

/**
 * inject node with animation
 * @param  {[type]} node      [description]
 * @param  {[type]} refer     [description]
 * @param  {[type]} direction [description]
 * @return {[type]}           [description]
 */
animate.inject = function( node, refer ,direction, callback ){
  callback = callback || _.noop;
  if( Array.isArray(node) ){
    var fragment = dom.fragment();
    var count=0;

    for(var i = 0,len = node.length;i < len; i++ ){
      fragment.appendChild(node[i]); 
    }
    dom.inject(fragment, refer, direction);

    // if all nodes is done, we call the callback
    var enterCallback = function (){
      count++;
      if( count === len ) callback();
    }
    if(len === count) callback();
    for( i = 0; i < len; i++ ){
      if(node[i].onenter){
        node[i].onenter(enterCallback);
      }else{
        enterCallback();
      }
    }
  }else{
    dom.inject( node, refer, direction );
    if(node.onenter){
      node.onenter(callback)
    }else{
      callback();
    }
  }
}

/**
 * remove node with animation
 * @param  {[type]}   node     [description]
 * @param  {Function} callback [description]
 * @return {[type]}            [description]
 */
animate.remove = function(node, callback){
  if(node.onleave){
    node.onleave(function(){
      removeDone(node, callback)
    })
  }else{
    removeDone(node, callback)
  }
}

var removeDone = function (node, callback){
    dom.remove(node);
    callback && callback();
}



animate.startClassAnimate = function ( node, className,  callback, mode ){
  var activeClassName, timeout, tid, onceAnim;
  if( (!animationEnd && !transitionEnd) || env.isRunning ){
    return callback();
  }

  onceAnim = _.once(function onAnimateEnd(){
    if(tid) clearTimeout(tid);

    if(mode === 2) {
      dom.delClass(node, activeClassName);
    }
    if(mode !== 3){ // mode hold the class
      dom.delClass(node, className);
    }
    dom.off(node, animationEnd, onceAnim)
    dom.off(node, transitionEnd, onceAnim)

    callback();

  });
  if(mode === 2){ // auto removed
    dom.addClass( node, className );

    activeClassName = className.split(/\s+/).map(function(name){
       return name + '-active';
    }).join(" ");

    dom.nextReflow(function(){
      dom.addClass( node, activeClassName );
      timeout = getMaxTimeout( node );
      tid = setTimeout( onceAnim, timeout );
    });

  }else{

    dom.nextReflow(function(){
      dom.addClass( node, className );
      timeout = getMaxTimeout( node );
      tid = setTimeout( onceAnim, timeout );
    });

  }


  dom.on( node, animationEnd, onceAnim )
  dom.on( node, transitionEnd, onceAnim )
  return onceAnim;
}


animate.startStyleAnimate = function(node, styles, callback){
  var timeout, onceAnim, tid;

  dom.nextReflow(function(){
    dom.css( node, styles );
    timeout = getMaxTimeout( node );
    tid = setTimeout( onceAnim, timeout );
  });


  onceAnim = _.once(function onAnimateEnd(){
    if(tid) clearTimeout(tid);

    dom.off(node, animationEnd, onceAnim)
    dom.off(node, transitionEnd, onceAnim)

    callback();

  });

  dom.on( node, animationEnd, onceAnim )
  dom.on( node, transitionEnd, onceAnim )

  return onceAnim;
}


/**
 * get maxtimeout
 * @param  {Node} node 
 * @return {[type]}   [description]
 */
function getMaxTimeout(node){
  var timeout = 0,
    tDuration = 0,
    tDelay = 0,
    aDuration = 0,
    aDelay = 0,
    ratio = 5 / 3,
    styles ;

  if(window.getComputedStyle){

    styles = window.getComputedStyle(node),
    tDuration = getMaxTime( styles[transitionProperty + 'Duration']) || tDuration;
    tDelay = getMaxTime( styles[transitionProperty + 'Delay']) || tDelay;
    aDuration = getMaxTime( styles[animationProperty + 'Duration']) || aDuration;
    aDelay = getMaxTime( styles[animationProperty + 'Delay']) || aDelay;
    timeout = Math.max( tDuration+tDelay, aDuration + aDelay );

  }
  return timeout * 1000 * ratio;
}

function getMaxTime(str){

  var maxTimeout = 0, time;

  if(!str) return 0;

  str.split(",").forEach(function(str){

    time = parseFloat(str);
    if( time > maxTimeout ) maxTimeout = time;

  });

  return maxTimeout;
}

module.exports = animate;
});
require.register("regularjs/src/helper/combine.js", function(exports, require, module){
// some nested  operation in ast 
// --------------------------------

var dom = require("../dom.js");

var combine = module.exports = {

  // get the initial dom in object
  node: function(item){
    var children,node;
    if(item.element) return item.element;
    if(typeof item.node === "function") return item.node();
    if(typeof item.nodeType === "number") return item;
    if(item.group) return combine.node(item.group)
    if(children = item.children){
      if(children.length === 1){
        
        return combine.node(children[0]);
      }
      var nodes = [];
      for(var i = 0, len = children.length; i < len; i++ ){
        node = combine.node(children[i]);
        if(Array.isArray(node)){
          nodes.push.apply(nodes, node)
        }else{
          nodes.push(node)
        }
      }
      return nodes;
    }
  },

  // get the last dom in object(for insertion operation)
  last: function(item){
    var children = item.children;

    if(typeof item.last === "function") return item.last();
    if(typeof item.nodeType === "number") return item;

    if(children && children.length) return combine.last(children[children.length - 1]);
    if(item.group) return combine.last(item.group);

  },

  destroy: function(item, first){
    if(!item) return;
    if(Array.isArray(item)){
      for(var i = 0, len = item.length; i < len; i++ ){
        combine.destroy(item[i], first);
      }
    }
    var children = item.children;
    if(typeof item.destroy === "function") return item.destroy(first);
    if(typeof item.nodeType === "number" && first)  dom.remove(item);
    if(children && children.length){
      combine.destroy(children, true);
      item.children = null;
    }
  }

}
});
require.register("regularjs/src/helper/entities.js", function(exports, require, module){
// http://stackoverflow.com/questions/1354064/how-to-convert-characters-to-html-entities-using-plain-javascript
var entities = {
  'quot':34, 
  'amp':38, 
  'apos':39, 
  'lt':60, 
  'gt':62, 
  'nbsp':160, 
  'iexcl':161, 
  'cent':162, 
  'pound':163, 
  'curren':164, 
  'yen':165, 
  'brvbar':166, 
  'sect':167, 
  'uml':168, 
  'copy':169, 
  'ordf':170, 
  'laquo':171, 
  'not':172, 
  'shy':173, 
  'reg':174, 
  'macr':175, 
  'deg':176, 
  'plusmn':177, 
  'sup2':178, 
  'sup3':179, 
  'acute':180, 
  'micro':181, 
  'para':182, 
  'middot':183, 
  'cedil':184, 
  'sup1':185, 
  'ordm':186, 
  'raquo':187, 
  'frac14':188, 
  'frac12':189, 
  'frac34':190, 
  'iquest':191, 
  'Agrave':192, 
  'Aacute':193, 
  'Acirc':194, 
  'Atilde':195, 
  'Auml':196, 
  'Aring':197, 
  'AElig':198, 
  'Ccedil':199, 
  'Egrave':200, 
  'Eacute':201, 
  'Ecirc':202, 
  'Euml':203, 
  'Igrave':204, 
  'Iacute':205, 
  'Icirc':206, 
  'Iuml':207, 
  'ETH':208, 
  'Ntilde':209, 
  'Ograve':210, 
  'Oacute':211, 
  'Ocirc':212, 
  'Otilde':213, 
  'Ouml':214, 
  'times':215, 
  'Oslash':216, 
  'Ugrave':217, 
  'Uacute':218, 
  'Ucirc':219, 
  'Uuml':220, 
  'Yacute':221, 
  'THORN':222, 
  'szlig':223, 
  'agrave':224, 
  'aacute':225, 
  'acirc':226, 
  'atilde':227, 
  'auml':228, 
  'aring':229, 
  'aelig':230, 
  'ccedil':231, 
  'egrave':232, 
  'eacute':233, 
  'ecirc':234, 
  'euml':235, 
  'igrave':236, 
  'iacute':237, 
  'icirc':238, 
  'iuml':239, 
  'eth':240, 
  'ntilde':241, 
  'ograve':242, 
  'oacute':243, 
  'ocirc':244, 
  'otilde':245, 
  'ouml':246, 
  'divide':247, 
  'oslash':248, 
  'ugrave':249, 
  'uacute':250, 
  'ucirc':251, 
  'uuml':252, 
  'yacute':253, 
  'thorn':254, 
  'yuml':255, 
  'fnof':402, 
  'Alpha':913, 
  'Beta':914, 
  'Gamma':915, 
  'Delta':916, 
  'Epsilon':917, 
  'Zeta':918, 
  'Eta':919, 
  'Theta':920, 
  'Iota':921, 
  'Kappa':922, 
  'Lambda':923, 
  'Mu':924, 
  'Nu':925, 
  'Xi':926, 
  'Omicron':927, 
  'Pi':928, 
  'Rho':929, 
  'Sigma':931, 
  'Tau':932, 
  'Upsilon':933, 
  'Phi':934, 
  'Chi':935, 
  'Psi':936, 
  'Omega':937, 
  'alpha':945, 
  'beta':946, 
  'gamma':947, 
  'delta':948, 
  'epsilon':949, 
  'zeta':950, 
  'eta':951, 
  'theta':952, 
  'iota':953, 
  'kappa':954, 
  'lambda':955, 
  'mu':956, 
  'nu':957, 
  'xi':958, 
  'omicron':959, 
  'pi':960, 
  'rho':961, 
  'sigmaf':962, 
  'sigma':963, 
  'tau':964, 
  'upsilon':965, 
  'phi':966, 
  'chi':967, 
  'psi':968, 
  'omega':969, 
  'thetasym':977, 
  'upsih':978, 
  'piv':982, 
  'bull':8226, 
  'hellip':8230, 
  'prime':8242, 
  'Prime':8243, 
  'oline':8254, 
  'frasl':8260, 
  'weierp':8472, 
  'image':8465, 
  'real':8476, 
  'trade':8482, 
  'alefsym':8501, 
  'larr':8592, 
  'uarr':8593, 
  'rarr':8594, 
  'darr':8595, 
  'harr':8596, 
  'crarr':8629, 
  'lArr':8656, 
  'uArr':8657, 
  'rArr':8658, 
  'dArr':8659, 
  'hArr':8660, 
  'forall':8704, 
  'part':8706, 
  'exist':8707, 
  'empty':8709, 
  'nabla':8711, 
  'isin':8712, 
  'notin':8713, 
  'ni':8715, 
  'prod':8719, 
  'sum':8721, 
  'minus':8722, 
  'lowast':8727, 
  'radic':8730, 
  'prop':8733, 
  'infin':8734, 
  'ang':8736, 
  'and':8743, 
  'or':8744, 
  'cap':8745, 
  'cup':8746, 
  'int':8747, 
  'there4':8756, 
  'sim':8764, 
  'cong':8773, 
  'asymp':8776, 
  'ne':8800, 
  'equiv':8801, 
  'le':8804, 
  'ge':8805, 
  'sub':8834, 
  'sup':8835, 
  'nsub':8836, 
  'sube':8838, 
  'supe':8839, 
  'oplus':8853, 
  'otimes':8855, 
  'perp':8869, 
  'sdot':8901, 
  'lceil':8968, 
  'rceil':8969, 
  'lfloor':8970, 
  'rfloor':8971, 
  'lang':9001, 
  'rang':9002, 
  'loz':9674, 
  'spades':9824, 
  'clubs':9827, 
  'hearts':9829, 
  'diams':9830, 
  'OElig':338, 
  'oelig':339, 
  'Scaron':352, 
  'scaron':353, 
  'Yuml':376, 
  'circ':710, 
  'tilde':732, 
  'ensp':8194, 
  'emsp':8195, 
  'thinsp':8201, 
  'zwnj':8204, 
  'zwj':8205, 
  'lrm':8206, 
  'rlm':8207, 
  'ndash':8211, 
  'mdash':8212, 
  'lsquo':8216, 
  'rsquo':8217, 
  'sbquo':8218, 
  'ldquo':8220, 
  'rdquo':8221, 
  'bdquo':8222, 
  'dagger':8224, 
  'Dagger':8225, 
  'permil':8240, 
  'lsaquo':8249, 
  'rsaquo':8250, 
  'euro':8364
}



module.exports  = entities;
});
require.register("regularjs/src/helper/filter.js", function(exports, require, module){

var f = module.exports = {};

// json:  two way 
//  - get: JSON.stringify
//  - set: JSON.parse
//  - example: `{ title|json }`
f.json = {
  get: function( value ){
    return typeof JSON !== 'undefined'? JSON.stringify(value): value;
  },
  set: function( value ){
    return typeof JSON !== 'undefined'? JSON.parse(value) : value;
  }
}

// last: one-way
//  - get: return the last item in list
//  - example: `{ list|last }`
f.last = function(arr){
  return arr && arr[arr.length - 1];
}

// average: one-way
//  - get: copute the average of the list
//  - example: `{ list| average: "score" }`
f.average = function(array, key){
  array = array || [];
  return array.length? f.total(array, key)/ array.length : 0;
}


// total: one-way
//  - get: copute the total of the list
//  - example: `{ list| average: "score" }`
f.total = function(array, key){
  var total = 0;
  if(!array) return;
  array.forEach(function( item ){
    total += key? item[key] : item;
  })
  return total;
}

// var basicSortFn = function(a, b){return b - a}

// f.sort = function(array, key, reverse){
//   var type = typeof key, sortFn; 
//   switch(type){
//     case 'function': sortFn = key; break;
//     case 'string': sortFn = function(a, b){};break;
//     default:
//       sortFn = basicSortFn;
//   }
//   // need other refernce.
//   return array.slice().sort(function(a,b){
//     return reverse? -sortFn(a, b): sortFn(a, b);
//   })
//   return array
// }



});
require.register("regularjs/src/directive/base.js", function(exports, require, module){
// Regular
var _ = require("../util.js");
var dom = require("../dom.js");
var animate = require("../helper/animate.js");
var Regular = require("../Regular.js");



require("./event.js");
require("./form.js");


// **warn**: class inteplation will override this directive 

Regular.directive('r-class', function(elem, value){
  this.$watch(value, function(nvalue){
    var className = ' '+ elem.className.replace(/\s+/g, ' ') +' ';
    for(var i in nvalue) if(nvalue.hasOwnProperty(i)){
      className = className.replace(' ' + i + ' ',' ');
      if(nvalue[i] === true){
        className += i+' ';
      }
    }
    elem.className = className.trim();
  },true);

});

// **warn**: style inteplation will override this directive 

Regular.directive('r-style', function(elem, value){
  this.$watch(value, function(nvalue){
    for(var i in nvalue) if(nvalue.hasOwnProperty(i)){
      dom.css(elem, i, nvalue[i]);
    }
  },true);
});

// when expression is evaluate to true, the elem will add display:none
// Example: <div r-hide={{items.length > 0}}></div>

Regular.directive('r-hide', function(elem, value){
  var preBool = null, compelete;
  this.$watch(value, function(nvalue){
    var bool = !!nvalue;
    if(bool === preBool) return; 
    preBool = bool;
    if(bool){
      if(elem.onleave){
        compelete = elem.onleave(function(){
          elem.style.display = "none"
          compelete = null;
        })
      }else{
        elem.style.display = "none"
      }
      
    }else{
      if(compelete) compelete();
      elem.style.display = "";
      if(elem.onenter){
        elem.onenter();
      }
    }
  });

});

// unescaped inteplation. xss is not be protect
Regular.directive('r-html', function(elem, value){
  this.$watch(value, function(nvalue){
    nvalue = nvalue || "";
    dom.html(elem, nvalue)
  }, {force: true});
});










});
require.register("regularjs/src/directive/form.js", function(exports, require, module){
// Regular
var _ = require("../util.js");
var dom = require("../dom.js");
var Regular = require("../Regular.js");

var modelHandlers = {
  "text": initText,
  "select": initSelect,
  "checkbox": initCheckBox,
  "radio": initRadio
}


// @TODO


// two-way binding with r-model
// works on input, textarea, checkbox, radio, select

Regular.directive("r-model", function(elem, value){
  var tag = elem.tagName.toLowerCase();
  var sign = tag;
  if(sign === "input") sign = elem.type || "text";
  else if(sign === "textarea") sign = "text";
  if(typeof value === "string") value = this.$expression(value);

  if( modelHandlers[sign] ) return modelHandlers[sign].call(this, elem, value);
  else if(tag === "input"){
    return modelHandlers.text.call(this, elem, value);
  }
});



// binding <select>

function initSelect( elem, parsed){
  var self = this;
  var wc =this.$watch(parsed, function(newValue){
    var children = _.slice(elem.getElementsByTagName('option'))
    children.forEach(function(node, index){
      if(node.value == newValue){
        elem.selectedIndex = index;
      }
    })
  });

  function handler(){
    parsed.set(self, this.value);
    wc.last = this.value;
    self.$update();
  }

  dom.on(elem, "change", handler);
  
  if(parsed.get(self) === undefined && elem.value){
     parsed.set(self, elem.value);
  }
  return function destroy(){
    dom.off(elem, "change", handler);
  }
}

// input,textarea binding

function initText(elem, parsed){
  var self = this;
  var wc = this.$watch(parsed, function(newValue){
    if(elem.value !== newValue) elem.value = newValue == null? "": "" + newValue;
  });

  // @TODO to fixed event
  var handler = function handler(ev){
    var that = this;
    if(ev.type==='cut' || ev.type==='paste'){
      _.nextTick(function(){
        var value = that.value
        parsed.set(self, value);
        wc.last = value;
        self.$update();
      })
    }else{
        var value = that.value
        parsed.set(self, value);
        wc.last = value;
        self.$update();
    }
  };

  if(dom.msie !== 9 && "oninput" in dom.tNode ){
    elem.addEventListener("input", handler );
  }else{
    dom.on(elem, "paste", handler)
    dom.on(elem, "keyup", handler)
    dom.on(elem, "cut", handler)
    dom.on(elem, "change", handler)
  }
  if(parsed.get(self) === undefined && elem.value){
     parsed.set(self, elem.value);
  }
  return function destroy(){
    if(dom.msie !== 9 && "oninput" in dom.tNode ){
      elem.removeEventListener("input", handler );
    }else{
      dom.off(elem, "paste", handler)
      dom.off(elem, "keyup", handler)
      dom.off(elem, "cut", handler)
      dom.off(elem, "change", handler)
    }
  }
}


// input:checkbox  binding

function initCheckBox(elem, parsed){
  var self = this;
  var watcher = this.$watch(parsed, function(newValue){
    dom.attr(elem, 'checked', !!newValue);
  });

  var handler = function handler(){
    var value = this.checked;
    parsed.set(self, value);
    watcher.last = value;
    self.$update();
  }
  if(parsed.set) dom.on(elem, "change", handler)

  if(parsed.get(self) === undefined){
    parsed.set(self, !!elem.checked);
  }

  return function destroy(){
    if(parsed.set) dom.off(elem, "change", handler)
  }
}


// input:radio binding

function initRadio(elem, parsed){
  var self = this;
  var wc = this.$watch(parsed, function( newValue ){
    if(newValue == elem.value) elem.checked = true;
    else elem.checked = false;
  });


  var handler = function handler(){
    var value = this.value;
    parsed.set(self, value);
    self.$update();
  }
  if(parsed.set) dom.on(elem, "change", handler)
  // beacuse only after compile(init), the dom structrue is exsit. 
  if(parsed.get(self) === undefined){
    if(elem.checked) {
      parsed.set(self, elem.value);
    }
  }

  return function destroy(){
    if(parsed.set) dom.off(elem, "change", handler)
  }
}

});
require.register("regularjs/src/directive/animation.js", function(exports, require, module){
var // packages
  _ = require("../util.js"),
 animate = require("../helper/animate.js"),
 dom = require("../dom.js"),
 Regular = require("../Regular.js");


var // variables
  rClassName = /^[-\w]+(\s[-\w]+)*$/,
  rCommaSep = /[\r\n\f ]*,[\r\n\f ]*(?=\w+\:)/, //  dont split comma in  Expression
  rStyles = /^\{.*\}$/, //  for Simpilfy
  rSpace = /\s+/, //  for Simpilfy
  WHEN_COMMAND = "when",
  EVENT_COMMAND = "on",
  THEN_COMMAND = "then";

/**
 * Animation Plugin
 * @param {Component} Component 
 */


function createSeed(type){

  var steps = [], current = 0, callback = _.noop;
  var key;

  var out = {
    type: type,
    start: function(cb){
      key = _.uid();
      if(typeof cb === "function") callback = cb;
      if(current> 0 ){
        current = 0 ;
      }else{
        out.step();
      }
      return out.compelete;
    },
    compelete: function(){
      key = null;
      callback && callback();
      callback = _.noop;
      current = 0;
    },
    step: function(){
      if(steps[current]) steps[current ]( out.done.bind(out, key) );
    },
    done: function(pkey){
      if(pkey !== key) return; // means the loop is down
      if( current < steps.length - 1 ) {
        current++;
        out.step();
      }else{
        out.compelete();
      }
    },
    push: function(step){
      steps.push(step)
    }
  }

  return out;
}

Regular._addProtoInheritCache("animation")


// builtin animation
Regular.animation({
  "wait": function( step ){
    var timeout = parseInt( step.param ) || 0
    return function(done){
      // _.log("delay " + timeout)
      setTimeout( done, timeout );
    }
  },
  "class": function(step){
    var tmp = step.param.split(","),
      className = tmp[0] || "",
      mode = parseInt(tmp[1]) || 1;

    return function(done){
      // _.log(className)
      animate.startClassAnimate( step.element, className , done, mode );
    }
  },
  "call": function(step){
    var fn = this.$expression(step.param).get, self = this;
    return function(done){
      // _.log(step.param, 'call')
      fn(self);
      self.$update();
      done()
    }
  },
  "emit": function(step){
    var param = step.param;
    var tmp = param.split(","),
      evt = tmp[0] || "",
      args = tmp[1]? this.$expression(tmp[1]).get: null;

    if(!evt) throw "you shoud specified a eventname in emit command";

    var self = this;
    return function(done){
      self.$emit(evt, args? args(self) : undefined);
      done();
    }
  },
  // style: left {10}px,
  style: function(step){
    var styles = {}, 
      param = step.param,
      pairs = param.split(","), valid;
    pairs.forEach(function(pair){
      pair = pair.trim();
      if(pair){
        var tmp = pair.split( rSpace ),
          name = tmp.shift(),
          value = tmp.join(" ");

        if( !name || !value ) throw "invalid style in command: style";
        styles[name] = value;
        valid = true;
      }
    })

    return function(done){
      if(valid){
        animate.startStyleAnimate(step.element, styles, done);
      }else{
        done();
      }
    }
  }
})



// hancdle the r-animation directive
// el : the element to process
// value: the directive value
function processAnimate( element, value ){
  value = value.trim();

  var composites = value.split(";"), 
    composite, context = this, seeds = [], seed, destroies = [], destroy,
    command, param , current = 0, tmp, animator, self = this;

  function reset( type ){
    seed && seeds.push( seed )
    seed = createSeed( type );
  }

  function whenCallback(start, value){
    if( !!value ) start()
  }

  function animationDestroy(element){
    return function(){
      delete element.onenter;
      delete element.onleave;
    } 
  }

  for( var i = 0, len = composites.length; i < len; i++ ){

    composite = composites[i];
    tmp = composite.split(":");
    command = tmp[0] && tmp[0].trim();
    param = tmp[1] && tmp[1].trim();

    if( !command ) continue;

    if( command === WHEN_COMMAND ){
      reset("when");
      this.$watch(param, whenCallback.bind( this, seed.start ) );
      continue;
    }

    if( command === EVENT_COMMAND){
      reset(param);
      if( param === "leave" ){
        element.onleave = seed.start;
        destroies.push( animationDestroy(element) );
      }else if( param === "enter" ){
        element.onenter = seed.start;
        destroies.push( animationDestroy(element) );
      }else{
        if( ("on" + param) in element){ // if dom have the event , we use dom event
          destroies.push(this._handleEvent( element, param, seed.start ));
        }else{ // otherwise, we use component event
          this.$on(param, seed.start);
          destroies.push(this.$off.bind(this, param, seed.start));
        }
      }
      continue
    }

    var animator =  Regular.animation(command) 
    if( animator && seed ){
      seed.push(
        animator.call(this,{
          element: element,
          done: seed.done,
          param: param 
        })
      )
    }else{
      throw "you need start with `on` or `event` in r-animation";
    }
  }

  if(destroies.length){
    return function(){
      destroies.forEach(function(destroy){
        destroy();
      })
    }
  }
}


Regular.directive( "r-animation", processAnimate)
Regular.directive( "r-sequence", processAnimate)


});
require.register("regularjs/src/directive/event.js", function(exports, require, module){
/**
 * event directive  bundle
 *
 */
var _ = require("../util.js");
var dom = require("../dom.js");
var Regular = require("../Regular.js");

Regular._addProtoInheritCache("event");

Regular.event("enter", function(elem, fire) {
  _.log("on-enter will be removed in 0.4.0", "error");
  function update( ev ) {
    if ( ev.which === 13 ) {
      ev.preventDefault();
      fire(ev);
    }
  }
  dom.on( elem, "keypress", update );

  return function() {
    dom.off( elem, "keypress", update );
  }
})


Regular.directive( /^on-\w+$/, function( elem, value, name , attrs) {
  if ( !name || !value ) return;
  var type = name.split("-")[1];
  return this._handleEvent( elem, type, value, attrs );
});
// TODO.
/**
- $('dx').delegate()
*/
Regular.directive( /^delegate-\w+$/, function( elem, value, name, attrs ) {
  var root = this.$root;
  var _delegates = root._delegates || ( root._delegates = {} );
  if ( !name || !value ) return;
  var type = name.split("-")[1];
  var fire = _.handleEvent.call(this, value, type);

  function delegateEvent(ev){
    matchParent(ev, _delegates[type]);
  }

  if( !_delegates[type] ){
    _delegates[type] = [];

    root.$on( "$inject", function( newParent ){
      var preParent = this.parentNode;
      if( preParent ){
        dom.off(preParent, type, delegateEvent);
      }
      dom.on(newParent, type, delegateEvent);
    })

    root.$on("$destroy", function(){
      if(root.parentNode) dom.off(root.parentNode, type, delegateEvent)
      root._delegates[type] = null;
    })
  }
  var delegate = {
    element: elem,
    fire: fire
  }
  _delegates[type].push( delegate );

  return function(){
    var delegates = _delegates[type];
    if(!delegates || !delegates.length) return;
    for( var i = 0, len = delegates.length; i < len; i++ ){
      if( delegates[i] === delegate ) delegates.splice(i, 1);
    }
  }

});


function matchParent(ev , delegates){
  var target = ev.target;
  while(target && target !== dom.doc){
    for( var i = 0, len = delegates.length; i < len; i++ ){
      if(delegates[i].element === target){
        delegates[i].fire(ev);
      }
    }
    target = target.parentNode;
  }
}
});
require.register("regularjs/src/module/timeout.js", function(exports, require, module){
var Regular = require("../Regular.js");

/**
 * Timeout Module
 * @param {Component} Component 
 */
function TimeoutModule(Component){

  Component.implement({
    /**
     * just like setTimeout, but will enter digest automately
     * @param  {Function} fn    
     * @param  {Number}   delay 
     * @return {Number}   timeoutid
     */
    $timeout: function(fn, delay){
      delay = delay || 0;
      return setTimeout(function(){
        fn.call(this);
        this.$update(); //enter digest
      }.bind(this), delay);
    },
    /**
     * just like setInterval, but will enter digest automately
     * @param  {Function} fn    
     * @param  {Number}   interval 
     * @return {Number}   intervalid
     */
    $interval: function(fn, interval){
      interval = interval || 1000/60;
      return setInterval(function(){
        fn.call(this);
        this.$update(); //enter digest
      }.bind(this), interval);
    }
  });
}


Regular.plugin('timeout', TimeoutModule);
Regular.plugin('$timeout', TimeoutModule);
});
require.alias("regularjs/src/index.js", "regularjs/index.js");
if (typeof exports == 'object') {
  module.exports = require('regularjs');
} else if (typeof define == 'function' && define.amd) {
  define(function(){ return require('regularjs'); });
} else {
  window['Regular'] = require('regularjs');
}})();
I$(644,function (NEJ,_e,_p,_o,_f,_r){
	/**
	 * 关联file的label点击事件
	 * @return {Void}
	 */
	_p.__handleFileLabelClick = function(){
		//do nothing
	};

	return _p;
});
I$(609,function(b1482406245261,_v,_h,_p,_o,_f,_r){if (b1482406245261._$KERNEL.engine==='gecko'){I$(645,function (){
		/**
		 * 关联file的label点击事件
		 * @return {Void}
		 */
	    _h.__handleFileLabelClick = (function(){
	    	var _doLabelClick = function(_event){
	            _v._$stop(_event);
	            _v._$getElement(_event,'t:label').control.click();
	        };
	    	return function(_label){
		    	_v._$addEvent(
		    		_label,'click',_doLabelClick
		    	);
		    };
	    })();
	});}return _h;},78,3,644);
I$(516,function (NEJ,_e,_v,_u,_h,_x,_p,_o,_f,_r){
    var _cache = {},// {id:{lab:'label',pid:'parent'}}
        _class = _e._$pushCSSText('.#<uispace>{position:absolute;width:0;height:0;overflow:hidden;}');
    /**
     * 文件选择按钮封装
     *
     * 结构举例
     * ```html
     * <p>
     *   <!-- 必须为LABEL标签 -->
     *   <label id="abc">选择文件</label>
     * </p>
     * ```
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/file/select'
     * ],function(_e){
     *     // 绑定文件选择按钮
     *     var _id = _e._$bind('abc',{
     *         multiple:true,
     *         onchange:function(_event){
     *             // _event.form
     *             // _event.id
     *             // 如果要删除某个文件选择节点必须使用以下接口
     *             _e._$remove(_event.id);
     *         }
     *     });
     * });
     * ```
     *
     * @method   module:util/file/select._$bind
     * @param    {String|Node} arg0     - 绑定选择文件的节点，必须为label节点，且未设置for属性
     * @param    {Object}      arg1     - 配置参数
     * @property {String|Node} form     - 文件选择控件所在的表单，默认全新生成一个
     * @property {String|Node} parent   - 如果新生成form表单则可以指定表单容器节点，默认为document.body
     * @property {String}      name     - 单个文件选择支持指定提交时文件名称
     * @property {String}      clazz    - 表单样式名称，可用于控制表单位置
     * @property {Boolean}     multiple - 是否允许多选，默认单选
     * @property {String}      accept   - 文件类型过滤，如image/*或者.png，多个类型用逗号分隔
     * @property {Object}      param    - 参数集合，以input.hidden的形式放置在form中提交
     * @property {Function}    onchange - 文件选择变化触发回调，{form:form,id:'xxx'}，
     *                                    form - 文件选择控件封装表单对象，
     *                                    id   - 当前变化的文件选择控件的ID
     */
    /**
     * @method CHAINABLE._$bind
     * @see module:util/file/select._$bind
     */
    _p._$bind = (function(){
        // init cache
        var _doInitCache = function(_id){
            var _cch = _cache[_id];
            if (!_cch){
                _cch = {};
                _cache[_id] = _cch;
            }
            return _cch;
        };
        // init param
        var _doInitParam = function(_form,_param){
            if (!_param) return;
            var _arr = [];
            _u._$loop(_param,function(_value,_key){
                _arr.push('<input type="hidden" name="'+_key+'" value="'+_value+'">');
            });
            _form.insertAdjacentHTML('afterBegin',_arr.join(''));
        };
        // build parent
        var _doBuildParent = function(_id,_form,_clazz,_param,_fbox){
            var _parent,
                _cch = _cache[_id],
                _cls = _class+' '+(_clazz||'');
            _form = _e._$get(_form);
            if (!!_form){
                _parent = _e._$create('div',_cls);
                _form.appendChild(_parent);
                _e._$dataset(_form,'id',_id);
                _doInitParam(_form,_param);
            }else{
                _parent = _e._$create('form',_cls);
                _e._$dataset(_parent,'id',_id);
                _doInitParam(_parent,_param);
                (_fbox||document.body).appendChild(_parent);
            }
            _cch.pid = _e._$id(_parent);
        };
        var _doAppendFile = function(_id,_cch){
            var _accept = _cch.accept||'';
            if (!!_accept){
                _accept = 'accept="'+_accept+'"';
            }
            var _multiple = '';
            if (!!_cch.multiple){
                _multiple = 'multiple="true"';
            }
            var _cch = _cache[_id],
                _fid = _id+"-"+_cch.nmb,
                _file = _e._$html2node('<input type="file" '+_multiple+' '+_accept+' contenteditable="false" id="'+_fid+'"/>');
            _cch.nmb++;
            _e._$get(_cch.pid).appendChild(_file);
            _v._$addEvent(_file,'change',_onFileChange);
            return _fid;
        };
        // file select
        var _onFileChange = function(_event){
            var _element = _v._$getElement(_event),
                _id = _element.id,
                _arr = _id.split('-'),
                _cch = _cache[_arr[0]];
            if (!_element.value) return;
            if (_cch.multiple){
                _e._$get(_cch.lab).htmlFor =
                    _doAppendFile(_arr[0],_cch);
            }
            if (!_element.name){
                var _sufix = '';//!_cch.multiple?'':('-'+(_cch.nmb-2));
                _element.name = _cch.name+_sufix;
            }
            _cch.onchange({
                id:_id,
                form:_element.form,
                target:_e._$get(_cch.lab)
            });
        };
        return function(_element,_options){
            _element = _e._$get(_element);
            if (!_element||
                 _element.tagName!='LABEL') return;
            _e._$dumpCSSText();
            var _id = _u._$uniqueID(),
                _cch = _doInitCache(_id);
            _options = _options||_o;
            _doBuildParent(
                _id,
                _options.form,
                _options.clazz,
                _options.param,
                _e._$get(_options.parent)
            );
            _cch.nmb = 0;
            _cch.name = _options.name||'file';
            _cch.lab = _e._$id(_element);
            _cch.accept = _options.accept||'';
            _cch.multiple = !!_options.multiple;
            _cch.onchange = _options.onchange||_f;
            _element.htmlFor =
                _doAppendFile(_id,_cch);
            _h.__handleFileLabelClick(_element);
            return _id;
        };
    })();
    /**
     * 根据ID取选中文件的form表单
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/file/select'
     * ],function(_e){
     *     // 取文件绑定的表单节点
     *     var _form = _e._$get(_id);
     * });
     * ```
     *
     * @method module:util/file/select._$get
     * @see    module:util/file/select._$file
     * @param  {String} arg0 - 标识
     * @return {Node}          表单节点
     */
    _p._$get = function(_id){
        var _conf = _cache[_id];
        if (!_conf) return;
        var _form = _e._$get(_conf.pid);
        if (!_form) return;
        if (_form.tagName!='FORM'){
            _form = _form.parentNode;
        }
        return _form;
    };
    /**
     * 根据ID删除选中文件的form表单
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/file/select'
     * ],function(_e){
     *     // 解绑文件选择按钮
     *     _e._$unbind(_id);
     * });
     * ```
     *
     * @method module:util/file/select._$unbind
     * @see    module:util/file/select._$file
     * @param  {String} arg0 - 标识
     * @return {Void}
     */
    _p._$unbind = function(_id){
        var _conf = _cache[_id];
        if (!!_conf){
            _e._$remove(_conf.pid);
            delete _cache[_id];
        }
    };
    // for chainable method
    _x._$merge({_$bind:_p._$bind});

    if (CMPT){
        var _x = NEJ.P('nej.e');
        _x._$file = _p._$bind;
        _x._$getFileForm = _p._$get;
        _x._$removeFileForm = _p._$unbind;
    }

    return _p;
},215,4,3,2,609,217);
/*! JSON v3.2.5 | http://bestiejs.github.io/json3 | Copyright 2012-2013, Kit Cambridge | http://kit.mit-license.org */
;(function(){var o=!0,w=null;
(function(B){function v(a){if("bug-string-char-index"==a)return"a"!="a"[0];var f,c="json"==a;if(c||"json-stringify"==a||"json-parse"==a){if("json-stringify"==a||c){var d=k.stringify,b="function"==typeof d&&l;if(b){(f=function(){return 1}).toJSON=f;try{b="0"===d(0)&&"0"===d(new Number)&&'""'==d(new String)&&d(m)===r&&d(r)===r&&d()===r&&"1"===d(f)&&"[1]"==d([f])&&"[null]"==d([r])&&"null"==d(w)&&"[null,null,null]"==d([r,m,w])&&'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==d({a:[f,o,!1,w,"\x00\u0008\n\u000c\r\t"]})&&
"1"===d(w,f)&&"[\n 1,\n 2\n]"==d([1,2],w,1)&&'"-271821-04-20T00:00:00.000Z"'==d(new Date(-864E13))&&'"+275760-09-13T00:00:00.000Z"'==d(new Date(864E13))&&'"-000001-01-01T00:00:00.000Z"'==d(new Date(-621987552E5))&&'"1969-12-31T23:59:59.999Z"'==d(new Date(-1))}catch(n){b=!1}}if(!c)return b}if("json-parse"==a||c){a=k.parse;if("function"==typeof a)try{if(0===a("0")&&!a(!1)){f=a('{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}');var e=5==f.a.length&&1===f.a[0];if(e){try{e=!a('"\t"')}catch(g){}if(e)try{e=
1!==a("01")}catch(i){}}}}catch(O){e=!1}if(!c)return e}return b&&e}}var m={}.toString,p,C,r,D=typeof define==="function"&&define.amd,k="object"==typeof exports&&exports;k||D?"object"==typeof JSON&&JSON?k?(k.stringify=JSON.stringify,k.parse=JSON.parse):k=JSON:D&&(k=B.JSON={}):k=B.JSON||(B.JSON={});var l=new Date(-3509827334573292);try{l=-109252==l.getUTCFullYear()&&0===l.getUTCMonth()&&1===l.getUTCDate()&&10==l.getUTCHours()&&37==l.getUTCMinutes()&&6==l.getUTCSeconds()&&708==l.getUTCMilliseconds()}catch(P){}if(!v("json")){var s=
v("bug-string-char-index");if(!l)var t=Math.floor,J=[0,31,59,90,120,151,181,212,243,273,304,334],z=function(a,f){return J[f]+365*(a-1970)+t((a-1969+(f=+(f>1)))/4)-t((a-1901+f)/100)+t((a-1601+f)/400)};if(!(p={}.hasOwnProperty))p=function(a){var f={},c;if((f.__proto__=w,f.__proto__={toString:1},f).toString!=m)p=function(a){var f=this.__proto__,a=a in(this.__proto__=w,this);this.__proto__=f;return a};else{c=f.constructor;p=function(a){var f=(this.constructor||c).prototype;return a in this&&!(a in f&&
this[a]===f[a])}}f=w;return p.call(this,a)};var K={"boolean":1,number:1,string:1,undefined:1};C=function(a,f){var c=0,b,h,n;(b=function(){this.valueOf=0}).prototype.valueOf=0;h=new b;for(n in h)p.call(h,n)&&c++;b=h=w;if(c)c=c==2?function(a,f){var c={},b=m.call(a)=="[object Function]",d;for(d in a)!(b&&d=="prototype")&&!p.call(c,d)&&(c[d]=1)&&p.call(a,d)&&f(d)}:function(a,f){var c=m.call(a)=="[object Function]",b,d;for(b in a)!(c&&b=="prototype")&&p.call(a,b)&&!(d=b==="constructor")&&f(b);(d||p.call(a,
b="constructor"))&&f(b)};else{h=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"];c=function(a,f){var c=m.call(a)=="[object Function]",b,d;if(d=!c)if(d=typeof a.constructor!="function"){d=typeof a.hasOwnProperty;d=d=="object"?!!a.hasOwnProperty:!K[d]}d=d?a.hasOwnProperty:p;for(b in a)!(c&&b=="prototype")&&d.call(a,b)&&f(b);for(c=h.length;b=h[--c];d.call(a,b)&&f(b));}}c(a,f)};if(!v("json-stringify")){var L={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",
10:"\\n",13:"\\r",9:"\\t"},u=function(a,f){return("000000"+(f||0)).slice(-a)},G=function(a){var f='"',b=0,d=a.length,h=d>10&&s,n;for(h&&(n=a.split(""));b<d;b++){var e=a.charCodeAt(b);switch(e){case 8:case 9:case 10:case 12:case 13:case 34:case 92:f=f+L[e];break;default:if(e<32){f=f+("\\u00"+u(2,e.toString(16)));break}f=f+(h?n[b]:s?a.charAt(b):a[b])}}return f+'"'},E=function(a,b,c,d,h,n,e){var g=b[a],i,j,k,l,q,s,v,x,y;try{g=b[a]}catch(A){}if(typeof g=="object"&&g){i=m.call(g);if(i=="[object Date]"&&
!p.call(g,"toJSON"))if(g>-1/0&&g<1/0){if(z){k=t(g/864E5);for(i=t(k/365.2425)+1970-1;z(i+1,0)<=k;i++);for(j=t((k-z(i,0))/30.42);z(i,j+1)<=k;j++);k=1+k-z(i,j);l=(g%864E5+864E5)%864E5;q=t(l/36E5)%24;s=t(l/6E4)%60;v=t(l/1E3)%60;l=l%1E3}else{i=g.getUTCFullYear();j=g.getUTCMonth();k=g.getUTCDate();q=g.getUTCHours();s=g.getUTCMinutes();v=g.getUTCSeconds();l=g.getUTCMilliseconds()}g=(i<=0||i>=1E4?(i<0?"-":"+")+u(6,i<0?-i:i):u(4,i))+"-"+u(2,j+1)+"-"+u(2,k)+"T"+u(2,q)+":"+u(2,s)+":"+u(2,v)+"."+u(3,l)+"Z"}else g=
w;else if(typeof g.toJSON=="function"&&(i!="[object Number]"&&i!="[object String]"&&i!="[object Array]"||p.call(g,"toJSON")))g=g.toJSON(a)}c&&(g=c.call(b,a,g));if(g===w)return"null";i=m.call(g);if(i=="[object Boolean]")return""+g;if(i=="[object Number]")return g>-1/0&&g<1/0?""+g:"null";if(i=="[object String]")return G(""+g);if(typeof g=="object"){for(a=e.length;a--;)if(e[a]===g)throw TypeError();e.push(g);x=[];b=n;n=n+h;if(i=="[object Array]"){j=0;for(a=g.length;j<a;y||(y=o),j++){i=E(j,g,c,d,h,n,
e);x.push(i===r?"null":i)}a=y?h?"[\n"+n+x.join(",\n"+n)+"\n"+b+"]":"["+x.join(",")+"]":"[]"}else{C(d||g,function(a){var b=E(a,g,c,d,h,n,e);b!==r&&x.push(G(a)+":"+(h?" ":"")+b);y||(y=o)});a=y?h?"{\n"+n+x.join(",\n"+n)+"\n"+b+"}":"{"+x.join(",")+"}":"{}"}e.pop();return a}};k.stringify=function(a,b,c){var d,h,j;if(typeof b=="function"||typeof b=="object"&&b)if(m.call(b)=="[object Function]")h=b;else if(m.call(b)=="[object Array]"){j={};for(var e=0,g=b.length,i;e<g;i=b[e++],(m.call(i)=="[object String]"||
m.call(i)=="[object Number]")&&(j[i]=1));}if(c)if(m.call(c)=="[object Number]"){if((c=c-c%1)>0){d="";for(c>10&&(c=10);d.length<c;d=d+" ");}}else m.call(c)=="[object String]"&&(d=c.length<=10?c:c.slice(0,10));return E("",(i={},i[""]=a,i),h,j,d,"",[])}}if(!v("json-parse")){var M=String.fromCharCode,N={92:"\\",34:'"',47:"/",98:"\u0008",116:"\t",110:"\n",102:"\u000c",114:"\r"},b,A,j=function(){b=A=w;throw SyntaxError();},q=function(){for(var a=A,f=a.length,c,d,h,k,e;b<f;){e=a.charCodeAt(b);switch(e){case 9:case 10:case 13:case 32:b++;
break;case 123:case 125:case 91:case 93:case 58:case 44:c=s?a.charAt(b):a[b];b++;return c;case 34:c="@";for(b++;b<f;){e=a.charCodeAt(b);if(e<32)j();else if(e==92){e=a.charCodeAt(++b);switch(e){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:c=c+N[e];b++;break;case 117:d=++b;for(h=b+4;b<h;b++){e=a.charCodeAt(b);e>=48&&e<=57||e>=97&&e<=102||e>=65&&e<=70||j()}c=c+M("0x"+a.slice(d,b));break;default:j()}}else{if(e==34)break;e=a.charCodeAt(b);for(d=b;e>=32&&e!=92&&e!=34;)e=a.charCodeAt(++b);
c=c+a.slice(d,b)}}if(a.charCodeAt(b)==34){b++;return c}j();default:d=b;if(e==45){k=o;e=a.charCodeAt(++b)}if(e>=48&&e<=57){for(e==48&&(e=a.charCodeAt(b+1),e>=48&&e<=57)&&j();b<f&&(e=a.charCodeAt(b),e>=48&&e<=57);b++);if(a.charCodeAt(b)==46){for(h=++b;h<f&&(e=a.charCodeAt(h),e>=48&&e<=57);h++);h==b&&j();b=h}e=a.charCodeAt(b);if(e==101||e==69){e=a.charCodeAt(++b);(e==43||e==45)&&b++;for(h=b;h<f&&(e=a.charCodeAt(h),e>=48&&e<=57);h++);h==b&&j();b=h}return+a.slice(d,b)}k&&j();if(a.slice(b,b+4)=="true"){b=
b+4;return o}if(a.slice(b,b+5)=="false"){b=b+5;return false}if(a.slice(b,b+4)=="null"){b=b+4;return w}j()}}return"$"},F=function(a){var b,c;a=="$"&&j();if(typeof a=="string"){if((s?a.charAt(0):a[0])=="@")return a.slice(1);if(a=="["){for(b=[];;c||(c=o)){a=q();if(a=="]")break;if(c)if(a==","){a=q();a=="]"&&j()}else j();a==","&&j();b.push(F(a))}return b}if(a=="{"){for(b={};;c||(c=o)){a=q();if(a=="}")break;if(c)if(a==","){a=q();a=="}"&&j()}else j();(a==","||typeof a!="string"||(s?a.charAt(0):a[0])!="@"||
q()!=":")&&j();b[a.slice(1)]=F(q())}return b}j()}return a},I=function(a,b,c){c=H(a,b,c);c===r?delete a[b]:a[b]=c},H=function(a,b,c){var d=a[b],h;if(typeof d=="object"&&d)if(m.call(d)=="[object Array]")for(h=d.length;h--;)I(d,h,c);else C(d,function(a){I(d,a,c)});return c.call(a,b,d)};k.parse=function(a,f){var c,d;b=0;A=""+a;c=F(q());q()!="$"&&j();b=A=w;return f&&m.call(f)=="[object Function]"?H((d={},d[""]=c,d),"",f):c}}}D&&define(function(){return k})})(this);return JSON;
}());
I$(632,function(_m,_p,_o,_f,_r){
if (_m._$KERNEL.engine==='trident'&&_m._$KERNEL.release=='2.0'){I$(653,function (){
	    // eval for big string
	    JSON.parse = (function(){
	        // check save json string
	        // http://www.ietf.org/rfc/rfc4627.txt
	        var _isSafeJSON = function(_content){
	            return !(/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(
	                        _content.replace(/"(\\.|[^"\\])*"/g,'')
	                    ));
	        };
	        return JSON.parse._$aop(function(_event){
	            var _str = _event.args[0]||'';
	            if (_str.length>=500000){  // &&_isSafeJSON(_str)
	                _event.stopped = !0;
	                _event.value = eval('('+_str+')');
	            }
	        });
	    })();
	});}return JSON;},78);
I$(590,function (){return JSON;},632);
I$(451,function (_k,_u,_e,_c,_g,_t,_j,JSON,_p,_o,_f,_r){
    var _pro;
    /**
     * Ajax代理对象
     * 
     * @class   module:util/ajax/proxy/proxy._$$ProxyAbstract
     * @extends module:util/event._$$EventTarget
     * 
     * @param    {Object}  config  - 构造配置参数
     * @property {String}  url     - 请求地址
     * @property {Boolean} sync    - 是否同步请求
     * @property {String}  type    - 返回数据格式,text/json/xml
     * @property {String}  method  - 请求方式,GET/POST
     * @property {Number}  timeout - 超时时间,0表示禁止超时监测
     * @property {Object}  headers - 头信息
     */
    /** 
     * 载入回调
     * 
     * @event module:util/ajax/proxy/proxy._$$ProxyAbstract#onload
     * @param {Object} event - 服务器返回数据信息
     */
    /** 
     * 异常回调
     * 
     * @event    module:util/ajax/proxy/proxy._$$ProxyAbstract#onerror
     * @param    {Object}   event   - 错误信息
     * @property {Number}   code    - 错误代码
     * @property {String}   message - 错误描述
     * @property {Variable} data    - 出错时携带数据
     */
    /** 
     * [hr]
     * 请求之前对数据处理回调
     * @event    module:util/ajax/proxy/proxy._$$ProxyAbstract#onbeforerequest
     * @param    {Object} event   - 请求信息
     * @property {Object} request - 请求参数，数据信息 url/sync/cookie/type/method/timeout
     * @property {Object} headers - 请求头信息
     */
    _p._$$ProxyAbstract = _k._$klass();
    _pro = _p._$$ProxyAbstract._$extend(_t._$$EventTarget);
    /**
     * 控件重置
     * 
     * @protected
     * @method module:util/ajax/proxy/proxy._$$ProxyAbstract#__reset
     * @param  {Object} arg0 - 配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        // reset request information
        this.__request = _u._$fetch({
            url:'',
            sync:!1,
            cookie:!1,
            type:'text',
            method:'GET',
            timeout:60000
        },_options);
        // for csrf attack
        var _csrf = _c._$get('csrf');
        if (!!_csrf.cookie&&!!_csrf.param){
            var _query = encodeURIComponent(_csrf.param)+'='+
                         encodeURIComponent(_j._$cookie(_csrf.cookie)||''),
                _split = this.__request.url.indexOf('?')<0?'?':'&';
            this.__request.url += _split+_query;
        }
        // reset headers
        this.__headers = _options.headers||{};
        var _content = this.__headers[_g._$HEAD_CT];
        if (_content==null){
            this.__headers[_g._$HEAD_CT] = _g._$HEAD_CT_FORM;
        }
    };
    /**
     * 回收控件
     * 
     * @protected
     * @method module:util/ajax/proxy/proxy._$$ProxyAbstract#__destroy
     * @return {Void}
     */
    _pro.__destroy = function(){
        this.__super();
        delete this.__rkey;
        delete this.__request;
        delete this.__headers;
    };
    /**
     * 请求载入回调
     * 
     * @protected
     * @method   module:util/ajax/proxy/proxy._$$ProxyAbstract#__onLoadRequest
     * @param    {Object} arg0   - 数据信息
     * @property {Number} status - 请求状态
     * @property {String} result - 请求结果，纯文本形式
     * @return   {Void}
     */
    _pro.__onLoadRequest = function(_event){
        var _status = _event.status;
        // timeout error
        if (_status==-1){
            this._$dispatchEvent('onerror',{
                code:_g._$CODE_TIMEOUT,
                message:'请求['+this.__request.url+']超时！'
            });
            return;
        }
        // check status
        if ((''+_status).indexOf('2')!=0){
            this._$dispatchEvent('onerror',{
                data:_status,
                result:_event.result,
                code:_g._$CODE_ERRSERV,
                message:'服务器返回异常状态['+_status+']!'
            });
            return;
        }
        // onload
        this._$dispatchEvent(
             'onload',_e._$text2type(
                 _event.result,
                 this.__request.type
             )
        );
    };
    /**
     * 往服务器发送请求，子类实现具体业务逻辑
     * 
     * @abstract
     * @method module:util/ajax/proxy/proxy._$$ProxyAbstract#__doSendRequest
     * @param  {Object} arg0 - 请求信息
     * @return {Void}
     */
    _pro.__doSendRequest = _f;
    /**
     * 取头信息，子类实现具体业务逻辑
     * 
     * @abstract
     * @method module:util/ajax/proxy/proxy._$$ProxyAbstract#__getResponseHeader
     * @param  {String} arg0 - 要取的头信息名称
     * @return {String}        头信息结果或集合
     */
    _pro.__getResponseHeader = _f;
    /**
     * 发送请求
     * 
     * @method module:util/ajax/proxy/proxy._$$ProxyAbstract#_$send
     * @param  {Variable} arg0 - 要发送的数据
     * @return {Void}
     */
    _pro._$send = function(_data){
        var _url = this.__request.url;
        if (!_url){
            this._$dispatchEvent('onerror',{
                code:_g._$CODE_NOTASGN,
                message:'没有输入请求地址！'
            });
            return;
        }
        try{
            this.__request.data = _data==null?null:_data;
            var _event = {
                request:this.__request,
                headers:this.__headers
            };
            // adjust param before request
            try{
                this._$dispatchEvent('onbeforerequest',_event);
            }catch(ex){
                // ignore exception
                console.error(ex.message);
                console.error(ex.stack);
            }
            this.__doSendRequest(_event);
        }catch(e){
            this._$dispatchEvent('onerror',{
                code:_g._$CODE_ERRSERV,
                message:'请求['+_url+']失败:'+e.message+'！'
            });
        }
    };
    /**
     * 中断请求，子类实现具体业务逻辑
     *
     * @abstract
     * @method module:util/ajax/proxy/proxy._$$ProxyAbstract#_$abort
     * @return {Void}
     */
    _pro._$abort = _f;
    /**
     * 取头信息
     * 
     * @method module:util/ajax/proxy/proxy._$$ProxyAbstract#_$header
     * @param  {String|Array}  arg0 - 要取的头信息名称
     * @return {String|Object}        头信息结果或集合
     */
    _pro._$header = function(_key){
        if (!_u._$isArray(_key)){
            return this.__getResponseHeader(_key)||'';
        }
        var _result = {};
        _u._$forEach(
            _key,function(_value){
                _result[_value] = this._$header(_value);
            },this
        );
        return _result;
    };
    
    return _p;
},1,2,4,377,227,23,11,590);
I$(591,function (_p,_o,_f,_r){
    /**
     * 取XHR对象
     * @return {XMLHttpRequest} XHR对象
     */
    _p.__getXMLHttpRequest = function(){
        return new XMLHttpRequest();
    };
    
    return _p;
});
I$(452,function(b1482406244884,_h,_u,_p,_o,_f,_r){if (b1482406244884._$KERNEL.engine==='trident'&&b1482406244884._$KERNEL.release<='2.0'){I$(592,function (){
        /**
         * 取XHR对象
         * @return {XMLHttpRequest} XHR对象
         */
        _h.__getXMLHttpRequest = (function(){
            // http://blogs.msdn.com/b/xmlteam/archive/2006/10/23/using-the-right-version-of-msxml-in-internet-explorer.aspx
            var _msxml = [
                'Msxml2.XMLHTTP.6.0',
                'Msxml2.XMLHTTP.3.0',
                'Msxml2.XMLHTTP.4.0',
                'Msxml2.XMLHTTP.5.0',
                'MSXML2.XMLHTTP',
                'Microsoft.XMLHTTP'
            ];
            return function(){
                var _xhr = null;
                _u._$forIn(
                    _msxml,function(_name){
                        try{
                            _xhr = new ActiveXObject(_name);
                            return !0;
                        }catch(e){
                            // ignore exception
                        }
                    }
                );
                return _xhr;
            };
        })();
    });}return _h;},78,591,2);
I$(243,function (_t,_u,_k,_g,_h,_p,_o,_f,_r){
    var _pro;
    /**
     * Ajax代理对象
     * 
     * @class   module:util/ajax/proxy/xhr._$$ProxyXHR
     * @extends module:util/ajax/proxy/proxy._$$ProxyAbstract
     * 
     * @param   {Object} config - 构造配置参数
     */
    _p._$$ProxyXHR = _k._$klass();
    _pro = _p._$$ProxyXHR._$extend(_t._$$ProxyAbstract);
    /**
     * 控件销毁
     * 
     * @protected
     * @method module:util/ajax/proxy/xhr._$$ProxyXHR#__destroy
     * @return {Void}
     */
    _pro.__destroy = function(){
        this.__super();
        // clear timeout
        window.clearTimeout(this.__timer);
        delete this.__timer;
        // clear request
        try{
            this.__xhr.onreadystatechange = _f;
            this.__xhr.abort();
        }catch(e){
            // ignore
        }
        delete this.__xhr;
    };
    /**
     * 往服务器发送请求
     * 
     * @protected
     * @method module:util/ajax/proxy/xhr._$$ProxyXHR#__doSendRequest
     * @param  {Object} arg0 - 请求信息
     * @return {Void}
     */
    _pro.__doSendRequest = (function(){
        // set header
        var _doSetHeader = function(_value,_key){
            this.__xhr.setRequestHeader(_key,_value);
        };
        // split input.file for multiple files
        var _doSplitMultFiles = function(_form){
            var _result = [];
            _u._$reverseEach(
                _form.getElementsByTagName('input'),
                function(_input){
                    if (_input.type!='file'){
                        return;
                    }
                    // remove file without name
                    if (!_input.name){
                        _input.parentNode.removeChild(_input);
                        return;
                    }
                    // for multiple file per-input
                    if (_input.files.length>1){
                        _u._$forEach(_input.files,function(_file){
                            _result.push({name:_input.name,file:_file});
                        });
                        _input.parentNode.removeChild(_input);
                    }
                }
            );
            return _result.length>0?_result:null;
        };
        return function(_options){
            var _request = _options.request,
                _headers = _options.headers;
            this.__xhr = _h.__getXMLHttpRequest();
            // add event listener
            // upload progress
            if (_headers[_g._$HEAD_CT]===_g._$HEAD_CT_FILE){
                delete _headers[_g._$HEAD_CT];
                this.__xhr.upload.onprogress = 
                    this.__onStateChange._$bind(this,1);
                if (_request.data.tagName==='FORM'){
                    var _files = _doSplitMultFiles(_request.data);
                    _request.data = new FormData(_request.data);
                    _u._$forEach(_files,function(_ret){
                        var _file = _ret.file;
                        _request.data.append(
                            _ret.name||_file.name||
                            ('file-'+_u._$uniqueID()),_file
                        );
                    });
                }
            }
            // state change
            this.__xhr.onreadystatechange = 
                this.__onStateChange._$bind(this,2);
            // timeout
            if (_request.timeout!==0){
                this.__timer = window.setTimeout(
                    this.__onStateChange._$bind(this,3),
                    _request.timeout
                );
            }
            // prepare and send request
            this.__xhr.open(
                _request.method,
                _request.url,
               !_request.sync
            );
            _u._$loop(_headers,_doSetHeader,this);
            // support credential
            if (!!this.__request.cookie&&
               ('withCredentials' in this.__xhr)){
                this.__xhr.withCredentials = !0;
            }
            this.__xhr.send(_request.data);
        };
    })();
    /**
     * 请求状态变化事件
     * 
     * @protected
     * @method module:util/ajax/proxy/xhr._$$ProxyXHR#__onStateChange
     * @param  {Number} arg0 - 状态变化类型
     * @return {Void}
     */
    _pro.__onStateChange = function(_type){
        switch(_type){
            // upload progress
            case 1 :
                this._$dispatchEvent('onuploading',arguments[1]);
            break;
            // state change
            case 2 :
                if (this.__xhr.readyState==4){
                    this.__onLoadRequest({
                        status:this.__xhr.status,
                        result:this.__xhr.responseText||''
                    });
                }
            break;
            // timeout
            case 3:
                this.__onLoadRequest({status:-1});
            break;
        }
    };
    /**
     * 取头信息
     * 
     * @protected
     * @method module:util/ajax/proxy/xhr._$$ProxyXHR#__getResponseHeader
     * @param  {String} arg0 - 要取的头信息名称
     * @return {String}        头信息结果或集合
     */
    _pro.__getResponseHeader = function(_key){
        return !this.__xhr?'':this.__xhr.getResponseHeader(_key);
    };
    /**
     * 中断请求
     * 
     * @method module:util/ajax/proxy/xhr._$$ProxyXHR#_$abort
     * @return {Void}
     */
    _pro._$abort = function(){
        this.__onLoadRequest({status:0});
    };
    
    return _p;
},451,2,1,227,452);
/*
 * TrimPath Template. Release 1.1.2.
 * Copyright (C) 2004 - 2007 TrimPath.
 * 
 * TrimPath Template is licensed under the GNU General Public License
 * and the Apache License, Version 2.0, as follows:
 *
 * This program is free software; you can redistribute it and/or 
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 * 
 * This program is distributed WITHOUT ANY WARRANTY; without even the 
 * implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  
 * See the GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/*
 * ------------------------------------------
 * JST模板引擎实现文件
 * 实现原理参考trimpath项目 (GPL & APL)
 * http://code.google.com/p/trimpath/
 * @version  1.0
 * @author   genify(caijf@corp.netease.com)
 * ------------------------------------------
 */
(function(){
    /**
     * TrimPath模版引擎名字空间
     * @namespace TrimPath
     */
    // init TrimPath
    if (typeof TrimPath==='undefined'){
        TrimPath = {};
        if (typeof exports!=='undefined')
            TrimPath = exports;
    }
    // variable declaration
    var _tcache = {}, // jst string cache
        _stack  = [], // loop statement stack
        _rspc   = /\s+/g,
        _seed   = +new Date,
        _trim,_config,_vars;
    /*
     * 解析表达式中变量信息，如
     * a.b(c,d) || d('aaaa',f,g) && !!test() || 'eeee'
     * @param  {String} 内容
     * @return {Void}
     */
    var _doParseVars = (function(){
        var _reg0 = /^\s*[\[\{'"].*?[\]\}'"]\s*$/,
            _reg1 = /[\&\|\<\>\+\-\*\/\%\,\(\)\[\]\?\:\!\=\;]/,
            // keyword extend later
            _reg2 = /^(?:defined|null|undefined|true|false|instanceof|new|this|typeof|\$v|[\d]+)$/i,
            // statement extend later
            // new XX
            _reg3 = /^new\s+/,
            _reg4 = /['"]/;
        var _doParseSimple = function(_value){
            if (_reg0.test(_value)) return;
            _value = _value.split('.')[0].trim();
            if (!_value||_reg4.test(_value)) return;
            _value = _value.replace(_reg3,'');
            //console.log('-->'+_value+'<--');
            try{
                if (_reg2.test(_value))
                    return;
                _vars[_value] = 1;
                //console.log('=====>'+_value+'<====');
            }catch(e){
                // ignore
            }
        };
        return function(_content){
            _content = _content||'';
            // for string/array
            if (!_content||_reg0.test(_content)) 
                return;
            var _arr = _content.split(_reg1);
            for(var i=0,l=_arr.length;i<l;i++)
                _doParseSimple(_arr[i]);
        };
    })();
    /*
     * 解析{for x in b}字符串的前缀
     * @param  {Array}  按空格拆分的值,['for','x','in','b']
     * @return {String} 解析后的前缀值
     */
    var _doParsePrefixFor = function(_part){
        if (_part[2]!='in')
            throw 'bad for loop statement: '+_part.join(' ');
        _stack.push(_part[1]);
        // b is array or has [1,2,4],{a:'aaa',b:'bbb'}
        _doParseVars(_part[3]);
        return 'var __HASH__'+_part[1]+' = '+_part[3]+','+
                    _part[1]+','+_part[1]+'_count=0;'+
               'if (!!__HASH__'+_part[1]+')'+
                   'for(var '+_part[1]+'_key in __HASH__'+_part[1]+'){'+
                        _part[1]+' = __HASH__'+_part[1]+'['+_part[1]+'_key];'+
                        'if (typeof('+_part[1]+')=="function") continue;'+
                        _part[1]+'_count++;';
    };
    /*
     * 解析{forelse}字符串的前缀
     * @return {String} 解析后的前缀值
     */
    var _doParsePrefixForElse = function(){
        var _part = _stack[_stack.length-1];
        return '}; if(!__HASH__'+_part+'||!'+_part+'_count){';
    };
    /*
     * 解析{/for}字符串的前缀
     * @return {String} 解析后的前缀值
     */
    var _doParsePrefixForEnd = function(){
        _stack.pop();
        return '};';
    };
    /*
     * 解析{list seq as x}或者{list 1..100 as x}字符串的前缀
     * @param  {Array}  按空格拆分的值,['list','seq','as','x']
     * @return {String} 解析后的前缀值
     */
    var _doParsePrefixList = function(_part){
        if (_part[2]!='as')
            throw 'bad for list loop statement: '+_part.join(' ');
        var _seq = _part[1].split('..');
        if (_seq.length>1){
            // {list 1..100 as x}
            _doParseVars(_seq[0]);
            _doParseVars(_seq[1]);
            return 'for(var '+_part[3]+','+_part[3]+'_index=0,'+
                        _part[3]+'_beg='+_seq[0]+','+_part[3]+'_end='+_seq[1]+','+
                        _part[3]+'_length=parseInt('+_part[3]+'_end-'+_part[3]+'_beg+1);'+
                        _part[3]+'_index<'+_part[3]+'_length;'+_part[3]+'_index++){'+
                        _part[3]+' = '+_part[3]+'_beg+'+_part[3]+'_index;';
        }else{
            // {list seq as x}
            // seq is array [1,2,4]
            _doParseVars(_part[1]);
            return 'for(var __LIST__'+_part[3]+' = '+_part[1]+','+
                        _part[3]+','+_part[3]+'_index=0,'+
                        _part[3]+'_length=__LIST__'+_part[3]+'.length;'+
                        _part[3]+'_index<'+_part[3]+'_length;'+_part[3]+'_index++){'+
                        _part[3]+' = __LIST__'+_part[3]+'['+_part[3]+'_index];';
        }
    };
    /*
     * 解析{macro macroName(arg1,arg2,...argN)}字符串的前缀
     * @param  {Array}  按空格拆分的值,['macro','macroName(arg1,arg2,...argN)']
     * @return {String} 解析后的前缀值
     */
    var _doParsePrefixMacro = function(_part){
        if (!_part||!_part.length) return;
        _part.shift(); // remove macro key word
        var _name = _part[0].split('(')[0];
        return 'var '+_name+' = function'+_part.join('').replace(_name,'')+'{var __OUT=[];';
    };
    /*
     * 解析{include "text-template-id"}字符串前缀
     * @param  {Array}  按空格拆分的值,['include','"text-template-id"']
     * @return {String} 解析后的前缀值
     */
    var _doParsePrefixInline = function(_part){
        if (!_part[1]) 
            throw 'bad include statement: '+_part.join(' ');
        return 'if (typeof inline == "function"){__OUT.push(inline(';
    };
    /**
     * 解析IF语句前缀，{if customer != null && customer.balance > 1000 || test(customer)}
     * @param  {String}  返回值
     * @param  {Array}   按空格拆分的值
     * @return {String}  解析后的前缀值
     */
    var _doParsePrefixCondition = function(_prefix,_part){
        _doParseVars(_part.slice(1).join(' '));
        return _prefix;
    };
    // parse prefix condition
    var _doParsePrefixConditionIF = function(_part){
        return _doParsePrefixCondition('if(',_part);
    };
    var _doParsePrefixConditionELSEIF = function(_part){
        return _doParsePrefixCondition('}else if(',_part);
    };
    var _doParsePrefixConditionVAR = function(_part){
        return _doParsePrefixCondition('var ',_part);
    };
    // jst configuration
    _config = {
        blk : /^\{(cdata|minify|eval)/i,
        tag : 'forelse|for|list|if|elseif|else|var|macro|break|notrim|trim|include',
        // {pmin : min param number,
        //  pdft : param default value,
        //  pfix : statement prefix,
        //  sfix : statement suffix}
        def : {
            'if'     : {pfix:_doParsePrefixConditionIF,sfix:'){',pmin:1},
            'else'   : {pfix:'}else{'},
            'elseif' : {pfix:_doParsePrefixConditionELSEIF,sfix:'){',pdft:'true'},
            '/if'    : {pfix:'}'},
            'for'    : {pfix:_doParsePrefixFor,pmin:3},
            'forelse': {pfix:_doParsePrefixForElse},
            '/for'   : {pfix:_doParsePrefixForEnd},
            'list'   : {pfix:_doParsePrefixList,pmin:3},
            '/list'  : {pfix:'};'},
            'break'  : {pfix:'break;'},
            'var'    : {pfix:_doParsePrefixConditionVAR,sfix:';'},
            'macro'  : {pfix:_doParsePrefixMacro},
            '/macro' : {pfix:'return __OUT.join("");};'},
            'trim'   : {pfix:function(){_trim = !0;}},
            '/trim'  : {pfix:function(){_trim = null;}},
            'inline' : {pfix:_doParsePrefixInline,pmin:1,sfix:'));}'}
        },
        ext : {
            'seed'   : function(_prefix){return (_prefix||'')+''+_seed;},
            'default': function(_value,_default){return _value||_default;}
        }
    };
    /*
     * 解析语句，如{if customer != null && customer.balance > 1000}
     * @param  {String} 待解析语句
     * @param  {Array}  内容输出
     * @return {Void}
     */
    var _doParseStatement = (function(){
        var _rbrc = /\\([\{\}])/g;
        return function(_content,_out){
            _content = _content.replace(_rbrc,'$1');
            //console.log('++++>'+_content);
            var _part = _content.slice(1, -1).split(_rspc),
                _conf = _config.def[_part[0]];
            if (!_conf){_doParseSectionText(_content,_out);return;}
            if (!!_conf.pmin&&_conf.pmin>=_part.length)
                throw 'Statement needs more parameters:'+_content;
            // parse prefix
            _out.push((!!_conf.pfix&&
                       typeof(_conf.pfix)!='string')
                       ?_conf.pfix(_part):(_conf.pfix||''));
            // parse params and suffix
            if (!!_conf.sfix){
                if (_part.length<=1) {
                    if (!!_conf.pdft) _out.push(_conf.pdft);
                }else{
                    for(var i=1,l=_part.length;i<l;i++){
                        if (i>1) _out.push(' ');
                        _out.push(_part[i]);
                    }
                }
                _out.push(_conf.sfix);
            }
        };
    })();
    /*
     * 解析表达式，如['firstName','default:"John Doe"','capitalize']
     * @param  {Array}  表达式内容
     * @param  {Number} 表达式索引
     * @param  {Array}  内容输出
     * @return {Void}
     */
    var _doParseExpression = function(_exps,_out){
        // foo|a:x|b:y1,y2|c:z1,z2 -> c(b(a(foo,x),y1,y2),z1,z2)
        if (!_exps||!_exps.length) return;
        if (_exps.length==1){
            var _var = _exps.pop();
            _doParseVars(_var);
            // fix error for ${}
            _out.push(_var==''?'""':_var);
            return;
        }
        var _exp = _exps.pop().split(':');
        _out.push('__MDF[\''+_exp.shift()+'\'](');
        _doParseExpression(_exps,_out);
        if (_exp.length>0){
            var _args = _exp.join(':');
            _doParseVars(_args);
            _out.push(','+_args);
        }
        _out.push(')');
    };
    /*
     * 解析内容，内容中可能包含换行
     * @param  {String} 待解析语句
     * @param  {Array}  内容输出
     * @return {Void}
     */
    var _doParseSectionText = function(_content,_out){
        if (!_content) return;
        var _lines = _content.split('\n');
        if (!_lines||!_lines.length) return;
        for(var i=0,l=_lines.length,_line;i<l;i++){
            _line = _lines[i];
            if (!!_trim){
                _line = _line.trim();
                if (!_line) continue;
            } 
            _doParseSectionTextLine(_line,_out);
            if (!!_trim&&i<l-1) _out.push('__OUT.push(\'\\n\');');
        }
    };
    /*
     * 解析内容，内容中可能包含${a}或者${%a%}取值语句
     * @param  {String} 待解析语句
     * @param  {Array}  内容输出
     * @return {Void}
     */
    var _doParseSectionTextLine = (function(){
        var _raor = /\|\|/g,
            _rvor = /#@@#/g;
        return function(_content,_out){
            // defined used variable
            var _prvmrkend = '}',_prvexpend = -1,
                _length = _content.length,
                _begin,_end,_begexp,_endexp,_exparr;
            while((_prvexpend+_prvmrkend.length)<_length){
                _begin = '${'; _end = '}';
                _begexp = _content.indexOf(_begin,_prvexpend+_prvmrkend.length);
                if (_begexp<0) break;
                // parse ${% customer.firstName %} syntax
                if (_content.charAt(_begexp+2)=='%'){
                    _begin = '${%'; _end = '%}';
                }
                _endexp = _content.indexOf(_end,_begexp+_begin.length);
                if (_endexp<0) break;
                _doParseText(_content.substring(_prvexpend+_prvmrkend.length,_begexp),_out);
                // parse expression: 'firstName|default:"John Doe"|capitalize'.split('|')
                _exparr = _content.substring(_begexp+_begin.length,_endexp).replace(_raor,'#@@#').split('|');
                for(var i=0,l=_exparr.length;i<l;_exparr[i]=_exparr[i].replace(_rvor,'||'),i++);
                _out.push('__OUT.push('); _doParseExpression(_exparr,_out); _out.push(');');
                _prvmrkend = _end; _prvexpend = _endexp;
            }
            _doParseText(_content.substring(_prvexpend+_prvmrkend.length),_out);
        };
    })();
    /*
     * 解析纯文本内容，不包含需要解析的内容
     * @param  {String} 待解析内容
     * @param  {Array}  内容输出
     * @return {Void}
     */
    var _doParseText = (function(){
        var _map = {r:/\n|\\|\'/g,'\n':'\\n','\\':'\\\\','\'':'\\\''};
        var _doEncode = function(_content){
            return (_content||'').replace(_map.r,function($1){
                return _map[$1]||$1;
            });
        };
        return function(_content,_out){
            if (!_content) return;
            _out.push('__OUT.push(\''+_doEncode(_content)+'\');');
        };
    })();
    /*
     * 解析模板为执行函数
     * @param  {String}   模板内容
     * @return {Function} 模板执行函数
     */
    var _doParseTemplate = (function(){
        var _rtab = /\t/g,
            _rnln = /\n/g,
            _rlne = /\r\n?/g;
        var _doSearchEnd = function(_content,_begin){
            var _index = _content.indexOf("}",_begin+1);
            // for {for x in \{a:'aaa',b:'bbbb'\}}
            while(_content.charAt(_index-1)=='\\'){
                _index = _content.indexOf("}",_index+1);
            }
            return _index;
        };
        var _doParseVarMap = function(){
            var _arr = [],
                _arg = arguments[0];
            for(var x in _arg){
                x = (x||'').trim();
                if (!x) continue;
                _arr.push(x+'=$v(\''+x+'\')');
            }
            return _arr.length>0?('var '+_arr.join(',')+';'):'';
        };
        return function(_content){
            _vars = {};
            _content = _content.replace(_rlne,'\n').replace(_rtab,'    ');
            var _ftxt = ['if(!__CTX) return \'\';',''];
            _ftxt.push('function $v(__NAME){var v = __CTX[__NAME];return v==null?window[__NAME]:v;};');
            _ftxt.push('var defined=function(__NAME){return __CTX[__NAME]!=null;},');
            _ftxt.push('__OUT=[];');
            // defiend used variables
            var _prvend = -1,_length = _content.length;
            var _stmtbeg,_stmtend,_statement,
                _blockrx,_blktmp,_blkend,_blkmrk,_blktxt;
            // search content
            while((_prvend+1)<_length){
                // search statement begin
                _stmtbeg = _prvend;
                _stmtbeg = _content.indexOf("{",_stmtbeg+1);
                while(_stmtbeg>=0){
                    _stmtend = _doSearchEnd(_content,_stmtbeg);
                    _statement = _content.substring(_stmtbeg,_stmtend);
                    _blockrx = _statement.match(_config.blk);
                    // minify/eval/cdata implementation
                    if (!!_blockrx){
                        _blktmp = _blockrx[1].length+1;
                        _blkend = _content.indexOf('}',_stmtbeg+_blktmp);
                        if (_blkend>=0){
                            // gen block end marker
                            _blkmrk = _blkend-_stmtbeg-_blktmp<=0
                                    ? ('{/'+_blockrx[1]+'}')
                                    : _statement.substr(_blktmp+1);
                            _blktmp = _content.indexOf(_blkmrk,_blkend+1);
                            // parse block content
                            if (_blktmp>=0){
                                _doParseSectionText(_content.substring(_prvend+1,_stmtbeg),_ftxt);
                                // get block text and parse
                                _blktxt = _content.substring(_blkend+1,_blktmp);
                                switch(_blockrx[1]){
                                    case 'cdata' : _doParseText(_blktxt,_ftxt); break;
                                    case 'minify': _doParseText(_blktxt.replace(_rnln,' ').replace(_rspc,' '),_ftxt); break;
                                    case 'eval'  : if (!!_blktxt) _ftxt.push('__OUT.push((function(){'+_blktxt+'})());'); break;
                                }
                                _stmtbeg = _prvend = _blktmp+_blkmrk.length-1;
                            }
                        }
                    }else if(_content.charAt(_stmtbeg-1)!='$'&&
                             _content.charAt(_stmtbeg-1)!='\\'&&
                             _statement.substr(_statement.charAt(1)=='/'?2:1)
                                                         .search(_config.tag)==0){
                        // break when result is a statement
                        break;
                    }
                    _stmtbeg = _content.indexOf("{",_stmtbeg+1);
                }
                if (_stmtbeg<0) break;
                _stmtend = _doSearchEnd(_content,_stmtbeg);
                if (_stmtend<0) break;
                // parse content
                _doParseSectionText(_content.substring(_prvend+1,_stmtbeg),_ftxt);
                _doParseStatement(_content.substring(_stmtbeg,_stmtend+1),_ftxt);
                _prvend = _stmtend;
            }
            _doParseSectionText(_content.substring(_prvend+1),_ftxt);
            _ftxt.push(';return __OUT.join("");'); 
            _ftxt[1] = _doParseVarMap(_vars);
            _vars = null;
            //console.log(_ftxt.join(''));
            return new Function('__CTX','__MDF',_ftxt.join(''));
        };
    })();
    // interface
    /**
     * 取模板随机数种子
     *
     * 代码举例
     * ```javascript
     * NEJ.define([
     *     'util/template/trimpath.nej'
     * ],function(){
     *     // 模版统一随机标识
     *     var _seed = TrimPath.seed();
     * });
     * ```
     * 
     * @method TrimPath.seed
     * @return {String} 随机数种子
     */
    TrimPath.seed = function(){
        return _seed;
    };
    /**
     * 根据模板的序列号合并模板数据
     * 
     * 代码举例
     * ```javascript
     * NEJ.define([
     *     'util/template/trimpath'
     * ],function(){
     *     // 模版合并数据
     *     var _html = TrimPath.merge(
     *         _jst_id,{
     *             a:'aaaaaa',
     *             b:'bbbbbbbbbb',
     *             c:'cccccccccccc'
     *         }
     *     );
     * });
     * ```
     *
     * @method TrimPath.merge
     * @param  {String} arg0 - 模板序列号
     * @param  {Object} arg1 - 模板数据
     * @param  {Object} arg2 - 扩展接口
     * @return {String}        合并数据后的内容
     */
    TrimPath.merge = (function(){
        var _fcache = {};
        // for test
        TrimPath.dump = function(){
            return {
                func:_fcache,
                text:_tcache
            };
        };
        return function(_sn,_data,_extend){
            try{
                _data = _data||{};
                if (!_fcache[_sn]&&!_tcache[_sn])
                    return '';
                if (!_fcache[_sn]){
                    _fcache[_sn] = _doParseTemplate(_tcache[_sn]);
                    delete _tcache[_sn];
                }
                if (!!_extend){
                    for(var x in _config.ext)
                        if (!_extend[x])
                            _extend[x] = _config.ext[x];
                }
                return _fcache[_sn](_data,_extend||_config.ext);
            }catch(ex){
                return ex.message||'';
            }
        };
    })();
    /**
     * 添加JST模板，JST模板可以是节点的值
     *
     * 代码举例
     * ```javascript
     * NEJ.define([
     *     'util/template/trimpath'
     * ],function(){
     *     // 解析缓存模版
     *     var _jst_id = TrimPath.merge(
     *         '<div>\
     *              <p>${a}</p>\
     *              <p>${b}</p>\
     *              <p>${c}</p>\
     *          </div>'
     *     );
     * });
     * ```
     *
     * @method TrimPath.parse
     * @param  {String}  arg0 - JST模板内容
     * @param  {Boolean} arg1 - 是否保留节点
     * @return {String}         JST模板在缓存中的标识
     */
    TrimPath.parse = (function(){
        var _xeed = +new Date;
        return function(_content,_sn){
            if (!_content) return '';
            _sn = _sn||('ck_'+(_xeed++));
            _tcache[_sn] = _content;
            return _sn;
        };
    })();
})();
I$(239,function (NEJ,_u,_e,_x,_t,_p,_o,_f,_r){
    var _ext = {};
    /**
     * 取模板随机数种子
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/template/jst'
     * ],function(_p){
     *     // 返回一个标识符
     *     var _seed = _p._$seed();
     * });
     * ```
     *
     * @method module:util/template/jst._$seed
     * @return {String} 随机数种子
     */
    _p._$seed = TrimPath.seed;
    /**
     * 根据模板的序列号合并模板数据
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/template/jst'
     * ],function(_p){
     *     // 添加模版
     *     var _html_seed =  _p._$add('<div>${name}</div>');
     *     // 生成结构<div>jack</div>
     *     var _html = _p._$get(_html_seed,{name:'jack'});
     * });
     * ```
     *
     * @method module:util/template/jst._$get
     * @see    module:util/template/jst._$add
     * @param  {String} arg0 - 模板序列号
     * @param  {Object} arg1 - 模板数据
     * @param  {Object} arg2 - 扩展接口
     * @return {String}        合并数据后的内容
     */
    _p._$get = (function(){
        var _doInline = function(_id){
            return !_p._$getTextTemplate?'':
                    _p._$getTextTemplate(_id);
        };
        return function(_sn,_data,_extend){
            _data = _data||{};
            _data.inline = _doInline;
            _extend = _u._$merge({},_ext,_extend);
            _extend.rand = _u._$uniqueID;
            _extend.format = _u._$format;
            _extend.escape = _u._$escape;
            _extend.inline = _doInline;
            return TrimPath.merge(_sn,_data,_extend);
        };
    })();
    /**
     * 添加JST模板，JST模板可以是节点的值
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/template/jst'
     * ],function(_p){
     *     // 添加模版缓存
     *     var _html_seed =  _p._$add('<div>${name}</div>');
     * });
     * ```
     *
     * @method module:util/template/jst._$add
     * @see    module:util/template/jst._$get
     * @param  {String}  arg0 - JST模板内容或者节点ID
     * @param  {Boolean} arg1 - 是否保留节点
     * @return {String}         JST模板在缓存中的序列号
     */
    _p._$add = function(_content,_keep){
        if (!_content) return '';
        var _sn,_element = _e._$get(_content);
        if (!!_element){
            _sn = _element.id;
            _content = _element.value||_element.innerText;
            if (!_keep) _e._$remove(_element);
        }
        return TrimPath.parse(_content,_sn);
    };
    /**
     * 整合模板后输出至指定容器节点
     *
     * 结构举例
     * ```html
     * <div id="box">aaa</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/template/jst'
     * ],function(_p){
     *     // 添加模版缓存
     *     var _html_seed =  _p._$add('<div>${name}</div>');
     *     // 把结构塞到box中，生成<div id="box"><div>jack</div></div>
     *     _p._$render('box',_html_seed,{name:'jack'});
     * });
     * ```
     *
     * @method module:util/template/jst._$render
     * @param  {String|Node} arg0 - 容器节点
     * @param  {String}      arg1 - 模板序列号
     * @param  {Object}      arg2 - 模板数据
     * @param  {Object}      arg3 - 扩展接口
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$render
     * @see module:util/template/jst._$render
     */
    _p._$render = function(_parent,_sn,_data,_extend){
        _parent = _e._$get(_parent);
        if (!!_parent){
            _parent.innerHTML =
                _p._$get(_sn,_data,_extend);
        }
    };
    /**
     * 注册JST扩展方法
     *
     * 结构举例
     * ```html
     * <textarea name="jst" id="abc">
     *   <div>
     *     <p>${name|a|b}</p>
     *   </div>
     * </textarea>
     * ```
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/template/jst'
     * ],function(_p){
     *     // 注册扩展方法 a和b
     *     _p._$extend({
     *         a:function(){},
     *         b:function(){}
     *     });
     *     // 模板整合数据
     *     _p._$render(
     *         'box','abc',{name:'jack'}
     *     );
     * });
     * ```
     *
     * @method module:util/template/jst._$extend
     * @param  {Object} arg0 - 扩展方法
     * @return {Void}
     */
    _p._$extend = function(_map){
        _u._$merge(_ext,_map);
    };
    // for chainable method
    _x._$merge({_$render:_p._$render});

    if (CMPT){ 
        var _z = NEJ.P('nej.e');
        _z._$addHtmlTemplate     = _p._$add;
        _z._$getHtmlTemplate     = _p._$get;
        _z._$getHtmlTemplateSeed = _p._$seed;
        _z._$renderHtmlTemplate  = _p._$render;
        _z._$registJSTExt        = _p._$extend;
    }

    return _p;
},215,2,4,217,450);
I$(643,function (_m,_p,_o,_f,_r){
    var _this = this,
        _prefix = _m._$KERNEL.prefix.pro,
        _fps = _m._$is('desktop')?80:(_m._$is('ios')?50:30);
    /**
     * 请求动画
     * @param  {Function} 动画回调
     * @return {String}   动画标识
     */
    _p.__requestAnimationFrame = (function(){
        var _handler = _m._$is('android')?null:(
            _this.requestAnimationFrame||
            _this[_prefix+'RequestAnimationFrame']
        );
        return function(){
            if (!_handler){
                _handler = function(_callback){
                    return window.setTimeout(
                        function(){
                            try{_callback(+new Date);}catch(ex){}
                        },1000/_fps
                    );
                };
            }
            return _handler.apply(this,arguments);
        };
    })();
    /**
     * 取消动画
     * @param  {String} 动画标识
     * @return {Void}
     */
    _p.__cancelAnimationFrame = (function(){
        var _handler = _m._$is('android')?null:(
            _this.cancelAnimationFrame||
            _this[_prefix+'CancelAnimationFrame']
        );
        return function(){
            if (!_handler){
                _handler = function(_id){
                    window.clearTimeout(_id);
                };
            }
            return _handler.apply(this,arguments);
        };
    })();
    
    return _p;
},78);
I$(607,function (_h,_m){
    return _h;
},643,78);
I$(491,function (_m,_h,_p,_o,_f,_r){
    /**
     * 请求动画
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/timer/animation'
     * ],function(_p){
     *     // 桌面端一秒钟调用12.5次，ios端没秒调用20次，否则调用33次
     *     var _id  = _p.requestAnimationFrame(
     *         function(_time){
     *             console.log(_time);
     *         }
     *     );
     * });
     * ```
     * 
     * @method module:util/timer/animation.requestAnimationFrame
     * @param  {Function} arg0 - 动画回调
     * @return {String}          动画标识
     */
    _p.requestAnimationFrame = function(){
        _h.__requestAnimationFrame.apply(null,arguments);
    };
    /**
     * 取消动画
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/timer/animation'
     * ],function(_p){
     *     var _id  = _p.requestAnimationFrame(
     *         function(_time){
     *             console.log(_time);
     *         }
     *     );
     *     // 停止掉时钟
     *     _p.cancelAnimationFrame(_id);
     * });
     * ```
     * 
     * @method module:util/timer/animation.cancelAnimationFrame
     * @param  {String} arg0 - 动画标识
     * @return {Void}
     */
    _p.cancelAnimationFrame = function(){
        _h.__cancelAnimationFrame.apply(null,arguments);
    };
    
    if (CMPT){
        if (!this.requestAnimationFrame){
            this.requestAnimationFrame = _p.requestAnimationFrame;
        }
        if (!this.cancelAnimationFrame){
            this.cancelAnimationFrame = _p.cancelAnimationFrame;
        }
    }
    
    return _p;
},78,607);
I$(613,function (_m,_p,_o,_f,_r){
    /**
     * 判断是否需要对Flash事件做代理，
     * 主要fix flash上的鼠标事件没法响应到DOM节点上的问题
     * @return {Boolean} 是否做代理
     */
    _p.__canFlashEventBubble = function(_wmode){
        return (_wmode||'').toLowerCase()!='transparent';
    };

    return _p;
},78);
I$(535,function(_h,_m,_p,_o,_f,_r){if (_m._$KERNEL.engine==='trident'){I$(614,function (){
        /**
         * 判断是否需要对Flash事件做代理，
         * 主要fix flash上的鼠标事件没法响应到DOM节点上的问题
         * @return {Boolean} 是否做代理
         */
        _h.__canFlashEventBubble = function(_wmode){
            return !0;
        };

    });}
if (_m._$KERNEL.engine==='webkit'){I$(615,function (){
        /**
         * 判断是否需要对Flash事件做代理，
         * 主要fix flash上的鼠标事件没法响应到DOM节点上的问题
         * @return {Boolean} 是否做代理
         */
        _h.__canFlashEventBubble = function(_wmode){
            return !0;
        };

    });}return _h;},613,78);
I$(536,"{var hide  = defined(\"hidden\")&&!!hidden}\n{var param = defined(\"params\")&&params||NEJ.O}\n{var width = !hide?width:\"1px\",height = !hide?height:\"1px\"}\n{if hide}<div style=\"position:absolute;top:0;left:0;width:1px;height:1px;z-index:10000;overflow:hidden;\">{/if}\n<object classid = \"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\"\n        codebase = \"http://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab\"\n        width = \"${width|default:\"100px\"}\"\n        height = \"${height|default:\"100px\"}\" id=\"${id}\">\n    <param value=\"${src}\" name=\"movie\">\n    {for x in param}\n    <param value=\"${x}\" name=\"${x_key}\"/>\n    {/for}\n    <embed src=\"${src}\" name=\"${id}\"\n           width=\"${width|default:\"100px\"}\"\n           height=\"${height|default:\"100px\"}\"\n           pluginspage=\"http://www.adobe.com/go/getflashplayer\"\n           type=\"application/x-shockwave-flash\"\n           {for x in param}${x_key}=\"${x}\" {/for}></embed>\n</object>\n{if hide}</div>{/if}");
I$(378,function (NEJ,_e,_v,_u,_t0,_t1,_h,_html,_p,_o,_f,_r){
    var _seed_html = _t0._$add(_html);
    /**
     * 页面嵌入flash，NEJ嵌入Flash如果需要同JS交互的遵循以下规则
     *
     *  1. Flash对象提供JS可访问接口 inited （返回Boolean值）
     *  2. 如果Flash未初始化完成inited返回为false
     *  3. 如果Flash初始化完成inited返回为true
     *  4. inited返回true表示Flash已完成所有初始化，此时JS可调用Flash的API
     *
     * Flash事件规则
     *
     *  1. JS中使用window.onflashevent监听flash中的事件（此步骤NEJ已封装）
     *  2. Flash通过flashvars参数输入当前flash的ID，如 &lt;param name="flashvars" value="id=ab&a=b"/&gt;
     *  3. Flash在需要触发事件时调用window.onflashevent回调函数，并输入一个Object作为参数,Object信息包括
     *     type   [String] - 鼠标事件类型，如click/mouseover/mouseout/play/pause...
     *     target [String] - 触发事件的flash标识，通过flashvars参数输入的id参数，做了encodeURIComponent，如a%23b
     *     ...
     *
     * 结构举例
     * ```html
     * <div id='flash'></div>
     * ```
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/flash/flash'
     * ],function(_e){
     *     // 生成flash对象，可以设置宽高，地址，父节点，flash参数在params中设置
     *     // flash需要提供inited接口，返回falsh已经准备好的状态
     *     _e._$flash({
     *         src:'../../qunit/res/FlexChart.swf',
     *         hidden:false,
     *         parent:'flash',
     *         width:900,
     *         height:600,
     *         params:{
     *             flashvars:'',
     *             wmode:'transparent',
     *             allowscriptaccess:'always'
     *         },
     *         onready:function(_flash){
     *             // 返回准备好的flash对象
     *             // 如果没有传入flash对象则表示无法识别到flash
     *         },
     *         oncustom:function(_event){
     *             // 自定义事件需Flash同JS预先协定好自定义事件名称，如这里的oncustom
     *             // Flash中通过调用JS的window.onflashevent({id:2222,type:'custom',...})调入此回调
     *         }
     *     });
     * });
     * ```
     *
     * @method   module:util/flash/flash._$flash
     * @param    {Object}      arg0    - 可选配置参数
     * @property {String}      src     - Flash文件地址，必须指定地址
     * @property {Boolean}     hidden  - Flash是否不可见
     * @property {Number}      width   - Flash显示宽度，设为不可见时可以不设此参数
     * @property {Number}      height  - Flash显示高度，设为不可见时可以不设此参数
     * @property {String|Node} parent  - 容器节点，默认为document.body
     * @property {Object}      params  - 设置参数，object标签中的param标签参数
     * @property {String|Node} target  - 触发事件的源节点
     * @property {Function}    onready - Flash初始化完毕触发事件，输入可交互的Flash对象
     * @return   {Void}
     */
    _p._$flash = (function(){
        var _cache = {},_title,
            _reg0 = /^(?:mouse.*|(?:dbl)?click)$/i;
        // flash event
        window.onflashevent = function(_event){
            var _id = decodeURIComponent(_event.target),
                _type = _event.type.toLowerCase();
            // check mouse event bubble
            var _target = _cache[_id+'-tgt'];
            if (!!_target&&_reg0.test(_type)){
                _doMouseEventBubble(
                    _target,_event
                );
            }
            // check id-type handler
            var _handler = _cache[_id+'-on'+_type];
            if (!!_handler){
                var _result = '';
                try{
                    _result = _handler(_event);
                }catch(e){
                    // ignore
                }
                return _result;
            }
        };
        // append flash element
        var _doInitDOM = function(_options){
            // bugfix for ie title with flash
            _title = document.title;
            var _parent = _e._$get(_options.parent)||document.body,
                _html = _t0._$get(_seed_html,_options);
            _parent.insertAdjacentHTML(
               !_options.hidden?'beforeEnd':'afterBegin',_html
            );
        };
        // listen flash mouse event
        var _doMouseEventBubble = function(_id,_event){
            var _type = _event.type.toLowerCase();
            _t1.requestAnimationFrame(function(){
                _v._$dispatchEvent(_id,_type);
            });
        };
        // check flash init state
        var _doCheckFlashInit = function(_flash){
            return !!_flash&&!!_flash.inited&&!!_flash.inited();
        };
        var _doCheckFlash = function(_id){
            var _arr = [document.embeds[_id],
                       _e._$get(_id),document[_id],window[_id]],
                _index = _u._$forIn(_arr,_doCheckFlashInit),
                _flash = _arr[_index],
                _ctkey = _id+'-count';
            _cache[_ctkey]++;
            if (!!_flash||_cache[_ctkey]>100){
                if (!!_title){
                    document.title = _title;
                    _title = null;
                }
                _cache[_id](_flash);
                delete _cache[_id];
                delete _cache[_ctkey];
                return;
            }
            window.setTimeout(_doCheckFlash._$bind(null,_id),300);
        };
        // init flash event
        var _doInitFlashEvent = function(_options){
            // init flash vars
            var _id = _options.id,
                _params = _options.params;
            if (!_params){
                _params = {};
                _options.params = _params;
            }
            var _vars = _params.flashvars||'';
            _vars += (!_vars?'':'&')+('id='+_id);
            // delegate mouse event bubble
            if (!_options.hidden&&(!!_options.target||
                 _h.__canFlashEventBubble(_params.wmode))){
                var _tid = _e._$id(_options.target)||
                           _e._$id(_options.parent);
                _cache[_id+'-tgt'] = _tid;
            }
            _params.flashvars = _vars;
            // check event callback
            _u._$loop(_options,function(_value,_key){
                if (_u._$isFunction(_value)&&_key!='onready'){
                    _cache[_id+'-'+_key] = _value;
                }
            });
        };
        return function(_options){
            _options = NEJ.X({},_options);
            if (!_options.src) return;
            var _id = '_'+_u._$uniqueID();
            _options.id = _id;
            // delegate event
            _doInitFlashEvent(_options);
            // append flash
            _doInitDOM(_options);
            // check flash ready
            if (!_options.onready) return;
            _cache[_id] = _options.onready;
            _cache[_id+'-count'] = 0;
            _doCheckFlash(_id);
        };
    })();

    if (CMPT){
        NEJ.copy(NEJ.P('nej.e'),_p);
    }

    return _p;
},215,4,3,2,239,491,535,536);
I$(453,function (_t,_k,_c,_u,_e,_p,_o,_f,_r){
    var _pro,
        _cache = {},
        _seed = _u._$uniqueID();
    /*
     * 代理请求正常回调
     * @param  {String} 请求标识
     * @param  {String} 返回数据
     * @return {Void}
     */
    this['ld'+_seed] = function(_key,_text){
        var _proxy = _cache[_key];
        if (!_proxy) return;
        delete _cache[_key];
        _proxy.__onLoadRequest({
            status:200,
            result:_text
        });
    };
    /*
     * 代理请求异常回调
     * @param  {String} 请求标识
     * @param  {Number} 请求状态
     * @return {Void} 
     */
    this['er'+_seed] = function(_key,_status){
        var _proxy = _cache[_key];
        if (!_proxy) return;
        delete _cache[_key];
        _proxy.__onLoadRequest({
            status:_status||0
        });
    };
    /**
     * Flashä»£ç†æ–¹å¼Ajaxè¯·æ±‚å¯¹è±¡
     * 
     * @class   module:util/ajax/proxy/flash._$$ProxyFlash
     * @extends module:util/ajax/proxy/proxy._$$ProxyAbstract
     * 
     * @param   {Object}  config - æž„é€ é…ç½®å‚æ•°
     */
    _p._$$ProxyFlash = _k._$klass();
    _pro = _p._$$ProxyFlash._$extend(_t._$$ProxyAbstract);
    /**
     * å¾€æœåŠ¡å™¨å‘é€è¯·æ±‚
     * 
     * @protected
     * @method module:util/ajax/proxy/flash._$$ProxyFlash#__doSendRequest
     * @param  {Object} arg0 - è¯·æ±‚ä¿¡æ¯
     * @return {Void}
     */
    _pro.__doSendRequest = function(_options){
        var _flash = _cache.flash;
        // callback list
        if (_u._$isArray(_flash)){
            _flash.push(
                this.__doSendRequest.
                    _$bind(this,_options)
            );
            return;
        }
        // build flash proxy
        if (!_flash){
            _cache.flash = [
                this.__doSendRequest.
                    _$bind(this,_options)
            ];
            _e._$flash({
                hidden:!0,
                src:_c._$get('ajax.swf'),
                onready:function(_flash){
                    if (!_flash) return;
                    var _list = _cache.flash;
                    _cache.flash = _flash;
                    _u._$reverseEach(
                        _list,function(_handler,_index,_list){
                            try{
                                _handler();
                            }catch(ex){
                                // ignore
                            }
                        }
                    );
                }
            });
            return;
        }
        // send request by flash
        this.__rkey = _u._$uniqueID();
        _cache[this.__rkey] = this;
        var _data = _u._$fetch({
            url:'',
            data:null,
            method:'GET'
        },_options.request);
        _data.key = this.__rkey;
        _data.headers  = _options.headers;
        _data.onerror  = 'cb.er'+_seed;
        _data.onloaded = 'cb.ld'+_seed;
        var _policy = _c._$getFlashProxy(_data.url);
        if (!!_policy){
            _data.policyURL = _policy;
        }
        _flash.request(_data);
    };
    /**
     * ä¸­æ–­è¯·æ±‚
     * 
     * @method module:util/ajax/proxy/flash._$$ProxyFlash#_$abort
     * @return {Void}
     */
    _pro._$abort = function(){
        delete _cache[this.__rkey];
        this.__onLoadRequest({status:0});
    };

    return _p;
},451,1,377,2,378);
I$(654,function (_p,_o,_f,_r){
    /**
     * æ ¼å¼åŒ–æºä¿¡æ¯
     * @param  {String} æº
     * @return {String} æ ¼å¼åŒ–åŽæº
     */
    _p.__formatOrigin = (function(){
        var _reg = /^([\w]+?:\/\/.*?(?=\/|$))/i;
        return function(_origin){
            _origin = _origin||'';
            if (_reg.test(_origin)){
                return RegExp.$1;
            }
            return '*';
        };
    })();
    /**
     * è§£æžæ¶ˆæ¯ä¼ é€’æ•°æ®
     * @param  {Variable} æ•°æ®
     * @return {Variable} æ•°æ®
     */
    _p.__formatPassData = function(_data){
        return _data;
    };
    /**
     * è·¨æ–‡æ¡£å‘é€æ•°æ®
     * @param  {Window} çª—ä½“å¯¹è±¡
     * @param  {Object} å‘é€é…ç½®
     * @return {Void}
     */
    _p.__postMessage = function(_window,_options){
        if (!_window.postMessage){
            return;
        }
        _options = _options||_o;
        _window.postMessage(
            _p.__formatPassData(_options.data),
            _p.__formatOrigin(_options.origin)
        );
    };
    
    return _p;
});
I$(438,function (NEJ,_k,_e,_v,_u,_t,_p,_o,_f,_r){
    var _pro;
    /**
     * è‡ªå®šä¹‰äº‹ä»¶å°è£…å¯¹è±¡ï¼Œå°è£…çš„äº‹ä»¶æ”¯æŒé€šè¿‡äº‹ä»¶ç›¸å…³æŽ¥å£è¿›è¡Œæ·»åŠ ã€åˆ é™¤ç­‰æ“ä½œ
     * 
     * è„šæœ¬ä¸¾ä¾‹
     * ```javascript
     * NEJ.define([
     *     'base/event'
     *     'util/event'
     * ],function(_v,_t){
     *     // æ”¯æŒè‡ªå®šä¹‰äº‹ä»¶
     *     _t._$$CustomEvent._$allocate({
     *         element:window,
     *         event:'ok'
     *     });
     * 
     *     // æ·»åŠ è‡ªå®šä¹‰äº‹ä»¶ 
     *     _v._$addEvent(window,'ok',function(){alert(0);});
     *     _v._$addEvent(window,'ok',function(){alert(1);});
     *     
     *     // åˆ é™¤è‡ªå®šä¹‰äº‹ä»¶
     *     _v._$delEvent(window,'ok',function(){alert(0);});
     *     _v._$clearEvent(window,'ok');
     *     
     *     // è§¦å‘è‡ªå®šä¹‰äº‹ä»¶
     *     window.onok({a:'aaaaa'});
     *     _v._$dispatchEvent(window,'ok',{a:'aaaaa'});
     * });
     * ```
     * 
     * @class    module:util/event/event._$$CustomEvent
     * @extends  module:util/event._$$EventTarget
     * 
     * @param    {Object}       config  - å¯é€‰é…ç½®å‚æ•°
     * @property {String|Node}  element - äº‹ä»¶å…³è”èŠ‚ç‚¹IDæˆ–è€…å¯¹è±¡ï¼Œé»˜è®¤ä¸ºwindowå¯¹è±¡
     * @property {String|Array} event   - äº‹ä»¶åç§°æˆ–è€…åç§°åˆ—è¡¨
     */
    /** 
     * åˆå§‹åŒ–æ—¶è§¦å‘äº‹ä»¶
     * 
     * @event module:util/event/event._$$CustomEvent#oninit
     * @param {Object} event - äº‹ä»¶ä¿¡æ¯
     */
    /** 
     * äº‹ä»¶è°ƒåº¦å‰è§¦å‘äº‹ä»¶
     * 
     * @event    module:util/event/event._$$CustomEvent#ondispatch
     * @param    {Object} event - äº‹ä»¶ä¿¡æ¯
     * @property {String} type  - äº‹ä»¶ç±»åž‹
     */
    /**
     * æ·»åŠ äº‹ä»¶æ—¶è§¦å‘äº‹ä»¶
     * 
     * @event    module:util/event/event._$$CustomEvent#oneventadd
     * @param    {Object}   event    - äº‹ä»¶ä¿¡æ¯
     * @property {String}   type     - äº‹ä»¶ç±»åž‹
     * @property {Function} listener - äº‹ä»¶æ‰§è¡Œå‡½æ•°
     */
    _p._$$CustomEvent = _k._$klass();
    _pro = _p._$$CustomEvent._$extend(_t._$$EventTarget);
    /**
     * æŽ§ä»¶åˆå§‹åŒ–
     * 
     * @protected
     * @method module:util/event/event._$$CustomEvent#__init
     * @return {Void}
     */
    _pro.__init = function(){
        // onxxx - event entry handler
        //   xxx - event callback handler list
        this.__cache = {};
        this.__super();
    };
    /**
     * æŽ§ä»¶é‡ç½®
     * 
     * @protected
     * @method module:util/event/event._$$CustomEvent#__reset
     * @param  {Object} arg0 - å¯é€‰é…ç½®å‚æ•°
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        this.__element = _e._$get(_options.element)||window;
        // init event
        this.__doEventInit(_options.event);
        this.__doEventAPIEnhance();
        this._$dispatchEvent('oninit');
    };
    /**
     * é”€æ¯æŽ§ä»¶
     * 
     * @protected
     * @method module:util/event/event._$$CustomEvent#__destroy
     * @return {Void}
     */
    _pro.__destroy = (function(){
        var _doClear = function(_value,_key,_map){
            if (!_u._$isArray(_value)){
                _u._$safeDelete(this.__element,_key);
            }
            delete _map[_key];
        };
        return function(){
            this.__super();
            // clear cache
            _u._$loop(
                this.__cache,_doClear,this
            );
            delete this.__element;
        };
    })();
    /**
     * åˆ¤æ–­æ˜¯å¦éœ€è¦ä»£ç†äº‹ä»¶
     * 
     * @protected
     * @method module:util/event/event._$$CustomEvent#__isDelegate
     * @param  {String|Node} arg0 - èŠ‚ç‚¹
     * @param  {String}      arg1 - äº‹ä»¶
     * @return {Boolean}            æ˜¯å¦éœ€è¦ä»£ç†äº‹ä»¶
     */
    _pro.__isDelegate = function(_element,_type){
        _element = _e._$get(_element);
        return _element===this.__element&&
               (!_type||!!this.__cache['on'+_type]);
    };
    /**
     * åˆå§‹åŒ–äº‹ä»¶
     * 
     * @protected
     * @method module:util/event/event._$$CustomEvent#__doEventInit
     * @param  {String} arg0 - äº‹ä»¶åç§°
     * @return {Void}
     */
    _pro.__doEventInit = function(_event){
        if (_u._$isString(_event)){
            var _name = 'on'+_event;
            if (!this.__cache[_name]){
                this.__cache[_name] = 
                    this.__doEventDispatch.
                        _$bind(this,_event);
            }
            this.__doEventBind(_event); 
            return;
        }
        if (_u._$isArray(_event)){
            _u._$forEach(
                _event,this.__doEventInit,this
            );
        }
    };
    /**
     * 绑定事件
     * 
     * @protected
     * @method module:util/event/event._$$CustomEvent#__doEventBind
     * @param  {String} arg0 - 事件名称
     * @return {Void}
     */
    _pro.__doEventBind = function(_type){
        var _event = 'on'+_type,
            _handler = this.__element[_event],
            _handler1 = this.__cache[_event];
        if (_handler!=_handler1){
            this.__doEventDelete(_type);
            if (!!_handler&&_handler!=_f){
                this.__doEventAdd(_type,_handler);
            }
            this.__element[_event] = _handler1;
        }
    };
    /**
     * 添加事件
     * 
     * protected
     * @method module:util/event/event._$$CustomEvent#__doEventAdd
     * @param  {String}   arg0 - 事件名称
     * @param  {Function} arg1 - 事件回调
     * @return {Void}
     */
    _pro.__doEventAdd = function(_type,_handler,_front){
        var _list = this.__cache[_type];
        if (!_list){
            _list = [];
            this.__cache[_type] = _list;
        }
        if (_u._$isFunction(_handler)){
            !_front ? _list.push(_handler)
                    : _list.unshift(_handler);
        } 
    };
    /**
     * 删除事件
     * 
     * protected
     * @method module:util/event/event._$$CustomEvent#__doEventDelete
     * @param  {String}   arg0 - 事件名称
     * @param  {Function} arg1 - 事件回调
     * @return {Void}
     */
    _pro.__doEventDelete = function(_type,_handler){
        var _list = this.__cache[_type];
        if (!_list||!_list.length) return;
        // clear all event handler
        if (!_handler){
            delete this.__cache[_type];
            return;
        }
        // delete one event handler
        _u._$reverseEach(
            _list,function(_value,_index,_xlist){
                if (_handler===_value){
                    _xlist.splice(_index,1);
                    return !0;
                }
            }
        );
    };
    /**
     * 事件调度
     * 
     * protected
     * @method module:util/event/event._$$CustomEvent#__doEventDispatch
     * @param  {String} arg0 - 事件名称
     * @param  {Object} arg1 - 事件对象
     * @return {Void}
     */
    _pro.__doEventDispatch = function(_type,_event){
        _event = _event||{noargs:!0};
        if (_event==_o){
            _event = {};
        }
        _event.type = _type;
        this._$dispatchEvent('ondispatch',_event);
        if (!!_event.stopped) return;
        _u._$forEach(
            this.__cache[_type],function(_handler){
                if (DEBUG){
                    _handler(_event);
                }else{
                    try{
                        _handler(_event);
                    }catch(ex){
                        // ignore
                        console.error(ex.message);
                        console.error(ex.stack);
                    }
                }
            }
        );
    };
    /**
     * 增强事件操作API
     * 
     * protected
     * @method module:util/event/event._$$CustomEvent#__doEventAPIEnhance
     * @return {Void}
     */
    _pro.__doEventAPIEnhance = (function(){
        var _doAddEvent = function(_event){
            var _args = _event.args,
                _type = _args[1].toLowerCase();
            if (this.__isDelegate(_args[0],_type)){
                _event.stopped = !0;
                this.__doEventBind(_type);
                this.__doEventAdd(_type,_args[2],_args[3]);
                this._$dispatchEvent('oneventadd',{
                    type:_type,
                    listener:_args[2]
                });
            }
        };
        var _doDelEvent = function(_event){
            var _args = _event.args,
                _type = _args[1].toLowerCase();
            if (this.__isDelegate(_args[0],_type)){
                _event.stopped = !0;
                this.__doEventDelete(_type,_args[2]);
            }
        };
        var _doClearEvent = function(_event){
            var _args = _event.args,
                _type = (_args[1]||'').toLowerCase();
            if (this.__isDelegate(_args[0])){
                if (!!_type){
                    this.__doEventDelete(_type);
                    return;
                }
                _u._$loop(
                    this.__cache,function(_value,_key){
                        if (_u._$isArray(_value)){
                            this.__doEventDelete(_key);
                        }
                    },this
                );
            }
        };
        var _doDispatchEvent = function(_event){
            var _args = _event.args,
                _type = _args[1].toLowerCase();
            if (this.__isDelegate(_args[0],_type)){
                _event.stopped = !0;
                _args[0]['on'+_type].apply(_args[0],_args.slice(2));
            }
        };
        return function(){
            // void multi-enhance
            if (!!this.__enhanced){
                return;
            }
            // enhance event api
            this.__enhanced = true;
            _v._$addEvent = _v._$addEvent._$aop(_doAddEvent._$bind(this));
            _v._$delEvent = _v._$delEvent._$aop(_doDelEvent._$bind(this));
            _v._$clearEvent = _v._$clearEvent._$aop(_doClearEvent._$bind(this));
            _v._$dispatchEvent = _v._$dispatchEvent._$aop(_doDispatchEvent._$bind(this));
            
            if (CMPT){
                NEJ.copy(NEJ.P('nej.v'),_v);
            }
        };
    })();
    
    if (CMPT){
        NEJ.copy(NEJ.P('nej.ut'),_p);
    }
    
    return _p;
},215,1,4,3,2,23);
I$(633,function(b1482406245299,_h,_u,_v,_p,_o,_f,_r){if (b1482406245299._$KERNEL.engine==='trident'&&b1482406245299._$KERNEL.release>='4.0'&&b1482406245299._$KERNEL.release<='5.0'){I$(655,function (){
        /**
         * 解析消息传递数据
         * @param  {Variable} 数据
         * @return {Variable} 数据
         */
        _h.__formatPassData = function(_data){
            // ie8-9 only support string data
            return JSON.stringify(_data);
        };
    });}
if (b1482406245299._$KERNEL.engine==='trident'&&b1482406245299._$KERNEL.release<='3.0'){I$(656,function (_t){
        var _key = 'MSG|',
            _queue = [];
        /*
         * 检测window.name变化情况
         * @return {Void}
         */
        var _doCheckWindowName = function(){
            // check name
            var _name = unescape(window.name||'').trim();
            if (!_name||_name.indexOf(_key)!=0) return;
            window.name = '';
            // check result
            var _result = _u._$string2object(_name.replace(_key,''),'|'),
                _origin = (_result.origin||'').toLowerCase();
            // check origin
            if (!!_origin&&_origin!='*'&&
                location.href.toLowerCase().indexOf(_origin)!=0){
                return;
            }
            // dispatch onmessage event
            _v._$dispatchEvent(window,'message',{
                data:JSON.parse(_result.data||'null'),
                source:window.frames[_result.self]||_result.self,
                origin:_h.__formatOrigin(_result.ref||document.referrer)
            });
        };
        /*
         * 检测window.name设置队列
         * @return {Void}
         */
        var _doCheckNameQueue = (function(){
            var _checklist;
            // set window.name
            var _doSetWindowName = function(_map,_index,_list){
                if (_u._$indexOf(_checklist,_map.w)<0){
                    _checklist.push(_map.w);
                    _list.splice(_index,1);
                    _map.w.name = _map.d;
                }
            };
            return function(){
                _checklist = [];
                _u._$reverseEach(_queue,_doSetWindowName);
                _checklist = null;
            };
        })();
        /**
         * 跨文档发送数据
         * @param  {Window} 窗体对象
         * @param  {Object} 发送配置
         * @return {Void}
         */
        _h.__postMessage = (function(){
            // serialize send data
            var _doSerialize = function(_data){
                var _result = {};
                _data = _data||_o;
                _result.origin = _data.origin||'';
                _result.ref  = location.href;
                _result.self = _data.source;
                _result.data = JSON.stringify(_data.data);
                return _key+_u._$object2string(_result,'|',!0);
            };
            // function body
            return function(_window,_options){
                _queue.unshift({
                    w:_window,
                    d:escape(_doSerialize(_options))
                });
            };
        })();

        // init window onmessage event
        _t._$$CustomEvent._$allocate({
            element:window,
            event:'message'
        });
        setInterval(_doCheckNameQueue,100);
        setInterval(_doCheckWindowName,20);
    },438,590);}return _h;},78,654,2,3);
I$(593,function (NEJ,_u,_e,_h,_p,_o,_f,_r){
    /**
     * 发送跨文档的消息
     *
     * 结构举例
     * ```html
     * <!-- 注意需要通过source进行双向交互的frame节点必须设置id属性作为标识 -->
     * <iframe id="targetFrame" src="http://a.b.com/a.html"></iframe>
     * ```
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'base/event'
     *     'util/ajax/message'
     * ],function(_v,_j){
     *     // top页面代码
     *     // 发送消息至 http://c.d.com 的页面
     *     _j._$postMessage('targetFrame',{
     *         data:'hello c.d.com',
     *         origin:'http://c.d.com'
     *     });
     *
     *     // http://a.b.com/a.html页面代码
     *     // 添加消息监测事件
     *     _v._$addEvent(
     *         window,'message',function(_event){
     *             // 因为top页面发送消息到 http://c.d.com
     *             // 所以在http://a.b.com页面不会收到任何消息
     *         }
     *     );
     *
     *     // top页面代码
     *     // 发送消息至 http://a.b.com 的页面
     *     _j._$postMessage('targetFrame',{
     *         data:'hello a.b.com'
     *     });
     *
     *     // http://a.b.com/a.html页面代码
     *     // 添加消息监测事件
     *     _v._$addEvent(
     *         window,'message',function(_event){
     *             // 必须先验证消息来源_event.origin是否你允许的域
     *              if (!_isAllow(_event.origin))
     *                 return;
     *
     *             // 处理_event.data中的消息内容
     *             // TODO something
     *
     *             // 回复消息，使用_event.source
     *             _j._$postMessage(_event.source,{
     *                 data:'hello!',
     *                 origin:_event.origin
     *             });
     *         }
     *     );
     * });
     * ```
     *
     * @method module:util/ajax/message._$postMessage
     * @param  {String|Window} arg0   - window对象或者Frame的name，或者字符串如_top、_parent、_self
     * @param  {Object}        arg1   - 消息配置
     * @property {Variable}      data   - 消息内容
     * @property {String}        origin - 目标Origin，只有指定的页面可以收到消息，如http://a.b.com
     * @property {String}        source - 当前窗体标识，除非你非常确定当前窗体的标识是什么，否则请采用自动识别
     * @return {Void}
     */
    _p._$postMessage = (function(){
        var _self = window.name||'_parent',
            _wmap = {
                '_top'   : window.top,
                '_self'  : window,
                '_parent': window.parent
            };
        return function(_target,_options){
            if (_u._$isString(_target)){
                _target = _wmap[_target]||
                          window.frames[_target]||
                         (_e._$get(_target)||_o).contentWindow;
                if (!_target) return;
            }
            // check data
            var _data = _u._$fetch({
                data:null,
                origin:'*',
                source:_self
            },_options);
            // send message
            _h.__postMessage(_target,_data);
        };
    })();

    if (CMPT){
        NEJ.copy(NEJ.P('nej.j'),_p);
    }

    return _p;
},215,2,4,633);
I$(454,function (_t,_u,_k,_v,_c,_e,_j,_p,_o,_f,_r){
    var _pro,
        _cache = {};
    /**
     * Frame代理方式Ajax请求对象
     * 
     * @class   module:util/ajax/proxy/frame._$$ProxyFrame
     * @extends module:util/ajax/proxy/proxy._$$ProxyAbstract
     * 
     * @param   {Object}  config - 构造配置参数
     */
    _p._$$ProxyFrame = _k._$klass();
    _pro = _p._$$ProxyFrame._$extend(_t._$$ProxyAbstract);
    /**
     * 控件初始化
     *
     * @protected
     * @method module:util/ajax/proxy/frame._$$ProxyFrame#__init
     * @return {Void}
     */
    _pro.__init = (function(){
        var _flag = 'NEJ-AJAX-DATA:',
            _init = !1;
        // receive message
        var _doReceiveMessage = function(_event){
            var _data = _event.data;
            if (_data.indexOf(_flag)!=0) return;
            _data = JSON.parse(_data.replace(_flag,''));
            var _proxy = _cache[_data.key];
            if (!_proxy) return;
            delete _cache[_data.key];
            _data.result = decodeURIComponent(_data.result||'');
            _proxy.__onLoadRequest(_data);
        };
        // init message listener
        var _doInitMessage = function(){
            if (!_init){
                _init = !0;
                _v._$addEvent(
                    window,'message',
                    _doReceiveMessage
                );
            }
        };
        return function(){
            this.__super();
            _doInitMessage();
        };
    })();
    /**
     * 往服务器发送请求
     *
     * @protected
     * @method module:util/ajax/proxy/frame._$$ProxyFrame#__doSendRequest
     * @param  {Object} arg0 - 请求信息
     * @return {Void}
     */
    _pro.__doSendRequest = function(_options){
        var _request = _options.request,
            _proxy = _c._$getFrameProxy(_request.url),
            _frame = _cache[_proxy];
        // callback list
        if (_u._$isArray(_frame)){
            _frame.push(
                this.__doSendRequest.
                    _$bind(this,_options)
            );
            return;
        }
        // build frame proxy
        if (!_frame){
            _cache[_proxy] = [
                this.__doSendRequest.
                    _$bind(this,_options)
            ];
            _e._$createXFrame({
                src:_proxy,visible:!1,
                onload:function(_event){
                    var _list = _cache[_proxy];
                    _cache[_proxy] = _v.
                        _$getElement(_event).contentWindow;
                    _u._$reverseEach(
                        _list,function(_handler){
                            try{
                                _handler();
                            }catch(ex){
                                // ignore
                            }
                        }
                    );
                }
            });
            return;
        }
        // send message to frame
        this.__rkey = _u._$uniqueID();
        _cache[this.__rkey] = this;
        var _data = _u._$fetch({
            url:'',data:null,
            timeout:0,method:'GET'
        },_request);
        _data.key = this.__rkey;
        _data.headers = _options.headers;
        _j._$postMessage(_cache[_proxy],{data:_data});
    };
    /**
     * 中断请求
     * 
     * @method module:util/ajax/proxy/frame._$$ProxyFrame#_$abort
     * @return {Void}
     */
    _pro._$abort = function(){
        delete _cache[this.__rkey];
        this.__onLoadRequest({status:0});
    };
    
    return _p;
},451,2,1,3,377,4,593);
I$(455,function (_t,_k,_u,_v,_e,_g,_j0,_j1,_p,_o,_f,_r){
    var _pro,
        _cache = {},
        _xflag = 'NEJ-UPLOAD-RESULT:';
    /**
     * 文件上传代理
     *
     * @class   module:util/ajax/proxy/upload._$$ProxyUpload
     * @extends module:util/ajax/proxy/proxy._$$ProxyAbstract
     *
     * @param   {Object}  config - 构造配置参数
     */
    _p._$$ProxyUpload = _k._$klass();
    _pro = _p._$$ProxyUpload._$extend(_t._$$ProxyAbstract);
    /**
     * 控件初始化
     *
     * @protected
     * @method module:util/ajax/proxy/upload._$$ProxyUpload#__init
     * @return {Void}
     */
    _pro.__init = (function(){
        var _init = !1;
        // receive message callback
        var _doReceiveMessage = function(_event){
            var _data = _event.data;
            if (_data.indexOf(_xflag)!=0) return;
            _data = JSON.parse(_data.replace(_xflag,''));
            var _proxy = _cache[_data.key];
            if (!_proxy) return;
            delete _cache[_data.key];
            _proxy.__onLoadRequest(
                decodeURIComponent(_data.result)
            );
        };
        // init message listener
        var _doInitMessage = function(){
            if (!_init){
                _init = !0;
                _v._$addEvent(
                    window,'message',
                    _doReceiveMessage
                );
            }
        };
        return function(){
            this.__super();
            _doInitMessage();
        };
    })();
    /**
     * 控件销毁
     * 
     * @protected
     * @method module:util/ajax/proxy/upload._$$ProxyUpload#__destroy
     * @return {Void}
     */
    _pro.__destroy = function(){
        this.__super();
        _e._$remove(this.__frame);
        delete this.__frame;
        window.clearTimeout(this.__timer);
        delete this.__timer;
    };
    /**
     * 请求载入回调
     * 
     * @protected
     * @method module:util/ajax/proxy/upload._$$ProxyUpload#__onLoadRequest
     * @param  {String} arg0 - 数据信息
     * @return {Void}
     */
    _pro.__onLoadRequest = function(_text){
        var _json;
        try{
            _json = JSON.parse(_text);
            this._$dispatchEvent('onload',_json);
        }catch(ex){
            this._$dispatchEvent('onerror',{
                code:_g._$CODE_ERREVAL,
                message:_text
            });
        }
    };
    /**
     * 往服务器发送请求
     * 
     * @protected
     * @method module:util/ajax/proxy/upload._$$ProxyUpload#__doSendRequest
     * @param  {Object} arg0 - 请求信息
     * @return {Void}
     */
    _pro.__doSendRequest = (function(){
        // same domain upload result check
        var _doCheckResult = function(){
            var _body,_text;
            try{
                var _body = this.__frame.contentWindow.document.body,
                    _text = (_body.innerText||_body.textContent||'').trim();
                // check result for same domain with upload proxy html
                if (_text.indexOf(_xflag)>=0||
                    _body.innerHTML.indexOf(_xflag)>=0){
                    // use post message path
                    return;
                }
            }catch(ex){
                // ignore if not same domain
                return;
            }
            this.__onLoadRequest(_text);
        };
        // check upload progress
        var _doProgress = function(_url,_mode,_cookie){
            _j0._$request(_url,{
                type:'json',
                method:'POST',
                cookie:_cookie,
                mode:parseInt(_mode)||0,
                onload:function(_data){
                    if (!this.__timer) return;
                    this._$dispatchEvent('onuploading',_data);
                    this.__timer = window.setTimeout(
                        _doProgress._$bind(
                            this,_url,_mode,_cookie
                        ),1000
                    );
                }._$bind(this),
                onerror:function(_error){
                    if (!this.__timer) return;
                    this.__timer = window.setTimeout(
                        _doProgress._$bind(
                            this,_url,_mode,_cookie
                        ),1000
                    );
                }._$bind(this)
            });
        };
        return function(_options){
            var _request = _options.request,
                _headers = _options.headers,
                _form = _request.data,
                _name = _u._$uniqueID();
            _cache[_name]  = this;
            _form.target   = _name;
            _form.method   = 'POST';
            _form.enctype  = _g._$HEAD_CT_FILE;
            _form.encoding = _g._$HEAD_CT_FILE;
            var _url = _form.action||'',
                _sep = _url.indexOf('?')<=0?'?':'&';
            _form.action = _url+_sep+'_proxy_=form';
            this.__frame = _e._$createXFrame({
                name:_name,
                onload:function(_event){
                    var _frame = _v._$getElement(_event);
                    _v._$addEvent(
                        _frame,'load',
                        _doCheckResult._$bind(this)
                    );
                    _form.submit();
                    var _qurl = (_form.nej_query||_o).value;
                    if (!_qurl) return;
                    var _mode = (_form.nej_mode||_o).value,
                        _cookie = (_form.nej_cookie||_o).value==='true';
                    this.__timer = window.setTimeout(
                        _doProgress._$bind(
                            this,_qurl,_mode,_cookie
                        ),100
                    );
                }._$bind(this)
            });
        };
    })();
    /**
     * 中断请求
     * 
     * @method module:util/ajax/proxy/upload._$$ProxyUpload#_$abort
     * @return {Void}
     */
    _pro._$abort = function(){
        this._$dispatchEvent('onerror',{
            code:_g._$CODE_ERRABRT,
            message:'客户端终止文件上传'
        });
    };

    return _p;
},451,1,2,3,4,227,14,593);
I$(456,function (_t0,_t1,_t2,_t3,_p,_o,_f,_r){
    /**
     * 根据模式返回代理实例，模式说明
     * 0 - 自动模式，高版本使用HTML5的CORS协议，低版本采用Frame代理方式
     * 1 - 高版本使用HTML5的CORS协议，普通请求低版本采用Flash代理方式
     * 2 - 全部使用Frame代理方式
     * 3 - 全部使用Flash代理方式
     * @param  {Number}   模式
     * @param  {Boolean}  是否文件上传
     * @param  {Object}   构造配置参数
     * @return {_$$ProxyAbstract} 代理实例
     */
    _p.__getProxyByMode = function(_mode,_upload,_options){
        var _map = !!_upload 
                 ? {2:_t3._$$ProxyUpload}
                 : {2:_t2._$$ProxyFrame,3:_t1._$$ProxyFlash};
        return (_map[_mode]||_t0._$$ProxyXHR)._$allocate(_options);
    };
    
    return _p;
},243,453,454,455);
I$(244,function(b1482406244153,_h,_p,_o,_f,_r){if (b1482406244153._$KERNEL.engine==='trident'&&b1482406244153._$KERNEL.release<='5.0'){I$(457,function (){
        /**
         * 根据模式返回代理实例，模式说明
         * 0 - 自动模式，高版本使用HTML5的CORS协议，低版本采用Frame代理方式
         * 1 - 高版本使用HTML5的CORS协议，普通请求低版本采用Flash代理方式
         * 2 - 全部使用Frame代理方式
         * 3 - 全部使用Flash代理方式
         * @param  {Number}  模式
         * @param  {Boolean} 是否文件上传
         * @param  {Object}  构造配置参数
         * @return {_$$ProxyAbstract} 代理实例
         */
        _h.__getProxyByMode = (function(){
            var _pmap = {0:2,1:3};
            return _h.__getProxyByMode._$aop(function(_event){
               var _args = _event.args,
                   _mode = _args[0]||0;
               _args[0] = !!_args[1] ? 2 :
                          _pmap[_mode]||_mode;
            });
        })();
    });}return _h;},78,456);
I$(14,function (NEJ,_g,_u,_e,_t,_h,_p,_o,_f,_r){
    /**
     * 载入回调
     *
     * @callback module:util/ajax/xdr.onload
     * @param    {Variable|Object} event - 请求返回数据，根据请求时type指定格式返回，
     *                                     如果请求时指定了result参数，则此处输入为包含额外信息的对象，
     *                                     数据结果从此对象的data属性中取，如{headers:{'x-res-0':'12345', ...},data:{a:'aaa', ...}}
     */
    /**
     * 出错回调
     *
     * @callback module:util/ajax/xdr.onerror
     * @param    {Object}   event   - 错误信息
     * @property {Number}   code    - 错误代码
     * @property {String}   message - 错误描述
     * @property {Variable} data    - 出错时携带数据
     */
    /**
     * 请求之前对数据处理回调
     *
     * @callback module:util/ajax/xdr.onbeforerequest
     * @param    {Object} event   - 请求信息
     * @property {Object} request - 请求参数，数据信息 url/sync/cookie/type/method/timeout
     * @property {Object} headers - 请求头信息
     */
    /**
     * 上传进度回调
     *
     * @callback module:util/ajax/xdr.onuploading
     * @param    {Object} event  - 进度信息
     * @property {Number} loaded - 载入数量
     * @property {Number} total  - 总量
     */
    // sn:{req:proxy,onload:function(){},onerror:function(){}}
    var _xcache = {},
        _doFilter = _f;
    /**
     * 中断请求
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/ajax/xdr'
     * ],function(_j){
     *     var _id = _j._$request(
     *         'http://123.163.com/xhr/',{
     *             type:'json',
     *             method:'POST',
     *             data:{name:'ABC'},
     *             timeout:60000,
     *             onload:function(_data){
     *                 // TODO
     *             },
     *             onerror:function(_error){
     *                 // TODO
     *             }
     *         }
     *     );
     *     // 1秒后中断掉这个请求
     *     window.setTimeout(
     *         function(){
     *             _j._$abort(_id);
     *         },1000
     *     );
     * });
     * ```
     *
     * @method module:util/ajax/xdr._$abort
     * @param  {String} arg0 - 请求标识
     * @return {Void}
     */
    _p._$abort = function(_sn){
        var _cache = _xcache[_sn];
        if (!!_cache){
            _cache.req._$abort();
        }
    };
    /**
     * 全局请求过滤器，过滤器中可以通过设置输入事件对象的stopped值阻止继续回调
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/ajax/xdr'
     * ],function(_j){
     *     _j._$filter(function(_event){
     *         // _event.type     请求过滤类型
     *         // _event.result   请求结果
     *         // _event.stopped  是否阻止后续逻辑
     *
     *         // 过滤掉404的异常，如果type是onload不做处理
     *         if (_event.type == 'onerror'){
     *             if (_event.result.data == 404){
     *                 _event.stopped = false;
     *             }
     *         }
     *     });
     *     _j._$request('xxxx',{
     *         type:'json',
     *         method:'POST',
     *         data:{name:'abc'},
     *         timeout:3000,
     *         onload:function(_data){
     *             // TODO
     *         },
     *         onerror:function(_error){
     *             // TODO
     *         }
     *     });
     * });
     * ```
     *
     * @method module:util/ajax/xdr._$filter
     * @param  {Function} arg0 - 过滤器
     * @return {Void}
     */
    _p._$filter = function(_filter){
        _doFilter = _filter||_f;
    };
    /**
     * 发送ajax请求
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/ajax/xdr'
     * ],function(_p){
     *     var _id = _p._$request(
     *         'http://a.b.com/api',{
     *             sync:true,
     *             type:'json',
     *             data:'hello',
     *             query:'a=1&b=2',
     *             method:'post',
     *             timeout:3000,
     *             mode:0||1||2||3,
     *             onload:function(_data){
     *                 // 正常回调处理
     *             },
     *             onerror:function(_error){
     *                 // 异常处理
     *             },
     *             onbeforerequest:function(_data){
     *                 // 请求发送前，对请求数据处理
     *             }
     *         }
     *     );
     * });
     * ```
     *
     * @method   module:util/ajax/xdr._$request
     * @param    {String}   arg0    - 请求地址
     * @param    {Object}   arg1    - 配置参数
     * @property {Boolean}  sync    - 是否同步请求
     * @property {String}   type    - 返回数据格式,text/json/xml
     * @property {Variable} data    - 要发送的数据
     * @property {Variable} query   - 查询参数,字符串格式a=b&c=d,对象格式{a:'b',c:'d'}
     * @property {String}   method  - 请求方式,GET/POST
     * @property {Number}   timeout - 超时时间,0 禁止超时监测
     * @property {Object}   headers - 头信息表
     * @property {Boolean}  cookie  - 跨域请求是否带cookie，仅对CORS方式有效
     * @property {Number}   mode    - 请求模式,针对跨域请求采用的请求方式
     *
     * * 0 - 自动模式，高版本使用HTML5的CORS协议，低版本采用Frame代理方式
     * * 1 - 高版本使用HTML5的CORS协议，低版本采用Flash代理方式
     * * 2 - 全部使用Frame代理方式
     * * 3 - 全部使用Flash代理方式
     *
     * @property {Object}   result  - onload回调输入时需包含的额外信息，已处理额外数据
     *
     * * headers - 服务器返回头信息，如{headers:'x-res-0'}或者{headers:['x-res-0','x-res-1']}
     *
     * @property {module:util/ajax/xdr.onload}          onload  - 数据载入回调
     * @property {module:util/ajax/xdr.onerror}         onerror - 请求异常回调
     * @property {module:util/ajax/xdr.onbeforerequest} onbeforerequest - 请求之前回调
     *
     * @return   {String} 分配给请求的ID
     */
    _p._$request = (function(){
        var _location = (location.protocol+'//'
                        +location.host).toLowerCase();
        // check cross-domain request
        var _isXDomain = function(_url){
            var _origin = _u._$url2origin(_url);
            return !!_origin&&_origin!=_location;
        };
        // check file upload
        var _isUpload = function(_headers){
            return (_headers||_o)[_g._$HEAD_CT]==_g._$HEAD_CT_FILE;
        };
        // get ajax proxy
        var _getProxy = function(_options){
            var _upload = _isUpload(_options.headers);
            if (!_isXDomain(_options.url)&&!_upload)
                return _t._$$ProxyXHR._$allocate(_options);
            return _h.__getProxyByMode(_options.mode,_upload,_options);
        };
        // parse ext result
        var _doParseExtData = function(_cache,_result){
            var _data = {
                data:_result
            };
            // parse ext headers
            var _keys = _cache.result.headers;
            if (!!_keys){
                _data.headers = _cache.req._$header(_keys);
            }
            // TODO parse other ext data
            return _data;
        };
        // clear cache
        var _doClear = function(_sn){
            var _cache = _xcache[_sn];
            if (!_cache) return;
            if (!!_cache.req)
                _cache.req._$recycle();
            delete _xcache[_sn];
        };
        // do callback
        var _doCallback = function(_sn,_type){
            var _cache = _xcache[_sn];
            if (!_cache) return;
            var _data = arguments[2];
            if (_type=='onload'&&!!_cache.result){
                _data = _doParseExtData(_cache,_data);
            }
            _doClear(_sn);
            var _event = {
                type:_type,
                result:_data
            };
            _doFilter(_event);
            if (!_event.stopped){
               (_cache[_type]||_f)(_event.result);
            }
        };
        // onload callback
        var _onLoad = function(_sn,_data){
            _doCallback(_sn,'onload',_data);
        };
        // onerror callback
        var _onError = function(_sn,_error){
            _doCallback(_sn,'onerror',_error);
        };
        // function body
        return function(_url,_options){
            _options = _options||{};
            // cache request callback
            var _sn = _u._$uniqueID(),
                _cache = {
                    result:_options.result,
                    onload:_options.onload||_f,
                    onerror:_options.onerror||_f
                };
            _xcache[_sn] = _cache;
            _options.onload = _onLoad._$bind(null,_sn);
            _options.onerror = _onError._$bind(null,_sn);
            // append request query
            if (!!_options.query){
                var _sep = _url.indexOf('?')<0?'?':'&',
                    _query = _options.query;
                if (_u._$isObject(_query))
                    _query = _u._$object2query(_query);
                if (!!_query) _url += _sep+_query;
            }
            _options.url = _url;
            _cache.req = _getProxy(_options);
            _cache.req._$send(_options.data);
            return _sn;
        };
    })();
    /**
     * 文件上传
     *
     * 结构举例
     * ```html
     * <form id="upload" name="upload" action="http://123.163.com:3000/xhr/uploadCallback">
     *    <input type="text" id="progress" />
     *    <input type="hidden" name="nej_mode" value="2" />
     *    <input type="hidden" name="nej_query" value="http://123.163.com:3000/xhr/progress" />
     * </form>
     * ```
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/ajax/xdr'
     * ],function(_j){
     *     _j._$upload('upload',{
     *         mode:2,
     *         cookie:true,
     *         onuploading:function(_data){
     *             // 后台处理http://123.163.com:3000/xhr/progress，返回一个json对象
     *             // 前台会去轮询此接口获取进度
     *             if(!!_data.total&&_data.progress){
     *                 _progress.value = _data.progress;
     *             }
     *         },
     *         onload:function(_url){
     *             // 此前会把进度轮询终止掉。如果要显示进度100%，可在此设置一次
     *             // 后台处理http://123.163.com:3000/xhr/uploadCallback，返回url
     *             // 文件上传完成的回调,url为返回的地址
     *         }
     *     });
     * });
     * ```
     *
     * @method   module:util/ajax/xdr._$upload
     * @see      module:util/ajax/xdr._$request
     * @param    {HTMLFormElement}  arg0    - 表单对象，待上传的文件及目标地址信息封装在此对象中
     * @param    {Object}           arg1    - 可选配置参数
     * @property {String}           type    - 返回数据格式
     * @property {Variable}         query   - 查询参数
     * @property {Number}           mode    - 跨域类型，0/2，见_$request接口说明
     * @property {Object}           headers - 头信息
     * @property {Boolean}          cookie  - 跨域请求是否带cookie，仅对CORS方式有效
     *
     * @property {module:util/ajax/xdr.onload}          onload  - 数据载入回调
     * @property {module:util/ajax/xdr.onerror}         onerror - 请求异常回调
     * @property {module:util/ajax/xdr.onuploading}     onuploading     - 上传进度回调
     * @property {module:util/ajax/xdr.onbeforerequest} onbeforerequest - 请求之前回调
     *
     * @return   {String}                     分配给请求的ID
     */
    _p._$upload = function(_form,_options){
        _form = _e._$get(_form);
        if (!_form){
            return '';
        }
        // init param
        var _option = _u._$fetch({
            mode:0,
            type:'json',
            query:null,
            cookie:!1,
            headers:{},
            onload:null,
            onerror:null,
            onuploading:null,
            onbeforerequest:null
        },_options);
        _option.data = _form;
        _option.method = 'POST';
        _option.timeout = 0;
        _option.headers[_g._$HEAD_CT] =
                        _g._$HEAD_CT_FILE;
        return _p._$request(_form.action,_option);
    };

    if (CMPT){
        NEJ.copy(NEJ.P('nej.j'),_p);
    }

    return _p;
},215,227,2,4,243,244);
I$(339,function (s, j,  v){

  // Regular中的dom帮助函数
  var dom = Regular.dom;

  var directives = {

    'r-tooltip': function(elem, value){
      console.log('do some directive logic');
    }
  }

  var events = {

    // 使用nej的mouseenter
    'mouseenter': function(elem, fire, attrs){
      v._$addEvent(elem, 'mouseenter', fire)
      return function(){
        v._$delEvent(elem, 'mouseenter', fire)
      }
    },
    // 使用nej的mouseleave
    'mouseleave': function(elem, fire, attrs){
      v._$addEvent(elem, 'mouseleave', fire)
      return function(){
        v._$delEvent(elem, 'mouseleave', fire)
      }
    },

    // on-upload 的custom event实现
    // 注意 on-upload 必须绑定在 label上
    'upload': function(elem, fire, attrs){
      // 我们需要另外一个属性以提取参数

      var uploadParam = attrs.filter(function(attr){
        return attr.name === 'upload-param';
      })[0];

      var form; 

      var param = {};

      if(uploadParam) param = this.$get(Regular.expression(uploadParam.value))||{};

      // 处理上传
      function onUpload(_json){
        var json = _json||{};
        if(json && json.retcode === 200){ //success
          fire({type:'upload', data:json, param:param});
        }else{
          fire({type:'error', message:json.retdesc, param:param});
        }
        bindSelectFile();
      }
      // 增加处理前回调 mt 20161128
      function onBeforeRequest(json){
        fire({type:'before',data:json});
      }
      // 处理进度条
      function onProgress(_json){
        var json = _json||{};
        if(json && typeof json.total === 'number' && typeof json.progress === 'number'){
          fire({ type: 'progress' , data: json.progress / json.total });
        }
      }
      // 处理选择file
      function onFileChange(ev){
        if(typeof FileReader === 'function'){
          var files = nes.one('input', ev.form ).files,
            file = files[0];
          var reader = new FileReader(file);

          reader.readAsDataURL(file); //读取文件

          reader.addEventListener('load', function(){
            fire({type: 'preview', data: this.result})
          })
        }
        
        s._$unbind(ev.id);
        ev.form.setAttribute('action', param.url||'/uploadImageForNej.html?module=authOcr')

        j._$upload(ev.form, {
          onload: onUpload,
          onerror: onUpload,
          onuploading: onProgress,
          onbeforerequest: onBeforeRequest
        })
      }
      var id;
      function bindSelectFile(){
        id = s._$bind(elem, {
          parent: elem.parentNode,
          name: 'img',
          multiple: !!param.multiple,
          accept:param.accept||'image/jpg,image/jpeg,image/png',
          onchange: onFileChange
        });
      }
      // 使用select动态生成input:file.
      // 由于必须要在文档中，所以必须在inject之后进行bind
      if(this.$root === this){
        this.$on('inject', bindSelectFile);
      }else{
        setTimeout(function(){
          bindSelectFile();
        }._$bind(this));
      }

      return function destroy(){
        if(id) s._$unbind(id);
        // TODO: remove form 根据id
      }
    }
  }

  return {
    events: events,
    directives: directives
  };

},516,14,3,247);
I$(245,function (NEJ,_p,_o,_f,_r){
    // bits per input character. 8 - ASCII; 16 - Unicode
    var __chrsz = 8;
    /*
     * Bitwise rotate a 32-bit number to the left.
     */
    var __rol = function(_number,_count){
        return (_number<<_count)|(_number>>>(32-_count));
    };
    /*
     * Add integers, wrapping at 2^32. This uses 16-bit operations internally
     * to work around bugs in some JS interpreters.
     */
    var __add = function(x,y){
        var _lsw = (x&0xFFFF)+(y&0xFFFF),
            _msw = (x>>16)+(y>>16)+(_lsw>>16);
        return (_msw<<16)|(_lsw&0xFFFF);
    };
    /*
     * Perform the appropriate triplet combination function for the current
     * iteration
     */
    var __sha1ft = function(t,b,c,d){
        if (t<20) return (b&c)|((~b)&d);
        if (t<40) return  b^c^d;
        if (t<60) return (b&c)|(b&d)|(c&d);
        return b^c^d;
    };
    /*
     * Determine the appropriate additive constant for the current iteration
     */
    var __sha1kt = function(t){
        if (t<20) return 1518500249;
        if (t<40) return 1859775393;
        if (t<60) return -1894007588;
        return -899497514;
    };
    /*
     * Convert an 8-bit or 16-bit string to an array of big-endian or little-endian words
     */
    var __str2bin = (function(){
        var _lmove = function(i){return i%32;},
            _bmove = function(i){return 32-__chrsz-i%32;};
        return function(_str,_little){
            var _bin  = [],
                _mask = (1<<__chrsz)-1,
                _move = _little?_lmove:_bmove;
            for (var i=0,l=_str.length*__chrsz;i<l;i+=__chrsz)
                _bin[i>>5] |= (_str.charCodeAt(i/__chrsz)&_mask)<<_move(i);
            return _bin;
        };
    })();
    /*
     * Convert an array of big-endian or little-endian words to a hex string.
     */
    var __bin2hex = (function(){
        // hex output table.
        var _hextab = '0123456789abcdef',
            _lmove  = function(i){return i%4;},
            _bmove  = function(i){return 3-i%4;};
        return function(_binarray,_little){
            var _arr = [],
                _move = _little?_lmove:_bmove;
            for(var i=0,l=_binarray.length*4;i<l;i++){
                _arr.push(_hextab.charAt((_binarray[i>>2]>>(_move(i)*8+4))&0xF)
                         +_hextab.charAt((_binarray[i>>2]>>(_move(i)*8))&0xF));
            }
            return _arr.join('');
        };
    })();
    /*
     * Convert an array of big-endian or little-endian words to a string
     */
    var __bin2str = (function(){
        var _lmove = function(i){return i%32;},
            _bmove = function(i){return 32-__chrsz-i%32;};
        return function(_bin,_little){
            var _arr  = [],
                _mask = (1<<__chrsz)-1,
                _move = _little?_lmove:_bmove;
            for(var i=0,l=_bin.length*32;i<l;i+=__chrsz)
                _arr.push(String.fromCharCode((_bin[i>>5]>>>_move(i))&_mask));
            return _arr.join('');
        };
    })();
    /*
     * Convert an array of big-endian or little-endian words to a base-64 string
     */
    var __bin2b64 = (function(){
        var _b64pad = '=', // base-64 pad character. "=" for strict RFC compliance
            _b64tab = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',
            _lmove  = function(i){return i%4;},
            _bmove  = function(i){return 3-i%4;};
        return function(_binarray,_little){
            var _arr = [],
                _move = _little?_lmove:_bmove;
            for(var i=0,_triplet;i<_binarray.length*4;i+=3){
                _triplet = (((_binarray[i>>2]>>8*_move(i))&0xFF)<<16)
                         | (((_binarray[i+1>>2]>>8*_move(i+1))&0xFF)<<8)
                         | ((_binarray[i+2>>2]>>8*_move(i+2))&0xFF);
                for(var j=0;j<4;j++)
                    _arr.push((i*8+j*6>_binarray.length*32) ? _b64pad
                             : _b64tab.charAt((_triplet>>6*(3-j))&0x3F));
            }
            return _arr.join('');
        };
    })();
    /*
     * These functions implement the four basic operations the algorithm uses.
     */
    var __md5cm = function(q,a,b,x,s,t){
        return __add(__rol(__add(__add(a,q),__add(x,t)),s),b);
    };
    var __md5ff = function(a,b,c,d,x,s,t){
        return __md5cm((b&c)|((~b)&d),a,b,x,s,t);
    };
    var __md5gg = function(a,b,c,d,x,s,t){
        return __md5cm((b&d)|(c&(~d)),a,b,x,s,t);
    };
    var __md5hh = function(a,b,c,d,x,s,t){
        return __md5cm(b^c^d,a,b,x,s,t);
    };
    var __md5ii = function(a,b,c,d,x,s,t){
        return __md5cm(c^(b|(~d)),a,b,x,s,t);
    };
    /*
     * Calculate the MD5 of an array of little-endian words, and a bit length
     */
    var __data2md5  = function(x,y){
        x[y>>5] |= 0x80<<((y)%32);
        x[(((y+64)>>>9)<<4)+14] = y;
        var a = 1732584193,
            b = -271733879,
            c = -1732584194,
            d = 271733878;
        for(var i=0,l=x.length,_oa,_ob,_oc,_od;i<l;i+=16){
            _oa = a; _ob = b; _oc = c; _od = d;
            a = __md5ff(a, b, c, d, x[i+ 0], 7 , -680876936);
            d = __md5ff(d, a, b, c, x[i+ 1], 12, -389564586);
            c = __md5ff(c, d, a, b, x[i+ 2], 17,  606105819);
            b = __md5ff(b, c, d, a, x[i+ 3], 22, -1044525330);
            a = __md5ff(a, b, c, d, x[i+ 4], 7 , -176418897);
            d = __md5ff(d, a, b, c, x[i+ 5], 12,  1200080426);
            c = __md5ff(c, d, a, b, x[i+ 6], 17, -1473231341);
            b = __md5ff(b, c, d, a, x[i+ 7], 22, -45705983);
            a = __md5ff(a, b, c, d, x[i+ 8], 7 ,  1770035416);
            d = __md5ff(d, a, b, c, x[i+ 9], 12, -1958414417);
            c = __md5ff(c, d, a, b, x[i+10], 17, -42063);
            b = __md5ff(b, c, d, a, x[i+11], 22, -1990404162);
            a = __md5ff(a, b, c, d, x[i+12], 7 ,  1804603682);
            d = __md5ff(d, a, b, c, x[i+13], 12, -40341101);
            c = __md5ff(c, d, a, b, x[i+14], 17, -1502002290);
            b = __md5ff(b, c, d, a, x[i+15], 22,  1236535329);
            a = __md5gg(a, b, c, d, x[i+ 1], 5 , -165796510);
            d = __md5gg(d, a, b, c, x[i+ 6], 9 , -1069501632);
            c = __md5gg(c, d, a, b, x[i+11], 14,  643717713);
            b = __md5gg(b, c, d, a, x[i+ 0], 20, -373897302);
            a = __md5gg(a, b, c, d, x[i+ 5], 5 , -701558691);
            d = __md5gg(d, a, b, c, x[i+10], 9 ,  38016083);
            c = __md5gg(c, d, a, b, x[i+15], 14, -660478335);
            b = __md5gg(b, c, d, a, x[i+ 4], 20, -405537848);
            a = __md5gg(a, b, c, d, x[i+ 9], 5 ,  568446438);
            d = __md5gg(d, a, b, c, x[i+14], 9 , -1019803690);
            c = __md5gg(c, d, a, b, x[i+ 3], 14, -187363961);
            b = __md5gg(b, c, d, a, x[i+ 8], 20,  1163531501);
            a = __md5gg(a, b, c, d, x[i+13], 5 , -1444681467);
            d = __md5gg(d, a, b, c, x[i+ 2], 9 , -51403784);
            c = __md5gg(c, d, a, b, x[i+ 7], 14,  1735328473);
            b = __md5gg(b, c, d, a, x[i+12], 20, -1926607734);
            a = __md5hh(a, b, c, d, x[i+ 5], 4 , -378558);
            d = __md5hh(d, a, b, c, x[i+ 8], 11, -2022574463);
            c = __md5hh(c, d, a, b, x[i+11], 16,  1839030562);
            b = __md5hh(b, c, d, a, x[i+14], 23, -35309556);
            a = __md5hh(a, b, c, d, x[i+ 1], 4 , -1530992060);
            d = __md5hh(d, a, b, c, x[i+ 4], 11,  1272893353);
            c = __md5hh(c, d, a, b, x[i+ 7], 16, -155497632);
            b = __md5hh(b, c, d, a, x[i+10], 23, -1094730640);
            a = __md5hh(a, b, c, d, x[i+13], 4 ,  681279174);
            d = __md5hh(d, a, b, c, x[i+ 0], 11, -358537222);
            c = __md5hh(c, d, a, b, x[i+ 3], 16, -722521979);
            b = __md5hh(b, c, d, a, x[i+ 6], 23,  76029189);
            a = __md5hh(a, b, c, d, x[i+ 9], 4 , -640364487);
            d = __md5hh(d, a, b, c, x[i+12], 11, -421815835);
            c = __md5hh(c, d, a, b, x[i+15], 16,  530742520);
            b = __md5hh(b, c, d, a, x[i+ 2], 23, -995338651);
            a = __md5ii(a, b, c, d, x[i+ 0], 6 , -198630844);
            d = __md5ii(d, a, b, c, x[i+ 7], 10,  1126891415);
            c = __md5ii(c, d, a, b, x[i+14], 15, -1416354905);
            b = __md5ii(b, c, d, a, x[i+ 5], 21, -57434055);
            a = __md5ii(a, b, c, d, x[i+12], 6 ,  1700485571);
            d = __md5ii(d, a, b, c, x[i+ 3], 10, -1894986606);
            c = __md5ii(c, d, a, b, x[i+10], 15, -1051523);
            b = __md5ii(b, c, d, a, x[i+ 1], 21, -2054922799);
            a = __md5ii(a, b, c, d, x[i+ 8], 6 ,  1873313359);
            d = __md5ii(d, a, b, c, x[i+15], 10, -30611744);
            c = __md5ii(c, d, a, b, x[i+ 6], 15, -1560198380);
            b = __md5ii(b, c, d, a, x[i+13], 21,  1309151649);
            a = __md5ii(a, b, c, d, x[i+ 4], 6 , -145523070);
            d = __md5ii(d, a, b, c, x[i+11], 10, -1120210379);
            c = __md5ii(c, d, a, b, x[i+ 2], 15,  718787259);
            b = __md5ii(b, c, d, a, x[i+ 9], 21, -343485551);
            a = __add(a, _oa);
            b = __add(b, _ob);
            c = __add(c, _oc);
            d = __add(d, _od);
        }   return [a, b, c, d];
    };
    /*
     * Calculate the HMAC-MD5, of a key and some data
     */
    var __data2hmacmd5 = function(_key,_data){
        var _bkey = __str2bin(_key,!0);
        if (_bkey.length>16)
            _bkey = __data2md5(_bkey,_key.length*__chrsz);

        var _ipad = Array(16),
            _opad = Array(16);
        for(var i=0;i<16;i++){
            _ipad[i] = _bkey[i]^0x36363636;
            _opad[i] = _bkey[i]^0x5C5C5C5C;
        }

        var _hash = __data2md5(_ipad.concat(
                               __str2bin(_data,!0)),
                               512+_data.length*__chrsz);
        return __data2md5(_opad.concat(_hash),512+128);
    };
    /*
     * Calculate the SHA-1 of an array of big-endian words, and a bit length
     */
    var __data2sha1 = function(x,_length){
        /* append padding */
        x[_length>>5] |= 0x80<<(24-_length%32);
        x[((_length+64>>9)<<4)+15] = _length;
        var w = Array(80),  a = 1732584193,
            b = -271733879, c = -1732584194,
            d = 271733878,  e = -1009589776;
        for(var i=0,l=x.length,_olda,
            _oldb,_oldc,_oldd,_olde;i<l;i+=16){
            _olda = a; _oldb = b;
            _oldc = c; _oldd = d; _olde = e;
            for(var j=0;j<80;j++){
                w[j] = j<16 ? x[i+j]
                            : __rol(w[j-3]^w[j-8]^w[j-14]^w[j-16],1);
                var t = __add(__add(__rol(a,5),
                              __sha1ft(j,b,c,d)),
                              __add(__add(e,w[j]),
                              __sha1kt(j)));
                e = d; d = c;
                c = __rol(b,30);
                b = a; a = t;
            }
            a = __add(a,_olda);
            b = __add(b,_oldb);
            c = __add(c,_oldc);
            d = __add(d,_oldd);
            e = __add(e,_olde);
        }
        return [a,b,c,d,e];
    };
    /*
     * Calculate the HMAC-SHA1 of a key and some data
     */
    var __data2hmacsha1 = function(_key,_data){
        var _bkey = __str2bin(_key);
        if (_bkey.length>16)
            _bkey = __data2sha1(_bkey,_key.length*__chrsz);

        var _ipad = Array(16),
            _opad = Array(16);
        for(var i=0;i<16;i++){
            _ipad[i] = _bkey[i]^0x36363636;
            _opad[i] = _bkey[i]^0x5C5C5C5C;
        }
        var _hash = __data2sha1(_ipad.concat(__str2bin(
                                _data)),512+_data.length*__chrsz);
        return __data2sha1(_opad.concat(_hash),512+160);
    };
    /**
     * HMAC-SHA1编码数据输出十六进制串
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/encode/md5'
     * ],function(_u){
     *     // 密钥123，加密abc，输出十六进制编码串
     *     // a3c024f01cccb3b63457d848b0d2f89c1f744a3d
     *     var _result = _u._$hmacsha12hex('123','abc');
     * });
     * ```
     * 
     * @method module:util/encode/md5._$hmacsha12hex
     * @param  {String}   arg0 - 密钥
     * @param  {Variable} arg1 - 数据
     * @return {String}          十六进制编码串
     */
    _p._$hmacsha12hex = function(_key,_data) {
        return __bin2hex(__data2hmacsha1(_key,_data));
    };
    /**
     * HMAC-SHA1编码数据输出Base64串
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/encode/md5'
     * ],function(_u){
     *     // 密钥123，加密abc，输出Base64编码串
     *     // o8Ak8BzMs7Y0V9hIsNL4nB90Sj0=
     *     var _result = _u._$hmacsha12b64('123','abc');
     * });
     * ```
     * 
     * @method module:util/encode/md5._$hmacsha12b64
     * @param  {String}   arg0 - 密钥
     * @param  {Variable} arg1 - 数据
     * @return {String}          Base64编码串
     */
    _p._$hmacsha12b64 = function(_key,_data) {
        return __bin2b64(__data2hmacsha1(_key,_data));
    };
    /**
     * HMAC-SHA1编码数据输出字符串
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/encode/md5'
     * ],function(_u){
     *     // 密钥123，加密abc，输出字符串
     *     // £À$ðÌ³¶4WØH°ÒøtJ=
     *     var _result = _u._$hmacsha12str('123','abc');
     * });
     * ```
     * 
     * @method module:util/encode/md5._$hmacsha12str
     * @param  {String}   arg0 - 密钥
     * @param  {Variable} arg1 - 数据
     * @return {String}          编码串
     */
    _p._$hmacsha12str = function(_key,_data) {
        return __bin2str(__data2hmacsha1(_key,_data));
    };
    /**
     * HMAC-MD5编码数据输出十六进制串
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/encode/md5'
     * ],function(_u){
     *     // 密钥123，加密abc，输出十六进制串
     *     // b2a1ec0f3e0607099d7f39791c04e9a4
     *     var _result = _u._$hmacsha12str('123','abc');
     * });
     * ```
     * 
     * @method module:util/encode/md5._$hmacsha12str
     * @param  {String} arg0 - 密钥
     * @param  {String} arg1 - 数据
     * @return {String}        十六进制串
     */
    _p._$hmacmd52hex = function(_key,_data){
        return __bin2hex(__data2hmacmd5(_key,_data),!0);
    };
    /**
     * HMAC-MD5编码数据输出Base64串
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/encode/md5'
     * ],function(_u){
     *     // 密钥123，加密abc，输出Base64串
     *     // sqHsDz4GBwmdfzl5HATppA==
     *     var _result = _u._$hmacmd52b64('123','abc');
     * });
     * ```
     * 
     * @method module:util/encode/md5._$hmacmd52b64
     * @param  {String} arg0 - 密钥
     * @param  {String} arg1 - 数据
     * @return {String}        Base64串
     */
    _p._$hmacmd52b64 = function(_key,_data){
        return __bin2b64(__data2hmacmd5(_key,_data),!0);
    };
    /**
     * HMAC-MD5编码数据输出字符串
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/encode/md5'
     * ],function(_u){
     *     // 密钥123，加密abc，输出字符串
     *     // ²¡ì> 9yé¤
     *     var _result = _u._$hmacmd52str('123','abc');
     * });
     * ```
     * 
     * @method module:util/encode/md5._$hmacmd52str
     * @param  {String} arg0 - 密钥
     * @param  {String} arg1 - 数据
     * @return {String}        字符串
     */
    _p._$hmacmd52str = function(_key,_data){
        return __bin2str(__data2hmacmd5(_key,_data),!0);
    };
    /**
     * SHA1编码数据输出十六进制串
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/encode/md5'
     * ],function(_u){
     *     // 输入数据123，输出十六进制编码串
     *     // 40bd001563085fc35165329ea1ff5c5ecbdbbeef
     *     var _result = _u._$sha12hex('123');
     * });
     * ```
     * 
     * @method module:util/encode/md5._$sha12hex
     * @param  {Variable} arg0 - 数据
     * @return {String}          十六进制编码串
     */
    _p._$sha12hex = function(_data) {
        return __bin2hex(__data2sha1(
                         __str2bin(_data),
                         _data.length*__chrsz));
    };
    /**
     * SHA1编码数据输出Base64串
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/encode/md5'
     * ],function(_u){
     *     // 输入数据123，输出Base64编码串
     *     // QL0AFWMIX8NRZTKeof9cXsvbvu8=
     *     var _result = _u._$sha12b64('123');
     * });
     * ```
     * 
     * @method module:util/encode/md5._$sha12b64
     * @param  {Variable} arg0 - 数据
     * @return {String}          Base64编码串
     */
    _p._$sha12b64 = function(_data) {
        return __bin2b64(__data2sha1(
                         __str2bin(_data),
                         _data.length*__chrsz));
    };
    /**
     * SHA1编码数据输出字符串
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/encode/md5'
     * ],function(_u){
     *     // 输入数据123，输出字符串
     *     // @½c_ÃQe2¡ÿ\^ËÛ¾ï
     *     var _result = _u._$sha12str('123');
     * });
     * ```
     * 
     * @method module:util/encode/md5._$sha12str
     * @param  {Variable} arg0 - 数据
     * @return {String}          字符串
     */
    _p._$sha12str = function(_data) {
        return __bin2str(__data2sha1(
                         __str2bin(_data),
                         _data.length*__chrsz));
    };
    /**
     * MD5编码数据输出十六进制串
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/encode/md5'
     * ],function(_u){
     *     // 输入数据123，输出十六进制串
     *     // 202cb962ac59075b964b07152d234b70
     *     var _result = _u._$md52hex('123');
     * });
     * ```
     * 
     * @method module:util/encode/md5._$md52hex
     * @param  {String} arg0 - 数据
     * @return {String}        十六进制串
     */
    _p._$md52hex = function(_data){
        return __bin2hex(__data2md5(
                         __str2bin(_data,!0),
                         _data.length*__chrsz),!0);
    };
    /**
     * MD5编码数据输出Base64串
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/encode/md5'
     * ],function(_u){
     *     // 输入数据123，输出Base64串
     *     // ICy5YqxZB1uWSwcVLSNLcA==
     *     var _result = _u._$md52b64('123');
     * });
     * ```
     * 
     * @method module:util/encode/md5._$md52b64
     * @param  {String} arg0 - 数据
     * @return {String}        Base64串
     */
    _p._$md52b64 = function(_data){
        return __bin2b64(__data2md5(
                         __str2bin(_data,!0),
                         _data.length*__chrsz),!0);
    };
    /**
     * MD5编码数据输出字符串
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/encode/md5'
     * ],function(_u){
     *     // 输入数据123，输出字符串
     *     //  ,¹b¬Y[K-#Kp
     *     var _result = _u._$md52str('123');
     * });
     * ```
     * 
     * @method module:util/encode/md5._$md52str
     * @param  {String} arg0 - 数据
     * @return {String}        字符串
     */
    _p._$md52str = function(_data){
        return __bin2str(__data2md5(
                         __str2bin(_data,!0),
                         _data.length*__chrsz),!0);
    };
    /**
     * 字符串转十六进制,低位补零
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/encode/md5'
     * ],function(_u){
     *     // 输入数据0，输出十六进制串
     *     // 30000000
     *     var _result = _u._$str2hex('0');
     * });
     * ```
     * 
     * @method module:util/encode/md5._$str2hex
     * @param  {String}  arg0 - 字符串
     * @param  {Boolean} arg1 - 是否大端序
     * @return {String}         十六进制串
     */
    _p._$str2hex = function(_data,_big){
        return __bin2hex(__str2bin(_data,!_big),!_big);
    };

    if (CMPT){
        NEJ.copy(NEJ.P('nej.u'),_p);
    }
    
    return _p;
},215);
I$(15,function (_v,_e,_ut,_p,_u,_req) {

  var _ = {},
      noop = function(){},
      _resCache = {},
      _version = _ut._$format(new Date(), 'yyyyMMddHHmm')+_ut._$randNumberString(6);


  // 类型判断， 同typeof 
  _.typeOf = function (o) {
    return o == null ? String(o) : ({}).toString.call(o).slice(8, -1).toLowerCase();
  }

  _.isLogin = function(callback) {
      var _url = '/getUserName.html',
        _opts = {
          method: 'get',
          norest: true,
          type: 'json',
          onload: function(_json) {
            if (!(_json && _json.retcode == 461)) {
              // 已登陆
              callback(1);
            } else {
              callback(0);
            }
          }._$bind(this),
          onerror: function() {
            callback(0);
          }._$bind(this)
        };
      _req._$request(_url, _opts);
  }


  _.findInList = function(id, list, ident){
    ident = ident || "id";
    var len = list.length;
    for(; len--;){
      if(list[len][ident] == id) return len
    }
    return -1;
  }
  _.merge = function(obj1, obj2){
    var 
      type1 = _.typeOf(obj1),
      type2 = _.typeOf(obj2),
      len;

    if(type1 !== type2) return obj2;
    switch(type2){
      case 'object': 
        for(var i in obj2){
          if(obj2.hasOwnProperty(i)){
            obj1[i] = _.merge(obj1[i], obj2[i]);
          }
        }
        break;
      case "array": 
        for(var i = 0, len = obj2.length; i < len; i++ ){
          obj1[i] = _.merge(obj1[i], obj2[i]);
        }
        obj1.length = obj2.length;
        break;
      default: 
        return obj2;
    }
    return obj1;
   }  // meregeList
	  
  _.mergeList = function(list, list2, ident){
    ident = ident || "id";
    var len = list.length;
    for(; len--;){
      for(var i = 0, len1 = list2.length; i < len1; i++){
        if(list2[i][ident] != null&&list2[i][ident] === list[len][ident]){
          list.splice(len, 1, _.merge(list2[i],list[len]));
          break;
        }
      }
    }
  }
  // 深度clone
  _.clone = function(obj){
    var type = _.typeOf(obj);
    switch(type){
      case "object": 
        var cloned = {};
        for(var i in obj){
          cloned[i] = _.clone(obj[i])
        }
        return cloned;
      case 'array':
        return obj.map(_.clone);
      default:
        return obj;
    }
  }

  _.extend = function(o1, o2 ,override){
	    for( var i in o2 ) if( o1[i] == undefined || override){
	      o1[i] = o2[i]
	    }
	    return o1;
	  }
  _.initSelect = function(_select,_list,_value,_text){
	  _select.options.length = 0;
	  _value = _value||'value';
	  _text = _text||'text';
	  for(var i=0,l=_list.length;i<l;i++){
		  if(typeof _list[i]==='string'){
			  var option = new Option(_list[i],_list[i]);
		  } else{
			  var option = new Option(_list[i][_text],_list[i][_value]);
		  }
		  _select.options.add(option);
	  }
  }
  /**
   * 频率控制 返回函数连续调用时，func 执行频率限定为 次 / wait
   *
   * @param  {function}   func      传入函数
   * @param  {number}     wait      表示时间窗口的间隔
   * @param  {object}     options   如果想忽略开始边界上的调用，传入{leading: false}。
   *                                如果想忽略结尾边界上的调用，传入{trailing: false}
   * @return {function}             返回客户调用函数
   */
  _.throttle = function(func, wait, options) {
    var context, args, result;
    var timeout = null;
    // 上次执行时间点
    var previous = 0;
    if (!options) options = {};
    // 延迟执行函数
    var later = function() {
      // 若设定了开始边界不执行选项，上次执行时间始终为0
      previous = options.leading === false ? 0 : (+new Date);
      timeout = null;
      result = func.apply(context, args);
      if (!timeout) context = args = null;
    };
    return function() {
      var now = (+new Date);
      // 首次执行时，如果设定了开始边界不执行选项，将上次执行时间设定为当前时间。
      if (!previous && options.leading === false) previous = now;
      // 延迟执行时间间隔
      var remaining = wait - (now - previous);
      context = this;
	  args = arguments;
      // 延迟时间间隔remaining小于等于0，表示上次执行至此所间隔时间已经超过一个时间窗口
      // remaining大于时间窗口wait，表示客户端系统时间被调整过
      if (remaining <= 0 || remaining > wait) {
        clearTimeout(timeout);
        timeout = null;
        previous = now;
        result = func.apply(context, args);
        if (!timeout) context = args = null;
      //如果延迟执行不存在，且没有设定结尾边界不执行选项
      } else if (!timeout && options.trailing !== false) {
        timeout = setTimeout(later, remaining);
      }
      return result;
    };
  };
  /**
   * 这个节点是否在含有className的节点内
   */
  _.isInClassNode = function(elm,className){
		while(elm){
			if(_e._$hasClassName(elm,className)){
				return true;
			} else{
				elm = elm.parentNode;
			}
		}
		return false;
  };
  /**
   * 这个节点是否在含有className的节点内
   */
  _.getParentElementByTag = function(elm,tagName){
	while(elm){
		if(elm.tagName==tagName.toUpperCase()){
			return elm
		} else{
			elm = elm.parentNode;
		}
	}
	return null;
  };
  /**
   * 这个节点是否在含有className的节点内
   */
  _.getParentElementByClass = function(elm,className){
	while(elm){
		if(_e._$hasClassName(elm,className)){
			return elm
		} else{
			elm = elm.parentNode;
		}
	}
	return null;
  };
  /**
   * 图片增加nos参数  hzmating 20160216
   * @param  {String} url 原始url  
   * @param  {Number|String} width
   * @param  {Number|String} height
   * @param  {Number|String} quality
   * @return {String} 增加nos参数后的url
   */
  _.imgThumbnailUrl = function(url,width,height,quality){
    var u=url||"", w=width||0, h=height||0, q=quality||85, paraStr="";
    if(!u){
      return '';
    }
    u = u.replace(/^http:/i,'');
    if(/imageView/g.test(u)&&/thumbnail/g.test(u)){
      return u;
    }
    if(w+h==0){
      w=1000;
    }
    paraStr = 'imageView&thumbnail='+w+'x'+h+'&quality='+q;
    if(/\?/g.test(u)){
      return u+'&'+ paraStr;
    }else{
      return u+'?'+ paraStr;
    }
  };
  /**
   * da.js 通用方法
   * @author hzmating 20160223
   * @param  category 
   * @param  action
   * @param  label
   * @param  {Object} 自定义参数
   * @return null
   */
  _.daEvent = function(category,action,label,customData){
    var obj = {'userAccount':window.account||'','userId':window.account||''};
    if(!!customData){
      obj = this.merge(obj,customData);
    }
    // console.log(category,action,label,obj);
    !!window._dapush && window._dapush("_trackEvent",category||'',action||'',label||'',obj);
  };
	/**
   * 获取url参数
   */
  _.getUrlParam = function(param){
    return _ut._$query2object(window.location.search.replace(/^\?/g,''))[param];
  };

  /**
   * url中插入参数
   * @param {String} url 链接
   * @param {String} insertstr 要插入的字符串，如'aaa=111'
   */
  _.insertParamIntoUrl = function(url, insertstr){
    if(!url || !insertstr){
      return url||'';
    }
    var splitAry = url.split('#'), before = splitAry[0];
    splitAry[0] = (before.indexOf('?')>=0)?(before+'&'+insertstr):(before+'?'+insertstr);
    return (splitAry.length > 1)?splitAry.join('#'):splitAry[0];
  };

  /**
   * 压缩regular模版
   * @param htmlstr
   * @returns {XML|string}
   * add by xuejimiao 2016/02/25
   */
  _.compressHtml = function(htmlstr){
    //防止nej打包模版后报错
    if(typeof htmlstr !== "string"){
      return htmlstr;
    }
    return htmlstr.replace(/[\r\n]|\s+(?=[<{])/g,'').replace(/[}>]\s+/g, function(value){
      return value.substr(0,1);
    })
  };
  /**
   * 获取节点的offset信息
   * @param node
   * @returns {obj} offset信息
   * add by hzmating 2016/09/08
   */
  _.getOffset = function(node){
			var scrollTop = document.documentElement.scrollTop || document.body.scrollTop,
				scrollLeft = document.documentElement.scrollLeft || document.body.scrollLeft,
				rect = node.getBoundingClientRect();
			return {
				top : scrollTop+rect.top,
				bottom : scrollTop+rect.bottom,
				left : scrollLeft+rect.left,
				right : scrollLeft+rect.right,
				width : rect.right-rect.left,
				height : rect.bottom-rect.top
			};
	};
  /*
   * 毫秒数转为剩余天时分秒
   * @param {Number} num 毫秒数
   * @param {Boolean} needObj 是否返回剩余时间的对象格式
   */
  _.millisecond2LeftTime = function(num, needObj){
    var time = +num > 0 ? +num : 0,
    //刻度
    onemin = 60000, onehour = 60*onemin, oneday = 24*onehour,
    //转化为两位数字 补0
    fillZ = function( N ){
      return (N < 10 ? "0" : "" )+N;
    };
    var d = Math.floor(time / oneday),
        h = Math.floor(time % oneday / onehour),
        m = Math.floor(time % oneday % onehour / onemin),
        s = Math.floor(time % oneday % onehour % onemin / 1000);
    //优化临界点显示
    if (d == 1 && h == 0) {
        d = 0;
        h = 24;
    }
    var timeArr = [fillZ(d),fillZ(h),fillZ(m),fillZ(s)];
    return needObj ? {
      d : d, h : h, m: m, s : s,
      dd : timeArr[0], hh: timeArr[1], mm : timeArr[2], ss : timeArr[3]
    } : timeArr;
  };
  /*
   * 毫秒数转为相应格式的时间
   * @param {Number} timeNum 毫秒数
   * @param {String} tmpl "yyyy-MM-dd hh:mm:ss"
   * add by hzmating 2016/10/08
   */
  _.formatTime = function(timeNum,tmpl){
    var num = /^\d+$/gi.test(timeNum+"")?+timeNum:Date.parse(timeNum);
    if(isNaN(num))return timeNum;
    var D = new Date(num),
        zz = function(a){
          return("0"+a).slice(-2)
        },
        M=D.getMonth()+1, d=D.getDate(), h=D.getHours(), m=D.getMinutes(), s=D.getSeconds(),
        obj = {
          yyyy:D.getFullYear(),
          M:M, MM:zz(M),
          d:d, dd:zz(d),
          h:h, hh:zz(h),
          m:m, mm:zz(m),
          s:s, ss:zz(s)
        };
        return (tmpl||"yyyy-MM-dd hh:mm:ss").replace(/y{4}|[Mdhms]{1,2}/gi,function(str){return obj[str];});
    };
    /*
    * 替换安全的html字符串
    * @param {String} str 待处理字符串
    * add by hzmating 2016/11/04
    */
    _.safeHtml = function(str){
      return String(str||'').replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#39;");
    };

  //去掉图片协议头
  _.noProtocol = function(url){
    url = (url||'').replace(/^http:/i,'');
    return url;
  };

  return _;
},3,4,2,78,245,14);
I$(155,function (_u,_,_p){
    // common filter
    _p.format = function(date, format){
    	if(_u._$isString(date)){
    		var timeArr=date.split(" ");
    		var d=timeArr[0].split("-");
    		var t=timeArr[1].split(":");
    		date = new Date(d[0],(d[1]-1),d[2],t[0],t[1],t[2]);
    	}
        return _u._$format(date, format || "yyyy-MM-dd")
    }
    // mobile mix:
    // 13588652102 -> 135****2102
    _p.mixMobile = function(mobile){
        if(!mobile)
            return '';
        var part1 = mobile.substring(0,3),
            part2 = mobile.substring(mobile.length-4);
        return part1 + (new Array(4)).join('*') + part2;
    };

    _p.escape = _u._$escape;

    /**
     * by hzwuyuedong
     * 字符串截取， 中英文都算一个len
     */
    _p.cutstr = function(str, len) {
      var temp,
        icount = 0,
        patrn = /[^\x00-\xff]/,
        strre = "";
      for (var i = 0; i < str.length; i++) {
        if (icount < len - 1) {
          temp = str.substr(i, 1);
          if (patrn.exec(temp) == null) {
            icount = icount + 1
          } else {
            icount = icount + 2
          }
          strre += temp
        } else {
          break;
        }
      }
      return strre + "..."
    };

    //去掉图片协议头
    _p.noProtocol = function(url){
      url = (url||'').replace(/^http:/i,'');
      return url;
    };

    _p.concatObjValue = function(_object, _str){
      var _join = [];
      _u._$forIn(_object,function(_item,_index,_this){
        _join.push(_item);
      });
      return _join.join(_str);
    };
    /**
     * by hzwuyuedong
     * 浮点数值保留指定位数小数点
     */
    _p.fixed = function(_data, _len){
      var _num= parseFloat(_data, 10), _tmp;
      if(_len == null){
        _len = 2;
      }
      if(_u._$isNumber(_num)){
        _tmp = _u._$fixed(_num, 2);
        var _s = _tmp.toString();
        var _rs = _s.indexOf('.');
        if (_rs < 0) {
          _rs = _s.length;
          _s += '.';
        }
        while (_s.length <= _rs + _len) {
          _s += '0';
        }
        return _s;
      }else{
        return '';
      }
    };
    /**
     * 最大长度支持，中英文区分
     */
    _p.maxlength = {
    		get:function(value, limit){
    			return value||''
    		},
    		set:function(value, limit){
    			var value = (value||'');
    			return _p.substr(value,limit);
    		}
    }
    _p.integer = {
    		get:function(value){
    			return value||''
    		},
    		set:function(value){
    			return parseInt(value);
    		}
    }
    _p.number = {
    		get:function(value){
    			return value||''
    		},
    		set:function(value,fixed){
    			fixed = fixed||2;
    			var index = value.indexOf('.');
    			if(index==value.length-1||value=='0'){
    				return value;
    			} else{
    				value = parseFloat(value);
        			return _u._$fixed(value,fixed)	
    			}
    			
    		}
    }
    /**
     * 图片增加nos参数  hzmating 20160216
     * @param  {String} url 原始url  
     * @param  {Number|String} width
     * @param  {Number|String} height
     * @param  {Number|String} quality
     * @return {String} 增加nos参数后的url
     */
    _p.imgThumbnailUrl = _.imgThumbnailUrl;
    
    return _p;
},2,15);
I$(437,"<div class=\"progress progress-fix animated\" r-hide='!progress' style='display:none' \n  r-animation= 'on: leave;  wait: 200;class: fadeOut'>\n  <div class=\"progress-bar progress-bar-striped active\" \n    role=\"progressbar\" \n    style=\" background-color: {currentColor};width: {percent||0}% ;\">\n  </div>\n</div>");
I$(225,function (tpl, R){
	var config ={
	  COLOR_SUCCESS:'#5cb85c',
	  COLOR_INFO:'#5bc0de',
	  COLOR_DANGER:'#d9534f',
	  COLOR_WARNING:'#f0ad4e'
	};

  // @TODO: move to another file
  // mix color1 with color2 : from mcss
  function mix(c1, c2, weight){
    var p = weight/100,
        a = 0,
        w = p * 2 -1,
        w1 = (((w * a == -1) ? w : (w + a) / (1 + w * a)) + 1) / 2.0,
        w2 = 1 - w1,
        channels = [
            parseInt(c1[0] * w1 + c2[0] * w2),
            parseInt(c1[1] * w1 + c2[1] * w2),
            parseInt(c1[2] * w1 + c2[2] * w2)
        ];
    return channels
  }

  function rgb(hash){
    hash = hash.charAt(0) === '#'? hash.slice(1) : hash
    var channels;
    if (hash.length === 6) {
      channels = [
        parseInt(hash.substr(0, 2), 16), 
        parseInt(hash.substr(2, 2), 16), 
        parseInt(hash.substr(4, 2), 16) 
      ];
    }else {
      var r = hash.substr(0, 1);
      var g = hash.substr(1, 1);
      var b = hash.substr(2, 1);
      channels = [
          parseInt(r + r, 16), 
          parseInt(g + g, 16), 
          parseInt(b + b, 16)
      ];
    }
    return channels;

  }

  var color = {
    ERROR: rgb(config.COLOR_DANGER),
    COMPLETE: rgb(config.COLOR_SUCCESS)
  } 

  var Progress = Regular.extend({
    template: tpl,
    // 默认属性
    data: {
      startColor: rgb(config.COLOR_INFO),
      endColor: color.COMPLETE,
      percent:0
    },
    // 计算属性
    computed: {
      currentColor: function(data){
        var channels = mix(data.startColor, data.endColor, 100 - data.percent);
        return "rgb(" + channels[0] + "," + channels[1] + "," +channels[2] + ")";
      } 
    },
    // 初始化后的函数
    init: function(){
      // 证明不是内嵌组件
      if(this.$root == this) this.$inject(document.body);
    },
    // 移动到某个百分比
    move: function(percent){
      clearTimeout(this.timer);
      if(percent === 1000) this.end(true)
      else this.$update('percent', percent);
    },
    // 开始
    start: function(){
      if(this.timer) clearTimeout(this.timer);
      this.data.progress = true;
      this.data.percent = 2;
      this.data.endColor = color.COMPLETE;
      this.$update();
      this._startTimer();
    },
    // 结束
    end: function(error){
      clearTimeout(this.timer);
      this.data.progress = false;
      this.data.percent = 100;
      this.data.endColor = !error? color.COMPLETE: color.ERROR;
      this.$update()
    },
    // 开始定时器
    _startTimer: function(){
      var data = this.data;
      this.timer = this.$timeout(function(){
        data.percent = data.percent + (100 - data.percent) * (Math.random() * .2);
        this._startTimer();
        console.log(this.$get('currentColor'))
      }, Math.random() * 1000 + 2000);
    }
    // 使用timeout模块
  }).use('timeout');


  // 单例, 直接初始化
  return new Progress();

  /**
   * 使用:
   *    progress.start() 开始进度条
   *    progress.end(isError) 结束进度条
   *    progress.move() 移动到某个进度条位置，最大100
   */

},437,247);
I$(226,function (NEJ,_v,_u,_g,_j,_t,_p,_o,_f,_r){
    /**
     * 使用REST进行数据交互接口
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'base/event',
     *     'util/ajax/rest'
     * ],function(_v,_j){
     *     // 通用错误处理，所有请求异常均会调用此回调处理
     *     _v._$addEvent(
     *         window,'resterror',function(_error){
     *             // _error.code
     *             // _error.message
     *             // _error.data
     *             // 通过设置_error.stopped阻止事件回调到请求的onerror中
     *         }
     *     );
     *
     *     var url = "http://a.b.com/rest/list";
     *     var opt = {
     *          param:{brand:'nokia',model:'9'},
     *          data:'123',
     *          method:'post',
     *          onload:function(_data){
     *              // 请求正常回调
     *          },
     *          onerror:function(_error){
     *              // _error.code
     *              // _error.message
     *              // _error.data
     *              // 如果window的resterror回调中stopped了事件则不会进入此回调
     *          },
     *          onbeforerequest:function(_event){
     *              // _event.request
     *              // _event.headers
     *          }
     *     }
     *     _j._$request(url,opt);
     * });
     * ```
     *
     * @method module:util/ajax/rest._$request
     * @param    {String}  arg0 - 请求地址
     * @param    {Object}  arg1 - 可选配置参数
     * @property {Boolean}  sync    - 是否同步请求
     * @property {Variable} data    - 要发送的数据
     * @property {Object}   param   - 请求参数,包括模板地址里使用的参数
     * @property {String}   method  - 请求方式,GET/POST/PUT/DELETE
     * @property {Number}   timeout - 超时时间,0 禁止超时监测
     * @property {Object}   headers - 头信息
     * @property {Object}   result  - onload回调输入时需包含的额外信息
     *
     * @property {module:util/ajax/xdr.onload} onload   - 请求载入成功回调
     * @property {module:util/ajax/xdr.onerror} onerror - 请求载入失败回调
     * @property {module:util/ajax/xdr.onbeforerequest} onbeforerequest - 发起请求之前回调
     *
     * @return   {Void}
     */
    _p._$request = (function(){
        var _cache = {},  // request cache - sn:{s:funciton(){},f:function(){}}
            _reg0 = /\{(.*?)\}/gi,
            _reg1 = /^get|delete|head$/i,
            _jsn = /json/i,
            _xml = /xml/i;
        // clear request
        var _doClear = function(_key){
            var _request = _cache[_key];
            if (!_request) return;
            delete _request.s;
            delete _request.f;
            delete _cache[_key];
        };
        // request callback
        var _doCallback = function(_key,_type){
            var _request = _cache[_key];
            if (!_request) return;
            var _callback = _request[_type],
                _args = _r.slice.call(arguments,2);
            try{
                (_callback||_f).apply(null,_args);
            }catch(ex){
                // ignore
                if (DEBUG) throw ex;
                console.error(ex.message);
                console.error(ex);
            }
            _doClear(_key);
        };
        // request success
        var _onLoad = function(_key,_data){
            _doCallback(_key,'s',_data);
        };
        // request error
        var _onError = function(_key,_error){
            _error = _error||{};
            // status 204 is ok
            if (_error.code==_g._$CODE_ERRSERV&&
                _error.data==204){
                _onLoad(_key,null);
                return;
            }
            // do error filter
            // set error attr stopped=!0 will stop request error callback
            _v._$dispatchEvent(
                window,'resterror',_error
            );
            if (!!_error.stopped){
                _doClear(_key);
                return;
            }
            // do request fail callback
            _doCallback(_key,'f',_error);
        };
        // check default headers
        var _doCheckWithDefault = function(_headers,_key,_default){
            var _value = _headers[_key]||
                         _headers[_key.toLowerCase()];
            if (!_value){
                _value = _default;
                _headers[_key] = _value;
            }
            return _value;
        };
        // pre convert array
        var _doCheckData = function(_data,_key,_map){
            if (_u._$isArray(_data)){
                _map[_key] = JSON.stringify(_data);
            }
        };
        return function(_url,_options){
            _options = _u._$merge({},_options);
            var _exist = {},
                _param = _options.param||_o;
            // parse uri template
            _url = _url.replace(_reg0,function($1,$2){
                var _value = _param[$2];
                if (_value!=null) _exist[$2] = !0;
                return encodeURIComponent(_value||'')||$1;
            });
            // parse remain param
            var _data = _options.data||{};
            _u._$loop(
                _param,function(_value,_key){
                    if (!_exist[_key]){
                        _data[_key] = _value;
                    }
                }
            );
            // parse headers
            var _type = 'text',
                _headers = _options.headers||{},
                _accept  = _doCheckWithDefault(_headers,'Accept','application/json'),
                _content = _doCheckWithDefault(_headers,'Content-Type','application/json');
            // response data format
            if (_jsn.test(_accept)){
                _type = 'json';
            }else if(_xml.test(_accept)){
                _type = 'xml';
            }
            // do request
            var _key = _u._$uniqueID();
            _cache[_key] = {
                s:_options.onload||_f,
                f:_options.onerror||_f
            };
            // add params to url with GET/HEAD/DELETE method
            _options.method = _options.method||'GET';
            if (_reg1.test(_options.method.trim())){
                _u._$forIn(_data,_doCheckData);
                _options.query = _data;
                _data = null;
            }else if (_jsn.test(_content)){
                _data = JSON.stringify(_data);
            }
            _options.type    = _type;
            _options.data    = _data;
            _options.headers = _headers;
            _options.onload  = _onLoad._$bind(null,_key);
            _options.onerror = _onError._$bind(null,_key);
            _j._$request(_url,_options);
        };
    })();
    /**
     * 通用载入出错回调函数，所有REST请求的异常均会进入此事件的回调逻辑中
     *
     * @event    external:window.onresterror
     * @param    {Object}   event   - 错误信息
     * @property {Number}   code    - 错误代码
     * @property {String}   message - 错误描述
     * @property {Variable} data    - 出错时携带数据
     * @property {Boolean}  stopped - 是否阻止单个请求中的onerror回调
     */
    _t._$$CustomEvent._$allocate({
        element:window,
        event:'resterror'
    });

    if (CMPT){
        NEJ.P('nej.j')._$requestByREST = _p._$request;
    }

    return _p;
},215,3,2,227,14,438);
I$(6,function ( progress , rest, xdr,_ut) {

var noop = function(){};
  /**
   * 平台request, 避免后续需要统一处理
   * opt:  其他参数如 $request
   *   - progress:  是否使用进度条提示(假)
   *   - norest:  是否 不使用REST接口
   */
  var request = function(url, opt){
    opt = opt || {};
    //统一设置请求头 标识异步请求
    opt.headers = opt.headers || {};
    opt.headers["X-Requested-With"] = "XMLHttpRequest";
    var olderror = opt.onerror || noop,
      oldload = opt.onload || noop;

    if(opt.progress){
      progress.start();
      opt.onload = function(json){
        if((json && json.code>=200 && json.code < 400)||(json && json.retcode>=200 && json.retcode < 400)){
          progress.end();
          oldload.apply(this, arguments);
        }else{
          progress.end(true)
          olderror.apply(this, arguments);
        }
      }
      opt.onerror = function(json){
        progress.end(true)
        olderror.apply(this, arguments);
      }
    }
    if(opt.method&&opt.method.toLowerCase()=='get'){
      if(!opt.data){
        opt.data ={};
      }
      if(!opt.query){
          opt.query ={};
        }
      opt.data.t=opt.query.t= +new Date;
    }
    if(!opt.type){
    	opt.type='json'
    }
    if(opt.norest){
	  if(!_ut._$isString(opt.data)){
		  opt.data = _ut._$object2query(opt.data);
      }
      xdr._$request(url, opt);
    }else{
      rest._$request(url, opt)
    }
  }
  return request;
},225,226,14,2);
I$(151,function (x, directive,filters,request){

	 var slice = Regular.util.slice,
     msie = Regular.dom.msie,
     noop = function(){},
     config = {BEGIN: "{", END: "}"};

 if(Regular.config){
   Regular.config(config);
 }

 // 一些基础帮助函数
 var util = function(){
   var rEvent = /^on-(\w+)$/,
     rExpression = new RegExp("^" + config.BEGIN + "(.*)" + config.END + "$");

   // 获得元素的所有属性
   function getAttrs( element ){
     var attrs = element.attributes, len = attrs && attrs.length,
       attr, passedAttr = [];

     if(len){
       for( var i = 0; i < len; i++ ){
         if(!msie || msie > 8 || attrs[i].specified){
           attr = attrs[i]
           passedAttr.push(attr);
         }
       }
     }
     return passedAttr;
   }

   function getEventName(str){
     var matched = rEvent.exec(str);
     return matched && matched[1];
   }
   function getExpression(str){
     var matched = rExpression.exec(str) ;
     return matched && matched[1] && Regular.expression(matched[1]);
   }
   return {
     getAttrs: getAttrs,
     getEventName: getEventName,
     getExpression: getExpression
   }

 }();


 // 由Hub去承载初始化分立的全部component的责任;
 var Hub = Regular.extend({
   scope: Regular,
   init: function initHub(){
     var scope = this.scope;
     this._initComponents(scope._components);
     // @TODO: 是否开发指令的全局启动？
     // this._initDirective(scope._directives);
   },
   // 初始化所有Components
   _initComponents: function(components){
     var Component;
     for( var i in components ){
       Component = components[i];
       if( Component){
         this._initComponent(i, Component);
       }
     }
   },
   /**
    * 使用nes找到带有directive的节点,
    * 并初始化
    */
   _initDirectives: function(directives){
     var directive;
     for( var i in directives ){
       directive = directives[i];
       if( directive){
         this._initDirective(i, directive);
       }
     }
   },
   // 初始化单个指令
   _initDirective: function(name, directive){
     var container = this.container || document.body;
     var nodes = nes.all("[" + name +"]") ;
     nodes.forEach(this._singleDirective.bind(this, "r-" + name ,  directive, "name"))
   },
   // 初始化Component
   _initComponent: function(name, Component){
     var container =  this.container || document.body;
     var nodes = slice( container.getElementsByTagName(name) );
     nodes.forEach(this._initTag.bind(this, Component));
   },
   // 初始化单个标签
   _initTag: function(Component, node){
     var attrs = util.getAttrs(node);
     var data = {}, events = {},
       watchers = {}, context = this, id;

     attrs.forEach(function(attr){
       var value = attr.value,
         name = attr.name, expression, eventName;


       if(name === 'id') id=name;
       eventName = util.getEventName(name);
       expression = util.getExpression(value);
       if( !eventName ){ // data
         if( !expression ){
           data[name] = value
         }else{
           watchers[name] = expression;
           data[name] = expression.get(context);
         }
       }else{ //event bind
         events[eventName] = Regular.util.handleEvent.call(context, expression || value, eventName);
       }
     })



     var component = new Component({data: data, events: events, $parent: this});
     if(id) this[id] = component;
     component.$bind(this, watchers);
     component.$inject(node, 'after');
     node.parentNode.removeChild(node);
   }
 });
  /**
   * 重写Regular.dom.find. 使得可以使用选择器
   * @param  {String} sl 选择器
   * @return {[type]}    [description]
   */
  Regular.dom.find = function(sl){
    return nes.one(sl);
  }


  // BaseComponent与Hub没有任何关系， 它是整个工程的基础Regular组件(基类)，
  // 主要是作为容器使用, 你可以通过扩展BaseComponent来达到工程范围内的组件能力
  // 具体: http://regularjs.github.io/guide/zh/core/use.html
  //
  var BaseComponent = Regular.extend({
    // TODO
    $request: function(_url,_options){
      var self = this;
      var olderror = _options.onerror || noop,
        oldload = _options.onload || noop;


      self.$update('loading', true);
      function oncomplete(){
        self.$update('loading', false);
      }

      _options.onload = oldload._$aop(null, oncomplete).bind(this);
      _options.onerror = olderror._$aop(null, oncomplete).bind(this);

      request(_url,_options);
    }
  })// 扩展指令和事件
    .directive(directive.directives||{})
    .event(directive.events||{})
    .filter(filters || {});

  /**
   * 启动BaseComponent下的所有注册component
   * @return {[type]} [description]
   */
  BaseComponent.boot = function(data){
    new Hub({
      scope: BaseComponent,
      data: data || window.__data__ || {}
    })
  }

  return BaseComponent;
},247,339,155,6);
!function(win, doc, undefined) {
  // __nes命名空间__
  var nes = function(node, context){return all(node, context);},
    locals = {}; //存放local属性...被global坑死了

  // 常用属性local化
  var ap = Array.prototype,
    op = Object.prototype,
    sp = String.prototype,
    fp = Function.prototype,
    slice = ap.slice,
    body = doc.body,
    testNode = doc.createElement("div"),
    // 1. Helper(助手函数)
    // =================================
    // 将类数组(如Nodelist、Argument)变为数组
    toArray = function(arr) {
      return slice.call(arr);
    },
    // 够用的短小类型判断
    typeOf = function(o) {
      return o == null ? String(o) : op.toString.call(o).slice(8, -1).toLowerCase();
    },
    // 够用的简单对象扩展
    extend = function(o1, o2, override) {
      for (var i in o2) {
        if (o1[i] == null || override) o1[i] = o2[i];
      }
    },
    // 最简单先进先出缓存队列, max设置最大缓存长度, 为了不必要重复parse
    // nes会多次用到这个方法创建cache
    createCache = function(max) {
      var keys = [],
        cache = {};
      return {
        set: function(key, value) {
          if (keys.length > this.length) {
            delete cache[keys.shift()];
          }
          cache[key] = value;
          keys.push(key);
          return value;
        },
        get: function(key) {
          if (key === undefined) return cache;
          return cache[key];
        },
        length: max,
        len: function() {
          return keys.length;
        }
      };
    },
    // 让setter型函数fn支持object型的参数
    // 即支持`set(name:value)`
    // 也支持`set({name1:value1,name2:value2})`
    autoSet = function(fn) {
      return function(key, value) {
        if (typeOf(key) == "object") {
          for (var i in key) {
            fn.call(this, i, key[i]);
          }
        } else {
          fn.call(this, key, value);
        }
        return this;
      };
    },
    assert = function(fn) {
      try {
        return fn();
      } catch (e) {
        return false;
      } finally {
        testNode = document.createElement("div");
      }
    };
  // Fixed: toArray 低于IE8的 Nodelist无法使用slice获得array
  try {
    slice.call(doc.getElementsByTagName("body"));
  } catch (e) {
    toArray = function(arr) {
      var result = [],
        len = arr.length;
      for (var i = 0; i < len; i++) {
        result.push(arr[i]);
      }
      return result;
    };
  }

  // 扩展ES5 Native支持的函数，坑爹的远古浏览器
  //es5 trim
  var trimReg = /^\s+|\s+$/g;
  sp.trim = sp.trim ||
  function() {
    return this.replace(trimReg, "");
  };

  //es5 bind
  fp.bind = fp.bind ||
  function(context, args) {
    args = slice.call(arguments, 1);
    var fn = this;
    return function() {
      return fn.apply(context, args.concat(slice.call(arguments)));
    };
  };
  //es5 Array indexOf
  ap.indexOf = ap.indexOf ||
  function(a) {
    for (var i = 0, len = this.length; i < len; i++) {
      if (a === this[i]) return i;
    }
    return -1;
  };

  // Parser 相关
  var
  //抽离出字匹配数目
  ignoredRef = /\(\?\!|\(\?\:/,
    extractRefNum = function(regStr) {
      var left = 0,
        right = 0,
        len = regStr.length,
        ignored = regStr.split(ignoredRef).length - 1; //忽略非捕获匹配
      for (; len--;) {
        var letter = regStr.charAt(len);
        if (len === 0 || regStr.charAt(len - 1) !== "\\") { //不包括转义括号
          if (letter === "(") left++;
          if (letter === ")") right++;
        }
      }
      if (left !== right) throw regStr + "中的括号不匹配";
      else return left - ignored;
    },
    //前向引用 如\1 \12 等在TRUNK合并时要做处理
    refIndexReg = /\\(\d+)/g,
    extractRefIndex = function(regStr, curIndex) {
      return regStr;
      // .replace(refIndexReg, function(a, b) {
      //   return "\\" + (parseInt(b, 10) + curIndex);
      // });
    },
    // // 生成默认的action，这个会将匹配到的参数推入一个同名的数组内
    // createAction = function(name) {
    //   return function(all) {
    //     var parsed = this.parsed,
    //       current = parsed[name] || (parsed[name] = [])
    //       current.push(slice.call(arguments))
    //   }
    // },
    // Object.keys 规则排序时的调用方法
    keys = Object.keys ||
  function(obj) {
    var result = [];
    for (var prop in obj) {
      if (obj.hasOwnProperty(prop)) result.push(prop);
    }
    return result;
  },
  // 将规则中的reg中的macro替换掉
  cleanRule = function(rule) {
    var reg = rule.reg;
    //如果已经是regexp了就转为string
    if (typeOf(reg) === "regexp") reg = reg.toString().slice(1, -1);
    //将macro替换
    rule.regexp = reg.replace(replaceReg, function(a, b) {
      if (b in macros) return macros[b];
      else throw new Error('can"t replace undefined macros:' + b);
    });
    return rule;
  }, cleanRules = function(rules) {
    for (var i in rules) {
      if (rules.hasOwnProperty(i)) cleanRule(rules[i]);
    }
    return rules;
  };


  // ##2. Parser
  // 
  // 为何要抽象成一个类? 其实这里只用到了一个实例
  // 事实上这个简单Parser还帮我实现了命令行参数解析，
  // zen-coding的实现等等, 它可以帮助实现基于正则式的
  // 字符串解析


  function Parser(opts) {
    opts = opts || {};
    if (opts.macros) this._macros = opts.macros;
    this._links = {}; //symbol link map
    this._rules = {}; //symbol def
    this.TRUNK = null;
    this.cache = createCache(opts.maxCache || 200);
    this.cache.set("", [[] ]); //输入空字符串返回空数组
  }

  extend(Parser.prototype, {
    // ### 解析输入字符串input、返回action定义的data数据
    parse: function(input) {
      // 清理input数据、因为parsed数据最终会被缓存，
      // 我们要尽量让相同的选择器只对应一份parsed数据
      input = clean(input);
      // 先检查缓存中是否有数据
      if (parsed = this.cache.get(input)) return parsed;
      // 如果没有: 初始化参数
      var parsed = this.parsed = [
        [null]
      ];
      var remain = this.input = input;
      var TRUNK = this.TRUNK;
      var prevRemain;
        // 将remain进行this._process这里每匹配一个字符串都会进行一次reduce
      while (prevRemain != (remain = remain.replace(TRUNK, this._process.bind(this)))) {
        prevRemain = remain;
      }
      // 如果没有被解析完 证明选择器字符串有不能被解析的部分
      if (remain !== '') this.error(remain);
      // 返回数据并推入cache
      return this.cache.set(input, parsed);
    },
    // ###添加新规则 : 
    // 在nes中你可以想象成添加一个与Id、className、pesudo等价简单选择符
    on: function(rules) {
      if (typeOf(rules) === "string") { //当不是hash传入时
        var tmp = {};
        tmp[rules] = arguments[1];
        rules = tmp;
      }
      // 可以同时接受object型或者key, value对的参数
      for (var i in rules) {
        var rule = rules[i];
        if (typeOf(rule) !== "object") {
          rule = {
            regexp: rule
          };
        }
        var reg = rule.regexp;
        if (typeOf(reg) === "regexp") {
          rule.regexp = reg.toString().slice(1, -1);
        }
        // 初始化order
        if (rule.order === undefined) rule.order = 1;
        this._rules[i] = rule;
      }
      // 每进行一次新规则监听，都重新组装一次
      this.setup();
      return this;
    },
    // ###__删除规则__ :
    // 删除对应规则, 即nes的规则都是在运行时可删可增的
    off: function(name) {
      if (typeOf(name) === "array") {
        for (var i = name.length; i--;) {
          this.off(name[i]);
        }
      } else {
        if (this._rules[name]) {
          delete this._rules[name];
        }
      }
      return this;
    },
    // 获得当前解析位置所在的datum，你只需要在这个datum中塞数据即可
    current: function() {
      var data = this.parsed;
      var piece = data[data.length - 1],
        len = piece.length;
      return piece[len - 1] || (piece[len - 1] = {
        tag: "*"
      });
    },
    error: function(info) {
      throw Error("输入  " + this.input + "  含有未识别语句:" + info || "");
    },

    clone: function(parser) {
      return new Parser().on(this._rules);
    },
    // __`this.parser`__的依赖方法，
    // 即遍历links检查是否有子匹配满足关系，
    // 有则推入对应的action数组,
    // 注意由于其是是replace方法的调用，每次都要返回""完成
    // reduce操作
    _process: function() {
      var links = this._links,
        rules = this._rules,
        args = slice.call(arguments);

        for (var i in links) {
          var link = links[i],
            retain = link[1],
            index = parseInt(link[0]);
            if (args[index] && (rule = rules[i])) {
              rule.action.apply(this, args.slice(index, index + retain));
              return "";
            }
        }
      return "";
    },
    // 组装
    setup: function() {
      cleanRules(this._rules);
      var curIndex = 1,
        //当前下标
        splits = [],
        rules = this._rules,
        links = this._links,
        ruleNames = keys(rules).sort(function(a, b) {
          return rules[a].order >= rules[b].order;
        }),
        len = ruleNames.length;

      for (; len--;) {
        var i = ruleNames[len],
          rule = rules[i],
          retain = extractRefNum(rule.regexp) + 1; // 1就是那个all
        if (rule.filter && !filters[i]) {
          filters[i] = rule.filter;
        } //将filter转移到filters下
        links[i] = [curIndex, retain]; //分别是rule名，参数数量
        var regexp = extractRefIndex(rule.regexp, curIndex - 1);
        curIndex += retain;
        splits.push(regexp);
      }
      this.TRUNK = new RegExp("^(?:(" + splits.join(")|(") + "))");
      return this;
    }
  });



  // ### parse的规则定义部分开始
  // 一些用到的正则式，但是又不属于parser的规则组成
  var
  replaceReg = /\{\{([^\}]*)\}\}/g,
    //替换rule中的macro
    nthValueReg = /^(?:(\d+)|([+-]?\d*)?n([+-]\d+)?)$/,
    // nthä¼ªç±»çš„valueè§„åˆ™
    posPesudoReg = /^(nth)[\w-]*(-of-type|-child)/,
    //åˆ¤æ–­éœ€è¦pos
    // ç¬¬ä¸€ä¸ªcache ç”¨æ¥è£…è½½nthä¼ªç±»ä¸­çš„å‚æ•°è§£æžåŽçš„æ•°æ®
    // å¦‚nth-childã€nth-of-typeç­‰8ä¸ªä¼ªç±»
    nthCache = createCache(100),
    // æå–nthValueä¸­çš„æœ‰ç”¨ä¿¡æ¯ æ¯”å¦‚an + b æˆ‘ä»¬éœ€è¦æå–å‡ºaä»¥åŠ,bå¹¶å¯¹é¢å¤–æƒ…å†µå¦‚ç¼ºå°‘aå‚æ•°æˆ–bå‚æ•°
    // æˆ–è€…æœ‰aã€bå°äºŽ0è¿™äº›æƒ…å†µä½œç»Ÿä¸€å¤„ç†ï¼Œè¿”å›žfindé€‚åˆä½¿ç”¨çš„æ•°æ®
    extractNthValue = function(param) {
      var step, start, res;
      //å¦‚æžœæ— å‚æ•° å½“æˆæ˜¯èŽ·å–ç¬¬ä¸€ä¸ªå…ƒç´ 
      if (!param || !(param = param.replace(/\s+/g, ""))) {
        return {
          start: 1,
          step: 0
        };
      }
      if (res = nthCache.get(param)) return res;
      // å¯¹even oddç­‰è½¬åŒ–ä¸ºæ ‡å‡†çš„aï¼Œbç»„åˆ(å³stepä¸Žstart)
      if (param == "even") {
        start = 2;
        step = 2;
      } else if (param == "odd") {
        step = 2;
        start = 1;
      } else {
        res = param.match(nthValueReg);
        // å¯¹é”™è¯¯çš„nthå‚æ•°æŠ›å‡ºé”™è¯¯
        if (!res) step = null; // æ— è®ºå…¶ä»–å‚æ•°ï¼Œå¦‚æžœstepä¸ºnullï¼Œåˆ™æ°¸è¿œä¸ºfalse
        else {
          if (res[1]) {
            step = 0;
            start = parseInt(res[1]);
          } else {
            if (res[2] == "-") res[2] = "-1";
            step = res[2] ? parseInt(res[2]) : 1;
            start = res[3] ? parseInt(res[3]) : 0;
          }
        }
      }
      if (start < 1) {
        if (step < 1) {
          step = null; //æ ‡å¿—false
        } else {
          start = -(-start) % step + step;
        }
      }
      return nthCache.set(param, {
        start: start,
        step: step
      });
    };

    // ### parse Rule ç›¸å…³
    // äº†è§£bisonç­‰è§£æžå™¨ç”Ÿæˆçš„åŒå­¦å¯ä»¥æŠŠè¿™éƒ¨åˆ†çœ‹æˆæ˜¯è¯æ³•ä¸Žè¯­æ³•å®šä¹‰çš„æ‚ç³…
    // å¾ˆæ··ä¹±ä¹Ÿå¾ˆä¸æ ‡å‡†ï¼Œä½†å¯¹äºŽé€‰æ‹©å™¨è¿™ç§æœ€ç®€å•çš„DSLå…¶å®žå¤Ÿç”¨ï¼Œå¹¶ä¸”æœ‰äº†å¥‡æ•ˆ
    // æ•´ä¸ªParseræ ¹æ®rulesåŠ¨æ€äº§ç”Ÿ(å³å¯åœ¨ä½¿ç”¨æ—¶å‘ç”Ÿæ”¹å˜)
    // å…·ä½“çš„æµç¨‹æ˜¯ä¸‹é¢çš„ruleså¯¹è±¡å®šä¹‰äº†ä¸€ç»„è¯­æ³•(è¯æ³•?)ruleâ€”â€”å¦‚attributeï¼Œ
    // ä½ å¯ä»¥æŠŠæ¯ä¸ªruleä¸­çš„regæƒ³è±¡æˆä¸€ä¸ªtoken(word?),è¿™äº›tokenå¯èƒ½ä¼šæœ‰{{word}}è¿™ç§å ä½ç¬¦
    // å ä½ç¬¦é¦–å…ˆä¼šè¢«macrosä¸­å¯¹åº”çš„macroæ›¿æ¢ï¼Œç„¶åŽè¿™äº›tokenä¼šè¢«ç»„è£…æˆä¸€ä¸ªå¤§ç‰ˆçš„Regexpï¼Œå³ä¸Šé¢çš„
    // Trunkå˜é‡,è¿™ä¸ªè¿‡ç¨‹æ²¡ä»€ä¹ˆç‰¹æ®Šï¼Œä¸€èˆ¬æ¯”è¾ƒä¼˜ç§€çš„é€‰æ‹©å™¨éƒ½æ˜¯åŸºäºŽè¿™ä¸ªæ–¹æ³•ã€‚ åœ¨nesä¸­,æœ€ç»ˆçš„Trunkå¯èƒ½æ˜¯
    // è¿™æ ·çš„:
    //
    // `/(\s*,\s*)|(#([\w\u4e00-\u9fbf-]+))|(\*|\w+)|(\.([\w\u4e00-\u9fbf-]+))|
    // (:([\w\u4e00-\u9fbf-]+)(?:\(([^\(\)]*|(?:\([^\)]+\)|[^\(\)]*)+)\))?)|
    // (\[([\w\u4e00-\u9fbf-]+)(?:([*^$|~!]?=)['"]?((?:[\w\u4e00-\u9fbf-]||\s)+)['"]?)?\])|(::([\w\u4e00-\u9fbf-]+))
    // |([>\s+~&%](?!=))|(\s*\{\s*(\d*),(\-?\d*)\s*\}\s*)/g`
    // 
    // çœ‹åˆ°ä¸Šé¢é‚£é•¿ä¸²ï¼Œä½ å¤§æ¦‚ç†è§£äº†å°†regexpæŒ‰è¯æ³•åˆ†å¼€è¿™æ ·åšçš„ç¬¬ä¸€ä¸ªåŽŸå›  : __ç»´æŠ¤__. 
    // ç¬¬äºŒä¸ªåŽŸå› å°±æ˜¯: __æ•ˆçŽ‡__  ä¸€æ¬¡å¤§åž‹æ­£åˆ™çš„è°ƒç”¨æ—¶é—´è¦è¿œä½ŽäºŽå¤šæ¬¡å°åž‹æ­£åˆ™çš„åŒ¹é…(å‰æå®ƒä»¬åšåŒæ ·è§„æ¨¡çš„åŒ¹é…)
  var
  // ä¸€äº›macro
  macros = {
    split: "\\s*,\\s*",
    // åˆ†éš”ç¬¦
    operator: "[*^$|~!]?=",
    // å±žæ€§æ“ä½œç¬¦ å¦‚= ã€!=
    combo: "[>\\s+~](?!=)",
    // è¿žæŽ¥ç¬¦ å¦‚ > ~ 
    word: "[\\\\\\w\\u00A1-\\uFFFF-]"
  },
    // è¯­æ³•è§„åˆ™å®šä¹‰
    rules = {
      split: {
        // åˆ†éš”ç¬¦ å¦‚ ï¼Œ
        reg: "{{split}}",
        action: function(all) {
          this.parsed.push([null]);
        },
        order: 0
      },
      // id å¦‚ #home
      id: {
        reg: "#({{word}}+)",
        action: function(all, id) {
          this.current().id = id;
        }
      },
      // èŠ‚ç‚¹ç±»åž‹é€‰æ‹©ç¬¦ å¦‚ div
      tag: {
        reg: "\\*|[a-zA-Z-]\\w*",
        // å•çº¯çš„æ·»åŠ åˆ°
        action: function(tag) {
          this.current().tag = tag.toLowerCase();
        }
      },
      // ç±»é€‰æ‹©ç¬¦ å¦‚ .m-home
      classList: {
        reg: "\\.({{word}}+)",
        action: function(all, className) {
          var current = this.current(),
            classList = current.classList || (current.classList = []);
            classList.push(className);
        }
      },
      // ä¼ªç±»é€‰æ‹©ç¬¦ å¦‚ :nth-child(3n+4)
      pesudos: {
        reg: ":({{word}}+)" + //ä¼ªç±»å
        "(?:\\(" + //æ‹¬å·å¼€å§‹
        "([^\\(\\)]*" + //ç¬¬ä¸€ç§æ— æ‹¬å·
        "|(?:" + //æœ‰æ‹¬å·(å³ä¼ªç±»ä¸­ä»æœ‰ä¼ªç±»å¹¶ä¸”æ˜¯å¸¦æ‹¬å·çš„)
        "\\([^\\)]+\\)" + //æ‹¬å·éƒ¨åˆ†
        "|[^\\(\\)]*" + ")+)" + //å…³é—­æœ‰æ‹¬å·
        "\\))?",
        // å…³é—­æœ€å¤–åœˆæ‹¬å·
        action: function(all, name, param) {
          var current = this.current(),
            pesudos = current.pesudos || (current.pesudos = []),
            name = name.toLowerCase(),
            res = {
              name: name
            };

          if (param) param = param.trim();
          if (posPesudoReg.test(name)) {
            // parse çš„æˆæœ¬æ˜¯å¾ˆå°çš„ å°½é‡åœ¨findå‰æŠŠä¿¡æ¯å‡†å¤‡å¥½
            // è¿™é‡Œæˆ‘ä»¬ä¼šæŠŠnth-child(an+b) çš„ a ä¸Ž b åœ¨ä¸åŒè¾“å…¥ä¸‹æ ‡å‡†åŒ–
            param = extractNthValue(param);
          }
          if (param) res.param = param;
          pesudos.push(res);
        }
      },
      // å±žæ€§é€‰æ‹©ç¬¦  å¦‚  [class=hahaha]
      //
      // è¿™é‡Œä»¥å±žæ€§é€‰æ‹©ç¬¦ä¸ºä¾‹ï¼Œè¯´æ˜Žä¸‹regä¸Žactionçš„å…³ç³»
      // 
      attributes: {
        reg: "\\[\\s*({{word}}+)(?:({{operator}})[\'\"]?([^\'\"\\[]+)[\'\"]?)?\\s*\\]",
        action: function(all, key, operator, value) {
          var current = this.current(),
            attributes = current.attributes || (current.attributes = []);
            var res = {};
          attributes.push({
            key: key,
            operator: operator,
            value: value
          });
        }
      },
      // ä¼ªå…ƒç´ å¯ä»¥å®žçŽ°ä¹ˆï¼Ÿ å ä½
      combo: {
        reg: "\\s*({{combo}})\\s*",
        action: function(all, combo) {
          var data = this.parsed,
            cur = data[data.length - 1];
            this.current().combo = combo;
            cur.push(null);
        },
        order: 0
      }
    };

  var cleanReg = new RegExp("\\s*(,|" + macros.combo + "|" + macros.operator + ")\\s*", "g");
  clean = function(sl) {
      return sl.trim().replace(/\s+/g, " ").replace(cleanReg, "$1");
    };
    // ### parserç”Ÿæˆ
    // åˆå§‹åŒ–parserå®žä¾‹
  var parser = new Parser();
  parser.on(rules); //ç”Ÿæˆè§„åˆ™
  // ä¸ºäº†å…¼å®¹å‰é¢ç‰ˆæœ¬ï¼Œä»ç„¶æä¾›è¿™ä¸ªparseå‡½æ•°, ä¹Ÿä¸ºäº†ä¸Žfindæƒ³å¯¹åº”


  function parse(sl) {
    return parser.parse(sl);
  }

  //   3. Finder
  // ================
  //   Util
  // -------------------------
  // å°†nodelistè½¬å˜ä¸ºarray
  //  DOM related Util
  // --------------------
  var root = doc.documentElement || doc;
  var attrMap = {
    'for': "htmlFor",
    "href": function(node) {
      return "href" in node ? node.getAttribute("href", 2) : node.getAttribute("href");
    },
    "type": function(node) {
      return "type" in node ? node.getAttribute("type") : node.type;
    }
  };
  var checkTagName = assert(function() {
    testNode.appendChild(doc.createComment(""));
    // æœ‰äº›ç‰ˆæœ¬çš„getElementsByTagName("*")ä¼šè¿”å›žæ³¨é‡ŠèŠ‚ç‚¹
    return !testNode.getElementsByTagName("*").length ||
    // ä½Žç‰ˆæœ¬ieä¸‹input name æˆ–è€… idä¸ºlengthæ—¶ lengthè¿”å›žå¼‚å¸¸
    typeof doc.getElementsByTagName("input").length !== "number";
  });
  //form __sizzle__line200 åˆ¤æ–­getAttributeæ˜¯å¦å¯ä¿¡
  var checkAttributes = assert(function() {
    testNode.innerHTML = "<select></select>";
    var type = typeOf(testNode.lastChild.getAttribute("multiple"));
    // IE8 returns a string for some attributes even when not present
    return type !== "boolean" && type !== "string";
  });
  // å°†nthç±»æ–¹æ³•çš„åˆ¤æ–­éƒ¨åˆ†ç»Ÿä¸€æŠ½ç¦»å‡ºæ¥,
  // å…¶ä¸­typeä»£è¡¨æ˜¯å¦æ˜¯nth-type-ofç±»åž‹çš„åˆ¤æ–­,ä¸‹é¢ç±»ä¼¼


  function checkNth(node, type) {
    return type? node.nodeName === type : node.nodeType === 1;
  }
  // èŽ·å¾—çˆ¶èŠ‚ç‚¹nodeçš„é¡ºæ•°ç¬¬n(ä»Ž1å¼€å§‹)ä¸ªå­èŠ‚ç‚¹


  function nthChild(node, type) {
    var node = node.firstChild;
    return (!node || checkNth(node, type)) ? node : nthNext(node, type);
  };
  // èŽ·å¾—çˆ¶èŠ‚ç‚¹nodeçš„å€’æ•°ç¬¬n(ä»Ž1å¼€å§‹)ä¸ªå­èŠ‚ç‚¹


  function nthLastChild(node,type) {
    var node = node.lastChild;
    return (!node || checkNth(node, type))? node:nthPrev(node, type);
  };
  // èŽ·å¾—èŠ‚ç‚¹nodeçš„ç¬¬n(ä»Ž1å¼€å§‹)ä¸ªå‰ç½®å…„å¼ŸèŠ‚ç‚¹


  function nthPrev(node, type) {
    while (node = node.previousSibling) {
      if (checkNth(node, type)) return node;
    }
    return node;
  };
  // èŽ·å¾—èŠ‚ç‚¹nodeçš„å€’æ•°ç¬¬n(ä»Ž1å¼€å§‹)ä¸ªå‰ç½®å…„å¼ŸèŠ‚ç‚¹


  function nthNext(node, type) {
    while (node = node.nextSibling) {
      if (checkNth(node, type)) return node;
    }
    return node;
  };
  // èŽ·å¾—èŠ‚ç‚¹nodeçš„keyå±žæ€§çš„å€¼, ä¿®æ”¹è‡ªfrom sizzle...è›‹ç–¼å•Šå„æµè§ˆå™¨çš„å±žæ€§èŽ·å–

  function getAttribute(node, key) {
    var map = attrMap[key];
    if (map) return typeof map === "function" ? map(node) : node[map];
    if (checkAttributes) {
      return node.getAttribute(key);
    }
    var attrNode = node.getAttributeNode(key);
    // å¯¹äºŽselected checked å½“è¿”å›žä¸ºboolå€¼æ—¶  å°†å…¶æ ‡å‡†åŒ–ä¸º selected = "selected"
    // æ–¹ä¾¿åŽç»­å¤„ç†
    // å¾ˆå¤šæ—¶å€™nullå¯ä»¥ä½œä¸ºæ ‡å¿—ä½ï¼Œnesä¸­å¤§éƒ¨åˆ†ç‰¹æ®Šflagéƒ½ç”¨nullæ ‡ç¤º
    return typeof node[key] === "boolean" 
            ? node[key] ? key : null
            : (attrNode && attrNode.specified ?attrNode.value : null);
  };
  // __æ•°ç»„åŽ»é‡__


  function distinct(array) {
    for (var i = array.length; i--;) {
      var n = array[i];
      // å…ˆæŽ’é™¤ å³ å¦‚æžœå®ƒæ˜¯æ¸…ç™½çš„ åŽé¢å°±æ²¡æœ‰ç­‰å€¼å…ƒç´ 
      array.splice(i, 1, null);
      if (~array.indexOf(n)) {
        array.splice(i, 1); //ä¸æ¸…ç™½
      } else {
        array.splice(i, 1, n); //ä¸æ¸…ç™½
      }
    }
    return array;
  }
  // ä»ŽsizzleæŠ„è¢­çš„ document sorter 
  // å°†åŒ¹é…å…ƒç´ é›†æŒ‰æ–‡æ¡£é¡ºåºæŽ’åˆ—å¥½ è¿™å¾ˆé‡è¦!
  var sortor = (doc.compareDocumentPosition) ?
  function(a, b) {
    if (!a.compareDocumentPosition || !b.compareDocumentPosition) return 0;
    return a.compareDocumentPosition(b) & 4 ? -1 : a === b ? 0 : 1;
  } : ('sourceIndex' in doc) ?
  function(a, b) {
    if (!a.sourceIndex || !b.sourceIndex) return 0;
    return a.sourceIndex - b.sourceIndex;
  } : function(a, b) {
    var i = 0,
      ap = [a],
      bp = [b],
      aup = a.parentNode,
      bup = b.parentNode,
      cur = aup;

    if (a === doc) {
      return -1;
    } else if (b === doc) {
      return 1;
    } else if (!aup && !bup) {
      return 0;
    } else if (!bup) {
      return -1;
    } else if (!aup) {
      return 1;
    } else if (aup === bup) {
      return siblingCheck(a, b);
    }
    while (cur) {
      ap.unshift(cur);
      cur = cur.parentNode;
    }
    cur = bup;
    while (cur) {
      bp.unshift(cur);
      cur = cur.parentNode;
    }
    while (ap[i] === bp[i]) {
      i++;
    }
    return siblingCheck(ap[i], bp[i]);
  };

  function siblingCheck(a, b) {
    if (a && b) {
      var cur = a.nextSibling;
      while (cur) {
        if (cur === b) {
          return -1;
        }
        cur = cur.nextSibling;
      }
    }
    return a ? 1 : -1;
  };

  function uniqueSort(nodeList) {
    return distinct(nodeList.sort(sortor));
  };

  // ### nth position Cache éƒ¨åˆ†
  // å¯¹äºŽnthç±»åž‹çš„æŸ¥æ‰¾ï¼Œæœ‰æ—¶å€™ä¸€æ¬¡èŠ‚ç‚¹æŸ¥æ‰¾ä¼šéåŽ†åˆ°å¤šæ¬¡ç›¸åŒèŠ‚ç‚¹ï¼Œ
  // ç”±äºŽä¸€æ¬¡èŠ‚ç‚¹æŸ¥æ‰¾æ—¶ï¼Œç”±äºŽjsçš„å•çº¿ç¨‹ï¼ŒèŠ‚ç‚¹ä¸å¯èƒ½å‘ç”Ÿæ”¹å˜ï¼Œä»‹äºŽæ­¤ï¼Œæˆ‘ä»¬å°†
  // nthç±»çš„nodeçš„èŠ‚ç‚¹ä½ç½®ç¼“å­˜èµ·æ¥ï¼Œåœ¨æœ¬æ¬¡æŸ¥æ‰¾ç»“æŸåŽå†æ¸…ç©º
  // èŽ·å¾—nodeçš„å”¯ä¸€æ ‡ç¤º
  var getUid = (function(token) {
    var _uid = 0;
    return function(node) {
      return node._uid || (node._uid = token + _uid++);
    };
  })("nes_" + (+new Date).toString(36));
  // åˆ›å»ºnthç›¸å…³çš„Filterï¼Œç”±äºŽéƒ½ç±»ä¼¼ï¼Œå°±ç»Ÿä¸€é€šè¿‡å·¥åŽ‚å‡½æ•°ç”Ÿæˆäº†
  // å‚æ•°æœ‰ä¸¤ä¸ª  
  //    1. isNext: ä»£è¡¨éåŽ†é¡ºåºæ˜¯å‘å‰è¿˜æ˜¯å‘åŽ
  //    2. isType: ä»£è¡¨æ˜¯å¦æ˜¯è¦æŒ‡å®šnodeName


  function createNthFilter(isNext, isType) {
    var next, prev, cacheKey, getStart;
    if (isNext) {
      cacheKey = isType ? "type" : "child";
      // if(typeof isType === "function") cacheKey = "match"
      next = nthNext;
      prev = nthPrev;
      getStart = nthChild;
    } else {
      // Fixed:!!! è¿™é‡Œcacheæ˜¯é¦–æ¬¡ç”Ÿæˆçš„cacheè¢«å†™æ­»äº†ï¼Œå³ä½¿åŽé¢clearäº†ä¹Ÿæ²¡æœ‰ç”¨,
      // å³æ°¸è¿œæ— æ³•è¢«é‡Šæ”¾
      cacheKey = "last" + (isType ? "type" : "child");
      // if(typeof isType === "function") cacheKey = "last-match"
      prev = nthNext;
      next = nthPrev;
      getStart = nthLastChild;
    }
    // å®žé™…è¿”å›žå‡½æ•°, paramå³pesudoçš„actionå®šä¹‰çš„å‚æ•°å½¢å¦‚
    // `{step:1, start:1}` æ‰€æœ‰çš„ç±»ä¼¼evenã€oddæˆ–è€…å…¶ä»–å½¢å¦‚nã€-3n-11éƒ½ä¼šæ ‡å‡†åŒ–
    // æˆè¿™ç§å½¢åŠ¿
    return function(node, param) {
      var cache = nthPositionCache[cacheKey];
      if (node === root) return false; // å¦‚æžœæ˜¯htmlç›´æŽ¥è¿”å›žfalse å‘çˆ¹å•Š
      var _uid = getUid(node),
        parent = node.parentNode,
        traverse = param.step > 0 ? next : prev,
        step = param.step,
        start = param.start,
        type = isType && node.nodeName;
        //Fixed
      if (step === null) return false; //means always false
      if (!cache[_uid]) {
        var startNode = getStart(parent, type),
          index = 0;
          do {
            cache[getUid(startNode)] = ++index;
            nthPositionCache.length++;
          } while (startNode = next(startNode, type));
      }
      var position = cache[_uid];
      if (step === 0) return position === start;
      return ((position - start) / step >= 0) && ((position - start) % step === 0);
    };
  }
  // 
  var nthPositionCache = {length: 1 };
  function clearNthPositionCache() {
    if (nthPositionCache.length) {
      nthPositionCache = {
        child: {},
        lastchild: {},
        type: {},
        lasttype: {},
        length: 0
      };
    }
  }
  // åˆå§‹åŒ–positioncache
  clearNthPositionCache();


  // è¿™é‡Œçš„å‡ ä¸ªfindersæ˜¯ç¬¬ä¸€è½®èŽ·å–ç›®æ ‡èŠ‚ç‚¹é›†çš„ä¾èµ–æ–¹æ³•
  // æˆ‘æ²¡æœ‰å¯¹byClassNameåšç»†è‡´ä¼˜åŒ–ï¼Œæ¯”å¦‚ç”¨XPathçš„æ–¹å¼
  // form sizzle line 147
  var finders = {
    byId: function(id) {
      var node = doc.getElementById(id);
      return node ? [node] : [];
    },
    byClassName: doc.getElementsByClassName ? function(classList, node) {
      classList = classList.join(" ");
      return toArray((node || doc).getElementsByClassName(classList));
    } : null,
    byTagName: checkTagName ? function(tagName, node) {
      var results = (node || doc).getElementsByTagName(tagName);
      return toArray(results);
    } : function(tagName, node) {
      var results = (node || doc).getElementsByTagName(tagName);
      var elem, tmp = [],
        i = 0;
      for (;
      (elem = results[i]); i++) {
        if (elem.nodeType === 1) tmp.push(elem);
      }
      return tmp;
    }
  };
  // ### filter: 
  // Actionä¸­å¡žå…¥çš„æ•°æ®ä¼šç»Ÿä¸€å…ˆè¿™é‡Œå¤„ç†ï¼Œå¯èƒ½æ˜¯ç›´æŽ¥å¤„ç†å¦‚idã€classç­‰ç®€å•çš„.
  // ä¹Ÿå¯èƒ½æ˜¯åˆ†å‘å¤„ç†ï¼Œç”šè‡³æ˜¯å¤šé‡çš„åˆ†å‘ï¼Œå¦‚é‚£äº›å¤æ‚çš„attributeæˆ–è€…æ˜¯pesudo
  // è¿™é‡Œç®€åŒ–åˆ°è¿‡æ»¤å•ä¸ªèŠ‚ç‚¹ é€»è¾‘æ¸…æ™° ,ä½†å¯èƒ½æ€§èƒ½ä¼šé™ä½Žï¼Œå› ä¸ºæœ‰äº›å±žæ€§ä¼šé‡å¤èŽ·å–
  var filters = {
    id: function(node, id) {
      return node.id === id;
    },
    classList: function(node, classList) {
      var len = classList.length,
        className = " " + node.className + " ";
      for (; len--;) {
        if (className.indexOf(" " + classList[len] + " ") === -1) {
          return false;
        }
      }
      return true;
    },
    tag: function(node, tag) {
      if (tag == "*") return true;
      return node.tagName.toLowerCase() === tag;
    },
    // pesudos会分发到ExpandsFilter中pesudo中去处理
    pesudos: function(node, pesudos) {
      var len = pesudos.length,
        pesudoFilters = expandFilters["pesudos"];

      for (; len--;) {
        var pesudo = pesudos[len],
          name = pesudo.name,
          filter = pesudoFilters[name];

        if (!filter) throw Error("不支持的伪类:" + name);
        if (!filter(node, pesudo.param)) return false;
      }
      return true;
    },
    // attributes会分发到ExpandsFilter中的operator去处理
    attributes: function(node, attributes) {
      var len = attributes.length,
        operatorFilters = expandFilters["operators"];

      for (; len--;) {
        var attribute = attributes[len],
          operator = attribute["operator"],
          filter = operatorFilters[operator],
          nodeValue = getAttribute(node, attribute.key);

          if (nodeValue === null) {
            if (operator !== "!=") return false;
            continue;
          }
        if (!operator) continue;
        if (!filter) throw Error("不支持的操作符:" + operator);
        if (!filter(attribute.value, nodeValue + "")) return false;
      }
      return true;
    }
  };

  // expandFilters 
  // -------------------------
  // 原生可扩展的方法
  var expandFilters = {
    // __扩展连接符__:
    // 选择符filter 与其他filter不同 node 同样是当前节点 区别是
    // 如果成功返回成功的上游节点(可能是父节点 可能是兄弟节点等等)
    // 其中 match(node) 返回 这个上游节点是否匹配剩余选择符(内部仍是一个递归)
    combos: {
      ">": function(node, match) {
        var parent = node.parentNode;
        if (match(parent)) return parent;
      },
      "~": function(node, match) {
        var prev = nthPrev(node);
        while (prev) {
          if (match(prev)) return prev;
          prev = nthPrev(prev);
        }
      },
      " ": function(node, match) {
        var parent = node.parentNode;
        while (parent) {
          var pass = match(parent);
          if (pass) return parent;
          if (pass === null) return null;
          parent = parent.parentNode;
        }
        return null;
      },
      "+": function(node, match) {
        var prev = nthPrev(node);
        if (prev && match(prev)) return prev;
      }
    },
    // __扩展操作符__ :
    operators: {
      "^=": function(value, nodeValue) {
        if (nodeValue == null) return false;
        return nodeValue.indexOf(value) === 0;
      },
      "=": function(value, nodeValue) {
        return nodeValue === value;
      },
      "~=": function(value, nodeValue) {
        if (nodeValue == null) return false;
        return ~ (" " + nodeValue + " ").indexOf(value);
      },
      "$=": function(value, nodeValue) { //以value结尾
        return nodeValue.substr(nodeValue.length - value.length) === value;
      },
      "|=": function(value, nodeValue) { // 连接符
        return ~ ("-" + nodeValue + "-").indexOf("-" + value + "-");
      },
      "*=": function(value, nodeValue) { //出现在nodeValue的任意位置
        return ~ (nodeValue).indexOf(value);
      },
      "!=": function(value, nodeValue) {
        return nodeValue !== value;
      }
    },
    // __扩展伪类__:
    pesudos: {
      //TODO:这里如果出自 SELECtorAPI 标注下处处
      "not": function(node, sl) {
        return !matches(node, sl);
      },
      "matches": function(node, sl) {
        return matches(node, sl);
      },
      // child pesudo ç»Ÿä¸€ç”±å·¥åŽ‚å‡½æ•°ç”Ÿæˆ
      "nth-child": createNthFilter(true, false),
      "nth-last-child": createNthFilter(false, false),
      "nth-of-type": createNthFilter(true, true),
      "nth-last-of-type": createNthFilter(false, true),
  
      "first-child": function(node) {
        return !nthPrev(node);
      },
      "last-child": function(node) {
        return !nthNext(node);
      },
      "last-of-type": function(node) {
        return !nthNext(node, node.nodeName);
      },
      "first-of-type": function(node) {
        return !nthPrev(node, node.nodeName);
      },
      "only-child": function(node) {
        return !nthPrev(node) && !nthNext(node);
      },
      "only-of-type": function(node) {
        return !nthPrev(node, node.nodeName) && !nthNext(node, node.nodeName);
      },
      //æ‰¾å‡ºæœ‰å…·ä½“textå†…å®¹çš„èŠ‚ç‚¹
      "contains": function(node, param) {
        return ~ (node.innerText || node.textContent || '').indexOf(param);
      },
      "checked": function(node) {
        return !!node.checked || !! node.selected;
      },
      "selected": function(node) {
        return node.selected;
      },
      "enabled": function(node) {
        return node.disabled === false;
      },
      "disabled": function(node) {
        return node.disabled === true;
      },
      "empty": function(node) {
        var nodeType;
        node = node.firstChild;
        while (node) {
          if (node.nodeName > "@" || (nodeType = node.nodeType) === 3 || nodeType === 4) {
            return false;
          }
          node = node.nextSibling;
        }
        return true;
      },
      "focus": function(node) {
        return node === doc.activeElement && (!doc.hasFocus || doc.hasFocus()) && !! (node.type || node.href || ~node.tabIndex);
      },
      "target": function(node, param) {
        var id = node.id || node.name;
        if (!id) return false;
        return ("#" + id) === location.hash;
      }
    }
  };

  // è¿™é‡Œä¸»è¦æ˜¯æ•´åˆä¹‹å‰çš„ExpandsFilterä¸­çš„mathch, å•å±‚æ•°æ®


  function matchDatum(node, datum, ignored) {
    var subFilter;
    for (var i in datum) {
      if (ignored !== i && (subFilter = filters[i]) && !subFilter(node, datum[i])) {
        return false;
      }
    }
    return true;
  };
  // è¿™ä¸ªå…¨å±€cacheçš„å¼•å…¥æ˜¯ä¸ºäº†é¿å…å¤šæ¬¡ä¼ å…¥å‚æ•°ã€‚
  // å½“ç„¶å…¨å±€çš„ç¼ºç‚¹ä¹Ÿå¾ˆæ˜Žæ˜¾ï¼Œç»´æŠ¤ä¼šä¸æ–¹ä¾¿, ä¸åˆ©äºŽæµ‹è¯•
  var matchesCache = null; //ä¿å­˜é‚£äº›matcheså‡½æ•°
  

  function matchData(node, data, ignored) { // ç¨åŽå†çœ‹å­˜å…¥step
    var len = data.length,
      datum = data[len - 1];
      // é¦–å…ˆè¦æ»¡è¶³è‡ªèº«
    if (!matchDatum(node, datum, ignored)) return false;
    else {
      if (len == 1) return true;
      var nextDatum = data[len - 2],
        getNext = expandFilters.combos[nextDatum.combo],
        match = matchesCache[len - 2],
        next = getNext(node, match);

        if (next) return true;
        else return false;
    }
  };
  //åŠ¨æ€äº§ç”Ÿä¾›FilterOneNodeä½¿ç”¨çš„match


  function createMatch(data) {
    return function(node) {
      if (node == root || node == null || node == doc) return null; //null ç›¸å½“äºŽä¼‘æ­¢ç¬¦
      return matchData(node, data);
    };
  };

  function createMatches(data) {
    var matches = [];
    for (var i = 0, len = data.length; i < len; i++) {
      matches.push(createMatch(data.slice(0, i + 1)));
    }
    return matches;
  };
  // è¿‡æ»¤ä¸»å‡½æ•°filter
  // -----------------------------------
  // è‡ªåº•å‘ä¸Šè¿‡æ»¤éžåŒ¹é…èŠ‚ç‚¹


  function filter(results, data, ignored) {
    if (!data.length) return results;
    //è¿™é‡Œæ˜¯ä¸ºäº†ç¼“å­˜matchåŒ¹é…å‡½æ•°
    var preMatchesCache = matchesCache;
    matchesCache = createMatches(data);
    for (var i = results.length; i--;) {
      if (!matchData(results[i], data, ignored)) {
        results.splice(i, 1);
      }
    }
    // Fixed: å› ä¸ºä¸€æ¬¡filterå¯èƒ½ä¼šæœ‰å­—filterè°ƒç”¨ï¼Œæ¯”å¦‚matchesã€notã€include
    matchesCache = preMatchesCache; // warning :ä»¥åŽå†™å…¨å±€å˜é‡ä¸€å®šå½“å¿ƒ
    return results;
  }
  // èŽ·å¾—ç¬¬ä¸€æ¬¡ç›®æ ‡èŠ‚ç‚¹é›†


  function getTargets(data, context) {
    var results, ignored, lastPiece = data[data.length - 1];
    if (lastPiece.id) {
      results = finders.byId(lastPiece.id);
      ignored = "id";
    } else if (lastPiece.classList && lastPiece.classList.length && finders.byClassName) {
      results = finders.byClassName(lastPiece.classList, context);
      ignored = "classList";
    } else {
      results = finders.byTagName(lastPiece.tag || "*", context);
      ignored = "tag";
    }
    if (!results.length) return results;
    return filter(results, data, ignored);
  }
  // API : find (private)
  // -------------
  // æ ¹æ®parseåŽçš„æ•°æ®è¿›è¡ŒèŠ‚ç‚¹æŸ¥æ‰¾
  // options:
  //    1. parsed.data  parseæ•°æ®ä¸ºä¸€æ•°ç»„
  //    2. node         contextèŠ‚ç‚¹
  // äº‹å®žä¸Šæ²¡æœ‰dataè¿™ä¸ªå•è¯ï¼Œæˆ‘è¿™é‡Œç®—æ˜¯è‡ªå®šäº†è¿™ä¸ªå•è¯
  //     datas : [data,data]   
  //     data : [datum, datum]
  //     datum: {tag:"*"....etc}


  function find(datas, context) {
    if (!datas[0][0]) return [];
    var results = [],
      notNullResult = 0;

    for (var i = 0, len = datas.length; i < len; i++) {
      var data = datas[i],
        dlen = data.length,
        last = data[dlen - 1],
        result = getTargets(data, context);

      if (result && result.length) {notNullResult++;};
      if (!results) results = result;
      else results =results.concat(result);
    }
    clearNthPositionCache();//æ¸…ç†
    if (notNullResult > 1) uniqueSort(results);
    return results;
  }
  // API : æµ‹è¯•ç”¨getç›¸å½“äºŽall (private)
  // -------------------------------------
  // ä¸ºäº†æµ‹è¯•æ—¶é¿å…åŽŸç”ŸquerySelectorçš„å½±å“
  // 


  function get(sl, context) {
    var data = parse(sl);
    var result = find(data, context || doc);
    return result;
  }

  // API 
  // ----------------------------------------------------------------------
  var supportQuerySelector = !! doc.querySelector;

  // API1â€”â€”__one__:å¯¹åº”æ ‡å‡†çš„querySelectoræ–¹æ³•


  function one(sl, context) {
    var node;
    if (supportQuerySelector && !nes.debug) {
      try {
        node = (context || doc).querySelector(sl);
      } catch (e) {
        node = get(sl, context)[0];
      }
    } else {
      node = get(sl, context)[0];
    }
    return node;
  }

  // API2â€”â€”__all__
  // -------------------------------
  // å¯¹åº”æ ‡å‡†çš„querySelectorAllæ–¹æ³•


  function all(sl, context) {
    var nodeList;
    if (supportQuerySelector && !nes.debug) {
      try {
        nodeList = toArray((context || doc).querySelectorAll(sl));
      } catch (e) {
        nodeList = get(sl, context);
      }
    } else {
      nodeList = get(sl, context);
    }
    return nodeList;
  }

  // API 3: 
  // ----------------------------------------------------------------------
  // å¯¹åº”æ ‡å‡†çš„matchesæ–¹æ³•
  // nesçš„matchesåŠŸèƒ½ç¨å¼ºï¼Œå®ƒæ”¯æŒç”¨åˆ†éš”ç¬¦é“¾æŽ¥ç¬¦ç»„åˆçš„å¤æ‚é€‰æ‹©å™¨
  // å³ä¸Žallã€oneå‡½æ•°çš„æ”¯æŒæ˜¯ä¸€æ ·çš„
  //
  // æ³¨: ç”±äºŽ:notä¸Ž:matchesä¾èµ–äºŽè¿™ä¸ªå‡½æ•° ,æ‰€ä»¥åŒæ ·æ”¯æŒå¤æ‚é€‰æ‹©å™¨


  function matches(node, sl) {
    if (!node || node.nodeType !== 1) return false;
    var datas = parse(sl),
      len = datas.length;
    if (!datas[len - 1][0]) return false;
    for (; len--;) {
      if (matchOneData(node, datas[len])) return true;
    }
    return false;
  }

  // matches å•æ­¥è°ƒç”¨æ–¹æ³•


  function matchOneData(node, data) {
    var len = data.length;
    if (!matchDatum(node, data[len - 1])) {
      return false;
    } else {
      return filter([node], data.slice(0)).length === 1;
    }
  }

  // ASSEMBLE 
  // =========================
  // ç»„è£…åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤
  //
  // 1. ç”Ÿæˆpesudo ã€ operatorã€combo ç­‰expandæ–¹æ³•
  // ----------------------------------------------------------------------
  // 具体扩展方法的使用请参见 [nes的github](https://github.com/leeluolee/nes)
  // 统一由工厂函数createExpand
  ;
  (function createExpand(host, beforeAssign) {
    for (var i in host) {
      nes[i] = (function(i) {
        var container = host[i];
        // autoSet代表了这三个函数除了key、value参数
        // 也支持字面量的参数输入
        return autoSet(function(key, value) {
          // Warning: 直接覆盖，如果存在的话
          container[key] = value;
          if (i in beforeAssign) {
            beforeAssign[i](key, value);
          }
        });
      })(i);
    }
    // 有些扩展如combos、operators由于为了避免冲突
    // 关键字都写入了正则式中，这种情况下需要将新的正则式
    // 填入相关正则，并进行parser的setup
  })(expandFilters, {
    "operators": function(key) {
      var befores = macros.operator.split("]");
      befores.splice(1, 0, key.charAt(0) + "]");
      macros.operator = befores.join("");
      parser.setup();
    },
    "combos": function(key) {
      var befores = macros.combo.split("]");
      befores.splice(1, 0, key + "]");
      macros.combo = befores.join("");
      parser.setup();
    }
  });

  // 2. 暴露API
  // -------------------------------------
  //
  // 直接设置其为true 来强制不适用原生querySelector Api
  nes.debug = false; 
  nes._nthCache = nthCache;
  // parser , 抽离的parser部分
  // ---------------------------
  // 它可以:
  //
  //    1. parser.parse 解析内部规则定义的字符串匹配
  //    2. parser.on    添加新规则
  //    3. parser.clone 复制此parser，这个作用会在后面的zen-coding的demo中体现
  //    4. parser.off   删除规则
  //    5. parser.cache 缓存控制
  nes.parser = parser;

  //解析, 这个将被移除，使用parser.parse来代替
  nes.parse = parse;
  //查找parser解析后的data代表的节点 __private__
  nes._find = find;
  //测试时排除原生querySelector的影响 __deprecated__! 使用nes.debug来控制
  nes._get = get;
  //        *主要API*
  // -------------------------
  nes.one = one; 
  nes.all = all; 
  nes.matches = matches;
  // 内建扩展 api 这三个已经内建:
  // 
  // 1. `pesudos`
  // 2. `operators`
  // 3. `combos`
  nes._uniqueSort = uniqueSort;
  nes._cleanSelector = clean;
  nes._getUid = getUid;


  //          5.Exports
  // ----------------------------------------------------------------------
  // 暴露API:  amd || commonjs  || global 
  // 支持commonjs
  if (typeof exports === 'object') {
    module.exports = nes;
    // 支持amd
  } else if (typeof define === 'function' && define.amd) {
/* */define(function() {
      return nes;
    });
  } else {
    // 直接暴露到全局
    win.nes = nes;
  }

  //        6. extension
  //-------------------------------------------------------------
  // 很多人不看extend文件夹， 所以这部分也作为Demo实例

  /**
   * nth Math 的调用方法
   * @param  {[type]} first [description]
   * @return {[type]}
   */
  function nthMatch(first) {
    return function(node, param) {
      var tmp = param.split(/\s+of\s+/);
      if(tmp.length<2) throw Error("no 'of' keyword in nth-match\"s selector");

      var params = extractNthValue(tmp[0]),
        sl = tmp[1],
        testNode = node.parentNode[first? "firstChild":"lastChild"],
        next = first? "nextSibling" : "previousSibling",
        step = params.step,
        start = params.start,
        position = 0;

        if(!matches(node, sl)) return false;
        if (step === null) return false; //means always false
        do {
          if (testNode.nodeType === 1 && nes.matches(testNode, sl)) position++;
          if (testNode === node) break;
        } while (testNode = testNode[next]);
        
        if (step === 0) return position === start;
        return ((position - start) / step >= 0) && ((position - start) % step === 0);
    };
  }
  nes.pesudos({
    // 例如 :nth-match(3 of li.active) 第三个满足这个li.active的节点
    "nth-match": nthMatch(true),
    "nth-last-match": nthMatch(false),
    "local-link": function(_node, param){
      if(param) param = parseInt(param);
    }
  });
}(window, document, undefined);
I$(290,function (NEJ,_t0,_p,_o,_f,_r){
    /**
     * 节点选择器
     *
     * 结构示例
     * ```html
     * <ul class="w-tab">
     *   <li class="itm">Tab-0</li>
     *   <li class="itm">Tab-1</li>
     *   <li class="itm">Tab-2</li>
     *   <li class="itm js-selected">Tab-3</li>
     *   <li class="itm">Tab-4</li>
     *   <li class="itm">Tab-5</li>
     * </ul>
     * ```
     *
     * 脚本示例
     * ```javascript
     * NEJ.define([
     *     'util/query/query',
     *     'util/tab/tab'
     * ],function(_e,_t){
     *     // 使用选择器接口来取列表
     *     _t._$$Tab._$allocate({
     *         list:_e._$all('.w-tab > li'),
     *         onchange:function(_event){
     *                // TODO
     *         }
     *     });
     * });
     * ```
     *
     * @method module:util/query/query._$all
     * @param  {String} arg0 - 选择器
     * @param  {Node}   arg1 - 用于匹配的根节点，默认为document
     * @return {Array}         符合规则的节点列表
     */
    _p._$all = function(){
        try{
            return nes.all.apply(nes,arguments);
        }catch(e){
            return null;
        }
    };
    /**
     * 节点选择器
     *
     * 结构示例
     * ```html
     * <ul class="w-tab">
     *   <li class="itm">Tab-0</li>
     *   <li class="itm">Tab-1</li>
     *   <li class="itm">Tab-2</li>
     *   <li class="itm js-selected">Tab-3</li>
     *   <li class="itm">Tab-4</li>
     *   <li class="itm">Tab-5</li>
     * </ul>
     * ```
     *
     * 脚本示例
     * ```javascript
     * NEJ.define([
     *     'util/query/query'
     * ],function(_t){
     *     // 使用选择器接口来取选中的节点
     *     var _node = _t._$one('.w-tab > li.js-selected');
     * });
     * ```
     *
     * @method module:util/query/query._$one
     * @param  {String} arg0 - 选择器
     * @param  {Node}   arg1 - 用于匹配的根节点，默认为document
     * @return {Node}          符合规则的节点
     */
    _p._$one = function(){
        try{
            return nes.one.apply(nes,arguments);
        }catch(e){
            return null;
        }
    };
    // for test only
    _p._$g = nes._get;

    if (CMPT){
        NEJ.copy(NEJ.P('nej.e'),_p);
    }

    return _p;
},215,485);
I$(79,function (_v,_e,_u,_x,_t){
    var fragmentRE = /^\s*<(\w+|!)[^>]*>/,
        // local vals
        _slice = [].slice,
        _doc = document,
        _de = "documentElement",
        _docElem = _doc[_de],
        _testNode = _doc.createElement('div'),

        // assert
        _textHandle = _testNode.textContent == null? 'innerText' : 'textContent' ,
        _extend = function(_name, _value, _options) {
            _options = _options || {};
            if (this[_name] == null || _options.override) this[_name] = _value;
            return this;
        },
        _bubbleUp = function(_sl, _node, _container) {
            while (_node && _node !== _container) {
                if (nes.matches(_node, _sl)){
                    return _node;
                }
                _node = _node.parentNode;
            }
        },
        /**
         * 根据返回类型决定返回this，还是别的什么
         * @param  {Mix} _result
         * @param  {String} _methodName 当前方法名
         * @return {Mix}
         */
        _ischainableRet = function(_result, _methodName, _node){
            return (_result === _node || _result === "undefined" || _result === this ||
                    _result === _e || _result === _v);// 这两个是为了兼容nej
        },
        _isAcceptedNode = function(_node){
            if(!_node) return false;
            var _type = _node.nodeType;
            return _type === 1 || _type === 9 || //  element document
                _type === 11|| _node.window === _node; // framement window
        },
        // 安全的添加原型, 本作用域内
        _safeProtoExtend = function(Type){
            var _proto = Type.prototype,
                _list = {};
            return {
                extend:function(_name, _fn){
                    _list[_name] = _proto[_name];//先保存之前的
                    _proto[_name] = _fn;
                    return this;
                },
                reset: function(){
                    for(var _i in _list) if(_list.hasOwnProperty(_i)){
                        if(_list[_i] === undefined){
                            delete _proto[_i];
                        }else{
                            _proto[_i] = _list[_i];
                        }
                    }
                }
            };
        },
        _fn = _safeProtoExtend(Function);

    // 安全扩展函数原型
    // 1. autoSet, 自动转换set({name:value})为多重set(name, value)
    _fn.extend("autoSet", function(){
        var _fn = this;
        return function(_key, _value) {
            if (_u._$isObject(_key)){
                var _args = _slice.call(arguments, 1);
                for(var _i in _key){
                    _fn.apply(this, [_i, _key[_i]].concat(_args));
                }
                return this;
            }else{
                return _fn.apply(this, arguments);
            }
        };
    // 2. splitProcess, 自动在首参数为数组时，拆分为多步，
    }).extend("splitProcess", function(_isGetter){
        var _fn = this;
        return function(_params){
            if(_u._$isArray(_params)){
                var _args = _slice.call(arguments, 1),
                    _len = _params.length,
                    _ret;
                if(_isGetter) _ret = {}; //当时getter函数需要返回值
                for(var _i = 0 ; _i < _len ;_i++){
                    var _param = _params[_i],
                        _tmpRet = _fn.apply(this, [_param].concat(_args));
                    if(_isGetter && typeof _param === "string") _ret[_param] = _tmpRet;
                }
                return _isGetter? _ret : this;
            }else{
                return _fn.apply(this, arguments);
            }
        };
    });

    _extend = _extend.autoSet();

  /**
    *    将输入的选择器指定节点或节点和节点数组包装成_$$NodeList对象，NodeList是一个类似jQuery的对象
    *    可以进行链式操作，拥有大部分nej.e下的接口，并扩展了一部分jQuery的常用方法。
    *
    *    一个脑残的例子告诉你链式调用可以做什么
    *    ```javascript
    *    // 获得某个节点集, 设置样式
    *    $("#chainable li:nth-child(odd)")._$style({
    *        "background": "#cca",
    *        "cursor": "pointer"
    *    })
    *    // 然后抛弃他们 找他们的下一个位置条件满足是4倍数的兄弟节点并设置样式
    *    ._$next(":nth-child(2n)")._$style({
    *        "background": "#a19",
    *        "cursor": "help"
    *    })
    *    // 过滤出其中是4倍数的行,并绑定事件
    *    ._$filter(":nth-child(4n)")._$click(function(_e) {
    *        $(this)._$style("background", "#111");
    *    // 并给他们中的第一行设置边框
    *    })._$get(1, true)._$style("border", "3px solid #222")
    *    // 找到父节点div并且有chainable的id并且设置样式
    *    ._$parent("div#chainable")._$style({
    *        width: "800px",
    *        left: "300px",
    *        position:"absolute"
    *    // 绑定事件以及代理事件
    *    })._$on({
    *        "click" :function(){
    *            var div = document.createElement("div")
    *            div.innerHTML = "hahaæ’å…¥ä¸€è¡Œ"
    *            //æ¯æ¬¡ç‚¹å‡»æ’å…¥ä¸€è¡Œ
    *            $(this)._$insert(div, "bottom");
    *        },
    *        "mouseover li:nth-child(odd)":function(_e){
    *            this._isLight = !this._isLight;
    *            // æ¯æ¬¡ç‚¹å‡»æ”¹å˜èƒŒæ™¯è‰²
    *            $(this)._$style("background-color", this._isLight? "#cca":"#331")
    *        }
    *    // èŽ·å¾—æ ·å¼å€¼
    *    })._$style(["width", "left"])
    *    // åˆ°è¿™é‡Œé“¾å¼ç»“æŸè¿”å›ž{"width":"80px", "left":"30px"}
    *    ```
    *
    *    nej.$ æ”¯æŒçš„é€‰æ‹©å™¨ä¸Žnesé€‰æ‹©å™¨ä¸€è‡´ï¼Œå…·ä½“è¯·å‚è€ƒ https://github.com/leeluolee/nes
    * 
    *    ç»“æž„ä¸¾ä¾‹
    *    ```html
    *      <ul>
    *          <li><a href=""></a></li>
    *          <li><a href=""></a></li>
    *          <li><a href=""></a></li>
    *          <li><a href=""></a></li>
    *      </ul>
    *    ```
    * 
    *    ```javascript
    *      var $ = NEJ.P('nej.$');
    *      $('ul > li:nth-child(2n+1) >a')
    *       .addClassName('odd')
    *       ._$on('click', _callback) //å°†æ‰€æœ‰çš„å¥‡æ•°lièŠ‚ç‚¹ä¸‹çš„aæ ‡ç­¾åŠ ä¸ŠclassNameï¼Œå¹¶è¿›è¡Œäº‹ä»¶ç»‘å®š
    *    ```
    *
    *    $æŽ¥å—çš„å‚æ•°ä¸ŽjQueryçš„ä¸€è‡´ ï¼Œéžå¸¸çµæ´»
    *    ```javascript
    *    // èŽ·å¾—"body"èŠ‚ç‚¹ï¼Œ å¾ˆæ˜Žæ˜¾æ­¤æ—¶èŠ‚ç‚¹é›†åªæœ‰ä¸€ä¸ªå…ƒç´ 
    *    $("body")
    *
    *    // æ‰¾åˆ°æœ‰class1å¹¶ä¸”æœ‰relå±žæ€§çš„èŠ‚ç‚¹é›†ï¼Œè¿™æ—¶å¯èƒ½ä¼šæœ‰å¾ˆå¤šä¸ªèŠ‚ç‚¹
    *    $("body li.class1[rel]")
    *    // ä¼šè¿‡æ»¤å‡ºchildNodesçš„èŠ‚ç‚¹ï¼Œå…¶ä»–Array Likeä¹Ÿæ˜¯ç±»ä¼¼
    *    $(document.body.childNodes)
    *
    *    // æœ‰æ—¶å€™ä½ ä¸ç¡®å®šè¾“å…¥çš„æ˜¯ä»€ä¹ˆå‚æ•°ï¼Œ å®‰å…¨çš„å†åŒ…ä¸€æ¬¡å§ï¼Œæ— å‰¯ä½œç”¨
    *    $body = $("body")
    *    $body2 = $($body2)
    *    ```
    * 
    *    @method CHAINABLE.$
    *    @param  {String|Array|_$$NodeList|Node} _selector å¯ä»¥æ˜¯é€‰æ‹©å™¨ã€èŠ‚ç‚¹ã€èŠ‚ç‚¹æ•°ç»„æˆ–å¦ä¸€ä¸ª_$$NodeListå®žä¾‹
    *    @param  {String|Node|_$$NodeList} _context  ä»£è¡¨ä»Žè¿™ä¸ªæ ¹èŠ‚ç‚¹ä¸‹æŸ¥æ‰¾èŠ‚ç‚¹ï¼Œç‰¹åˆ«æ˜¯é¡µé¢ä¸ŠèŠ‚ç‚¹è¿˜ä¸å­˜åœ¨æ—¶ï¼Œéœ€è¦ä¼ å…¥è¿™ä¸ªå‚æ•°
    *    @return {_$$NodeList}           è¿”å›ž_$$NodeListå®žä¾‹
    */
    var $ = function(_selector, _context){
        
        // dump nej methods implement
        $._$implement(_x._$dump(), {"statics": true});
        _x._$clear();
        
        if (typeof _selector === 'string' && _selector.trim().indexOf("<") == 0) {
        var container = document.createElement('div');
            container.innerHTML = _selector;
            var res = $(container.childNodes);
            return res;
        }
        return new _$$NodeList(_selector, _context);
    };

    function _$$NodeList(_selector, _context){
        this.length = 0;
        this._signs = {};//æ ‡ç¤ºæ˜¯å¦æœ‰äº†å½“å‰èŠ‚ç‚¹
        this._context = _context || _doc;
        if(!_selector) return ;
        if(typeof _selector === "string"){
            // if(/\^<[-\w]+/.test(_selector)) return $.fragment(_selector);
            if(_context && _context instanceof _$$NodeList) _context = _context[0];
            if(typeof _context == 'string') _context = $(_context)[0];
            this._$add(_t._$all(_selector, _context));
        }else if(_selector instanceof _$$NodeList || _isAcceptedNode(_selector) ||
            _selector.length){ // _$$NodeList æˆ–è€… æ˜¯å•èŠ‚ç‚¹ã€æˆ–è€…æ˜¯ç±»æ•°ç»„(å¦‚childNodes)
            this._$add(_selector);
        }
    }

    // æ‰©å±•æŽ¥å£
    $._$extend = _extend._$bind($);


    $._$extend({
        _$signal: "_uid",//ä¼šç»‘å®šåœ¨èŠ‚ç‚¹ä¸Šçš„å”¯ä¸€æ ‡ç¤º
        _$instances:{},// ç¼“å­˜å¯¹è±¡
        _$handlers:[], // ä¿å­˜åŽŸå§‹handleræ–¹æ³•
        _$fragment: function(){
        },
        /**
         * æ‰©å±•é“¾å¼åŒ–æŽ¥å£ï¼Œä½ å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼ï¼Œä¸€æ˜¯è¿ç§»å·²æœ‰çš„é™æ€æŽ¥å£(æ¯”å¦‚NEJçš„å¤§éƒ¨åˆ†æŽ¥å£éƒ½æ˜¯è¿™æ ·è¿ç§»è¿‡æ¥çš„)ï¼Œè€Œæ˜¯ç›´æŽ¥è¿›è¡Œ_$$NodeListçš„åŽŸåž‹æ‰©å±•
         *
         * Example:
         * ```javascript
         * // 1. ç›´æŽ¥æ‰©å±•
         * $._$implement("_$hello", function(){
         *     // éåŽ†å®¹å™¨å†…çš„æ‰€æœ‰èŠ‚ç‚¹
         *     this._$forEach(function(_node, _index){
         *         _node.hello = "Hello World"
         *     })
         * })
         * $("li:nth-child(2n)")._$hello() // æ‰€æœ‰å¶æ•°è¡Œéƒ½è¢«åŠ ä¸Šäº† helloå±žæ€§
         * // 2. ç›´æŽ¥åˆ©ç”¨é™æ€æ–¹æ³•è¿›è¡Œæ‰©å±•(å¸¸ç”¨è¯­è¿ç§»), ä¸Šé¢æ‰©å±•ç­‰ä»·äºŽ
         * $._$implement("_$hello", function(_node){
         *    _node.hello = "Hello World"
         * }, {static: true})
         * // 3. åˆ›å»ºjQueyçš„wrap æ–¹æ³•
         * // åˆ›å»ºwrapæ–¹æ³•
         * $._$implement("_$wrap", function(_selector){
         *     var $content = $(_selector)
         *     $content._$after2(this)._$insert(this);
         * })
         * $("#list")._$wrap(document.createElement("div"))
         * ```
         *
         * éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“é™æ€æŽ¥å£çš„è¿ç§»æ—¶ï¼Œæœ‰å¦‚ä¸‹çº¦å®š(åŒæ—¶ä¹Ÿæ˜¯NEJåŽŸæŽ¥å£åœ¨é“¾å¼è°ƒç”¨çš„è¡¨çŽ°çº¦å®š)
         * 
         * * å½“è¿”å›žå€¼ä¸º: this ã€ ä¼ å…¥èŠ‚ç‚¹ ã€ nej.v ã€ nej.e ã€ undefined (å³ä¸è¿”å›ž)æ—¶, è§†ä¸ºsetteræ“ä½œ,å¯ä»¥è¿›è¡Œé“¾å¼è°ƒç”¨, å¦‚ä¸Šä¾‹:
         * * å½“è¿”å›žå€¼ä¸ºå…¶ä»–ç±»åž‹æ—¶: è§†ä¸ºgetteræ“ä½œ, è¿”å›žèŠ‚ç‚¹åˆ—è¡¨ä¸­ ç¬¬ä¸€ä¸ªå…ƒç´  çš„è¿”å›žå€¼ï¼Œè¿™ä¸ªä¹Ÿæ˜¯jQueryçš„é“¾å¼æŽ¥å£çš„è¡¨çŽ°
         * 
         *
         * @method CHAINABLE._$implement
         * @param  {Object} _definition è¦æ‰©å±•çš„æŽ¥å£é›†åˆ (æ³¨æ„ä¸è¦ä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸ºé”®å€¼)
         * @param  {Object} _options å‚æ•°  ç›®å‰åªæœ‰ä¸¤ä¸ªé€‰é¡¹{statics: ä»£è¡¨æ˜¯å¦æ˜¯é™æ€æŽ¥å£è¿ç§», override: æ˜¯å¦è¦†ç›–åŽŸåŒåæ–¹æ³•}
         * @return {this}
         */
        _$implement: function(_name, _fn, _options){
            _options = _options || {};
            _extend.call(_$$NodeList.prototype, _name, _options.statics? this._transport(_fn): _fn);
        }.autoSet(),
        _transport: function(_fn){
            return function(){
                // if(!this.length) throw Error("å†…éƒ¨èŠ‚ç‚¹é›†ä¸ºç©º")
                var _args = _slice.call(arguments);
                _args.unshift(this[0]);

                var _ret = _fn.apply(this,_args);
                // å½“è¿”å›ž_eã€_vã€thisã€_nodeã€undefined(æ— è¿”å›žå€¼)éƒ½è§†ä¸ºé“¾å¼
                if(!_ischainableRet.call(this, _ret)) return _ret;

                this._$forEach(function(_node, _index){
                    if(_index === 0) return;
                    _args[0] = _node;
                    _fn.apply(this ,_args);
                });
                return this;
            };
        },
        _merge: function(_list1, _list2 , _filter){
            var _i = _list1.length || 0,
                _j = 0;
            for( ;_list2[_j] !== undefined;){
                var _tmp = _list2[_j++];
                if(!_filter || _filter.call(_list1, _tmp)){
                    _list1[_i++] = _tmp;
                }
            }
            _list1.length = _i;
            return _list1;
        },
        _toArray: function(_list){
            return $._merge([], _list);
        },
        // ** fork form jQuery **
        _contains: _docElem.contains ? function( _a, _b ) {
            return _a === _b || (_a.nodeType == 9? _a[_de]: _a).contains(_b);
        }: _docElem.compareDocumentPosition ?
        function( _a, _b ) {
            // more info : https://gist.github.com/4601579
            return _b && !!( _a.compareDocumentPosition( _b ) & 16 );
        }: function( _a, _b ) {
            // fallback
            while ( (_b = _b.parentNode) ) {
                if ( _b === _a ) return true;
            }
            return false;
        },
        _$cloneNode:function(_node, _withContent){
            _withContent = !!_withContent;
            var _clone = _node.cloneNode(_withContent),
                _ce, _be;

            if(_withContent){
                _be = nes.all("*", _node);
                _be.push(_node);
                _ce = nes.all("*", _clone);
                _ce.push(_clone);
            }else{
                _be = [_node];
                _ce = [_clone];
            }

            for (_i = _ce.length; _i--;){
                _definitions.fixture.clone(_ce[_i], _be[_i]);
            }
            return _clone;
        },
        _delegateHandlers : {},// for delegate
        _cleanSelector : nes._cleanSelector,
        _$uniqueSort : nes._uniqueSort,
        _$matches : nes.matches,
        _$fn: _$$NodeList.prototype,
        _$uid : nes._getUid
    });

    // proto function 扩展
    // ================================
    var _rclickEvents = /^(?:click|dblclick|contextmenu|DOMMouseScroll|mouse(?:\w+))$/,
        _rkeyEvents = /^key(?:)/,
        _definitions ={
        // for insert
        // 这里统一视为_node2为插入点
        "insertor":{
            "top":function(_node, _node2){
                _node.insertBefore(_node2, _node.firstChild);
            },
            "bottom": function(_node, _node2){
                _node.appendChild(_node2);
            },
            "before":function(_node, _node2){
                var _parent = _node.parentNode;
                if(_parent) _parent.insertBefore(_node2, _node);
            },
            "after":function(_node, _node2){
                var _parent = _node.parentNode;
                if(_parent) _parent.insertBefore(_node2, _node.nextSibling);
            }
        },
        fixProps :{
            // 确保表单元素属性被正确设置 IE lt9
            input: 'checked',
            option: 'selected',
            textarea: 'value',
            // clone时 , IE某些版本不会正确设置text
            script:"text"
        },
        fixture:{
            // dest src attribute fixed
            "clone": function(_dest, _src){
                var _nodeName, _attr;

                if (_dest.nodeType !== 1) {
                    return;
                }
                // lt ie9 才有
                if (_dest.clearAttributes) {
                    _dest.clearAttributes();
                    _dest.mergeAttributes(_src);
                }
                // 判断是否有需要处理属性的节点
                _nodeName = _dest.nodeName.toLowerCase();
                if(_prop = _definitions.fixProps[_nodeName]){
                    _dest[_prop] = _src[_prop];
                }
                //移除节点标示
                _dest.removeAttribute($._$signal);
                // 移除ID:  TODO? 是否允许有重复ID?
                _dest.removeAttribute("id");
            },
            //patch event
            "event":function(_e){
                var _type = _e.type;
                var _button = _e.button;
                _e.__fixed = true; //标示被fix过
                _e.target = _e.target || _e.srcElement || document; //for ie
                _e.metaKey = !!_e.metaKey; //低版本ie会返回undefined 应该返回


                if(_e.target.nodeType === 3) _e.target = _e.target.parentNode;
                if(_rclickEvents.test(_type)){ //如果是鼠标事件 则初始化page相关
                    _e.pageX = _v._$pageX(_e);
                    _e.pageY = _v._$pageY(_e);
                    if (_type === 'mouseover' || _type === 'mouseout'){//如果是鼠标事件中的mouseover与mouseout
                        var related = _e.relatedTarget || _e[(_type == 'mouseover' ? 'from' : 'to') + 'Element'];
                        while (related && related.nodeType == 3) related = related.parentNode;
                        _e.relatedTarget = related;
                    }
                }
                _e.which = _e.charCode != null ? _e.charCode : _e.keyCode;
                if( !_e.which && _button !== undefined){
                    // http://api.jquery.com/event.which/ use which
                    _e.which = ( _button & 1 ? 1 : ( _button & 2 ? 3 : ( _button & 4 ? 2 : 0 ) ) );
                }
                if(!_e.preventDefault) _e.preventDefault = function(){
                    this.returnValue = false;
                    return this;
                };

                if(!_e.stopPropagation) _e.stopPropagation = function(){
                   this.cancelBubble = true;
                   return this;
                };
            }
        }
    },
    // for traverse
    _traverse = function(_direct){
        var _$matches = $._$matches;

        return function(_selector, _all){
            var _ret = $([]);
            if(typeof _selector === "boolean"){
                _all = _selector;
                _selector = null;
            }
            this._$forEach(function(_node){
                var _tmp = _node[_direct];
                while (_tmp) {
                  if(_tmp.nodeType ===1 && (!_selector || _$matches(_tmp, _selector))){
                    _ret._$add(_tmp);
                    if(!_all) break;
                  }
                  _tmp = _tmp[_direct];
                }
            });
            return _ret;
        };
    };


    $._$implement({
     /**
      * 获取节点样式或者设置节点样式, 这个接口的表现与jQuery的css方法一致, 根据参数不同有不同的表现
      * 比如:
      * ```javascript
      * $('li')._$style(name) //相当于_$getStyle 返回样式值
      * $('li')._$style([name1,name2...]) //相当于多重_$getStyle 返回一个Object(如{"height:20px, width:30px..."})
      * $('li')._$style(name, value) // 相当于setStyle 返回this
      * $('li')._$style(obj) //相当于多重版setStyle(即原_$style) 返回this
      * ```
      * @method CHAINABLE._$style
      * @param  {String|Object|Array} _key  可以是String(单取值或设置)，一个对象(多重赋值)，一个数组(多重取值)
      * @param  {String} _value 样式值
      * @return {_$$Nodelist|String|Object} setter操作返回_$$NodeList，单重取值返回String，多重取值返回样式属性为键的Object，表现与jQuery的css接口一致
      */
        _$style: function(_key, _value){
            if(!_key) throw Error("缺少css样式名");
            if(_value === undefined){
                return _e._$getStyle(this[0], _key);
            }
            return this._$forEach(function(_node){
                _e._$setStyle(_node, _key, _value);
            });
        }.splitProcess(true).autoSet(),
       /**
        * 获取节点属性或者设置节点属性, 这个接口的表现与jQuery的attr一致, 同_$style接口，根据参数不同有不同的表现
        * 比如:
        * ```javascript
        * $('li')._$attr(name): 相当于_$attr 返回属性值
        * $('li')._$attr([name1, name2]) 同style描述 返回{titile:"xxx",rel:"xxx", href:"xxx"}
        * $('li')._$attr(name, value): 相当于_$attr 返回this
        * $('li')._$attr(obj): 相当于多重版的_$attr 返回this
        * ```
        * 
        * @method CHAINABLE._$attr
        * @param  {String|Object|Array} _key  可以是String(单取值或设置)，一个对象(多重赋值)，一个数组(多重取值)
        * @param  {String} _value 属性值
        * @return {_$$Nodelist|String|Object} setter操作返回_$$NodeList，单重取值返回String，多重取值返回样式属性为键的Object，表现与jQuery的css接口一致
        */
        _$attr: function(_key, _value){
            if(!_key) throw Error("缺少属性名");
            if(_value === undefined){
                return _e._$attr(this[0], _key);
            }
            return this._$forEach(function(_node){
                _e._$attr(_node, _key, _value);
            });
        }.splitProcess(true).autoSet(),

        /**
         * 类似于ES5的Array#forEach, 一个遍历函数, 即遍历_$$NodeList的所有节点集
         * æ¯”å¦‚:
         * ```javascript
         * // å°†1,4,7...classå«æœ‰strongçš„liå…ƒç´ åˆ†åˆ«åŠ ä¸Šé˜¶æ¢¯åž‹çš„é«˜åº¦
         * $("li.strong:nth-child(3n+1)")._$forEach(function(_node, _index){
         *     _node.style.height = "" + (_index+1)*10 + "px";
         *     // è¿™é‡Œçš„thisæŒ‡å‘å®žä¾‹
         * })
         * ```
         * æ³¨æ„callbackä¸­ä¼ å…¥çš„èŠ‚ç‚¹æ˜¯è£¸èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯åŒ…è£…åŽçš„_$$NodeList
         * 
         * @method CHAINABLE._$forEach
         * @param  {Function} _fn éåŽ†å›žæŽ‰ï¼ŒæŽ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œå½“å‰éåŽ†åˆ°çš„èŠ‚ç‚¹å’ŒèŠ‚ç‚¹ä¸‹æ ‡
         * @return {_$$NodeList}
         */
        _$forEach: function(_fn){
            _u._$forEach(this, _fn);
            return this;
        },

      /**
       * ç±»ä¼¼äºŽES5çš„Array#filter, ä¸€ä¸ªè¿‡æ»¤, å³è¿‡æ»¤_$$NodeListçš„æ‰€æœ‰èŠ‚ç‚¹é›†å¹¶ç­›é€‰ç¬¦åˆçš„èŠ‚ç‚¹
       * æ¯”å¦‚:
       * ```javascript
       * // è¿”å›žèŠ‚ç‚¹é›†ä¸­çš„åŒ¹é…é€‰æ‹©å™¨.strong:nth-child(3n)çš„èŠ‚ç‚¹
       * $("li")._$filter(".strong:nth-child(3n)")

       * // ç›¸å½“äºŽ  ===>
       * $("li")._$filter(function(_node){
       *     return $(_node)._$matches(".strong:nth-child(3n)");
       * });
       * ```
       * æ³¨æ„callbackä¸­ä¼ å…¥çš„èŠ‚ç‚¹æ˜¯è£¸èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯åŒ…è£…åŽçš„_$$NodeList
       * 
       * @method CHAINABLE._$filter
       * @param  {Function|String} _fn éåŽ†å‡½æ•°ï¼ŒæŽ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œå½“å‰éåŽ†åˆ°çš„èŠ‚ç‚¹å’ŒèŠ‚ç‚¹ä¸‹æ ‡ã€‚åŒæ—¶ä¹ŸæŽ¥å—ä¸€ä¸ªSelectorï¼Œç­›é€‰å‡ºèŠ‚ç‚¹é›†ä¸­æ»¡è¶³é€‰æ‹©å™¨çš„èŠ‚ç‚¹
       * @return {_$$NodeList}
      */
        _$filter: function(_fn){
            var _ret = [],
                _isSelctor = typeof _fn === "string";
            this._$forEach(function(_node, _index){
                var _test = _isSelctor ? $._$matches(_node, _fn):_fn.call(this, _node, _index);
                if(_test) _ret.push(_node);
            });
            return $(_ret);
        },
        /**
         * ç›¸å½“äºŽES5çš„Array#map, å½“è¿”å›žå€¼å…¨éƒ¨æ˜¯èŠ‚ç‚¹ç±»åž‹æ—¶ï¼Œè¿”å›ž$NodeListchainable, å¦åˆ™è¿”å›žæ ‡å‡†ç»“æžœæ•°ç»„(æ­¤æ—¶chainableä¸èƒ½)
         *
         * example:
         * ```javascript
         * // æ­¤æ—¶è¿”å›žArray : ["li", "li", "li".........]
         * $("li")._$map(function(_node){
         *     return _node.tagName.toLowerCase()
         * });
         * // æ­¤æ—¶è¿”å›ž $NodeList: å³æ‰€æœ‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹
         * $("li")._$map(function(_node){
         *     return _node.nextSibling
         * });
         * ```
         * æ³¨æ„callbackä¸­ä¼ å…¥çš„èŠ‚ç‚¹æ˜¯è£¸èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯åŒ…è£…åŽçš„_$$NodeList
         * 
         * @method CHAINABLE._$map
         * @param  {Function} _fn éåŽ†callbackï¼ŒæŽ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œå½“å‰éåŽ†åˆ°çš„èŠ‚ç‚¹å’ŒèŠ‚ç‚¹ä¸‹æ ‡
         * @return {_$$NodeList}
         */
        _$map:function(_fn){
            var _ret = [],
                _isNotAllNode = false;
            this._$forEach(function(_node, _index){
                var _res = _fn.call(this, _node, _index);
                if(!_isAcceptedNode(_res)) _isNotAllNode = true;
                _ret.push(_res);
            });
            return _isNotAllNode ? _ret : $([])._$add(_ret);
        },
        /**
         * NodeListä¸­çš„èŠ‚ç‚¹æ˜¯ä¸ä¿è¯æŒ‰æ–‡æ¡£é¡ºåºçš„(å¦‚æžœæ˜¯ç”¨é€‰æ‹©å™¨ï¼Œåˆ™ä¿è¯æ˜¯æœ‰åºçš„), ä½ å¯ä»¥æ‰‹åŠ¨æŽ’åº
         * 
         * @method CHAINABLE._$sort
         * @return {_$$NodeList}
         */
        _$sort:function(){
            var _array = this._$get();
            $._$uniqueSort(_array);
            return $(_array);
        },
        /**
         * å‘å†…éƒ¨èŠ‚ç‚¹é›†å¡«å…¥å…ƒç´ , ä¼šå¤„ç†å¥½é‡å¤ä»¥åŠè¿‡æ»¤çš„é€»è¾‘ã€‚è¿™ä¸ªä¹Ÿæ˜¯$æŽ¥å£ä¾èµ–çš„æ–¹æ³•ã€‚
         * ```javascript
         * var $body = $("body")
         * $body._$add($("tbody")) //==> æ·»åŠ tbody
         * $body._$add($("tbody")) //==> ä»€ä¹ˆéƒ½ä¸ä¼šå‘ç”Ÿ å› ä¸ºé‡å¤äº†
         * $body._$add(document.body.childNodes) //==> æ·»åŠ æ‰€æœ‰çš„bodyä¸‹çš„å­èŠ‚ç‚¹,è¿‡æ»¤æŽ‰ä¸ç¬¦åˆçš„
         * ```
         * 
         * @method CHAINABLE._$add
         * @param  {Node|Array|_$$NodeList} _node è¦æ·»åŠ çš„èŠ‚ç‚¹æˆ–èŠ‚ç‚¹é›†
         * @return {_$$NodeList}      è¿”å›žthis
         */
        _$add:function(_node){
            if(!_node) return;
            // TODO: æŠŠwindow æŽ’é™¤åœ¨å¤–
            if(_node.tagName || typeof _node.length !== "number" || _node === window ) _node = [_node];
            $._merge(this, _node, function(_nodum){
                if(!_isAcceptedNode(_nodum)) return false;
                var _uid = $._$uid(_nodum);
                if(this._signs[_uid]){
                    return false;
                }else{
                    this._signs[_uid] = 1;
                    return true;
                }
            });
            return this;
        },
        _$get:function(_index, wrap){
            if(typeof _index !== "number") return $._toArray(this);
            return wrap ? $(this[_index]) : this[_index];
        },
        _$last: function(wrap){
            return wrap? $(this[this.length-1]) : this[this.length-1];
        },
        _$first: function(wrap){
            return wrap? $(this[0]) : this[0];
        },
        /**
         * åˆ¤æ–­åŒ…è£…èŠ‚ç‚¹æ˜¯å¦æ»¡è¶³æŸä¸ªé€‰æ‹©å™¨ï¼Œå³Selector APIçš„matchesæ–¹æ³•ã€‚å¦‚æžœèŠ‚ç‚¹é›†å†…ä¸æ­¢ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ™åªåˆ¤æ–­ç¬¬ä¸€ä¸ªèŠ‚ç‚¹
         * Exmaple:
         * ```javascript
         *  $("body tbody td:nth-child(4n)")._$matches("body tbody td:nth-child(2n)")
         *  //è¿”å›ž true... è¿™ä¸ªæ˜¯å½“ç„¶çš„, 4å€æ•°çš„èŠ‚ç‚¹å½“ç„¶æ»¡è¶³å¶æ•°æ¡ä»¶
         * ```
         *
         * 
         * @method CHAINABLE._$matches
         * @param  {String} _selector ä¾›æµ‹è¯•çš„é€‰æ‹©å™¨
         * @return {Boolean}          æ˜¯å¦é€šè¿‡æµ‹è¯•
         */
        _$matches: function(_selector){
            return $._$matches(this[0],_selector);
        },
        /**
         * æŸ¥æ‰¾ æ‰€æœ‰èŠ‚ç‚¹ çš„ç¬¬ä¸€ä¸ª(æˆ–æ‰€æœ‰)æ»¡è¶³å…³ç³»çš„ çˆ¶èŠ‚ç‚¹ é›†, å¹¶è¿”å›ž$NodeList
         *
         * Example:
         * ```javascript
         * $("tr")._$parent()
         * //=> ['tbody', 'thead'],ä¸¤ä¸ªæ˜¯å› ä¸ºèŠ‚ç‚¹é›†ä¸­çš„trå…ƒç´ å¯èƒ½åœ¨tbodyæˆ–theadä¸­
         * $("tr")._$parent("tbody")
         * //=> ['tbody'] å¿…é¡»æ»¡è¶³tbody
         * $("tr")._$parent(true)
         * // =>['tbody', 'thead', 'div', 'body' ....] //ä¼šå‘ä¸ŠæŸ¥æ‰¾æ‰€æœ‰çˆ¶èŠ‚ç‚¹
         * $("tr")._$parent("tbody, body",true)
         * // =>['body', 'tbody'] //ä¼šå‘ä¸ŠæŸ¥æ‰¾æ‰€æœ‰çˆ¶èŠ‚ç‚¹,ä½†æ˜¯å¿…é¡»æ»¡è¶³é€‰æ‹©å™¨
         * ```
         * @method CHAINABLE._$parent
         * @param  {String} _selector é€‰æ‹©å™¨
         * @param  {Boolean} _all     æ˜¯å¦èŽ·å–æ‰€æœ‰å±‚çº§çš„çˆ¶èŠ‚ç‚¹
         * @return {[type]}
         * @type {[type]}
         */
        _$parent: _traverse("parentNode"),
        /**
         * ä¸Ž_$parentç±»ä¼¼,æŸ¥æ‰¾ æ‰€æœ‰èŠ‚ç‚¹ çš„ç¬¬ä¸€ä¸ª(æˆ–æ‰€æœ‰æ ¹æ®_allå‚æ•°)æ»¡è¶³å…³ç³»çš„ å‰åºå…„å¼ŸèŠ‚ç‚¹ (previousSibling)é›†, å¹¶è¿”å›ž$NodeList
         * ```javascript
         * $("td")._$prev("th[scope=row]", true)
         * // è¿”å›žæ‰€æœ‰åœ¨tdä¹‹å‰çš„thå…ƒç´ , å®ƒä»¬çš„scopeå±žæ€§ä¸º row
         * $("td")._$prev("th[scope=row]")
         * // åªè¿”å›žç›´æŽ¥ç›¸é‚»çš„å‰èŠ‚ç‚¹ï¼Œå¦‚æžœä¸æ»¡è¶³é€‰æ‹©å™¨åˆ™è¿”å›žç©ºèŠ‚ç‚¹é›†
         * ```
         * @method CHAINABLE._$prev
         * @param  {String} _selector é€‰æ‹©å™¨
         * @param  {Boolean} _all     æ˜¯å¦èŽ·å–æ‰€æœ‰å‰åºèŠ‚ç‚¹
         * @return {[type]}
         */
        _$prev: _traverse("previousSibling"),
        /**
         * ä¸Ž_$prevç±»ä¼¼,æŸ¥æ‰¾ æ‰€æœ‰èŠ‚ç‚¹ çš„ç¬¬ä¸€ä¸ª(æˆ–æ‰€æœ‰æ ¹æ®_allå‚æ•°)æ»¡è¶³å…³ç³»çš„ å‘åŽå…„å¼ŸèŠ‚ç‚¹ (nextSibling)é›†, å¹¶è¿”å›ž$NodeList
         * @method CHAINABLE._$next
         * @param  {String} _selector é€‰æ‹©å™¨
         * @param  {Boolean} _all     æ˜¯å¦èŽ·å–æ‰€æœ‰åŽåºèŠ‚ç‚¹
         * @return {[type]}
         */
        _$next: _traverse("nextSibling"),
        /**
         * 查找到 本节点集中 所有节点 的满足选择器关系的 直接子节点 (或 任意层级子节点 )集, 并返回$NodeList
         * ```javascript
         * $("body, table")._$children();
         * // => 相当于 合并body与table的直接子节点
         * $("body, table")._$children("div, thead");
         * // => 只要他们子节点中的div 与 thead元素
         * $("body, table")._$children(true);
         * // => 这里会获取所有body下的所有层级的子节点(table也在body中)
         * $("body, table")._$children("td:not(:last-child, :nth-child(2n))",true);
         * // => 返回所有层级的td元素并且满足选择器 td:not(:last-child, :nth-child(2n))
         * ```
         *
         * @method CHAINABLE._$children
         * @param  {String} _selector 选择器
         * @param  {Boolean} _all     是否获取所有层级的节点
         * @return {[type]}
         */
        _$children: function(_selector, _all){
            var _ret = $([]);
            if(typeof _selector === "boolean"){
                _all = _selector;
                _selector = null;
            }
            this._$forEach(function(_node){
                var _backed = _all? _t._$all(_selector || "*", _node)
                    : _selector? $(_node.childNodes)._$filter(_selector)
                    : $(_node.childNodes);
                _ret._$add(_backed);
            });
            return _ret;
        },
        /**
         * 满足选择器条件的同级节点，但不包含本身
         * Example
         * ```javascript
         * $("script")._$siblings("title,h2"); // => 返回script的同级节点中的
         * ```
         *
         * 
         * @method CHAINABLE._$siblings
         * @param  {String} _selector
         * @return {_$$NodeList}    这些同级节点会被包装为一个_$$NodeList
         */
        _$siblings: function(_selector){ // sibling 默认就是取所有
            return this._$prev(_selector, true)._$add(this._$next(_selector, true));
        },
        /**
         * 这个insert 拥有jQuery的四个接口的功能(before, after, prepend , append) ，分别用_direct参数控制
         *
         * Example:
         * ```javascript
         * //将`a.next`插到`#home`的内部的最上方
         * $('#home')._$insert('a.next', 'up');
         * //将a.next插入到`#home`节点后面
         * $('#home')._$insert('a.next', 'after');
         * ```
         *
         * @method CHAINABLE._$insert
         * @param  {String|Node|_$$NodeList} _selector 代表被插入的节点，可以是选择器、节点或是另外一个_$$NodeList对象
         * @param  {String} _direct   插入位置，可以是节点内的底部、顶部(bottom, top)，或节点同层的前后位置(before, after)，默认为bottom
         * @return {_$$NodeList}    返回this
         */
        _$insert: function(_selector, _direct){
            _direct = (_direct && _direct.toLowerCase()) || "bottom";
            if(!_definitions.insertor[_direct]) _direct = "bottom";
            var _content = $(_selector)[0], //将被插入的节点
                _insertor = _definitions.insertor[_direct];
            if(!_content) throw Error("The Element to be inserted is not exist");

            return this._$forEach(function(_node, _index){
                _insertor(_node, _index === 0? _content
                    : $._$cloneNode(_content, true));//如果是多个节点则cloneNode
            });
        },
        /**
         * 这个_$insert2 拥有jQuery的四个接口的功能(insertBefore, insertAfter, prependTo , appendTo) ，分别用_direct参数控制。其实就是_$insert接口的相反版，
         * 你做的是将被插入节点插入到某个节点的指定位置。
         *
         * Example:
         * ```javascript
         * //将`#home`插到`a.next`的内部的最上方
         * $('#home')._$insert2('a.next', 'up');
         * //将`#home`插入到`a.next`节点后面
         * $('#home')._$insert2('a.next', 'after');
         * ```
         *
         * @method CHAINABLE._$insert2
         * @param  {String|Node|_$$NodeList} _selector 代表参考节点，可以是选择器、节点或是另外一个_$$NodeList对象
         * @param  {String} _direct   插入位置，可以是节点内的底部、顶部(bottom, top)，或节点同层的前后位置(before, after)，默认为bottom
         * @return {_$$NodeList}    返回this
         */
        _$insert2: function(_selector, _direct){
            $(_selector)._$insert(this, _direct);
            return this;
        },
        /**
         * 克隆节点集内部的 所有节点, 并返回clone的目标节点集 $NodeList 实例
         *
         * Example:
         * ```javascript
         * $('.m-template')._$clone(true)._$insert2('body');//将`.m-template`节点clone一份插入到`body`的内部下方
         * ```
         *
         * @method CHAINABLE._$clone
         * @param  {Boolean} _withContent 是否要克隆子节点
         * @return {_$$NodeList}
         */
        _$clone: function(_withContent){
            return this._$map(function(_node){
                return $._$cloneNode(_node, _withContent);
            });
        },
        /**
         * 获得节点集中的 第一个元素的innerText 或者 设置所有元素的innerText
         *
         * Example:
         * ```javascript
         * $("title,h2")._$text("haha")
         * // 同时设置title与h2的text内容为haha
         * $("title,h2")._$text()
         * // 获得title(第一个元素)的innerText
         * ```
         *
         * 
         * @method CHAINABLE._$text
         * @param  {content} _content 要插入的内容 , 不传入则认为是getter操作
         * @return {_$$NodeList|String} setter操作返回_$$NodeList getter操作返回String
         */
        _$text: function(_content){
            if(_content === undefined){
                if(!this[0]) throw Error("内部节点为空，无法完成get操作");
                return this[0][_textHandle];
            }
            return this._$forEach(function(_node){
                _node[_textHandle] = _content;
            });
        },
        /**
         * 获得节点集中的 第一个元素的innerHTML 或者设置所有元素的innerHTML(与_$text接口类似)
         *
         * Example:
         * ```javascript
         * $("title,h2")._$html("haha")
         * // 同时设置title与h2的innerHTML为haha
         * $("title,h2")._$html()
         * // 获得title(第一个元素)的innerHTML
         * ```
         *
         * 
         * @method CHAINABLE._$html
         * @param  {content} _content 要插入的内容 不传入则认为是getter操作
         * @return {_$$NodeList|String} setter操作返回_$$NodeList getter操作返回String
         */
        _$html: function(_content){
            if(_content === undefined){
                if(!this[0]) throw Error("内部节点为空，无法完成get操作");
                return this[0].innerHTML;
            }
            return this._$forEach(function(_node){
                _node.innerHTML = _content;
            });
            return this;
        },
        /**
         * 获得节点集中的 第一个元素的value 或者设置所有元素的value(与_$text接口类似)
         *
         * Example:
         * ```javascript
         * $("input,textarea")._$val()
         * // 获取第一个满足'input,textarea'选择器元素的value值
         * $("title,h2")._$html("haha")
         * // 获得title(第一个元素)的innerHTML
         * ```
         *
         * 
         * @method CHAINABLE._$html
         * @param  {content} _content 要插入的内容
         * @return {_$$NodeList|String} setter操作返回_$$NodeList getter操作返回String
         */
        _$val:function(_content){
            if(_content === undefined){
                if(!this[0]) throw Error("内部节点为空，无法完成get操作");
                return this[0].value;
            }
            return this._$forEach(function(_node){
                _node.value = _content;
            });
            return this;
        },

        // 事件相关
        // ==============
        // 私有方法  注册事件代理
        _delegate:function(_event, _selector, _handler){
            _selector = $._cleanSelector(_selector);
            return this._$forEach(function(_node){
                var _uid = $._$uid(_node),
                    _handlers = $._delegateHandlers[_uid] || ($._delegateHandlers[_uid] = {}),
                    _events = _handlers[_event] || (_handlers[_event] = {}),
                    _selectors = _events[_selector] || (_events[_selector] = []);

                var _realCb = function(_e) {//正式回调
                    var _trigger;
                    if (_trigger = _bubbleUp(_selector, _e.target || _e.srcElement , _node)) {
                        _handler.apply(_trigger, arguments);
                    }
                };
                // 保存引用 以可以正确off
                _realCb._raw = _handler;
                _selectors.push(_realCb);
                // 假如不存在对应的容器，则先创建
                _v._$addEvent(_node, _event, _realCb);
                // Fix: 我们保存原始_handler为了 nej的 delEvent可以正确解绑
                // 省去再存储一份handler列表的开销
            });
        },
        // 私有方法 解绑事件代理
        _undelegate:function(_event, _selector, _handler){
            _selector = $._cleanSelector(_selector);
            return this._$forEach(function(_node){
                var _uid = $._$uid(_node);
                var _handlers, _events, _selectors;
                if (!(_handlers = $._delegateHandlers[_uid]) ||
                    !(_events = _handlers[_event]) || !(_selectors = _events[_selector])){
                    return;
                }
                for(var _len = _selectors.length;_len--;){
                    var _fn = _selectors[_len];
                    //如果没有传入_handler或者 函数匹配了
                    if(!_handler || _fn._raw === _handler){
                        _v._$delEvent(_node, _event, _fn);
                        _selectors.splice(_len,1);
                    }
                }
                // 如果被删光了
                if(!_selectors.length) delete _events[_selector];
            });
            return this;
        },
        /**
         * 绑定事件，可以使用事件代理, 与jQuery的on类似
         *
         * __Example:__
         * ```javascript
         * // 1. 普通事件绑定
         * $("body")._$on("click", function(_e){
         *     alert("单个事件绑定"+_e.type)
         * })
         * // 2. 多个普通类型绑定到同一个handler
         * $("body")._$on(["click", "mouseover"], function(_e){
         *     alert("多个type绑定"+_e.type)
         * })
         * // 3. 单个代理事件绑定 这里等同于_$on("click", "tr:nth-child(2n)", handler)
         * $("body")._$on("click tr:nth-child(2n)", function(_e){
         *     // this 对象指向当前`触发`事件的tr:nth-child(2n)
         *     _e.preventDefault()
         *     alert("单个代理事件绑定"+_e.type)
         * })
         * // 4. 多个事件绑定(同回调), 这里分别是普通事件dblclick与代理事件click tr:nth-child(2n)
         * $("body")._$on(["dblclick", "click tr:nth-child(2n)"], function(_e){
         *     _e.preventDefault()
         *     alert("多个事件类型绑定"+_e.type)
         * })
         * // 5. 多重事件绑定,
         * $("body")._$on({
         *     "dblclick":function(_e){
         *         alert("多重事件绑定之普通版"+_e.type)
         *     },
         *     "click tr:nth-child(2n)":function(_e){
         *         alert("多重事件绑定之代理版"+_e.type)
         *     }
         * })
         * ```
         * 
         * @method CHAINABLE._$on
         * @param  {String|Array|Object} _event     事件名，_event支持多种参数类型会有不同的结果
         *                             如果_event参数中不包含空格, 则视为简单事件绑定如，click,
         *                             如果_event参数中包含空格,则会被split, 左边视为event参数，右边视为_selector参数如'click .next',
         *                             如果_event是个Ojbect,则会视为多重绑定,如{'click .next': callback1, 'mouseover': callback2}
         *                             如果_event是个Array, 则会对多个_event进行同一个函数的绑定, 如['click','mouseover']
         * @param  {String} _selector  如果传入则代表是一个事件代理,可忽略
         * @param  {Function} _handler 回掉函数
         * @return {_$$NodeList}
         */
        _$on:function(_event, _selector, _handler){
            if(_event === undefined) throw Error("缺少事件名参数");
            if(typeof _selector === "function"){
                _handler = _selector;
                _selector = null;
            };
            var _index = _event.indexOf(" ");
            if(~_index){//有空格分隔 如"click div.m-model"
                _selector = _event.slice(_index + 1);
                _event = _event.slice(0, _index);
            }
            if(!_handler) throw Error("缺少回调函数");
            // 创建一个realHandler
            else {
                var _raw = _handler;
                var _handler = function(_e){
                    _definitions.fixture.event(_e);
                    _raw.apply(this, arguments);
                };
                _raw.real = _handler;//
            }
            if(_selector){ // on ("click", "li.clas1", handler)或 on("click", "li.class1")
                return this._delegate(_event,_selector, _handler);
            }
            // on("click", handler)
            return this._$forEach(function(_node){
                _v._$addEvent(_node, _event, _handler);
            });
        }.splitProcess().autoSet(),

        /**
         * 为 节点集内的每一个节点 解除事件回调, 类似jQuery的off方法
         * __Example__
         * ```javascript
         * // 1. 普通事件解绑
         * $("body")._$off("click", handler)
         * // 2. 多个普通类型事件解绑(同一个handler)
         * $("body")._$off(["click", "mouseover"], handler)
         * // 3. 普通事件清除(即不传入handler) __同时会把节点上click类型的代理事件清除!__
         * $("body")._$off("click")
         * // 4. 多个普通事件清除 同时会把节点上相应类型的代理事件清除!
         * $("body")._$off(["click","mouseover"])
         * // 5. 单个代理事件的解绑
         * $("body")._$off("click","tr:nth-child(2n)", handler)
         * // 或
         * $("body")._$off("click tr:nth-child(2n)", handler)
         * // 6. 多个代理事件的解绑(同一个handler)
         * $("body")._$off(["dblclick td[title]", "click tr:nth-child(2n)"], handler)
         * // 7. 代理事件的清除
         * $("body")._$off("dblclick","td[title]");
         * $("body")._$off("dblclick td[title]");
         * $("body")._$off(["dblclick td[title]", "click tr:nth-child(2n)"])
         * // 8. 多重事件解绑
         * $("body")._$off({
         *     "dblclick td":handler1,
         *     "click tr":handler2
         * });
         * // 9. 所有事件清除
         * $("body")._$off() //慎重
         * ```
         *
         * 
         * @method CHAINABLE._$off
         * @param  {String|Array|Object} _event 与_$on方法一样，解绑也会根据参数不同可以有很大的灵活度
         *                                      如果_event参数中不包含空格, 则视为简单事件解绑如，click,
         *                                      如果_event参数中包含空格,则会被split, 左边视为event参数，右边视为_selector参数如'click .next',
         *                                      如果_event是个Ojbect,则会视为多重解绑, 如{'click .next': callback1, 'mouseover': callback2}
         *                                      如果_event是个Array, 则会对多个_event进行同一个函数的解绑, 如['click','mouseover']
         *                                      需要注意_$off与_$on不同的是_event也可以是个空值，代表会解决节点下的所有事件
         * @param  {[type]} _selector [description] 如果传入_selector参数，则会进行事件代理的事件解绑, 可忽略
         * @param  {[type]} _handler  [description] 要解绑对应回调，可忽略
         * @return {_$$NodeList}
         */
        _$off:function(_event, _selector, _handler){
            if(typeof _selector === "function"){
                _handler = _selector;
                _selector = null;
            }
            var _index;
            if(_event && ~(_index = _event.indexOf(" "))){//有空格分隔 如"click hello"
                _selector = _event.slice(_index + 1);
                _event = _event.slice(0, _index);
            }
            if(_handler) _handler = _handler.real || _handler;
            if(_selector){ // off("click", ".class")   off("click", ".class", handler)
                return this._undelegate(_event, _selector, _handler);
            }
            return this._$forEach(function(_node){
                var _uid = $._$uid(_node),
                    _handlers = $._delegateHandlers[_uid],
                    _events;
                if(!_event){ // off()
                    if(_handlers){
                        delete $._delegateHandlers[_uid]; // 删除所有
                    }
                    _v._$clearEvent(_node, _event);
                }else{
                    if(_handlers) _events = _handlers[_event];
                    if(!_handler){ // off("click")
                        if(_events){
                            delete _handlers[_event];
                        }
                        _v._$clearEvent(_node, _event);
                    }else{ // off("click", handler)
                        // 这里不对delegate做清理是因为 这样不会对delegate发生影响
                        _v._$delEvent(_node, _event, _handler);
                    }
                }
            });
        }.splitProcess().autoSet(),
        /**
         * 触发每个节点的对应事件, 同nej.v._$dispatchEvent，区别是参数类型自由度高一点
         *                                      如果_event参数为String, 则视为简单事件触发如，click,
         *                                      如果_event是个Ojbect,则会视为多重触发, 如{'click': param1, 'mouseover': param2}
         *                                      如果_event是个Array, 则会对多个_event进行触发(公用一个options), 如['click','mouseover']
         * Example:
         * ```javascript
         * //触发一个事件
         * _$trigger("click", params)
         * //一次触发多个事件(如果有参数，他们共用这个参数)
         * _$trigger(["click", "mouseover"], params)
         * // 触发多个事件有不同参数
         * _$trigger({
         *     "click": params1,
         *     "dblclick": params2
         * })
         * ```
         *
         * @method CHAINABLE._$trigger
         * @param  {String|Array|Object} _event   可以传入多种参数类型
         * @param  {Whatever} _options 同_$dispatchEvent的_options
         * @return {_$$NodeList}
         */
        _$trigger:function(_event, _options){
            if(typeof _event !== 'string') throw Error("事件类型参数错误");
            this._$forEach(function(_node){
                _v._$dispatchEvent(_node, _event, _options);
            });
            return this;
        }.splitProcess().autoSet(),

        // http://stackoverflow.com/questions/6599071/array-like-objects-in-javascript
        // 让这个对象看起来像数组
        splice: function(){ throw Error("don't use the NodeList#splice");}
    });
    // @ remove 无法被混淆的方法
    // // 无奈 添加 _$before // _$before2   _$bottom _$bottom2等方法
    // _u._$forIn(_definitions.insertor, function(_value, _key){
    //     $._$implement("_$" + _key, function(){
    //        var _args = _slice.call(arguments);
    //        _args.push(_key)
    //        return this._$insert.apply(this, _args)
    //     })
    //     $._$implement("_$" + _key+"2", function(){
    //        var _args = _slice.call(arguments);
    //        _args.push(_key)
    //        return this._$insert2.apply(this, _args)
    //     })
    // })

    // // 添加类似 _$click的事件
    // // ================================
    // // TODO: 检查是否有遗漏的方法
    //    @
    // var _beAttached = "click dbclick blur change focus focusin focusout keydown keypress keyup mousedown mouseover mouseup mousemove mouseout scroll select submit".split(" ");

    // @ remove 无法被混淆 移除
    // _u._$forEach(_beAttached, function(_eventName){
    //     $._$implement("_$"+_eventName, function(){
    //         var _type = typeof arguments[0];
    //         var _args = _slice.call(arguments);
    //         _args.unshift(_eventName);
    //         // click("li", handler)   或者  click(handler)
    //         if((_type == "function") || (_type === "string" && typeof arguments[1] === "function")){
    //             this._$on.apply(this, _args);
    //         }else{
    //         // click(options) 或者 click()
    //             this._$trigger.apply(this, _args);
    //         }
    //         return this;
    //     }.autoSet())
    // });
    // 把原型还回去, WARN:千万注意
    _fn.reset();
    
    if (CMPT){
        nej.$ = $;
    }
    
    return $;
},3,4,2,217,290);
I$(25,function (_l){
    return _l;
},79);
I$(494,function (_p,_o,_f,_r){
    /**
     * 节点hover行为
     * @param  {Node}   节点
     * @param  {String} 样式，默认为js-hover
     * @return {Void}
     */
    _p.__hoverElement = function(){
        // use css :hover
    };
    /**
     * 移除节点hover行为
     * @param  {String} 节点ID
     * @return {Void}
     */
    _p.__unhoverElement = function(_id){
        // use css :hover
    };
    
    return _p;
});
I$(302,function(b1482406244402,_h,_v,_p,_o,_f,_r){if (b1482406244402._$KERNEL.engine==='trident'&&b1482406244402._$KERNEL.release<='2.0'){I$(495,function (){
        var _cache = {};
        // enter element
        var _doEnter = function(_event){
            var _element = _event.srcElement,
                _class = _cache[_element.id],
                _name = _element.className;
            if (_name.indexOf(_class)<0){
                _element.className += ' '+_class;
            }
        };
        // leave element
        var _doLeave = function(_event){
            var _element = _event.srcElement,
                _class = _cache[_element.id],
                _name = _element.className||'';
            if (_name.indexOf(_class)>=0){
                _element.className = _name.replace(_class,'').trim();
            }
        };
        /**
         * 节点hover行为
         * @param  {Node}   节点
         * @param  {String} 样式，默认为js-hover
         * @return {Void}
         */
        _h.__hoverElement = function(_element,_class){
            var _id = _element.id;
            if (!!_cache[_id]) return;
            // hover element
            _cache[_id] = _class;
            _v._$addEvent(
                _id,'mouseenter',_doEnter
            );
            _v._$addEvent(
                _id,'mouseleave',_doLeave
            );
        };
        /**
         * 移除节点hover行为
         * @param  {String} 节点ID
         * @return {Void}
         */
        _h.__unhoverElement = function(_id){
            if (!_cache[_id]) return;
            delete _cache[_id];
            _v._$delEvent(
                _id,'mouseenter',_doEnter
            );
            _v._$delEvent(
                _id,'mouseleave',_doLeave
            );
        };
    });}return _h;},78,494,3);
I$(107,function (NEJ,_e,_x,_u,_h,_p,_o,_f,_r){
    /**
     * 节点hover行为，高版本浏览器用:hover样式处理
     *
     * 样式举例
     * ```css
     *    .page .element:hover,
     *    .page .element.js-hover{background:#f00;}
     * ```
     *
     * 结构举例
     * ```html
     *    <!-- 使用data-hover指定hover效果的样式名称 -->
     *    <div id="abc" data-hover="js-hover">aaaaa</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'util/hover/hover'
     *   ],function(_e){
     *       // 如果hover效果的样式名已经通过data-hover指定
     *       _e._$hover('abc');
     *
     *       // 如果hover效果的样式名没有通过data-hover指定
     *       _e._$hover('abc','js-hover');
     *   });
     * ```
     *
     * @method module:util/hover/hover._$hover
     * @param  {String|Node} arg0 - 节点
     * @param  {String}      arg1 - 样式，默认为js-hover
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$hover
     * @see module:util/hover/hover._$hover
     */
    _p._$hover = function(_element,_clazz){
        if (!_u._$isArray(_element)){
            _element = _e._$get(_element);
            if (!!_element){
                _e._$id(_element);
                _h.__hoverElement(
                    _element,_clazz||
                    _e._$dataset(_element,'hover')||
                    'js-hover'
                );
            }
            return;
        }
        // batch hover
        _u._$forEach(
            _element,function(_node){
                _p._$hover(_node,_clazz);
            }
        );
    };
    /**
     * 低版本移除节点hover行为，高版本不做处理
     *
     * 样式举例
     * ```css
     *    .page .element:hover,
     *    .page .element.js-hover{background:#f00;}
     * ```
     *
     * 结构举例
     * ```html
     *    <!-- 使用data-hover指定hover效果的样式名称 -->
     *    <div id="abc" data-hover="js-hover">aaaaa</div>
     * ```
     *
     * 脚本举例
     * ```javascript
     *   NEJ.define([
     *       'util/hover/hover'
     *   ],function(_e){
     *       // 如果hover效果的样式名已经通过data-hover指定
     *       _e._$hover('abc');
     * 
     *       // 移除_$hover接口添加的效果
     *       _e._$unhover('abc');
     *   });
     * ```
     *
     * @method module:util/hover/hover._$unhover
     * @param  {String|Node} arg0 - 节点
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$unhover
     * @see module:util/hover/hover._$unhover
     */
    _p._$unhover = function(_element){
        if (!_u._$isArray(_element)){
            var _id = _e._$id(_element);
            if (!!_id){
                _h.__unhoverElement(_id);
            }
            return;
        }
        // batch unhover
        _u._$forEach(
            _element,function(_node){
                _p._$unhover(_node);
            }
        );
    };
     // for chainable method
    _x._$merge(_p);

    if (CMPT){
        NEJ.copy(NEJ.P('nej.e'),_p);
    }

    return _p;
},215,4,217,2,302);
I$(433,function () {

  var config = {};

  
  if(DEBUG){
	  
  } else{
	  
  }


  return config;


},215);
I$(463,"{#if isLogin}\n您好，<span id=\"user163Box\">{user.account}</span><span class=\"sep\">|</span><a href=\"/logout.html?url={encodeURIComponent(location.href)}\" data-param=\"zn=top\">退出</a>\n{#else}\t\n考拉欢迎你！<a class=\"login\" href=\"/login.html?target={encodeURIComponent(location.href)}\" data-param=\"zn=top\">登录</a><span class=\"sep\">|</span><a target=\"_blank\" href=\"http://reg.163.com/reg/innerDomainReg.do?product=kaola&url=http://global.163.com/urs/redirect.html?target={encodeURIComponent(location.href)}\" data-param=\"zn=top\">免费注册</a>\n{/if}\t\n");
I$(264,function (tpl, BaseComponent){

  // <UserInfo total=3 current=1></UserInfo>
  var UserInfo = BaseComponent.extend({
    name: "UserInfo",
    template: tpl,
    // is called before compile. 一般用来处理数据
    data:{isLogin:false,location:location},
    config: function(data){
    	this.getUserName();
    },
    
    refresh:function(){
    	this.getUserName();
    },
    getUserName: function(){
    	this.$request('/getUserName.html',{
    		method:'GET',
    		norest:true,
    		type:'json',
    		onload:function(_json){
    			if(_json&&_json.retcode==461){ //未登录用户
    				this.data.isLogin = false;
    				window.isLogin = false;
    			} else{
                    _json = _json || {};
                    _json.result = _json.result || {};//判空mt
    				this.data.isLogin = true;
    				this.data.user = _json.result;
    				this.data.user.account = _json.result.nickname||_json.result.account;
    				window.account = _json.result.account;
    				window.user = _json.result;
    				window.isLogin = true;
    			}
    			this.$emit('logined',window.user);
    		}
    	})
    }
  });
  
  return UserInfo;

},463,151);
I$(434,function (_k,_u,_t,_e,_v,_v1,_h,config,_pt,_j,_p,_o,_f,_r,_pro){
    /**
     * 右侧栏实现
     * 原则是要找出body上的停靠的节点，
     * 主要是banner下方的那个节点，如果rightBar需要停靠到那个位置需要给那个节点加 rightBarAnchor这个样式，
     * 如果找不到这个节点就找id的兄弟节点topTabBox
     * @class   _$$RightBar
     * @extends _$$EventTarget
     */
    _p._$$RightBar = _k._$klass();
    _pro = _p._$$RightBar._$extend(_t._$$EventTarget);

    /**
     * 控件初始化
     * @param  {Object} 配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        this.__rightBar = _e._$get('rightBarNew');
        this.__leftBar = _e._$get('indexleft');
        this.__fixTop =  66;
        this.__abTop = 0;
        if(this.__leftBar){ 
	        if(window.screen.width <= 1280){   // 小屏幕
	        	this.__leftBar.style.marginLeft = '-642px';
			}
        }
        if(!this.__rightBar){
        	return;
        }
        this.__anchorNode = this.__getAnchorNode();
        if(!this.__anchorNode){
        	this.__top = 230;
        } else{
        	if(!this.__top)
        		this.__top = 230;
        }
        this.__width = this.__anchorNode.clientWidth;
        var right = ((document.body.clientWidth - this.__width)/2 - 68);
        this.__rightBar.style.right = right +'px';

        this.__getOffsetABTop();
        this.__rightBar.style.display ='block';
		if(this.__isIEOldVer()){ //ie6，7
			this.__rightBar.style.position = 'absolute';
			this.__rightBar.style.top = '0px';
			// var _top = (document.body.scrollTop||document.documentElement.scrollTop);
			// if(_top>this.__top){
			// 	this.__rightBar.style.top = _top +  this.__top +'px';
			// } else{
			// 	this.__rightBar.style.top = _e._$offset(this.__anchorNode).y+this.__top+'px';
			// }
		}else{
			_v._$addEvent(window,'scroll',this.__checkRightBar._$bind(this));
			this.__checkRightBar();
		}
    };

    _pro.__getOffsetABTop = function(){
        this.__offsetABTop = _e._$offset(this.__anchorNode).y + this.__top;
    };
    /**
     * 外部刷新方法
     */
    _pro._$refreshRightBar = function(opt){
        var opt = opt||{};
        _h.extend(this,opt,true);
        this.__checkRightBar();
    };
    
    _pro.__checkRightBar = function(_event){
		if((this.__offsetABTop - (document.body.scrollTop || document.documentElement.scrollTop)) < this.__top) {
			this.__rightBar.style.top = this.__top + 'px';
			this.__rightBar.style.position = 'fixed';
			if(_e._$get('mainBgWrapHome')) {
				this.__rightBar.style.top = this.__fixTop + 'px';
			}
			if(this.__leftBar) {
				this.__leftBar.style.position = 'fixed';
				this.__leftBar.style.top = this.__fixTop + 'px';
			}
		} else {
			this.__rightBar.style.position = 'absolute';
			this.__rightBar.style.top = this.__offsetABTop + 'px';
			if(_e._$get('mainBgWrapHome')) {
				this.__rightBar.style.top = this.__abTop + 'px';
			}
			if(this.__leftBar) {
				this.__leftBar.style.position = 'absolute';
				this.__leftBar.style.top = this.__abTop + 'px';
			}
		}
    };
    _pro.__getAnchorNode = function(){
    	var _anchorNode = _e._$get('mainBgWrapHome');   
    	if(_anchorNode){                                  //homepage
    		this.__top = _anchorNode.clientHeight + this.__abTop;
    		return _anchorNode;
    	} else if(_e._$get('topTabBox')){
    		_anchorNode = _e._$get('topTabBox');
    		if(_anchorNode){
	    		this.__top = _anchorNode.clientHeight +40;
	    		return _anchorNode;
    		}
    	}else {
    		_anchorNode = _e._$get('docHead');
    		if(_anchorNode){
    			this.__top =   _anchorNode.clientHeight +70;
        		return _anchorNode;
    		} 
    	}
    	return _anchorNode;
    };
    /**
     * 是否IE低版本
     */
    _pro.__isIEOldVer = (function(){
        var isIEOrderVer = _pt._$KERNEL.browser=='ie'&&_pt._$KERNEL.release<='3.0'
        return function(){
            return isIEOrderVer;
        }
    })();
    /**
     * 哪果用户登录了需要进行登录的信息处理
     */
   
    return _p._$$RightBar;
},1,2,23,4,3,107,15,433,78,11);
I$(298,function (NEJ,_k,_t,_t0,_p,_o,_f,_r){
    // variable declaration
    var _pro;
    /**
     * 动画基类
     * 
     * @class   module:util/animation/animation._$$Animation
     * @extends module:util/event._$$EventTarget
     *
     * @param    {Object} config - 可选配置参数
     * @property {Object} to     - 动画结束信息
     * @property {Object} from   - 动画初始信息
     * @property {Number} delay  - 延时时间，单位毫秒，默认0
     */
    /**
     * 动画结束回调事件
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/animation/bounce'
     * ],function(_t){
     *     var _bounce = _t._$$AnimBounce._$allocate({
     *         from: {
     *             offset: 100,
     *             velocity: 100
     *         },
     *         acceleration:100,
     *         onstop: function(){
     *             // 动画停止后回收控件
     *             _bounce = nej.ut._$$AnimBounce._$recycle(_bounce);
     *         }
     *     });
     * });
     * ```
     * 
     * @event module:util/animation/animation._$$Animation#onstop
     */
    /**
     * 动画过程回调事件
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/animation/bounce'
     * ],function(_t){
     *     var _bounce = _t._$$AnimBounce._$allocate({
     *         from: {
     *             offset: 100,
     *             velocity: 100
     *         },
     *         acceleration:100,
     *         onupdate: function(_event){
     *             // 坐标
     *             console.log(_event.offset + 'px');
     *             // 初速度
     *             console.log(_event.velocity);
     *         }
     *     });
     * });
     * ```
     * 
     * @event    module:util/animation/animation._$$Animation#onupdate
     * @param    {Object} event    - 可选配置参数
     * @property {Number} offset   - 偏移量
     * @property {Number} velocity - 初速度(px/s)
     */
    _p._$$Animation = _k._$klass();
    _pro = _p._$$Animation._$extend(_t._$$EventTarget);
    /**
     * 控件重置
     * 
     * @protected
     * @method   module:util/animation/animation._$$Animation#__reset
     * @param    {Object} arg0 - 可选配置参数
     * @property {Number} to   - 结束坐标
     * @property {Number} from - 起始坐标
     * @return   {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        this.__end = _options.to||_o;
        this.__begin = _options.from||{};
        this.__delay = Math.max(
            0,parseInt(_options.delay)||0
        );
    };
    /**
     * 控件销毁
     * 
     * @protected
     * @method module:util/animation/animation._$$Animation#__destroy
     * @return {Void}
     */
    _pro.__destroy = function(){
        this.__super();
        this._$stop();
        if (!!this.__dtime){
            window.clearTimeout(this.__dtime);
            delete this.__dtime;
        }
        delete this.__end;
        delete this.__begin;
    };
    /**
     * 动画帧逻辑
     * 
     * @protected
     * @method module:util/animation/animation._$$Animation#__onAnimationFrame
     * @param  {Number} arg0 - 时间值
     * @return {Void}
     */
    _pro.__onAnimationFrame = function(_time){
        if (!this.__begin) return;
        if ((''+_time).indexOf('.')>=0){
            _time = +new Date;
        }
        if (this.__doAnimationFrame(_time)){
            this._$stop();
            return;
        }
        this.__timer = _t0.requestAnimationFrame(
            this.__onAnimationFrame._$bind(this)
        );
    };
    /**
     * 动画帧回调，子类实现具体算法
     * 
     * @abstract
     * @method module:util/animation/animation._$$Animation#__doAnimationFrame
     * @param  {Number}  arg0 - 时间值
     * @return {Boolean}        是否停止动画
     */
    _pro.__doAnimationFrame = _f;
    /**
     * 注册动画监听事件
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/animation/bounce'
     * ],function(_t){
     *     var _bounce = _t._$$AnimBounce._$allocate({
     *         from: {
     *             offset: 100,
     *             velocity: 100
     *         },
     *         acceleration:100,
     *         onupdate: function(_event){
     *             // 坐标
     *             console.log(_event.offset + 'px');
     *             // 初速度
     *             console.log(_event.velocity);
     *         }
     *     });
     *     // 进行弹性动画
     *     _bounce._$play();
     * });
     * ```
     * 
     * @method module:util/animation/animation._$$Animation#_$play
     * @return {Void}
     */
    _pro._$play = (function(){
        var _doPlayAnim = function(){
            this.__dtime = window.clearTimeout(this.__dtime);
            this.__begin.time = +new Date;
            this.__timer = _t0.requestAnimationFrame(
                this.__onAnimationFrame._$bind(this)
            );
        };
        return function(){
            this.__dtime = window.setTimeout(
                _doPlayAnim._$bind(this),
                this.__delay
            );
        };
    })();
    /**
     * 取消动画监听事件
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/animation/bounce'
     * ],function(_t){
     *     var _bounce = _t._$$AnimBounce._$allocate({
     *         from: {
     *             offset: 100,
     *             velocity: 100
     *         },
     *         acceleration:100,
     *         onupdate: function(_event){
     *             // 坐标
     *             console.log(_event.offset + 'px');
     *             // 初速度
     *             console.log(_event.velocity);
     *         }
     *     });
     *     // 进行动画
     *     _bounce._$play();
     *     // 停止动画,触发onstop
     *     _bounce._$stop();
     * });
     * ```
     *
     * @method module:util/animation/animation._$$Animation#_$stop
     * @return {Void}
     */
    _pro._$stop = function(){
        this.__timer = _t0.cancelAnimationFrame(this.__timer);
        this._$dispatchEvent('onstop');
    };

    if (CMPT){
        NEJ.copy(NEJ.P('nej.ut'),_p);
    }

    return _p;
},215,1,23,491);
I$(96,function (NEJ,_k,_u,_t0,_p,_o,_f,_r){
    // variable declaration
    var _pro;
    /**
     * 贝塞尔曲线算法
     * 
     * 初始信息包括
     * 
     * * offset  [Number]  偏移量 
     *
     * 结束信息包括
     * 
     * * offset  [Number]  偏移量 
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/animation/bezier'
     * ],function(_t){
     *     var _easein = nej.ut._$$AnimBezier._$allocate({
     *         from: {
     *             offset: 100
     *         },
     *         to:{
     *             offset: 0
     *         },
     *         timing:'easein',
     *         onupdate:function(_event){
     *             // 坐标
     *             console.log(_event.offset + 'px');
     *             // 更新节点位置
     *         },
     *         onstop:function(){
     *             // 动画停止后回收控件
     *             this._$recycle();
     *         }
     *     });
     *     // 进行弹性动画
     *     _easein._$play();
     * });
     * ```
     * 
     * @class    module:util/animation/bezier._$$AnimBezier
     * @extends  module:util/animation/animation._$$Animation
     * 
     * @param    {Object} config   - 可选配置参数
     * @property {Number} duration - 持续时间，单位毫秒，默认为200ms
     * @property {String} timing   - 时间函数，默认为ease，ease/easein/easeout/easeinout/linear/cubic-bezier(x1,y1,x2,y2)
     */
    _p._$$AnimBezier = _k._$klass();
    _pro = _p._$$AnimBezier._$extend(_t0._$$Animation);
    /**
     * 控件重置
     * 
     * @protected
     * @method module:util/animation/bezier._$$AnimBezier#__reset
     * @param  {Object} arg0 - 可选配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        this.__duration = _options.duration||200;
        this.__epsilon  = 1/(200*this.__duration);
        this.__doParseTiming(_options.timing);
        this.__doCalPolynomialCoefficients();
    };
    /**
     * 控件销毁
     * 
     * @protected
     * @method module:util/animation/bezier._$$AnimBezier#__destroy
     * @return {Void}
     */
    _pro.__destroy = function(){
        this.__super();
        delete this.__pointer;
        delete this.__coefficient;
    };
    /**
     * 解析时间动画为坐标信息
     * 
     * @protected
     * @method module:util/animation/bezier._$$AnimBezier#__doParseTiming
     * @param  {String} arg0 - 时间动画
     * @return {Void}
     */
    _pro.__doParseTiming = (function(){
        var _reg0 = /^cubic\-bezier\((.*?)\)$/i,
            _reg1 = /\s*,\s*/i,
            _pointers = {
                linear:[0,0,1,1]
               ,ease:[0.25,0.1,0.25,1.0]
               ,easein:[0.42,0,1,1]
               ,easeout:[0,0,0.58,1]
               ,easeinout:[0,0,0.58,1]
            };
        var _doParseFloat = function(_value,_index,_list){
            _list[_index] = parseFloat(_value);
        };
        return function(_timing){
            _timing = (_timing||'').toLowerCase();
            this.__pointer = _pointers[_timing];
            if (_reg0.test(_timing)){
                this.__pointer = RegExp.$1.split(_reg1);
                _u._$forEach(this.__pointer,_doParseFloat);
            }
            if (!!this.__pointer) return;
            this.__pointer = _pointers.ease;
        };
    })();
    /**
     * 计算贝塞尔曲线多项式系数
     * 
     * @protected
     * @method module:util/animation/bezier._$$AnimBezier#__doCalPolynomialCoefficients
     * @return {Void}
     */
    _pro.__doCalPolynomialCoefficients = function(){
        var _pt = this.__pointer,
            _cx = 3*_pt[0],
            _bx = 3*(_pt[2]-_pt[0])-_cx,
            _ax = 1-_cx-_bx,
            _cy = 3*_pt[1],
            _by = 3*(_pt[3]-_pt[1])-_cy,
            _ay = 1-_cy-_by;
        this.__coefficient = {
            ax:_ax, ay:_ay,
            bx:_bx, by:_by,
            cx:_cx, cy:_cy
        };
    };
    /**
     * 计算目标接近率
     * 
     * @protected
     * @method module:util/animation/bezier._$$AnimBezier#__doCalCubicBezierAtTime
     * @param  {Number} arg0 - 当前时间
     * @return {Float}         终点接近率
     */
    _pro.__doCalCubicBezierAtTime = (function(){
        var _doSampleCurveX = function(_time,_coef){
            return ((_coef.ax*_time+_coef.bx)*_time+_coef.cx)*_time;
        };
        var _doSampleCurveY = function(_time,_coef){
            return ((_coef.ay*_time+_coef.by)*_time+_coef.cy)*_time;
        };
        var _doSampleCurveDerivativeX = function(_time,_coef){
            return (3*_coef.ax*_time+2*_coef.bx)*_time+_coef.cx;
        };
        var _doSolveCurveX = function(_time,_epsilon,_coef){
            var t0,t1,t2,x2,d2,i;
            // First try a few iterations of Newton's method -- normally very fast.
            for(t2=_time,i=0;i<8;i++){
                x2 = _doSampleCurveX(t2,_coef)-_time;
                if (Math.abs(x2)<_epsilon)
                    return t2;
                d2 = _doSampleCurveDerivativeX(t2,_coef);
                if (Math.abs(d2)<1e-6)
                    break;
                t2 = t2-x2/d2;
            }
            // Fall back to the bisection method for reliability.
            t0 = 0; t1 = 1; t2 = _time;
            if (t2<t0) return t0;
            if (t2>t1) return t1;
            while(t0<t1) {
                x2 = _doSampleCurveX(t2,_coef);
                if (Math.abs(x2-_time)<_epsilon)
                    return t2;
                if (_time>x2)
                    t0 = t2;
                else
                    t1 = t2;
                t2 = (t1-t0)*0.5+t0;
            }
            // Failure.
            return t2;
        };
        return function(_delta){
            return _doSampleCurveY(
                   _doSolveCurveX(_delta/this.__duration,
                   this.__epsilon,this.__coefficient),this.__coefficient);
        };
    })();
    /**
     * 动画帧回调
     * 
     * @protected
     * @method module:util/animation/bezier._$$AnimBezier#__doAnimationFrame
     * @param  {Number} arg0 - 时间值
     * @return {Boolean}       是否停止
     */
    _pro.__doAnimationFrame = function(_time){
        var _delta   = _time-this.__begin.time,
            _percent = this.__doCalCubicBezierAtTime(_delta),
            _offset  = _u._$fixed(this.__begin.offset*(1-_percent)+
                                  this.__end.offset*_percent,2),
            _stop = !1;
        // offset out of begin and end range
        if (_delta>=this.__duration){
            _offset = this.__end.offset;
            _stop = !0;
        }
        this._$dispatchEvent('onupdate',{
            offset:1*_offset
        });
        return _stop;
    };
    /**
     * 取消动画监听事件
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/animation/bezier'
     * ],function(_t){
     *     var _easein = nej.ut._$$AnimBezier._$allocate({
     *         from: {
     *             offset: 100
     *         },
     *         to:{
     *             offset: 0
     *         },
     *         timing:'easein',
     *         onupdate: function(_event){
     *             // 坐标
     *             console.log(_event.offset + 'px');
     *         }
     *     });
     *     // 进行弹性动画
     *     _easein._$play();
     *     // 结束动画
     *     _easein._$stop();
     * });
     * ```
     * @method module:util/animation/bezier._$$AnimBezier#_$stop
     * @return {Void}
     */
    _pro._$stop = function(){
        this._$dispatchEvent('onupdate',{
            offset:this.__end.offset
        });
        this.__super();
    };

    if (CMPT){
        NEJ.copy(NEJ.P('nej.ut'),_p);
    }

    return _p;
},215,1,2,298);
I$(299,function (_k,_u,_t,_e,_v,_, bezier){
    /**
     * 实现一个类似于抛物线方式将商品抛入购物车的动画
     * @class   _$$Fly
     * @extends _$$EventTarget
     * @public
     * @example
     * ```javascript
     * var fly = _$$Fly._$allocate({
     *     from: document.querySelector('#from'),
     *     to: document.querySelector('#to'),
     *     imageUrl: '//haitao.nos.netease.com/onlineicshsyhj10858.jpg'
     * });
     * fly._$play();
     * ```
     */
    var _$$Fly = _k._$klass();
    var _pro = _$$Fly._$extend(_t._$$EventTarget);

    /**
     * 飞入控件重置， 飞入动画默认为从起始到终点元素的中心定位
     * @param  {Object} _options 必须，飞入对象配置信息
     * @property {Node} from 必须，动画起始位置
     * @property {Node} to 必须，动画结束位置
     * @property {String} imageUrl 必须，用于飞入动作的图片
     * @property {Number} devx 可选，飞入动画终点位置的横向偏移，默认为0
     * @property {Number} devy 可选，飞入动画终点位置的纵向偏移，默认为0
     * @property {Boolean} plus 可选，是否在飞入动画结束时出现+1的上浮动画，默认为true
     * @return {void}          无返回值
     * @private
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        if (!_options.from || !_options.to || !_options.imageUrl) { return; }
        this.__from = _options.from;
        this.__to = _options.to;
        this.__imageUrl = (_options.imageUrl||'').replace(/^https?:/,'');
        this.__devx = _options.devx;
        this.__devy = _options.devy;
        this.__plus = _options.plus===false? false : true; //默认为true
        this.__cfg = {
            as: 4000,  //加速度
            toScale: 0.4,
            decCB: 'cubic-bezier(0.26,1,0.87,1)',
            accCB: 'cubic-bezier(0.13,0,0.74,0.04)',
            initW: 60,
            initH: 60,
            plusLength: 22,
            plusDeltaY: -40
        };
        this.__getImage();  
    };

    /**
     * 启动动画，启动后动画开始播放，播放期间无法干预动画的执行，动画播放完后会自动销毁本控件
     * @return {void} 无返回值
     * @public
     */
    _pro._$play = function(){
        if (!this.__to) { return; }
        this.__prepare();
        this.__aniStart = +new Date();
        this.__flyAni._$play();        
    };

    /**
     * 准备动画所需要的信息
     * @return {void} 无
     * @private
     */
    _pro.__prepare = function(){
        this.__getFromToPostions();
        this.__getTopPostion();        
        this.__initCurves();     
    };

    /**
     * 获取动画开始结束的位置信息，并根据浏览器差异做数据修正兼容处理
     * @return {void} 无
     * @private
     */
    _pro.__getFromToPostions = function(){
        this.__fromPos = _.extend({},this.__from.getBoundingClientRect());
        this.__toPos = _.extend({},this.__to.getBoundingClientRect());
        //部分老浏览器（<=IE8）需要修正宽高， getBoundingClientRect浏览器不提供宽高数据
        if (this.__fromPos.width===undefined) {
            this.__fromPos.width = this.__fromPos.right - this.__fromPos.left;    
            this.__fromPos.height = this.__fromPos.bottom - this.__fromPos.top;
            this.__toPos.width = this.__toPos.right - this.__toPos.left;
            this.__toPos.height = this.__toPos.bottom - this.__toPos.top;
        }
        //修正位置到图片中心与开始结束区域中心对齐
        //这样飞行的图片刚好能从起点的正中心飞出，飞入终点元素的正中心
        //如果终点元素购物车框位置有偏移，此时需要设置devx,devy
        this.__fromPos.left += (this.__fromPos.width - this.__cfg.initW)/2;
        this.__fromPos.top += (this.__fromPos.height - this.__cfg.initH)/2;
        this.__toPos.left += (this.__toPos.width - this.__cfg.initW)/2;
        this.__toPos.top += (this.__toPos.height - this.__cfg.initH)/2;

        // 如果设置了终点元素偏移，则附加
        if (typeof this.__devx === 'number') {
            this.__toPos.left += this.__devx;
        }
        if (typeof this.__devy === 'number') {
            this.__toPos.top += this.__devy;
        }
    };

    /**
     * 动画路径及时间计算的核心函数，
     * 主要是根据加速度以及位置信息计算出动画时间，抛物线顶点等，
     * 并以此计算水平速度
     * @return {void} 无
     * @private
     */
    _pro.__getTopPostion = function(){
        this.__topPos = {left: 0, top: 0};
        if (this.__fromPos.left === this.__toPos.left && 
            this.__fromPos.top < this.__toPos.top) {
            //垂直下降
            this.__flyType = 0; //垂直下降
            this.__totalTime = Math.sqrt( 2*Math.abs(this.__toPos.top - this.__fromPos.top)/this.__cfg.as);
        }else{            
            if (this.__fromPos.top > 0) {
                var dx = Math.abs( this.__fromPos.left - this.__toPos.left);
                var dy = Math.log(2*dx + 1)*120/8;
                this.__topPos.top = Math.min( this.__fromPos.top, this.__toPos.top) < dy ? 0 : Math.min( this.__fromPos.top, this.__toPos.top)-dy;
            }else{
                this.__topPos.top = this.__fromPos.top;
            }

            var h = Math.abs(this.__topPos.top - Math.max(this.__fromPos.top, this.__toPos.top));
            var s = Math.abs(this.__fromPos.top - this.__toPos.top);
            var t1,t2;
            if ( h-s < 50 && this.__fromPos.top  <=this.__toPos.top) {
                //顶部空间很少的情况
                this.__topPos.left = this.__fromPos.left;
                this.__topPos.top = this.__fromPos.top;
                if (this.__fromPos.top  <=this.__toPos.top) {
                    //往下落
                    t1 = 0.001;
                    t2 = Math.sqrt(2*s/this.__cfg.as)*2;
                }
            }else{
                t1 = Math.sqrt(2*h/this.__cfg.as);
                var m =  2*(h-s)/this.__cfg.as;
                t2 = m>0?Math.sqrt(m):0;
            }

            this.__topPos.left = (this.__toPos.left - this.__fromPos.left)*t1/(t1+t2) + 
                                 this.__fromPos.left;
            t1 *= 1000; t2 *= 1000; //转换为毫秒   
            this.__totalTime = t1+t2;
            this.__stage1Time = t1;
            this.__stage2Time = t2;
        }
    };

    /**
     * 根据前面计算的位置信息生成动画路径
     * @return {void} 无
     * @private
     */
    _pro.__initCurves = function(){
        var totalDist = 1;
        if (this.__flyType===0) {        
            totalDist = this.__toPos.top - this.__toPos.top;
            this.__flyAni = bezier._$$AnimBezier._$allocate({
                timing: this.__cfg.accCB,
                duration: this.__totalTime,
                from:{
                    offset: 0
                },
                to: {
                    offset: totalDist
                },
                onupdate: function(evt){
                    this.__move(evt.offset);
                }._$bind(this),
                onstop: function(){
                    this._$dispatchEvent('onflystop');   
                    this.__flyOver();                 
                }._$bind(this)
            });
        }else{
            this.__flyAni = bezier._$$AnimBezier._$allocate({
                timing: this.__cfg.decCB,
                duration: this.__stage1Time,
                from:{
                    offset: 0
                },
                to: {
                    offset: this.__topPos.top - this.__fromPos.top
                },
                onupdate: function(evt){
                    this.__move(evt.offset);
                }._$bind(this),
                onstop: function(){
                    drop2._$play();
                }
            });
            var drop2 = bezier._$$AnimBezier._$allocate({
                timing: this.__cfg.accCB,
                duration: this.__stage2Time,
                from:{
                    offset: 0
                },
                to: {
                    offset: this.__toPos.top - this.__topPos.top
                },
                onupdate: function(evt){
                    var origOffset = evt.offset + this.__topPos.top - this.__fromPos.top;
                    this.__move(origOffset);
                }._$bind(this),
                onstop: function(){
                    this._$dispatchEvent('onflystop');
                    drop2._$recycle();
                    this.__flyOver();
                }._$bind(this)
            });
        }
    };

    /**
     * 根据动画路径给出的偏移移动、缩放当前动画对象
     * @param  {number} offset 动画函数给出的在y方向偏移量（相对于起始点位置）
     * @return {void}        无
     * @private
     */
    _pro.__move = function(offset){
        var progress = (+new Date() - this.__aniStart)/this.__totalTime;
            currScale = 1, dx=0, dy=0;         
        progress = progress>1 ? 1 : progress;
        currScale = 1 - (1-this.__cfg.toScale)*progress;
        // 在不支持transform scale的时候，
        // 需要将位置修正到原有图形的中心，类似transform:scale缩放后任然在中间的效果
        // 通过scale 来计算需要的修正量
        if (!this.__supportTransform()) {
            var dx = this.__cfg.initW*(1 - currScale)/2,
                dy = this.__cfg.initW*(1 - currScale)/2;
        }
        var styleText = this.__getStyle({
            scale: currScale,
            x: progress*(this.__toPos.left - this.__fromPos.left)+dx,
            y: offset+dy
        });
        this.__imgNode.style.cssText = styleText;        
    };

    /**
     * 曲线动画运行结束后清理现场， 并根据设置启动+1浮动动画
     * @prevate
     */
    _pro.__flyOver = function(){
        this.__flyAni && this.__flyAni._$recycle();
        this.__imgNode && document.body.removeChild(this.__imgNode);
        this.__imgNode = null;
        this.__plus && this.__plusMove();
    };

    /**
     * +1上浮动画运行
     * @return {void} 无
     * @private
     */
    _pro.__plusMove = function(){
        var html = '<span class="favAddedPlus">&#xe603;<span class="favAddedPlusText">1</span></span>';
        var container = document.createElement('div');
            container.innerHTML = html,
            deltaY = this.__cfg.plusDeltaY;
        var plusAni = bezier._$$AnimBezier._$allocate({
            timing: this.__cfg.accCB,
            duration: 800,
            from:{
                offset: 0
            },
            to: {
                offset: deltaY
            },
            onupdate: function(evt){
                var progress = evt.offset/deltaY;
                var styleText = this.__getStyle({
                    width: this.__cfg.plusLength,
                    height: this.__cfg.plusLength,
                    opacity: 1-progress,
                    x: 0,
                    y: evt.offset,
                    left: this.__toPos.left+ (this.__cfg.initW-this.__cfg.plusLength)/2,
                    top: this.__toPos.top+ (this.__cfg.initH-this.__cfg.plusLength)/2,
                    scale: 1+progress/2
                });
                container.style.cssText = styleText;
            }._$bind(this),
            onstop: function(){
                this._$dispatchEvent('onplusstop');
                document.body.removeChild(container);
                container = null;
                plusAni._$recycle();
            }._$bind(this)
        });
        document.body.appendChild(container);
        plusAni._$play();
    };

    /**
     * 检查并返回当前执行环境是否支持transform     
     * @return {Boolean}    true：支持，false：不支持
     * @private
     */
    _pro.__supportTransform = (function(){
        var support = false;        
        if (window.CSS && CSS.supports) {
            support = CSS.supports('(transform: translateX(0)) or (-webkit-transform: translateX(0)) or (-ms-transform: translateX(0)) or (-moz-transform: translateX(0)) or (-ms-transform: translateX(0))');
        }else{
            //使用其它方式检测
            var div = document.createElement('div'),
                prefixs = ['transform','webkitTransform','msTransform','mozTransform'] ; 
            for (var i = 0; i < prefixs.length; i++) {
                if (div.style[prefixs[i]] !== undefined){
                    support = true;
                    break;
                }                
            }
            div = null;
        }
        return function(){ return support; };
    })();
    /**
     * 获取需要给动画运行元素设置的css文本（包括曲线，+1浮动动画）
     * @param {Object} offset 偏移对象，包括当前状态的偏移运动信息
     * @param {Boolean} init 是否初始曲线设置，第一次设置运动图片的css时，需要置为true
     * @return {String}      分号分隔的CSS文本
     * @private
     */
    _pro.__getStyle = (function(){
        var basicStyle = {
            'position': 'fixed',
            'z-index': '10000',
            'border-radius': '100%'
        };        
        function styleText(obj){
            var styles = [];
            for(var key in obj){
                if (!obj.hasOwnProperty(key)) { continue;}
                styles.push( key+':'+obj[key]);
            }
            return styles.join(';');
        }
        return function(offset, init){
            var style = _.extend({}, basicStyle);
            if (init) {
                style.display = 'none';
            }else{
                var fromPos = this.__fromPos;
                if (typeof offset.left === 'number') {
                    fromPos = {left: offset.left, top: offset.top};
                }
                var opacity = (typeof offset.opacity ==='number')? offset.opacity : 1;
                if (this.__supportTransform()) {
                    var tsl = 'translate('+ offset.x +'px,'+ offset.y +'px)  scale('+offset.scale+')';
                    style = _.extend(style, {
                        '-webkit-transform': tsl,
                        '-ms-transform': tsl,
                        '-moz-transform': tsl,
                        'transform': tsl,
                        'transition': 'transform 0s ease',
                        'left': (fromPos.left)+'px',
                        'top': (fromPos.top)+'px',
                        'width': (offset.width||this.__cfg.initW) +'px',
                        'height': (offset.height||this.__cfg.initH) + 'px',
                        'opacity': opacity
                    });
                }else{                    
                    style = _.extend(style, {
                        'width': (offset.width||this.__cfg.initW) *offset.scale+'px',
                        'height': (offset.height||this.__cfg.initH) *offset.scale + 'px',
                        'left': (fromPos.left + offset.x)+'px',
                        'top': (fromPos.top + offset.y)+'px',
                        'opacity': opacity,
                        'filter': 'alpha(opacity='+Math.floor(opacity*100)+')'
                    });
                }
            }
            return styleText(style);
        };
    })();

    /**
     * 插入用于曲线动画的图片节点
     * @return {void}  无
     * @private
     */
    _pro.__getImage = function(){
        this.__imgNode = document.createElement('img');
        this.__imgNode.src = this.__imageUrl;
        this.__imgNode.style.cssText = this.__getStyle(null, true);
        document.body.appendChild(this.__imgNode);
    };

    /**
     * 销毁控件
     * @return {void} 无
     * @private
     */
    _pro.__destroy = function(){
        this.__super();
        this.__from = null;
        this.__to = null;
        this.__flyAni && this.__flyAni._$recycle();
        this.__imgNode && document.body.removeChild(this.__imgNode);
        this.__imgNode = null;
    };

    return _$$Fly;
},1,2,23,4,3,15,96);
I$(374,function (BaseComponent,_ut, _e) {
	var Dialog = BaseComponent.extend({
		config:function(data) {
			_ut.extend(data, {
				active:true
			});
			this.supr(data);
		},
		onok:function() {
			this.data.active = false;
			setTimeout(function() {
				this.destroy();
			}._$bind(this), 350);
			this.$update();
		},
		onclose:function() {
			this.data.active = false;
			setTimeout(function() {
				this.destroy();
			}._$bind(this), 350);
			this.$update();
		}
	});
	Dialog.directive('animate', function(ele) {
		_e._$addClassName(ele, 'iDialogAnimate5');
		_e._$addClassName(ele, 'iDialogAniCore');

		this.$watch('active', function(val) {
			if ( !val ) {
				_e._$addClassName(ele, 'iDialogAnimate5');
			} else {
				setTimeout(function() {
					_e._$delClassName(ele, 'iDialogAnimate5');
				}, 100);
			}
		});
	});
	return Dialog;
},151,15,4);
I$(375,"<div ref=\"mdialog\" class=\"m-dialog {clazz}\" animate r-class=\"{{'valign':useTrans}}\" r-style=\"{style}\">\n\t<div class=\"head\">\n\t\t<h1>{title || '提示'}</h1>\n\t</div>\n\t<a class=\"close\" hidefocus=\"true\" href=\"javascript:;\" on-click=\"{this.onclose()}\"></a>\n\t<div class=\"body\">\n\t\t<div class=\"message\">\n\t\t\t{#include msg}\n\t\t</div>\n\t\t{#if hideOkBtn != true}\n\t\t<a href=\"javascript:;\" class=\"btn u-btn u-btn-ok u-btn-medium\" on-click=\"{this.onok()}\">\n\t\t\t<span r-html=\"{txtOk || '确认'}\"></span>\n\t\t</a>\n\t\t{/if}\n\t\t{#if hideCCBtn != true}\n\t\t<a href=\"javascript:;\" class=\"btn u-btn u-btn-cancel u-btn-medium\" on-click=\"{this.cancel()}\" r-html=\"{txtCC || '取消'}\"></a>\n\t\t{/if}\n\t</div>\n</div>\n<div class=\"u-mask\" style=\"z-index:10000;\"></div>");
I$(187,function (AnimateDialog, _ut, _v, _tpl) {
	var Dialog = AnimateDialog.extend({
		template:_tpl,
		config:function(data) {
			_ut.extend(data, {width: 520});

			data.style = {
				'height': 'auto',
				'margin-top': '0',
				'width': data.width + 'px',
				'margin-left': (-data.width / 2 + 'px'),
				'z-index': 10001,
				'left': '50%',
				'top': '50%'
			};

			// 无height，则高度自适应（兼容ie789）
			this.__autoHeight();

			// esc键关闭弹窗
			this.__bindEscEvent();

			this.supr(data);

			if(!!data.timeout){
				this.$timeout(function () {
					this.onclose();
				}._$bind(this), data.timeout);
			}
		},
		onok:function() {
			this.supr();
			this.data.onok && this.data.onok();
		},
		onclose:function() {
			this.supr();
			this.data.onclose && this.data.onclose();
		},
		cancel:function() {
			var _callback = this.data.oncancel, c;
			_callback && (c = _callback());
			c !== false && this.onclose();
		},
		__autoHeight: function () {
			var self = this, data = self.data;
			if(!!data.height) {
				data.style.height = data.height;
			}
			data.useTrans = true;
			if(nej.p._$KERNEL.browser=='ie' && nej.p._$KERNEL.version<=9){
				self.$on('inject', function () {
					data.useTrans = false;
					self.__calcH();
					self.$on('refresh', function () {
						self.__calcH();
					});
					self.$update();
				});
			}
		},
		__calcH: function () {
			var self = this, data = self.data,
				$mdialog = self.$refs.mdialog,
				rect, height;
			if(!$mdialog) return;
			height = $mdialog.clientHeight;
			data.style['margin-top'] = (-height / 2) + 'px';
		},
		__bindEscEvent: function () {
			var self = this;
			_v._$addEvent(document, 'keydown', keydownCb);
			function keydownCb(event) {
				if((event || window.event).keyCode == 27) {
					self.onclose();
					self.$update();
					_v._$delEvent(document, 'keydown', keydownCb);
				}
			}
		}
	}).use('timeout');

	Dialog.directive('countdown', function(ele, val) {
		if ( !val || isNaN(val) ) { return; }
		
		val = val/1;
		var timerId = setInterval(function() {
			!val && !clearInterval(timerId) && this.onclose();
			ele.innerHTML = val--;
		}._$bind(this), 1000);
	});

	return Dialog;
},374,15,3,375);
I$(101,function (_k,_u,_t,_e,_v,_v1,_,request,_j, Fly, Confirm,_p,_o,_f,_r,_pro){
    /**
     * 顶栏功能控件封装
     *
     * @class   _$$Cart
     * @extends _$$EventTarget
     */
    _p._$$Cart = _k._$klass();
    _pro = _p._$$Cart._$extend(_t._$$EventTarget);

    /**
     * 控件初始化
     * @param  {Object} 配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        this.__user = _options.user ||window.user;
        this.__refreshCart();
    };
    /**
     * 哪果用户登录了需要进行登录的信息处理
     */
    _pro.__refreshCart = function(){
        if(this.__user){
            //登录通过请求获取购物车数量
            request('/cartNumAjax.html',{
                method:'GET',
                type:'json',
                norest:true,
                onload:this.__cbCartInfo._$bind(this)
            })
        }else{ //未登录情况，从cookie里面获取购物车数量
            var ck = decodeURIComponent(_j._$cookie("NTES_KAOLA_CART_NEW")), arr = ck ? ck.split("|") : [],count=0,skuIds=[],add;
            //由之前的arr.length改成具体的数量,（goodsId,num,name,skuId...） 5091_4_HTODAYDEAL_5937-d2332028abf293576d2aec8491c637
            for(var i=0,l=arr.length;i<l;i++){
                var list = arr[i].split('_'),
                  sid = list[3];
                add = true;
                for(var j= 0,il=skuIds.length;j<il;j++){
                  if(skuIds[j] == sid){
                    add = false;
                  }
                }
                if(add){
                  skuIds.push(sid);
                  count+= 1;
                }
            }
            this.__setCartNum(count);
        }
    };
    _pro.__addGoods2Cookie = function(goods){
    	var cartCookie = decodeURIComponent(_j._$cookie("NTES_KAOLA_CART_NEW"));
		var source = goods.source ||'other' ,arr=[];
        var now = Date.now();//记录商品加入购物车的时间 KJDS-16595 mt
		if(cartCookie){
			arr = cartCookie.split('|'),index =-1;
			for(var i=0,l=arr.length;i<l;i++){
				arr[i] = arr[i].split('_');
				var goodsId = arr[i][0],
					skuId = arr[i][3];
				if(skuId==goods.skuId&&goodsId == goods.goodsId){
					arr[i][1] = parseInt(arr[i][1])+goods.count;
                    arr[i][4] = now;
					index = i;
				}
			}
			if(index==-1){
				arr.push([goods.goodsId,goods.count,goods.source,goods.skuId,now]);
			}
		} else {
			arr =[[goods.goodsId,goods.count,goods.source,goods.skuId,now]];
		}
		var cookeGoods = [];
		for(var i=0,l=arr.length;i<l;i++){
			cookeGoods.push(arr[i].join('_'))
		}
		_j._$cookie('NTES_KAOLA_CART_NEW',{value:encodeURIComponent(cookeGoods.join('|')),
										   path : '/', domain: 'kaola.com', expires:365});
    };
    _pro.__overNumAlert = function (desc) {
      new Confirm({
        data:{
          height: 270,
          title: '购物车满啦',
          msg: '<i class="iconfont main-icon notice" r-html="{\'&#xe609;\'}"></i>'
          + (desc || "啊哦~您的购物车商品已满，清理一下再加入新商品吧！"),
          clazz: 'm-dialogalert',
          txtOk: '暂不清理',
          txtCC: '去购物车清理',
          oncancel: function(){
            window.open('/cart.html', '_blank');
            return false;
          }
        }
      }).$inject(document.body);
    };
    _pro.__alert = function (desc) {
      new Confirm({
        data:{
          height: 220,
          msg: '<i class="iconfont main-icon notice" r-html="{\'&#xe609;\'}"></i>' + desc,
          clazz: 'm-dialogalert',
          hideOkBtn: true,
          hideCCBtn: true,
          timeout: 3000
        }
      }).$inject(document.body);
    };
    _pro._$addCart = function(goods, flyCfg){
    	if(!this.__user){
        this.__addGoods2Cookie(goods);//先加cookie，后端会根据cookie的值来校验
        request('/cartAjax/modify.html', {
          method: 'POST',
          type: 'json',
          data: {
            number: goods.count||1,
            goodsId: goods.goodsId || 0,
            skuId: goods.skuId || 0
          },
          norest: true,
          onload: function(json){
            if(json.retcode == 200){
              this._$dispatchEvent('onsuccess');
            }
            // 462、101异常下，后端会减掉对应的cookie
            else if(json.retcode == 101 && !!json.retdesc){ // 购物车数量超过，不可添加商品到购物车
              this.__overNumAlert(json.retdesc);
            } else if(json.retcode == 462 && !!json.retdesc){
              this.__alert(json.retdesc);
            }
            this.__refreshCart();//重新计算购物车商品数量（根据cookie）
          }._$bind(this)
        });
    	} else{
    		request('/cartAjax/modify.html', {
                method: 'POST',
                type: 'json',
                data: {
                	number: goods.count||1,
                    goodsId: goods.goodsId || 0,
                    skuId: goods.skuId || 0,
                    innerSource: goods.source || ''
                },
                norest: true,
                onload: function(json){
                	if(json.retcode==200){
                		this.__setCartNum(json.cartGoodsNum);
                		this._$dispatchEvent('onsuccess',json);
                	}else if(json.retcode == 101 && !!json.retdesc){ // 购物车数量超过，不可添加商品到购物车
                    this.__overNumAlert(json.retdesc);
                  } else if(json.retcode == 462 && !!json.retdesc){
                    this.__alert(json.retdesc);
                  }
                }._$bind(this),
                onerror: function(json){

                }
            })
    	}
        // 如果传入了飞入动画配置，则启动动画
        // 如果未传入动画终点，则默认为右侧侧滑中的购物车
        // 该动画不等待实际的加入动作执行结束（onsuccess 事件触发），直接执行
        if (flyCfg) {
            var _flyCfg = _.extend({}, flyCfg);
            if (!_flyCfg.to) {
                _flyCfg.to = _e._$getByClassName('rightBarNew', 'shopcart')[0];
                _flyCfg.devx = 0;
                _flyCfg.devy = -40;
            }
            if (_flyCfg.to) {
                var fly = Fly._$allocate(_flyCfg);
                fly._$play();
            }
        }
    };
    _pro.__cbCartInfo = function(_json){
    	if(_json&&_json.retcode==200){
            this.__setCartNum(_json.object);
        }
    };
    /**
     * 设置顶部和右侧的购物车数量
     * 设置自定义的购物车数量,class='custom-cart-num': 2016.2.15 by hztianyanan
     */
    _pro.__setCartNum = function(num){
        var cartNum = _e._$get('newcartnum'), rightBar = _e._$get('rightBarNew'),
            numNode = _e._$getByClassName(rightBar, 'num');
        var customCartNum = _e._$getByClassName(window.body, "custom-cart-num") || [];
        customCartNum = customCartNum.concat(cartNum||[]);
        num = num || 0;
        num = num<=0? 0 : (num<=99 ? num : '99+');
        for(var i= 0,l=customCartNum.length;i<l;i++){
            cartNum = customCartNum[i];
            if(num==0){
                // KJDS-795  为0时隐藏圆圈
                if(!!cartNum){cartNum.style.display = "none";}
            }else{
                if(!!cartNum){
                    cartNum.innerText = num;
                    cartNum.style.display = "";
                }
            }
        }

        if(num==0){
            if(numNode && numNode.length>0){
                numNode[0].style.visibility = "hidden";
            }
        }else{
            if(numNode && numNode.length>0){
                numNode[0].style.visibility = "visible";
                numNode[0].innerText = num;
            }
        }
        
        window.cartAmount = num;
        if(({}).toString.call(window.updateCustomCart)=="[object Function]"){
            window.updateCustomCart(num);
        }
    };

    return _p._$$Cart;
},1,2,23,4,3,107,15,6,11,299,187);
I$(486,function (_p,_o,_f,_r){
    /**
     * 节点占位符行为，高版本浏览器用样式处理
     * @param  {String|Node} 节点
     * @param  {String}      样式
     * @return {Void}
     */
    _p.__setPlaceholder = function(_element,_clazz){
        // do nothing
    };

    return _p;
});
I$(293,function(b1482406244328,_e,_v,_u,_h,_p,_o,_f,_r){if (b1482406244328._$KERNEL.engine==='trident'&&b1482406244328._$KERNEL.release<='5.0'){I$(487,function (){
		/**
		 * 节点占位符行为，高版本浏览器用样式处理
		 * @param  {String|Node} _element 节点
		 * @param  {String}      _clazz   样式
		 * @return {Void}
		 */
		_h.__setPlaceholder = (function(){
		    // placeholder flag
		    var _cache = {},
		        _ropt = {
		            nid:'j-holder-'+_u._$uniqueID()
		        };
		    // input foucs hide placeholder
		    var _onFocus = function(_id){
		        var _input = _e._$get(_id);
		        _cache[_id] = 2;
		        if (!!_input.value) return;
		        _e._$setStyle(
		            _e._$wrapInline(_input,_ropt),
		            'display','none'
		        );
		    };
		    // input blur check placeholder show
		    var _onBlur = function(_id){
		        var _input = _e._$get(_id);
		        _cache[_id] = 1;
		        if (!!_input.value) return;
		        _e._$setStyle(
		            _e._$wrapInline(_input,_ropt),
		            'display',''
		        );
		    };
		    // input value change
		    var _onInput = function(_id){
		        var _input = _e._$get(_id);
		        if (_cache[_id]==2) return;
		        _e._$setStyle(
		            _e._$wrapInline(_input,_ropt),
		            'display',!_input.value?'':'none'
		        );
		    };
		    // wrapper input control
		    var _doWrapInput = function(_input,_clazz){
		        var _id = _e._$id(_input),
		            _label = _e._$wrapInline(_input,{
		                tag:'label',
		                clazz:_clazz,
		                nid:_ropt.nid
		            });
		        _label.htmlFor = _id;
		        var _text = _e._$attr(_input,'placeholder')||'';
		        _label.innerText = _text=='null'?'':_text;
		        var _height = _input.offsetHeight+'px';
		        _e._$style(_label,{
		            left:0,
		            // width:_input.offsetWidth+'px',
		            // height:_height,lineHeight:_height,
		            display:!_input.value?'':'none'
		        });
		    };
		    return function(_input,_clazz){
                // has been placeholded
                if (_cache[_input.id]!=null)
                    return;
                _doWrapInput(_input,_clazz);
		        var _id = _input.id;
                _cache[_id] = 1;
                // listen blur and focus event
                _v._$addEvent(_input,'blur',_onBlur._$bind(null,_id));
                _v._$addEvent(_input,'focus',_onFocus._$bind(null,_id));
                _v._$addEvent(_input,'input',_onInput._$bind(null,_id));
        	};
		})();
    });}return _h;},78,4,3,2,486);
I$(93,function (NEJ,_e,_x,_h,_p,_o,_f,_r){
    /**
     * 输入框占位行为，高版本用placeholder属性和样式处理
     *
     * 样式设置占位符文字效果
     * ```css
     * input:-moz-placeholder{color:#aaa;font-style:italic;}
     * input::-ms-input-placeholder{color:#aaa;font-style:italic;}
     * input::-webkit-input-placeholder{color:#aaa;font-style:italic;}
     * .js-placeholder{color:#aaa;font-style:italic;}
     * ```
     *
     * 结构举例
     * ```html
     * <!-- 使用data-holder属性指定占位文字效果样式名称 -->
     * <input id="abc" type="text" placeholder="text content" data-holder="js-placeholder"/>
     * <textarea id="abc" placeholder="text content" data-holder="js-placeholder"></textarea>
     * ```
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/placeholder/placeholder'
     * ],function(_e){
     *     // 如果hover效果的样式名已经通过data-holder指定
     *     _e._$placeholder('abc');
     *     // 如果样式名没有通过data-holder指定，则可以通过参数输入
     *     // 当节点有data-holder指定样式名称，同时参数也输入样式名称，则优先使用data-holder指定的样式名
     *     _e._$placeholder('abc','js-placeholder');
     * });
     * ```
     *
     * @method module:util/placeholder/placeholder._$placeholder
     * @param  {String|Node} arg0 - 输入控件，如input、textarea
     * @param  {String}      arg1 - 占位样式名称，默认为js-placeholder
     * @return {Void}
     */
    /**
     * @method CHAINABLE._$placeholder
     * @see module:util/placeholder/placeholder._$placeholder
     */
    _p._$placeholder = function(_element,_clazz){
        _element = _e._$get(_element);
        _h.__setPlaceholder(_element,
            _e._$dataset(_element,'holder')
                ||_clazz||'js-placeholder');
    };
    // for chainable method
    _x._$merge(_p);

    if (CMPT){
        NEJ.copy(NEJ.P('nej.e'),_p);
    }

    return _p;
},215,4,217,293);
I$(448,function (NEJ,_k,_e,_v,_t,_p,_o,_f,_r,_pro){
    /**
     * 选择助手控件
     * 
     * 结构举例
     * ```html
     *  <!-- 搜索祖先节点，找到设置了tabindex大于1000的节点来响应键盘上下事件，找不到为document -->
     *  <div id="xxx" tabindex="1005">
     *    <p>aaaaaaaaaaaaaa</p>
     *    <p>bbbbbbbbbbbbbb</p>
     *    <p>cccccccccccccc</p>
     *    <p>dddddddddddddd</p>
     *    <p>eeeeeeeeeeeeee</p>
     *    <p>ffffffffffffff</p>
     *    <p>gggggggggggggg</p>
     *  </div>
     * ```
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/helper/select'
     * ],function(_t){
     *     var _helper = _t._$$SelectHelper._$allocate({
     *          parent:'xxx',
     *          loopable:!0,
     *          onchange:function(_event){
     *              // _event.last
     *              // _event.target
     *              console.log('selection change -> '+_event.target.innerText);
     *          },
     *          onselect:function(_event){
     *              // _event.target
     *              console.log('select -> '+_event.target.innerText);
     *          }
     *     });
     * });
     * ```
     * @class    module:util/helper/select._$$SelectHelper
     * @extends  module:util/event._$$EventTarget
     * @param    {Object}      config   - 可选配置参数
     * @property {String|Node} parent   - 容器节点，从该容器开始往上遍历找到设置了tabindex大于1000的节点来响应键盘上下事件，找不到为document
     * @property {String}      clazz    - 用于标识可选择的节点，不传则为body下的子节点
     * @property {String}      selected - 选中节点样式标识，默认为js-selected
     * @property {String}      hover    - 鼠标移入样式标识，默认同selected，如果hover样式和selected不一样，确保selected样式优先级高于hover
     * @property {Boolean}     loopable - 是否允许循环选择
     */
    /**
     * 选择项变化触发事件
     * @event    module:util/helper/select._$$SelectHelper#onchange
     * @param    {Object} event  - 选择信息
     * @property {Node}   target - 当前选中项
     * @property {Node}   last   - 上次选中项
     */
    /**
     * 选中某项触发事件，用户敲回车或者鼠标单击选项时触发此事件
     * @event    module:util/helper/select._$$SelectHelper#onselect
     * @param    {Object} event  - 选择信息
     * @property {Node}   target - 当前选中项
     */
    _p._$$SelectHelper = _k._$klass();
    _pro = _p._$$SelectHelper._$extend(_t._$$EventTarget);
    /**
     * 控件重置
     *
     * @protected
     * @method module:util/helper/select._$$SelectHelper#__reset
     * @param  {Object} arg0 - 配置信息
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        this.__loop = !!_options.loopable;
        this.__parent = _e._$get(_options.parent);
        this.__selected = _options.selected||'js-selected';
        this.__hovered = _options.hover||this.__selected;
        this.__nopt = {};
        if (!!_options.clazz){
            this.__nopt.filter =
                _e._$hasClassName.
                    _$bind2(_e,_options.clazz);
            this.__clazz = _options.clazz;
        }
        // init event
        this.__kbody = this.__getKeyBoardParent(
            this.__parent
        );
        this.__doInitDomEvent([[
            this.__kbody,'keydown',
            this.__doCheckKBAction._$bind(this),!0
        ],[
            this.__kbody,'enter',
            this.__doCheckKBEnter._$bind(this)
        ],[
            this.__parent,'click',
            this.__onCheckClick._$bind(this)
        ],[
            this.__parent,'mouseover',
            this.__onCheckHover._$bind(this)
        ],[
            this.__parent,'mouseleave',
            this.__onCheckLeave._$bind(this)
        ]]);
    };
    /**
     * 控件销毁
     *
     * @protected
     * @method module:util/helper/select._$$SelectHelper#__destroy
     * @return {Void}
     */
    _pro.__destroy = function(){
        this.__super();
        delete this.__selected;
        delete this.__hovered;
        delete this.__parent;
        delete this.__kbody;
        delete this.__clazz;
        delete this.__nopt;
        delete this.__loop;
    };
    /**
     * 判断节点是否选项节点
     *
     * @protected
     * @method module:util/helper/select._$$SelectHelper#__isItemElement
     * @param  {Node} ar0 - 节点
     * @return {Boolean}    是否选项
     */
    _pro.__isItemElement = function(_element){
        if (!!this.__clazz){
            return _e._$hasClassName(
                _element,this.__clazz
            );
        }
        return _element.parentNode==this.__parent;
    };
    /**
     * 取键盘检测节点
     *
     * @protected
     * @method module:util/helper/select._$$SelectHelper#__getKeyBoardParent
     * @return {Node} 节点
     */
    _pro.__getKeyBoardParent = (function(){
        var _max = 1000;
        return function(_element){
            while(!!_element&&(parseInt(_element.tabIndex)||0)<=_max){
                _element = _element.parentNode;
            }
            return _element||document;
        };
    })();
    /**
     * 根据样式取项节点
     *
     * @protected
     * @method module:util/helper/select._$$SelectHelper#__getItemElement
     * @return {Node} 节点
     */
    _pro.__getItemElement = function(_class){
        var _list = _e._$getByClassName(
            this.__parent,_class
        );
        return !_list?null:_list[0];
    };
    /**
     * 同步选中状态
     *
     * @protected
     * @method module:util/helper/select._$$SelectHelper#__doSyncSelection
     * @return {Void}
     */
    _pro.__doSyncSelection = function(_event,_class){
        // update state
        _e._$delClassName(_event.last,_class);
        _e._$addClassName(_event.target,_class);
        // trigger onselectionchange
        if (_class==this.__selected&&
            _event.last!=_event.target){
            this.__doScrollToView(_event.target);
            this._$dispatchEvent(
                'onchange',_event
            );
        }
    };
    /**
     * 节点滚动至可视区域
     *
     * @protected
     * @method module:util/helper/select._$$SelectHelper#__doScrollToView
     * @return {Void}
     */
    _pro.__doScrollToView = function(_element){
        var _parent = _e._$getScrollViewPort(_element),
            _offset = _e._$offset(_element,_parent);
        // item out of top
        if (_offset.y-_parent.scrollTop<0){
            _parent.scrollTop = _offset.y;
            return;
        }
        // item out of bottom
        var _delta = _offset.y+
            _element.offsetHeight-_parent.clientHeight;
        if (_delta>_parent.scrollTop){
            _parent.scrollTop = _delta;
        }
    };
    /**
     * 解析选择状态
     *
     * @protected
     * @method module:util/helper/select._$$SelectHelper#__doParseSelection
     * @return {Object} 状态信息
     */
    _pro.__doParseSelection = function(_event,_class){
        var _element = _v._$getElement(
            _event,this.__isItemElement._$bind(this)
        );
        return !_element?null:{
            last:this.__getItemElement(_class),
            target:_element
        };
    };
    /**
     * 触发键盘选择实践
     *
     * @protected
     * @method module:util/helper/select._$$SelectHelper#__doCheckKBAction
     * @param  {Event} arg0 - 事件对象
     * @return {Void}
     */
    _pro.__doCheckKBAction = function(_event){
        var _code = _event.keyCode;
        // only for up and down
        if (_code!=38&&_code!=40) return;
        
        var _eopt = {
            last:this._$getSelectedNode()
        };
        // calculate last and target
        this.__nopt.backward = _code==38;
        var _list = !this.__clazz
                  ? _e._$getChildren(this.__parent)
                  : _e._$getByClassName(this.__parent,this.__clazz),
            _next = this.__nopt.backward
                  ? _list[_list.length-1]
                  : _list[0];
        if (!_eopt.last){
            _eopt.target = this.__getItemElement(
                this.__hovered
            )||_next;
        }else{
            _eopt.target = _e._$getSibling(
                _eopt.last,this.__nopt
            );
        }
        // check loop selection
        if (!_eopt.target){
            if (!this.__loop||_list.length<=1){
                return;
            }
            _v._$stop(_event);
            _eopt.target = _next;
        }
        this.__doSyncSelection(_eopt,this.__selected);
    };
    /**
     * 回车事件
     *
     * @protected
     * @method module:util/helper/select._$$SelectHelper#__doCheckKBEnter
     * @return {Void}
     */
    _pro.__doCheckKBEnter = function(_event){
        _v._$stop(_event);
        this._$dispatchEvent('onselect',{
            target:this._$getSelectedNode()
        });
    };
    /**
     * 点击事件
     *
     * @protected
     * @method module:util/helper/select._$$SelectHelper#__onCheckClick
     * @return {Void}
     */
    _pro.__onCheckClick = function(_event){
        var _eopt = this.__doParseSelection(
            _event,this.__selected
        );
        if (!_eopt) return;
        this.__doSyncSelection(
            _eopt,this.__selected
        );
        this._$dispatchEvent('onselect',{
            target:_eopt.target
        });
    };
    /**
     * 鼠标移入事件
     *
     * @protected
     * @method module:util/helper/select._$$SelectHelper#__onCheckHover
     * @return {Void}
     */
    _pro.__onCheckHover = function(_event){
        var _eopt = this.__doParseSelection(
            _event,this.__hovered
        );
        if (!_eopt) return;
        this.__doSyncSelection(
            _eopt,this.__hovered
        );
        if (!!this.__kbody.focus){
            this.__kbody.focus();
        }
    };
    /**
     * 鼠标移出事件
     *
     * @protected
     * @method module:util/helper/select._$$SelectHelper#__onCheckLeave
     * @return {Void}
     */
    _pro.__onCheckLeave = function(_event){
        if (this.__hovered==this.__selected){
            return;
        }
        _e._$delClassName(
            this.__getItemElement(this.__hovered),
            this.__hovered
        );
    };
    /**
     * 取当前选中的节点
     *
     * @method module:util/helper/select._$$SelectHelper#_$getSelectedNode
     * @return {Node} 当前选中节点
     */
    _pro._$getSelectedNode = function(){
        return this.__getItemElement(this.__selected);
    };

    if (CMPT){
        NEJ.copy(NEJ.P('nej.ut'),_p);
    }

    return _p;
},215,1,4,3,23);
I$(232,function (NEJ,_k,_e,_t0,_t1,_p,_o,_f,_r){
    var _pro;
    /**
     * 建议提示控件
     *
     * 样式举例
     * ```css
     * .box{position:relative;width:100px;}
     * .xuanzhong{background:pink;}
     * #suggest-input{height:24px;line-height:24px;}
     * #card0{position:absolute;top:40px;left:0;width:100%;height:auto;background:#ccc;}
     * ```
     * 
     * 结构举例
     * ```html
     * <div class="box" tabindex="10005">
     *   <input id="suggest-input" type="text" />
     *   <div id="suggest-list"></div>
     * </div>
     * ```
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/suggest/suggest'
     * ],function(_t){
     *     var _suggest = _t._$$Suggest._$allocate({
     *         input:'suggest-input',
     *         body:'suggest-list',
     *         selected:'xuanzhong',
     *         onchange:function(_value){
     *             var _arr = [];
     *             for(var i = 1; i < 10;i++){
     *                 // 选项中设置data-value来触发选项变化时自动同步到输入框中
     *                 // 默认选中第一项，只需在第一项加选中样式即可
     *                 _arr.push('<p '+(i==1?'xuanzhong':'')+' data-value="'+i+'">'+i+'</p>');
     *             }
     *             // 输入框改变，改变select的列表内容
     *             this._$update(_arr.join(''));
     *         },
     *         onselect:function(_value){
     *             // 选择一个值的回调
     *         }
     *     });
     * });
     * ```
     * @class    module:util/suggest/suggest._$$Suggest
     * @extends  module:util/event._$$EventTarget
     * @param    {Object}      config   - 可选配置参数
     * @property {Node|String} input    - 输入框
     * @property {Node|String} body     - 提示卡片节点
     * @property {Boolean}     autofill - 选择时是否自动填充
     * @property {String}      clazz    - 可选节点样式标识，默认为所有子节点
     * @property {String}      selected - 提示项选中样式，默认为js-selected
     */
    /** 
     * 输入内容变化触发事件
     * @event  module:util/suggest/suggest._$$Suggest#onchange
     * @param  {String} event - 输入框去前后空格后的内容
     */
    /** 
     * 选中建议项触发事件
     * @event  module:util/suggest/suggest._$$Suggest#onselect
     * @param  {String} event - 节点的data-value值，没有则取节点的value
     */
    _p._$$Suggest = _k._$klass();
    _pro = _p._$$Suggest._$extend(_t0._$$EventTarget);
    /**
     * 控件初始化
     *
     * @protected
     * @method module:util/suggest/suggest._$$Suggest#__init
     * @return {Void}
     */
    _pro.__init = function(){
        this.__sopt = {
            loopable:!0,
            onselect:this.__onSelect._$bind(this),
            onchange:this.__onSelectionChange._$bind(this)
        };
        this.__super();
    };
    /**
     * 控件重置
     * 
     * @protected
     * @method module:util/suggest/suggest._$$Suggest#__reset
     * @param  {Object} arg0 - 可选配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        // init node
        this.__auto  = !!_options.autofill;
        this.__input = _e._$get(_options.input);
        this.__sopt.clazz = _options.clazz;
        this.__sopt.parent = _e._$get(_options.body);
        this.__sopt.selected = _options.selected||'js-selected';
        // init event
        this.__doInitDomEvent([[
            this.__input,'input',
            this.__onInput._$bind(this)
        ],[
            this.__input,'focus',
            this.__onInput._$bind(this)
        ],[
            this.__input,'blur',
            this.__onBlur._$bind(this)
        ]]);
        // init helper
        this._$visibile(!1);
        this.__helper = _t1._$$SelectHelper._$allocate(this.__sopt);
    };
    /**
     * 控件销毁
     * 
     * @protected
     * @method module:util/suggest/suggest._$$Suggest#__destroy
     * @return {Void}
     */
    _pro.__destroy = function(){
        this.__super();
        if (!!this.__helper){
            this.__helper._$recycle();
            delete this.__helper;
        }
        delete this.__xxx;
        delete this.__input;
        delete this.__sopt.parent;
    };
    /**
     * 输入框失去焦点事件
     * @return {Void}
     */
    _pro.__onBlur = function(){
        this.__onSelect({
            target:this.__helper._$getSelectedNode()
        });
    };
    /**
     * 输入内容变化触发事件
     * 
     * @protected
     * @method module:util/suggest/suggest._$$Suggest#__onInput
     * @return {Void}
     */
    _pro.__onInput = function(){
        var _value = this.__input.value.trim();
        if (!_value){
            this._$visibile(!1);
        }else if(!this.__xxx){
            this._$dispatchEvent('onchange',_value);
        }
    };
    /**
     * 更新输入框内容
     *
     * @protected
     * @method module:util/suggest/suggest._$$Suggest#__doUpdateValue
     * @param  {Object} arg0 - 值信息
     * @return {Void} 
     */
    _pro.__doUpdateValue = function(_value){
        // lock onchange for input value setting
        if (!!this.__xxx){
            return;
        }
        this.__xxx = !0;
        if (!!_value&&_value!=this.__input.value){
            this.__input.value = _value;
        }
        this.__xxx = !1;
    };
    /**
     * 建议项选中事件
     *
     * @protected
     * @method module:util/suggest/suggest._$$Suggest#__onSelect
     * @param  {Object} arg0 - 事件信息
     * @return {Void} 
     */
    _pro.__onSelect = function(_event){
        var _value = _e._$dataset(_event.target,'value')||'';
        this.__doUpdateValue(_value);
        _value = _value||this.__input.value;
        this._$update('');
        this._$dispatchEvent('onselect',_value);
    };
    /**
     * 建议卡片选择变化事件
     * 
     * @protected
     * @method module:util/suggest/suggest._$$Suggest#__onSelectionChange
     * @param  {Object} Object 事件信息
     * @return {Void}
     */
    _pro.__onSelectionChange = function(_event){
        if (this.__auto){
            this.__doUpdateValue(
                _e._$dataset(_event.target,'value')||''
            );
        }
    };
    /**
     * 设置列表，用于切换列表选择卡片是否可见，不建议使用
     * 
     * 脚本举例
     * ```javascript
     * // _list是节点列表
     * _suggest._$setList(_list);
     * ```
     *
     * @deprecated 
     * @method module:util/suggest/suggest._$$Suggest#_$setList
     * @see    module:util/suggest/suggest._$$Suggest#_$visibile
     * @param  {Array} arg0 - 建议项节点列表
     * @return {Void}
     */
    _pro._$setList = function(_list){
        this._$visibile(!!_list&&_list.length>0);
    };
    /**
     * 更新建议列表的可见性
     * 
     * 脚本举例
     * ```javascript
     * // 设置选择列表可见
     * _suggest._$visibile(true);
     * // 设置选择列表不可见
     * _suggest._$visibile(false);
     * ```
     *
     * @method module:util/suggest/suggest._$$Suggest#_$visibile
     * @param  {Boolean} arg0 - 是否可见
     * @return {Void}
     */
    _pro._$visibile = function(_visible){
        var _visible = !_visible?'hidden':'visible';
        this.__sopt.parent.style.visibility = _visible;
    };
    /**
     * 更新可选列表
     * 
     * 脚本举例
     * ```javascript
     * // 更新选择列表内容
     * var _arr = [];
     * for(var i=0;i<10;i++){
     *     _arr.push('<div>'+i+'</div>');
     * }
     * _suggest._$update(_arr.join(''));
     * ```
     * 
     * @method module:util/suggest/suggest._$$Suggest#_$update
     * @param  {String} arg0 - 列表HTML代码
     * @return {Void}
     */
    _pro._$update = function(_html){
        this.__sopt.parent.innerHTML = _html||'&nbsp;';
        this._$visibile(!!_html);
    };

    if (CMPT){
        NEJ.copy(NEJ.P('nej.ut'),_p);
    }

    return _p;
},215,1,4,23,448);
I$(588,function (NEJ,_k,_e,_v,_t,_p,_o,_f,_r,_pro){

    _p._$$NewSelectHelper = _k._$klass();
    _pro = _p._$$NewSelectHelper._$extend(_t._$$SelectHelper);

    /**
     * 鼠标移出事件
     *
     * @protected
     * @method module:util/helper/select._$$NewSelectHelper#__onCheckLeave
     * @return {Void}
     */
    _pro.__onCheckLeave = function(_event){
        this._$dispatchEvent('oncheckleave',this.__hovered,this.__selected,this.__getItemElement(this.__hovered));
        if (this.__hovered==this.__selected){
            return;
        }
        _e._$delClassName(
            this.__getItemElement(this.__hovered),
            this.__hovered
        );
    };

    return _p;
},215,1,4,3,448);
I$(435,function (_k,_ut,_v,_e,request,suggest,_t0,_t1,_t2,_p,_o,_f,_r,_pro) {
    var pro;

    _p._$$SearchSuggestModule = _k._$klass();
    pro = _p._$$SearchSuggestModule._$extend(_t0._$$EventTarget);
    
    pro.__init = function(_options) {
      this.__supInit(_options);

      this.__lsUsable = this.__getLsUsable();
      this.__initNode();
      this.__initEvent();

      this.__sopt = {
        loopable:!0,
        onselect:this.__onItemSelect._$bind(this),
        selected:'active',
        parent:this.__wrap,
        oncheckleave:this.__onItemLeave._$bind(this)
      }
      this.__helper = _t1._$$NewSelectHelper._$allocate(this.__sopt);

      //设置blur失效1次，并且触发focus
      this.__setBlurDisableOnce = false;
      if(this.__lsUsable){
        this.__initLatelySearch();
        window.kl = {};
        kl.delkey = this.__refreshLatelyKey._$bind(this);
        kl.setEmpty = this.__setLatelyKeyEmpty._$bind(this);
      }
    };

    pro.__initNode = function() {
      this.__cache = {};
      this.__searchBox = _e._$get('topsearchbox');
      this.__input = _e._$get('topSearchInput');
      this.__wrap = _e._$get('searchhintlist');
      this.__searchBtn = _e._$get('topSearchBtn');
      this.__linkBox = _e._$get('suggestlist');

      //对搜索下面的链接的key做转义
      if(this.__linkBox){
        var link=_e._$getByClassName(this.__linkBox, 'suggestitem'), item, key, 
            searchTypePage = window.searchTypePage||false;
        if(searchTypePage && pageType==0){
          this.__searchKey = this.__getUrlParam(location.href,'key');
        }
        for(var i=0,l=link.length; i<l; i++){
            item = link[i];
            key = item.getAttribute('datakey');
            if(!!key){
                //KJDS-3161 搜索热词埋点
                var searchReferText = 'searchRefer=suggestion';
                if(searchTypePage){
                  switch(pageType){
                    case 0:
                      searchReferText = 'searchRefer=suggest_search';
                      break;
                    case 1:
                      searchReferText = 'searchRefer=suggest_brand';
                      break;
                    case 2:
                      searchReferText = 'searchRefer=suggest_category';
                      break;
                  }
                  
                }
                item.href = '//www.kaola.com/search.html?zn=top&key='+encodeURIComponent(encodeURIComponent(key))+'&'+searchReferText+'&referPosition='+(i+1);
            }
        }
      }
    }

    pro.__initEvent = function() {
      if(this.__input){
        this.__holderText = this.__input.getAttribute('placeholder');
        //绑定回车事件
        _v._$addEvent(this.__input, 'keypress', function(e){
            var key = e.keyCode;
            if(key == 13) {
                this.__doSearch();
                return false;
            }
        }._$bind(this));
        _v._$addEvent(this.__searchBtn, 'click', this.__doSearch._$bind(this));
        if(!('placeholder' in document.createElement('input'))){
            _t2._$placeholder(this.__input);
        }else{
            // _v._$addEvent(this.__input, 'focus', function(){
            //     this.__input.setAttribute('placeholder','');
            // }._$bind(this));
            // _v._$addEvent(this.__input, 'blur', function(){
            //     this.__input.setAttribute('placeholder',this.__holderText);
            // }._$bind(this));
        }
      }

      this.__doInitDomEvent([[
          this.__input,'input',
          this.__onInput._$bind(this)
      ],[
          this.__input,'focus',
          this.__onInput._$bind(this, true)
      ],[
          this.__input,'blur',
          this.__onBlur._$bind(this)
      ]]);
    };

    //过滤搜索下面的链接后，维护个列表
    pro.__initLatelySearch = function(){
      //对于从联想词和最近记录下拉点击过来的链接，需要把key放置在列表里面
      var from = this.__getUrlParam(location.href,'searchRefer');
      if(location.href.indexOf('/search.html')>0 && (from=='recent' || from=='keyWordSuggestion')){
        var key = this.__getUrlParam(location.href,'key').replace(/%2B/ig,'%20');
        if(!!key){
          key = decodeURIComponent(decodeURIComponent(key));
          this.__addLatelyKey(key);
        }
      }
      this.__keyAry = this.__lsGetItem('latelysearch');
      if(!this.__keyAry || this.__keyAry.length == 0){
        this.__keyAry = [];
        this.__showKeyAry = [];
      }else{
        //过滤搜索下面的链接
        var string = ','+this.__keyAry.join(',')+',';
        if(this.__linkBox){
          var link=_e._$getByClassName(this.__linkBox, 'suggestitem'), item, key, value;
          for(var i=0,l=link.length; i<l; i++){
            item = link[i];
            value = item.innerHTML;
            if(!item.getAttribute('datakey')){
              string = string.replace(','+value+',', ',');
            }
          }
        }

        this.__showKeyAry = string.substring(1,string.length-1).split(',');
      }
    }

    pro.__addLatelyKey = function(key){
      if(!key)  return;
      
      var keyary = this.__lsGetItem('latelysearch')||[];
      for(var i=0, l=keyary.length; i<l; i++){
        if(keyary[i] == key){
          keyary.splice(i, 1);
          break;
        }
      }
      keyary.unshift(key);
      this.__lsSetItem('latelysearch', keyary.slice(0,20));
    }

    pro.__doSearch = function(){
      var key = this.__input.value.replace(/(^\s*)|(\s*$)/g,''),
          placeholder = this.__input.placeholder,
          urllink = this.__input.getAttribute('urllink') || '';

      if(!key || key == '输入搜索' || key == placeholder) {
        if(placeholder){
          key = placeholder;
        } else{
          return;
        }
      }else{
          urllink = '';
      }

      if(!!window.searchTrigger&&false) {
        window.searchTrigger(true, key)
      }else{
        if (key == '在千万海外商品中搜索') {
          location.href = window.__domainUrl || '/';
        }else{
          if(this.__lsUsable && !urllink && !!key){
            //判断这个key是否已经在历史里面了，如果存在则删除，重新添加key到首位
            for(var i=0, l=this.__keyAry.length; i<l; i++){
              if(this.__keyAry[i] == key){
                this.__keyAry.splice(i, 1);
                break;
              }
            }
            this.__keyAry.unshift(key);
            this.__lsSetItem('latelysearch', this.__keyAry.slice(0,20));
          }

          location.href = urllink == ''?((window.__domainUrl||'/')+'search.html?zn=top&key='+encodeURIComponent(encodeURIComponent(key))+'&searchRefer=searchbutton'+(this.__searchKey?('&oldQuery='+this.__searchKey):'')):urllink;
        }
      }
    }

    pro.__onInput = function(_event, _flag) {
      if(!!_flag){
        this.__isFocus = true;
        this.__input.setAttribute('placeholder','');
      }
      //当输入框没有focus时,不触发下拉请求
      if(!this.__isFocus) {
        return
      }

      var _value = this.__input.value.trim();
      if(!_value) {
        this.__clearItem();
        this.__showLatelyKey()
      } else {
        if(!!this.__cache[_value]){
          this.__showList(this.__cache[_value], _value);
        }else{
          this.__onChange(_value);
        }
      }
    };

    pro.__onChange = function(_value) {
      var _oldQuery = '';
      var _data = {
        query: _value,
        size: 10
      }
      if(this.__searchKey){
        _oldQuery = decodeURIComponent(decodeURIComponent(this.__searchKey));
        _data.oldQuery = _oldQuery;
      }
      request('/getSuggestKeyword.html',{
        method:'POST',
        type:'json',
        norest:true,
        data:_data,
        onload:this.__cbSuggestKey._$bind(this, _value),
        onerror:function(){}
      })
    };

    pro.__onSelect = function(_value) {
      
    };

    pro.__cbSuggestKey = function(_value,_json) {
      this.__cache[_value] = _json;

      this.__showList(_json, _value);
    };

    pro.__showList = function(_json, _val){
      var _value = this.__input.value.trim();
      if(_value !== _val){
        return;
      }

      var html='', item='';
      if(!!_json && _json.retcode == 200) {
        data = _json.suggestKeycords;
        for(var i=0, l=data.length, text, textescape; i<l; i++) {
          text = data[i].replace(/（?(删除|删|旧|暂时作废)）?/ig, '');
          textescape = _ut._$escape(text);
          item = '<li data-key="'+encodeURIComponent(text)+'" data-search="searchRefer=keyWordSuggestion&referPosition='+(i+1)+'&oriQuery='+_value+(this.__searchKey?('&oldQuery='+this.__searchKey):'')+'">\
                      <a class="item" title="'+textescape+'" href="'+(window.__domainUrl||'/')+'search.html?zn=top&key='+encodeURIComponent(encodeURIComponent(text))+'&searchRefer=keyWordSuggestion&referPosition='+(i+1)+'&oriQuery='+_value+(this.__searchKey?('&oldQuery='+this.__searchKey):'')+'">\
                          <span class="shname">'+textescape+'</span>\
                      </a>\
                  </li>'
          html += item;
        }
      }

      if(!!html){
        this.__wrap.innerHTML = html;
        this.__show(true);
      }else{
        this.__show(false);
      }
    }

    pro.__onBodyClick = function(e) {
      if(this.__wrap.style.display == 'none') {
        return;
      }

      var target = _v._$getElement(e), randomClass = 'j-searchflag-'+_ut._$randNumberString(6);
      if(!!target) {
        _e._$addClassName(target, randomClass)
        var node = _e._$getByClassName(this.__searchBox, randomClass);
        if(node.length == 0) {  //表示点击的节点不在搜索节点内，隐藏下拉
          this.__onHide();
        }else{  //表示点击的节点在搜索节点内，不隐藏下拉
          return
        }
      }else{
        this.__onHide();
      }
    };

    pro.__onBlur = function() {
      window.setTimeout(function(){
        if(!!this.__setBlurDisableOnce){
          this.__setBlurDisableOnce = false;
          this.__input.focus();
        }else{
          this.__onHide();
          this.__isFocus = false;
          this.__input.setAttribute('placeholder',this.__holderText);
        }
      }._$bind(this), 250)
    };

    pro.__onHide = function() {
      this.__show(false);
      var activeNode = this.__helper._$getSelectedNode();
      if(!!activeNode){
        _e._$delClassName(activeNode, 'active');
      }
    }

    pro.__show = function(_flag) {
      this.__wrap.style.display = !!_flag?'':'none';
    }

    pro.__clearItem = function() {
      this.__wrap.innerHTML = '';
    }

    pro.__onItemSelect = function(_obj) {
      if(!_obj || !_obj.target){
        return;
      }
      var key = _obj.target.getAttribute('data-key'),
          param = _obj.target.getAttribute('data-search');
      if(!!key){
        location.href = (window.__domainUrl||'/')+'search.html?zn=top&key='+encodeURIComponent(key)+(!!param?('&'+param):'');
      }
      return false;
    }

    pro.__onItemLeave = function(_hovered, _selected, _target){
      if(_hovered == _selected && _target){
        _e._$delClassName(_target,_hovered);
      }
    }

    pro.__showLatelyKey = function(){
      if(this.__showKeyAry.length == 0){
        this.__show(false);
        return;
      }
      var html='<li>\
                    <span class="item" title="最近搜索">\
                        <span class="shname tit">最近搜索</span>\
                        <span class="del" title="清空" onclick="kl.setEmpty(event)" style="display:block;">&#xe62b;</span>\
                    </span>\
                </li>', item='', keyAry=this.__showKeyAry.slice(0,9);
      for(var i=0, l=keyAry.length, text; i<l; i++) {
        text = keyAry[i];
        textescape = _ut._$escape(keyAry[i]);
        item = '<li data-key="'+encodeURIComponent(text)+'" data-search="searchRefer=recent">\
                    <a class="item" title="'+textescape+'" href="'+(window.__domainUrl||'/')+'search.html?zn=top&key='+encodeURIComponent(encodeURIComponent(text))+'&searchRefer=recent">\
                        <span class="shname">'+textescape+'</span>\
                        <span class="del" onclick="kl.delkey(event,'+i+')">删除</span>\
                    </a>\
                </li>'
        html += item;
      }

      if(!!html){
        this.__wrap.innerHTML = html;
        this.__show(true);
      }else{
        this.__show(false);
        this.__wrap.innerHTML = '';
      }
    }

    pro.__refreshLatelyKey = function(event,index){
      _v._$stop(event);
      //删除显示列表里的key
      var value = this.__showKeyAry[index];
      this.__showKeyAry.splice(index, 1);

      //删除原始列表里的key
      for(var i=0, l=this.__keyAry.length; i<l; i++){
        if(this.__keyAry[i] == value){
          this.__keyAry.splice(i, 1);
          break;
        }
      }
      this.__showLatelyKey();
      this.__lsSetItem('latelysearch', this.__keyAry);
      this.__setBlurDisableOnce = true;
      window['_gaq'].push(["_trackEvent",'搜索下拉框展示最近搜索词/词组','删除']);
    }

    pro.__setLatelyKeyEmpty = function(event){
      _v._$stop(event);
      this.__showKeyAry = this.__keyAry = [];
      this.__showLatelyKey();
      this.__lsRemoveItem('latelysearch');
      window['_gaq'].push(["_trackEvent",'搜索下拉框展示最近搜索词/词组','清空']);
    }

    pro.__getLsUsable =  function() {
      try{
        localStorage.getItem("test");
        return true;
      }catch(e){
        return false;
      }
    }

    //localStorage操作
    pro.__lsGetItem = function(key) {
      if(!this.__lsUsable)  return null;
 
      return JSON.parse(localStorage.getItem(key));
    }
 
    pro.__lsSetItem = function(key, value) {
      if(!this.__lsUsable)  return;
      
      localStorage.setItem(key, JSON.stringify(value));
    }
 
    pro.__lsRemoveItem = function(key) {
      if(!this.__lsUsable)  return;
      
      localStorage.removeItem(key);
    }

    pro.__getUrlParam = function(url, param) {
      if(url.indexOf(param + '=') < 0) {
          return '';
      }
      var tmp = (url+'&').split(param+'=');
      return tmp[1]?tmp[1].split('&')[0]:'';
    };
    
    return _p._$$SearchSuggestModule
  },1,2,3,4,6,232,23,588,93);
I$(605,function (NEJ,_k,_g,_v,_u,_t,_p,_o,_f,_r){
    var _pro,
        _timeout = 60000;
    /**
     * 资源加载器
     * 
     * @class    module:util/ajax/loader/loader._$$LoaderAbstract
     * @extends  module:util/event._$$EventTarget
     * 
     * @param    {Object} config  - 可选配置参数
     * @property {String} version - 版本信息
     * @property {Number} timeout - 超时时间，0表示禁止超时监测
     */
    /** 
     * 资源载入失败回调
     * 
     * @event    module:util/ajax/loader/loader._$$LoaderAbstract#onerror
     * @param    {Object} event   - 错误信息
     * @property {Number} code    - 错误码
     * @property {String} message - 错误信息
     */
    /** 
     * 资源载入成功回调
     * 
     * @event  module:util/ajax/loader/loader._$$LoaderAbstract#onload
     * @param  {Variable} event - 请求返回数据
     */
    /** 
     * 资源加载中回调
     * 
     * @event  module:util/ajax/loader/loader._$$LoaderAbstract#onloading
     */
    _p._$$LoaderAbstract = _k._$klass();
    _pro = _p._$$LoaderAbstract._$extend(_t._$$EventTarget);
    /**
     * 控件初始化
     * 
     * @protected
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#__init
     * @return {Void}
     */
    _pro.__init = function(){
        this.__super();
        this.__qopt = {
            onerror:this.__onQueueError._$bind(this),
            onload:this.__onQueueLoaded._$bind(this)
        };
        if (!this.constructor.__cache){
            // url : {request:script,timer:2,bind:[instance1,instance2 ... ]}
            // key : {error:0,loaded:0,total:0,bind:[instance1,instance2 ... ]}
            this.constructor.__cache = {loaded:{}};
        }
    };
    /**
     * 控件重置
     * 
     * @protected
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#__reset
     * @param  {Object} arg0 - 可选配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        this.__version = _options.version;
        this.__timeout = _options.timeout;
        this.__qopt.version = this.__version;
        this.__qopt.timeout = this.__timeout;
    };
    /**
     * 删除加载信息
     * 
     * @protected
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#__delLoadData
     * @param  {String} arg0 - 标识
     * @return {Object}        加载信息
     */
    _pro.__delLoadData = function(_key){
        delete this.constructor.__cache[_key];
    };
    /**
     * 取加载信息
     * 
     * @protected
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#__getLoadData
     * @param  {String} arg0 - 标识
     * @return {Object}        加载信息
     */
    _pro.__getLoadData = function(_key){
        return this.constructor.__cache[_key];
    };
    /**
     * 设置加载信息
     * 
     * @protected
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#__setLoadData
     * @param  {String} arg0 - 标识
     * @param  {Object} arg1 - 加载信息
     * @return {Void}
     */
    _pro.__setLoadData = function(_key,_data){
        this.constructor.__cache[_key] = _data;
    };
    /**
     * 取资源载入控件，子类实现具体逻辑
     * 
     * @abstract
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#__getRequest
     * @return {Script|Link} 控件
     */
    _pro.__getRequest = _f;
    /**
     * 清理控件
     * 
     * @protected
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#__doClearRequest
     * @param  {Script|Link} arg0 - 控件
     * @return {Void}
     */
    _pro.__doClearRequest = function(_request){
        _v._$clearEvent(_request);
    };
    /**
     * 资源载入
     * 
     * @protected
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#__doRequest
     * @param  {Script|Link} arg0 - 控件
     * @return {Void}
     */
    _pro.__doRequest = function(_request){
        _request.src = this.__url;
        document.head.appendChild(_request);
    };
    /**
     * 执行清理任务
     * 
     * @protected
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#__doClear
     * @return {Void}
     */
    _pro.__doClear = function(){
        var _cache = this.__getLoadData(this.__url);
        if (!_cache) return;
        window.clearTimeout(_cache.timer);
        this.__doClearRequest(_cache.request);
        delete _cache.bind;
        delete _cache.timer;
        delete _cache.request;
        this.__delLoadData(this.__url);
        this.__getLoadData('loaded')[this.__url] = !0;
    };
    /**
     * 执行回调
     * 
     * @protected
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#__doCallback
     * @param  {String} arg0 - 回调名称
     * @return {Void}
     */
    _pro.__doCallback = function(_name){
        var _cache = this.__getLoadData(this.__url);
        if (!_cache) return;
        var _list = _cache.bind;
        this.__doClear();
        if (!!_list&&_list.length>0){
            var _instance;
            while(_list.length){
                _instance = _list.shift();
                try{
                    _instance._$dispatchEvent(_name,arguments[1]);
                }catch(ex){
                    // ignore
                    if (DEBUG) throw ex;
                    console.error(ex.message);
                    console.error(ex.stack);
                }
                _instance._$recycle();
            }
        }
    };
    /**
     * 资源载入异常事件
     * 
     * @protected
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#__onError
     * @param  {Object} arg0 - 错误信息
     * @return {Void}
     */
    _pro.__onError = function(_error){
        this.__doCallback('onerror',_error);
    };
    /**
     * 资源载入成功事件
     * 
     * @protected
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#__onLoaded
     * @return {Void}
     */
    _pro.__onLoaded = function(){
        this.__doCallback('onload');
    };
    /**
     * 载入队列资源
     * 
     * @protected
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#__doLoadQueue
     * @param  {String} arg0 - 资源地址
     * @return {Void}
     */
    _pro.__doLoadQueue = function(_url){
        this.constructor._$allocate(this.__qopt)._$load(_url);
    };
    /**
     * 检查队列状况
     * 
     * @protected
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#__onQueueCheck
     * @return {Void}
     */
    _pro.__onQueueCheck = function(_error){
        var _cache = this.__getLoadData(this.__key);
        if (!_cache) return;
        if (!!_error) 
            _cache.error++;
        _cache.loaded ++;
        if (_cache.loaded<_cache.total) return;
        this.__delLoadData(this.__key);
        this._$dispatchEvent(_cache.error>0?'onerror':'onload');
    };
    /**
     * 队列载入资源异常事件
     * 
     * @protected
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#__onQueueError
     * @param  {Object} arg0 - 错误信息
     * @return {Void}
     */
    _pro.__onQueueError = function(_error){
        this.__onQueueCheck(!0);
    };
    /**
     * 队列载入资源成功事件
     * 
     * @protected
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#__onQueueLoaded
     * @return {Void}
     */
    _pro.__onQueueLoaded = function(){
        this.__onQueueCheck();
    };
    /**
     * 载入资源
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/ajax/loader/html',
     *     'util/ajax/loader/style',
     *     'util/ajax/loader/script'
     * ],function(_t0,_t1,_t2){
     *     // 载入指定html,10秒超时
     *     var _loader = _t0._$$LoaderHtml._$allocate({
     *         timeout:10000,
     *         onload:function(){
     *             // 载入资源成功的回调
     *         }
     *     });
     *     // 绝对路径或者当前页面的相对路径
     *     _loader._$load('../../../html/util/formTest.html');
     * 
     *     // 载入指定script,20秒超时
     *     var _loader = _t2._$$LoaderScript._$allocate({
     *         timeout:20000,
     *         onload:function(){
     *             // 载入资源成功的回调
     *         }
     *     });
     *     // 绝对路径或者当前页面的相对路径
     *     _loader._$load('../../../javascript/log.js');
     * 
     *     // 载入指定style,30秒超时
     *     var _loader = _t1._$$LoaderStyle._$allocate({
     *         timeout:30000,
     *         onload:function(){
     *             // 载入资源成功的回调
     *         }
     *     });
     *     // 绝对路径或者当前页面的相对路径
     *     _loader._$load('../../../base/qunit.css');
     * });
     * ```
     * 
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#_$load
     * @param  {String} arg0 - 资源地址
     * @return {Void}
     */
    _pro._$load = function(_url){
        _url = _u._$absolute(_url);
        if (!_url){
            this._$dispatchEvent('onerror',{
                code:_g._$CODE_NOTASGN,
                message:'请指定要载入的资源地址！'
            });
            return;
        };
        this.__url = _url;
        if (!!this.__version){
            this.__url += (this.__url.indexOf('?')<0?'?':'&')+this.__version;
        }
        if (this.__getLoadData('loaded')[this.__url]){
            try{
                this._$dispatchEvent('onload');
            }catch(ex){
                // ignore
                if (DEBUG) throw ex;
                console.error(ex.message);
                console.error(ex.stack);
            }
            this._$recycle();
            return;
        }
        var _cache = this.__getLoadData(this.__url),_request;
        if (!!_cache){
            _cache.bind.unshift(this);
            _cache.timer = window.clearTimeout(_cache.timer);
        }else{
            _request = this.__getRequest();
            _cache = {request:_request,bind:[this]};
            this.__setLoadData(this.__url,_cache);
            _v._$addEvent(
                _request,'load',
                this.__onLoaded._$bind(this)
            );
            _v._$addEvent(
                _request,'error',
                this.__onError._$bind(this,{
                    code:_g._$CODE_ERRSERV,
                    message:'无法加载指定资源文件['+this.__url+']！'
                })
            );
        }
        if (this.__timeout!=0){
            _cache.timer = window.setTimeout(
                this.__onError._$bind(this,{
                    code:_g._$CODE_TIMEOUT,
                    message:'指定资源文件['+this.__url+']载入超时！'
                }),
                this.__timeout||_timeout
            );
        }
        if (!!_request){
            this.__doRequest(_request);
        }
        this._$dispatchEvent('onloading');
    };
    /**
     * 队列载入资源
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/ajax/loader/html.js'
     * ],function(_t){
     *     var _loader = _t._$$LoaderHtml._$allocate({
     *         onload:function(){
     *             // 载入队列资源成功的回调
     *         }
     *     });
     *     // 路径列表，可以是绝对路径也可以是当前页面的相对路径
     *     var _list = [
     *         '../../../html/util/formTest.html',
     *         '../../../html/util/cacheTest.html'
     *     ];
     *     _loader._$queue(_list);
     * });
     * ```
     * 
     * @method module:util/ajax/loader/loader._$$LoaderAbstract#_$queue
     * @param  {Array} arg0 - 资源地址队列
     * @return {Void}
     */
    _pro._$queue = function(_list){
        if (!_list||!_list.length){
            this._$dispatchEvent('onerror',{
                code:_g._$CODE_NOTASGN,
                message:'请指定要载入的资源队列！'
            });
            return;
        } 
        this.__key = _u._$uniqueID();
        var _cache = {error:0,loaded:0,total:_list.length};
        this.__setLoadData(this.__key,_cache);
        _u._$forEach(
            _list,function(v,i){
                if (!v){
                    _cache.total--;
                    return;
                }
                this.__doLoadQueue(v);
            },this
        );
        this._$dispatchEvent('onloading');
    };
    
    return _p;
},215,1,227,3,2,23);
I$(481,function (_t,_k,_e,_j,_p,_o,_f,_r){
    var _pro;
    /**
     * 文本资源加载器
     *
     * @class   module:util/ajax/loader/text._$$LoaderText
     * @extends module:util/ajax/loader/loader._$$LoaderAbstract
     *
     * @param   {Object} config - 可选配置参数
     */
    _p._$$LoaderText = _k._$klass();
    _pro = _p._$$LoaderText._$extend(_t._$$LoaderAbstract);
    /**
     * 取资源载入控件
     *
     * @protected
     * @method module:util/ajax/loader/style._$$LoaderText#__getRequest
     * @return {Node} 控件节点
     */
    _pro.__getRequest = function(){
        return null;
    };
    /**
     * 资源载入
     *
     * @protected
     * @method module:util/ajax/loader/style._$$LoaderText#__doRequest
     * @param  {Node} 控件节点
     * @return {Void}
     */
    _pro.__doRequest = function(){
        _j._$request(this.__url,{
            method:'GET',
            type:'text',
            onload:this.__onLoaded._$bind(this),
            onerror:this.__onError._$bind(this)
        });
    };
    /**
     * 资源载入成功事件
     *
     * @protected
     * @method module:util/ajax/loader/style._$$LoaderText#__onLoaded
     * @return {Void}
     */
    _pro.__onLoaded = function(_text){
        this.__doCallback('onload',{
            url:this.__url,
            content:_text
        });
    };

    return _p;
},605,1,4,14);
I$(641,function (_e,_p,_o,_f,_r){
    /**
     * 删除IFrame节点，保留历史
     * @param  {Node} iframe节点
     * @return {Void}
     */
    _p.__removeIFrameKeepHistory = function(_iframe){
        _e._$remove(_iframe);
    };
    
    return _p;
},4);
I$(606,function(_h,_e,_m,_p,_o,_f,_r){if (_m._$KERNEL.engine==='trident'&&_m._$KERNEL.release<='2.0'){I$(642,function (){
        /**
         * 删除IFrame节点，保留历史
         * @param  {Node} iframe节点
         * @return {Void}
         */
        _h.__removeIFrameKeepHistory = function(_iframe){
            _e._$setStyle(_iframe,'display','none');
            try{_iframe.contentWindow.document.body.innerHTML = '&nbsp;';}catch(ex){}
        };
    });}return _h;},641,4,78);
I$(482,function (_t,_k,_e,_h,_p,_o,_f,_r){
    var _pro;
    /**
     * HTML资源加载器
     * 
     * @class   module:util/ajax/loader/html._$$LoaderHtml
     * @extends module:util/ajax/loader/loader._$$LoaderAbstract
     * 
     * @param   {Object} config - 可选配置参数
     */
    _p._$$LoaderHtml = _k._$klass(); 
    _pro = _p._$$LoaderHtml._$extend(_t._$$LoaderAbstract);
    /**
     * 取资源载入控件
     * 
     * @protected
     * @method module:util/ajax/loader/html._$$LoaderHtml#__getRequest
     * @return {Node} IFrame节点
     */
    _pro.__getRequest = function(){
        var _iframe = _e._$create('iframe');
        _iframe.width = 0;
        _iframe.height = 0;
        _iframe.style.display = 'none';
        return _iframe;
    };
    /**
     * 资源载入
     * 
     * @protected
     * @method module:util/ajax/loader/html._$$LoaderHtml#__doRequest
     * @param  {Node} arg0 - 控件节点
     * @return {Void}
     */
    _pro.__doRequest = function(_request){
        try{
            // append first for history bug
            document.body.appendChild(_request);
            _request.src = this.__url;
        }catch(ex){
            console.log(_request);
            console.error(ex);
        }
    };
    /**
     * 资源载入异常事件
     * 
     * @protected
     * @method module:util/ajax/loader/html._$$LoaderHtml#__onError
     * @param  {Object} arg0 - 错误信息
     * @return {Void}
     */
    _pro.__onError = function(_error){
        var _iframe = (
            this.__getLoadData(this.__url)||_o
        ).request;
        this.__doCallback('onerror',_error);
        _h.__removeIFrameKeepHistory(_iframe);
    };
    /**
     * 资源载入成功事件
     * 
     * @protected
     * @method module:util/ajax/loader/html._$$LoaderHtml#__onLoaded
     * @return {Void}
     */
    _pro.__onLoaded = function(){
        var _body = null,
            _iframe = (this.__getLoadData(this.__url)||_o).request;
        try{
            if (_iframe.src!=this.__url) return;
            _body = _iframe.contentWindow.document.body;
        }catch(ex){
            // ignore
        }
        this.__doCallback('onload',_body);
        _h.__removeIFrameKeepHistory(_iframe);
    };

    return _p;
},605,1,4,606);
I$(483,function (_t,_k,_e,_p,_o,_f,_r){
    var _pro;
    /**
     * 样式加载器
     *
     * @class   module:util/ajax/loader/style._$$LoaderStyle
     * @extends module:util/ajax/loader/loader._$$LoaderAbstract
     *
     * @param   {Object} config - 可选配置参数
     */
    _p._$$LoaderStyle = _k._$klass();
    _pro = _p._$$LoaderStyle._$extend(_t._$$LoaderAbstract);
    /**
     * 取资源载入控件
     *
     * @protected
     * @method module:util/ajax/loader/style._$$LoaderStyle#__getRequest
     * @return {Node} 控件节点
     */
    _pro.__getRequest = function(){
        return _e._$create('link');
    };
    /**
     * 资源载入
     *
     * @protected
     * @method module:util/ajax/loader/style._$$LoaderStyle#__doRequest
     * @param  {Node} 控件节点
     * @return {Void}
     */
    _pro.__doRequest = function(_request){
        _request.href = this.__url;
        document.head.appendChild(_request);
    };

    return _p;
},605,1,4);
I$(484,function (_t,_k,_e,_p,_o,_f,_r){
    var _pro;
    /**
     * 脚本加载器
     * 
     * @class    module:util/ajax/loader/script._$$LoaderScript
     * @extends  module:util/ajax/loader/loader._$$LoaderAbstract
     * 
     * @param    {Object} config   - 可选配置参数
     * @property {Boolean} async   - 异步载入并立刻执行，默认为!0
     * @property {String}  charset - 脚本编码
     */
    _p._$$LoaderScript = _k._$klass();
    _pro = _p._$$LoaderScript._$extend(_t._$$LoaderAbstract);
    /**
     * 控件重置
     * 
     * @protected
     * @method module:util/ajax/loader/script._$$LoaderScript#__reset
     * @param  {Object} arg0 - 可选配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        this.__async = _options.async;
        this.__charset = _options.charset;
        this.__qopt.async = !1;
        this.__qopt.charset = this.__charset;
    };
    /**
     * 取资源载入控件
     * 
     * @protected
     * @method module:util/ajax/loader/script._$$LoaderScript#__getRequest
     * @return {Script} 控件
     */
    _pro.__getRequest = function(){
        var _request = _e._$create('script');
        if (this.__async!=null){
            _request.async = !!this.__async;
        }
        if (this.__charset!=null){
            _request.charset = this.__charset;
        }
        return _request;
    };
    /**
     * 删除控件
     * 
     * @protected
     * @method module:util/ajax/loader/script._$$LoaderScript#__doClearRequest
     * @param  {Node} arg0 - 控件节点
     * @return {Void}
     */
    _pro.__doClearRequest = function(_request){
        _e._$remove(_request);
    };
    
    return _p;
},605,1,4);
I$(285,function (NEJ,_t0,_t1,_t2,_t3,_p,_o,_f,_r){
    /**
     * 载入完成回调函数
     *
     * @callback module:util/ajax/tag.onload
     * @param    {Variable} event - 请求返回数据
     */
    /**
     * 载入出错回调函数
     *
     * @callback module:util/ajax/tag.onerror
     * @param    {Object} event   - 错误信息
     * @property {Number} code    - 错误码
     * @property {String} message - 错误信息
     */
    /**
     * 载入脚本文件
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/ajax/tag'
     * ],function(_j){
     *     _j._$loadScript('../../../javascript/log.js',{
     *         onload:function(){
     *             // 载入成功的回调方法
     *         },
     *         onerror:function(_error){
     *             // 抛出异常回调
     *         }
     *     });
     * });
     * ```
     *
     * @method   module:util/ajax/tag._$loadScript
     * @see      module:util/ajax/tag._$queueScript
     * @param    {String}  arg0    - 请求地址
     * @param    {Object}  arg1    - 可选配置参数
     * @property {Boolean} async   - 异步载入并立刻执行，默认为!0
     * @property {Number}  timeout - 超时时间,0表示禁止超时监测
     * @property {String}  version - 版本信息
     * @property {String}  charset - 脚本编码
     * @property {module:util/ajax/tag.onload}  onload  - 载入回调
     * @property {module:util/ajax/tag.onerror} onerror - 异常回调
     * @return   {Void}
     */
    _p._$loadScript = function(_url,_options){
        _t3._$$LoaderScript._$allocate(_options)._$load(_url);
    };
    /**
     * 载入队列脚本并依次执行
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/ajax/tag'
     * ],function(_j){
     *     _j._$queueScript([
     *         '../../../javascript/log.js',
     *         'http://123.163.com/a.js'
     *     ],{
     *         onload:function(){
     *            // 载入成功的回调方法
     *         },
     *         onerror:function(_error){
     *            // 异常回调方法
     *         }
     *     });
     * });
     * ```
     *
     * @method   module:util/ajax/tag._$queueScript
     * @see      module:util/ajax/tag._$loadScript
     * @param    {Array}  arg0    - 脚本队列
     * @param    {Object} arg1    - 可选配置参数
     * @property {String} version - 版本信息
     * @property {String} charset - 脚本编码
     * @property {Number} timeout - 每个脚本超时时间,0表示禁止超时监测
     * @property {module:util/ajax/tag.onload}  onload  - 载入回调
     * @property {module:util/ajax/tag.onerror} onerror - 异常回调
     * @return   {Void}
     */
    _p._$queueScript = function(_list,_options){
        _t3._$$LoaderScript._$allocate(_options)._$queue(_list);
    };
    /**
     * 载入样式文件
     * ```javascript
     * NEJ.define([
     *     'util/ajax/tag'
     * ],function(_j){
     *     _j._$loadStyle('http://123.163.com/a.css',{
     *         onload:function(){
     *             // 载入成功的回调方法
     *         },
     *         onerror:function(_error){
     *             // 异常回调方法
     *         }
     *     });
     * });
     * ```
     *
     * @method   module:util/ajax/tag._$loadStyle
     * @see      module:util/ajax/tag._$queueStyle
     * @param    {String} arg0    - 样式文件地址
     * @param    {Object} arg1    - 可选配置参数
     * @property {Number} timeout - 超时时间,0表示禁止超时监测
     * @property {String} version - 版本信息
     * @property {module:util/ajax/tag.onload}  onload  - 载入回调
     * @property {module:util/ajax/tag.onerror} onerror - 异常回调
     * @return   {Void}
     */
    _p._$loadStyle = function(_url,_options){
        _t2._$$LoaderStyle._$allocate(_options)._$load(_url);
    };
    /**
     * 载入样式队列
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/ajax/tag'
     * ],function(_j){
     *     _j._$queueStyle([
     *         'http://123.163.com/a.css',
     *         'http://123.163.com/b.css'
     *     ],{
     *         onload:function(){
     *             // 载入成功的回调方法
     *         },
     *         onerror:function(_error){
     *             // 异常回调方法
     *         }
     *     });
     * });
     * ```
     *
     * @method   module:util/ajax/tag._$queueStyle
     * @see      module:util/ajax/tag._$loadStyle
     * @param    {Array}  arg0    - 样式队列
     * @param    {Object} arg1    - 可选配置参数
     * @property {Number} timeout - 超时时间,0表示禁止超时监测
     * @property {String} version - 版本信息
     * @property {module:util/ajax/tag.onload}  onload  - 载入回调
     * @property {module:util/ajax/tag.onerror} onerror - 异常回调
     * @return   {Void}
     */
    _p._$queueStyle = function(_list,_options){
        _t2._$$LoaderStyle._$allocate(_options)._$queue(_list);
    };
    /**
     * 载入HTML文件
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/ajax/tag'
     * ],function(_j){
     *     _j._$loadHtml('http://123.163.com/a.html',{
     *         onload:function(){
     *             // 载入成功的回调方法
     *         },
     *         onerror:function(_error){
     *             // 异常回调方法
     *         }
     *     });
     * });
     * ```
     *
     * @method   module:util/ajax/tag._$loadHtml
     * @param    {String} arg0    - 文件地址
     * @param    {Object} arg1    - 可选配置参数
     * @property {String} version - 版本信息
     * @property {module:util/ajax/tag.onload}  onload  - 载入回调
     * @property {module:util/ajax/tag.onerror} onerror - 异常回调
     * @return   {Void}
     */
    _p._$loadHtml = function(_url,_options){
        _t1._$$LoaderHtml._$allocate(_options)._$load(_url);
    };
    /**
     * 载入HTML文件
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/ajax/tag'
     * ],function(_j){
     *     _j._$loadText('http://123.163.com/a.txt',{
     *         onload:function(){
     *             // 载入成功的回调方法
     *         },
     *         onerror:function(_error){
     *             // 异常回调方法
     *         }
     *     });
     * });
     * ```
     *
     * @method   module:util/ajax/tag._$loadText
     * @param    {String} arg0    - 文件地址
     * @param    {Object} arg1    - 可选配置参数
     * @property {String} version - 版本信息
     * @property {module:util/ajax/tag.onload}  onload  - 载入回调
     * @property {module:util/ajax/tag.onerror} onerror - 异常回调
     * @return {Void}
     */
    _p._$loadText = function(_url,_options){
        _t0._$$LoaderText._$allocate(_options)._$load(_url);
    };

    if (CMPT){
        NEJ.copy(NEJ.P('nej.j'),_p);
    }

    return _p;
},215,481,482,483,484);
I$(233,function (NEJ,_u,_v,_e,_y,_t,_j0,_j1,_x,_p,_o,_f,_r){
    var _cache = {}, // template cache
        _skey  = (+new Date)+'-';
    /**
     * 解析模板集合
     *
     * 结构举例
     * ```html
     * <textarea name="jst" id="jst-box">
     *     <div>${name}</div>
     * </textarea>
     * <textarea name="txt" id="txt-box">
     *     <div>pure text</div>
     * </textarea>
     * <textarea name="ntp" id="ntp-box">
     *     <div>ntp</div>
     * </textarea>
     * <textarea name="js" id="js-box" data-src='/nej-baseline/src/define.js'></textarea>
     * <textarea name="css" id="css-box" data-src='/nej-baseline/qunit/base/qunit.css'></textarea>
     * <textarea name="html" id="html-box" data-src='/nej-baseline/qunit/html/ui/audioTest.html'></textarea>
     * <textarea name="res" id="res-box" data-src='http://pagead2.googlesyndication.com/simgad/15167196758298977737'></textarea>
     * ```
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/template/tpl'
     * ],function(_p){
     *     // 调用_$add接口缓存模版，id为key
     *     // 要用的时候通过_$get(key,{数据})合并模版后返回字符串
     *     _p._$parseTemplate('jst-box');
     *     // 生成结果：<div>jack</div>
     *     _p._$getTextTemplate('jst-box').trim();
     *
     *     // 通过_$addTextTemplate接口缓存纯文本,id为key
     *     _p._$parseTemplate('txt-box');
     *     // 要用的时候通过_e._$getTextTemplate(key)取到纯文本
     *     _p._$getTextTemplate('txt-box')
     *
     *
     *     // 通过_$addNodeTemplate接口缓存节点，第一次如果是字符串，缓存字符串，id为key
     *     _p._$parseTemplate('ntp-box');
     *     // 要用的时候通过_$getNodeTemplate('ntp-box')取出节点，
     *     // 如果缓存中是字符串,取的时候要重新转换成节点，然后重新缓存一边，下次直接是取节点
     *     _p._$getNodeTemplate('ntp-box');
     *
     *     // 加载id为js-box的textarea节点data-src指定的js文件
     *     _p._$parseTemplate('js-box');
     *
     *     // 加载id为css-box的textarea节点data-src指定的css文件
     *     _p._$parseTemplate('css-box');
     *
     *     // 加载id为html-box的textarea节点data-src指定的html文件
     *     _p._$parseTemplate('html-box');
     *
     *     // 加载id为res-box的textarea节点data-src指定的纯文本文件
     *     _p._$parseTemplate('res-box');
     * });
     * ```
     *
     * @method   module:util/template/tpl._$parseTemplate
     * @param    {String|Node} arg0 - 模板集合节点
     * @param    {Object}      arg1 - 可选配置参数
     * @property {String}      root - 根路径，相对规则
     * @return   {Void}
     */
    /**
     * @method CHAINABLE._$parseTemplate
     * @see module:util/template/tpl._$parseTemplate
     */
    _p._$parseTemplate = (function(){
        var _count = 0;
        var _doCheckReady = function(){
            if (_count>0) return;
            _count = 0;
            _v._$dispatchEvent(document,'templateready');
            _v._$clearEvent(document,'templateready');
        };
        var _doParseSrc = function(_textarea,_options){
            var _src = _e._$dataset(_textarea,'src');
            if (!_src) return;
            _options = _options||_o;
            var _root = _options.root;
            if (!_root){
                _root = _textarea.ownerDocument.location.href;
            }else{
                _root = _u._$absolute(_root);
            }
            _src = _src.split(',');
            _u._$forEach(_src,function(_value,_index,_list){
                _list[_index] = _u._$absolute(_value,_root);
            });
            return _src;
        };
        var _doAddStyle = function(_textarea,_options){
            if (!_textarea) return;
            var _src = _doParseSrc(_textarea,_options);
            if (!!_src){
                _j0._$queueStyle(_src,{
                    version:_e._$dataset(_textarea,'version')
                });
            }
            _e._$addStyle(_textarea.value);
        };
        var _onAddScript = function(_value){
            _count--;
            _e._$addScript(_value);
            _doCheckReady();
        };
        var _doAddScript = function(_textarea,_options){
            if (!_textarea) return;
            var _src = _doParseSrc(_textarea,_options),
                _val = _textarea.value;
            if (!!_src){
                _count++;
                var _options = {
                    version:_e._$dataset(_textarea,'version'),
                    onload:_onAddScript._$bind(null,_val)
                };
                window.setTimeout(
                    _j0._$queueScript._$bind(
                        _j0,_src,_options
                    ),0
                );
                return;
            }
            _e._$addScript(_val);
        };
        var _onAddHtml = function(_body){
            _count--;
            _p._$parseTemplate(_body);
            _doCheckReady();
        };
        var _doAddHtml = function(_textarea,_options){
            if (!_textarea) return;
            var _src = _doParseSrc(_textarea,_options)[0];
            if (!!_src){
                _count++;
                var _options = {
                    version:_e._$dataset(_textarea,'version'),
                    onload:_onAddHtml
                };
                window.setTimeout(
                    _j0._$loadHtml._$bind(
                        _j0,_src,_options
                    ),0
                );
            }
        };
        var _onAddTextResource = function(_id,_text){
            _count--;
            _p._$addTextTemplate(_id,_text||'');
            _doCheckReady();
        };
        var _doAddTextResource = function(_textarea,_options){
            if (!_textarea||!_textarea.id) return;
            var _id = _textarea.id,
                _src = _doParseSrc(_textarea,_options)[0];
            if (!!_src){
                _count++;
                var _url = _src+(_src.indexOf('?')<0?'?':'&')+
                          (_e._$dataset(_textarea,'version')||''),
                    _options = {
                        type:'text',
                        method:'GET',
                        onload:_onAddTextResource._$bind(null,_id)
                    };
                window.setTimeout(
                    _j1._$request._$bind(
                        _j1,_url,_options
                    ),0
                );
            }
        };
        var _doAddTemplate = function(_node,_options){
            var _type = _node.name.toLowerCase();
            switch(_type){
                case 'jst':
                    _y._$add(_node,!0);
                return;
                case 'txt':
                    _p._$addTextTemplate(_node.id,_node.value||'');
                return;
                case 'ntp':
                    _p._$addNodeTemplate(_node.value||'',_node.id);
                return;
                case 'js':
                    _doAddScript(_node,_options);
                return;
                case 'css':
                    _doAddStyle(_node,_options);
                return;
                case 'html':
                    _doAddHtml(_node,_options);
                return;
                case 'res':
                    _doAddTextResource(_node,_options);
                return;
            }
        };
        /**
         * 模版准备完毕触发事件，包括所有外联模版载入完成
         *
         * 结构举例
         * ```html
         * <div id="template-box">
         *   <textarea name="jst">
         *     jst tempalte here
         *   </textarea>
         *   <!-- text template with id="txt-id-1" in widget.html -->
         *   <textarea name="html" data-src="./widget.html"></textarea>
         * </div>
         * ```
         *
         * 脚本举例
         * ```javascript
         * NEJ.define([
         *     'base/event'
         *     'util/template/tpl'
         * ],function(_v,_e){
         *     // 解析模版集合
         *     _e._$parseTemplate('template-box');
         *
         *     // 在templateready事件中使用外联模版可以保证正确性
         *     _v._$addEvent(
         *         document,'templateready',
         *         function(_event){
         *             var _text = _e._$getTextTemplate('txt-id-1');
         *             // TODO
         *         }
         *     );
         * });
         * ```
         *
         * @event    external:document.ontemplateready
         * @param    {Object} event - 事件信息
         */
        _t._$$CustomEvent._$allocate({
            element:document,
            event:'templateready',
            oneventadd:_doCheckReady
        });
        return function(_element,_options){
            _element = _e._$get(_element);
            if (!!_element){
                var _list = _element.tagName=='TEXTAREA' ? [_element]
                          : _u._$object2array(
                                _element.getElementsByTagName('textarea')
                            );
                _u._$forEach(_list,function(_node){
                    _doAddTemplate(_node,_options);
                });
                _e._$remove(_element,!0);
            }
            _doCheckReady();
        };
    })();
    /**
     * 添加文本模板
     *
     * 脚本举例
     * ```javascript
     * // 通过_e._$addTextTemplate接口缓存纯文本,id为key
     * _e._$addTextTemplate('txt-box','i am content');
     * // 要用的时候通过_e._$getTextTemplate(key)取到纯文本
     * _e._$getTextTemplate('txt-box')
     * ```
     *
     * @method module:util/template/tpl._$addTextTemplate
     * @see    module:util/template/tpl._$getTextTemplate
     * @param  {String} arg0 - 模板键值
     * @param  {String} arg1 - 模板内容
     * @return {Void}
     */
    _p._$addTextTemplate = function(_key,_value){
        _cache[_key] = _value||'';
    };
    /**
     * 取文本模板
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/template/tpl'
     * ],function(_p){
     *     // 通过_$addTextTemplate接口缓存纯文本,id为key
     *     _p._$addTextTemplate('txt-box','i am content');
     *     // 要用的时候通过_$getTextTemplate(key)取到纯文本
     *     _p._$getTextTemplate('txt-box')
     * });
     * ```
     *
     * @method module:util/template/tpl._$getTextTemplate
     * @see    module:util/template/tpl._$addTextTemplate
     * @param  {String} arg0 - 模板键值
     * @return {String}        模板内容
     */
    _p._$getTextTemplate = function(_key){
        return _cache[_key]||'';
    };
    /**
     * 添加节点模板
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/template/tpl'
     * ],function(_p){
     *     // 通过_$addNodeTemplate接口缓存节点，第一次如果是字符串，缓存字符串，id为key
     *     _p._$addNodeTemplate(node,'ntp-box');
     *     // 要用的时候通过_$getNodeTemplate('ntp-box')取出节点，
     *     // 如果缓存中是字符串,取的时候要重新转换成节点，然后重新缓存一边，下次直接是取节点
     *     _p._$getNodeTemplate('ntp-box');
     * });
     * ```
     *
     * @method module:util/template/tpl._$addNodeTemplate
     * @see    module:util/template/tpl._$getNodeTemplate
     * @param  {String|Node} arg0 - 模板
     * @param  {String}      arg1 - 模板序列号
     * @return {String}             模板序列号
     */
    /**
     * @method CHAINABLE._$addNodeTemplate
     * @see module:util/template/tpl._$addNodeTemplate
     */
    _p._$addNodeTemplate = function(_element,_key){
        _key = _key||_u._$uniqueID();
        _element = _e._$get(_element)||_element;
        _p._$addTextTemplate(_skey+_key,_element);
        if (!_u._$isString(_element)){
            _e._$removeByEC(_element);
        }
        return _key;
    };
    /**
     * 取节点模板
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/template/tpl'
     * ],function(_p){
     *     // 通过_$addNodeTemplate接口缓存节点，第一次如果是字符串，缓存字符串，id为key
     *     _p._$addNodeTemplate('txt-box');
     *     // 要用的时候通过_$getNodeTemplate('ntp-box')取出节点，
     *     // 如果缓存中是字符串,取的时候要重新转换成节点，然后重新缓存一边，下次直接是取节点
     *     _p._$getNodeTemplate('ntp-box');
     * });
     * ```
     *
     * @method module:util/template/tpl._$getNodeTemplate
     * @see    module:util/template/tpl._$addNodeTemplate
     * @param  {String} arg0 - 模板序列号
     * @return {Node}          节点模板
     */
    _p._$getNodeTemplate = function(_key){
        if (!_key) return null;
        _key = _skey+_key;
        var _value = _p._$getTextTemplate(_key);
        if (!_value) return null;
        var _node;
        if (_u._$isString(_value)){
            _value = _e._$html2node(_value);
            // bugfix: https://connect.microsoft.com/IE/feedback/details/811408
            var _list = _value.getElementsByTagName('textarea');
            if (_value.tagName!='TEXTAREA'&&
               (!_list||!_list.length)){
                _p._$addTextTemplate(_key,_value);
            }else{
                _node = _value;
            }
        }
        // clone node and push to memory
        if (!_node){
            _node = _value.cloneNode(!0);
        }
        _e._$removeByEC(_node);
        return _node;
    };
    /**
     * 取ITEM模板列表
     *
     * 结构举例
     * ```html
     * <div id="item-box"></div>
     * ```
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'base/klass',
     *     'ui/item/item',
     *     'util/template/tpl'
     * ],function(_k,_i,_t,_p){
     *     var _pro;
     *     var _html_key = _t._$addNodeTemplate('<div>123</div>');
     *
     *     _p._$$MyItem = _k._$klass();
     *     _pro = _p._$$MyItem._$extend(_i._$$Item);
     *
     *     _pro.__reset = function(_options){
     *         this.__data = _options.data;
     *         this.__super(_options);
     *     }
     *
     *     _pro.__doRefresh = function(){
     *         this.__body.innerText = this.__data.name;
     *     };
     *
     *     _pro.__initXGui = function(){
     *         this.__seed_html = _html_key;
     *     };
     *
     *     return _p;
     * });
     * ```
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     '/path/to/my/item.js',
     *     'util/template/tpl'
     * ],function(_t,_p){
     *     // _$getItemTemplate接口生成item列表
     *     // 返回一个item的列表，可以循环调用_$recycle()，来销毁
     *     var _items = _p._$getItemTemplate(
     *         [{name:'jack'},{name:'sean'}],
     *         _t._$$MyItem,{parent:'item-box'}
     *     );
     * });
     * ```
     *
     * @method   module:util/template/tpl._$getItemTemplate
     * @param    {Array}   arg0   - 数据列表
     * @param    {module:ui/item/item._$$Item} arg1   - 列表项构造函数
     * @param    {Object}  arg2   - 可选配置参数，其他参数参见item指定的构造函数的配置参数
     * @property {Number}  offset - 起始指针【包含】，默认0
     * @property {Number}  limit  - 分配数据长度或者数量，默认为列表长度
     * @return   {Array}            ITEM模板列表
     */
    _p._$getItemTemplate = (function(){
        var _doFilter = function(_value,_key){
            return _key=='offset'||_key=='limit';
        };
        return function(_list,_item,_options){
            var _arr = [];
            if (!_list||!_list.length||!_item){
                return _arr;
            }
            _options = _options||_o;
            var _len = _list.length,
                _beg = parseInt(_options.offset)||0,
                _end = Math.min(_len,_beg+(
                       parseInt(_options.limit)||_len)),
                _opt = {total:_list.length,range:[_beg,_end]};
            _u._$merge(_opt,_options,_doFilter);
            for(var i=_beg,_instance;i<_end;i++){
                _opt.index = i;
                _opt.data = _list[i];
                _instance = _item._$allocate(_opt);
                var _id = _instance._$getId();
                _cache[_id] = _instance;
                _instance._$recycle =
                _instance._$recycle._$aop(
                    function(_id,_instance){
                        delete _cache[_id];
                        delete _instance._$recycle;
                    }._$bind(null,_id,_instance));
                _arr.push(_instance);
            }
            return _arr;
        };
    })();
    /**
     * 根据ID取列表项对象
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/template/tpl'
     * ],function(_p){
     *     // 通过id拿某一项item
     *     // id是生成item的时候，'itm'+日期字符串生成,存在于_instance.__id变量中
     *     var _item = _p._$getItemById('itm-123');
     * });
     * ```
     *
     * @method module:util/template/tpl._$getItemById
     * @param  {String} arg0 - 列表项
     * @return {module:ui/item/item._$$Item} 列表项实例
     */
    _p._$getItemById = function(_id){
        return _cache[_id];
    };
    /**
     * 解析UI模板集合
     *
     * @method module:util/template/tpl._$parseUITemplate
     * @param  {String} html - 待解析字符串
     * @param  {Object} map  - 模版id的对应map
     * @return {Object} 模版id的map
     */
    _p._$parseUITemplate = (function(){
        var _reg = /#<(.+?)>/;
        return function(_html,_map){ // {abc:'eeee'} // #<abc>
            _map = _map||{};
            var _element = _e._$html2node(_html);
            _u._$forIn(
                _element.getElementsByTagName('textarea'),
                function(_textarea){
                    _textarea.id = (_textarea.id||'').replace(
                        _reg,function($1,$2){
                            var _id = _map[$2];
                            if (!_id){
                                _id = 'tpl-'+_u._$uniqueID();
                                _map[$2] = _id;
                            }
                            return _id;
                        }
                    );
                }
            );
            _p._$parseTemplate(_element);
            return _map;
        };
    })();
    // for chainable method
    _x._$merge({
        _$parseTemplate:_p._$parseTemplate,
        _$addNodeTemplate:_p._$addNodeTemplate
    });

    if (CMPT){
        NEJ.copy(NEJ.P('nej.e'),_p);
    }

    return _p;
},215,2,3,4,239,438,285,14,217);
I$(286,function (NEJ,_k,_e,_u,_t,_t0,_p,_o,_f,_r){
    var _pro;
    /**
     * UI控件基类，框架及项目中所有涉及UI的控件均继承此类
     *
     * 脚本举例
     * ```javascript
     * // 分配控件实例
     * NEJ.define([
     *     'ui/base'
     * ],function(_i,_p,_o,_f,_r){
     *     var ctrl = _i._$allocate({
     *         clazz:'xxx',
     *         parent:document.body
     *     });
     *     ctrl._$appendTo(document.body);
     *     // 如果在分配时传入了parent则这步可省略
     *     ctrl._$appendTo(function(_body){
     *         // 如果需要自定义body插入的位置可以输入函数，返回父容器节点
     *         _parent.insertAdjacentElement('afterBegin',_body);
     *         return _parent;
     *     });
     * });
     * ```
     *
     * @class     module:ui/base._$$Abstract
     * @extends   module:util/event._$$EventTarget
     * @param     {Object}               arg0   - 可选配置参数
     * @property  {String}               clazz  - 控件样式
     * @property  {String|Node|Function} parent -  控件所在容器节点或者追加控件节点执行函数
     */
    _p._$$Abstract = _k._$klass();
    _pro = _p._$$Abstract._$extend(_t._$$EventTarget);
    /**
     * 初始化
     *
     * @protected
     * @method module:ui/base._$$Abstract#__init
     * @return {Void}
     */
    _pro.__init = function(){
        this.__super();
        _e._$dumpCSSText();
        this.__initXGui();
        this.__initNode();
    };
    /**
     * 控件重置
     *
     * @protected
     * @method module:ui/base._$$Abstract#__reset
     * @param  {Object} arg0 - 可选配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        this.__doInitClass(_options.clazz);
        this._$appendTo(_options.parent);
    };
    /**
     * 控件销毁
     *
     * @protected
     * @method module:ui/base._$$Abstract#__destroy
     * @return {Void}
     */
    _pro.__destroy = function(){
        this.__super();
        // clear parent
        this.__doDelParentClass();
        delete this.__parent;
        // clear body
        _e._$removeByEC(this.__body);
        _e._$delClassName(
            this.__body,
            this.__class
        );
        delete this.__class;
    };
    /**
     * 初始化外观信息，子类实现具体逻辑
     *
     * @abstract
     * @method module:ui/base._$$Abstract#__initXGui
     * @return {Void}
     */
    _pro.__initXGui = _f;
    /**
     * 初始化节点，子类重写具体逻辑
     *
     * @protected
     * @method module:ui/base._$$Abstract#__initNode
     * @return {Void}
     */
    _pro.__initNode = function(){
        if (!this.__seed_html){
            this.__initNodeTemplate();
        }
        this.__body = _t0._$getNodeTemplate(this.__seed_html);
        if (!this.__body){
            this.__body = _e._$create('div',this.__seed_css);
        }
        _e._$addClassName(this.__body,this.__seed_css);
    };
    /**
     * 动态构建控件节点模板，子类实现具体逻辑
     *
     * @abstract
     * @method module:ui/base._$$Abstract#__initNodeTemplate
     * @return {Void}
     */
    _pro.__initNodeTemplate = _f;
    /**
     * 添加节点样式
     *
     * @protected
     * @method module:ui/base._$$Abstract#__doInitClass
     * @param  {String} arg0 - 样式名称
     * @return {Void}
     */
    _pro.__doInitClass = function(_clazz){
        this.__class = _clazz||'';
        _e._$addClassName(this.__body,this.__class);
    };
    /**
     * 父节点增加辅助样式
     *
     * @protected
     * @method module:ui/base._$$Abstract#__doAddParentClass
     * @return {Void}
     */
    _pro.__doAddParentClass = function(){
        if (!!this.__seed_css){
            var _arr = this.__seed_css.split(/\s+/);
            _e._$addClassName(
                this.__parent,
                _arr.pop()+'-parent'
            );
        }
    };
    /**
     * 父节点删除辅助样式
     *
     * @protected
     * @method module:ui/base._$$Abstract#__doDelParentClass
     * @return {Void}
     */
    _pro.__doDelParentClass = function(){
        if (!!this.__seed_css){
            var _arr = this.__seed_css.split(/\s+/);
            _e._$delClassName(
                this.__parent,
                _arr.pop()+'-parent'
            );
        }
    };
    /**
     * 取当前控件节点
     *
     * 脚本举例
     * ```javascript
     * // _mask是一个继承了此基类的实例化对象
     * // 获取当前控件的节点
     *   _mask._$getBody();
     * ```
     *
     * @method module:ui/base._$$Abstract#_$getBody
     * @return {Node} 控件节点
     */
    _pro._$getBody = function(){
        return this.__body;
    };
    /**
     * 控件节点追加至容器
     *
     * 脚本举例
     * ```javascript
     * // _mask是一个继承了此基类的实例化对象
     * _mask._$appendTo(document.body);
     * // 还可以传方法
     * _mask._$appendTo(function(_body){
     *    // 根据情况插入节点
     *    var _parent = document.body;
     *    _parent.insertAdjacentElement('afterBegin',_body);
     *    return _parent;
     * });
     * ```
     *
     * @method module:ui/base._$$Abstract#_$appendTo
     * @param  {String|Node|Function} arg0 - 控件所在容器节点
     * @return {Void}
     */
    _pro._$appendTo = function(_parent){
        if (!this.__body) return;
        this.__doDelParentClass();
        if (_u._$isFunction(_parent)){
            this.__parent = _parent(this.__body);
        }else{
            this.__parent = _e._$get(_parent);
            if (!!this.__parent){
                this.__parent.appendChild(this.__body);
            }
        }
        this.__doAddParentClass();
    };
    /**
     * 显示控件
     *
     * 脚本举例
     * ```javascript
     * // _mask是一个继承了此基类的实例化对象
     * _mask._$show();
     * ```
     *
     * @method module:ui/base._$$Abstract#_$show
     * @return {Void}
     */
    _pro._$show = function(){
        if (!this.__parent||!this.__body||
             this.__body.parentNode==this.__parent){
            return;
        }
        this.__parent.appendChild(this.__body);
    };
    /**
     * 隐藏控件
     *
     * 脚本举例
     * ```javascript
     * // _mask是一个继承了此基类的实例化对象
     * _mask._$hide();
     * ```
     *
     * @method module:ui/base._$$Abstract#_$hide
     * @return {Void}
     */
    _pro._$hide = function(){
        _e._$removeByEC(this.__body);
    };

    if (CMPT){
        NEJ.copy(NEJ.P('nej.ui'),_p);
    }

    return _p;
},215,1,4,2,23,233);
I$(648,function (NEJ,_k,_e,_u,_i,_p,_o,_f,_r){
    var _pro;
    /**
     * 弹出层控件基类
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'base/klass',
     *     'base/element',
     *     'ui/layer/layer'
     * ],function(_k,_e,_i0,_p,_o,_f,_r){
     *     // 第一步：继承此基类生成新类
     *     var _seed_css = _e._$pushCSSText('.#<uispace>{position:absolute;background:#fff;}');
     *     _p._$$MyLayer = _k._$klass();
     *     _proMyLayer = _p._$$MyLayer._$extend(_i0._$$Layer);
     *
     *     _proMyLayer.__initXGui = function(){
     *        this.__seed_css = _seed_css;
     *     };
     *
     *     _proMyLayer.__initNode = function(){
     *         this.__super();
     *         // this.__ncnt作为放置卡片内容的容器
     *         this.__ncnt = this.__body;
     *     };
     *
     *
     *     // 最后项目中实例化wrapper的实例
     *      var _ly = _p._$$MyLayerCard._$allocate({
     *         parent:document.body,
     *         // 隐藏浮层时，是否销毁
     *         destroyable:false,
     *         oncontentready:function(_html){
     *           // 设置浮层内容的回调
     *         }
     *     });
     * });
     * // 第二步:实例化一个弹出层
     * // 一般在layerwrapper控件中使用
     * // 因为lopt的有默认配置在layerwrapper中
     * NEJ.define([
     *     'base/klass',
     *     'ui/layer/wrapper/layer',
     *     '/path/custom/to/mylayer.js'
     * ],function(_k,_i0,_i1,_p,_o,_f,_r){
     *     // 下面是对layerwrapper的描述
     *
     *     // 首先：继承layerwrapper基类生成的一个新类
     *     _p._$$MyCardWrapper = _k._$klass();
     *     _proMyCardWrapper = _p._$$MyCardWrapper._$extend
     *     (_i0._$$LayerWrapper);
     *
     *     // 这里返回内容层的实例
     *     _proMyCardWrapper.__getLayerInstance = function(){
     *         return _i1._$$MyLayer._$allocate(this.__lopt);
     *     };
     *
     *     // 这里配置lopt参数，生成内容层用
     *     _proMyCardWrapper.__doInitLayerOptions = function(){
     *         this.__super();
     *         this.__lopt.top = null;
     *         this.__lopt.left = null;
     *     };
     * });
     * ```
     *
     * @class     module:ui/layer/layer._$$Layer
     * @extends   module:ui/base._$$Abstract
     * @param     {Object}      arg0        - 可选配置参数
     * @property  {String|Node} content     - 内容HTML代码或者节点对象
     * @property  {Boolean}     destroyable -调用隐藏时是否自动回收，默认不自动回收
     * @property  {Boolean}     nohack      - 针对IE6不做hack处理
     */
    /**
     * 显示内容准备就绪触发事件
     *
     * @event  module:ui/layer/layer._$$Layer#oncontentready
     * @param  {Node} arg0 - 显示内容的节点
     */
    /**
     * 控件回收前触发事件
     *
     * @event  module:ui/layer/layer._$$Layer#onbeforerecycle
     */
    _p._$$Layer = _k._$klass();
    _pro = _p._$$Layer._$extend(_i._$$Abstract);
    /**
     * 控件重置
     *
     * @protected
     * @method module:ui/layer/layer._$$Layer#__reset
     * @param  {Object} arg0 - 可选配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        this._$setEvent('oncontentready',
                        _options.oncontentready||
                        this.__doInitContent._$bind(this));
        this.__nohack = !!_options.nohack;
        this.__destroyable = !!_options.destroyable;
        this._$setContent(_options.content);
    };
    /**
     * 控件销毁
     *
     * @protected
     * @method module:ui/layer/layer._$$Layer#__destroy
     * @return {Void}
     */
    _pro.__destroy = function(){
        this._$dispatchEvent('onbeforerecycle');
        this.__super();
        this.__doHide();
        this._$setContent('');
        _e._$style(this.__body,{top:'',left:''});
    };
    /**
     * 初始化内容区域，子类实现具体逻辑
     *
     * @abstract
     * @method module:ui/layer/layer._$$Layer#__doInitContent
     * @param  {Node} arg0 - 内容区容器节点
     * @return {Void}
     */
    _pro.__doInitContent = _f;
    /**
     * 调整显示位置，子类实现具体业务逻辑
     *
     * @abstract
     * @method module:ui/layer/layer._$$Layer#__doPositionAlign
     * @return {Void}
     */
    _pro.__doPositionAlign = _f;
    /**
     * 控件隐藏
     *
     * @protected
     * @method module:ui/layer/layer._$$Layer#__doHide
     * @return {Void}
     */
    _pro.__doHide = function(){
        _e._$removeByEC(this.__body);
        if (!!this.__mask){
            _e._$unmask(this.__body);
            delete this.__mask;
        }
    };
    /**
     * 设置层显示内容
     *
     * 脚本举例
     * ```javascript
     * // 设置层里面展示的内容
     * _ly._$setContent('节点或者字符串');
     * ```
     *
     * @method module:ui/layer/layer._$$Layer#_$setContent
     * @param  {String|Node} arg0 - 内容HTML代码或者节点
     * @return {Void}
     */
    _pro._$setContent = function(_content){
        if (!this.__body||
            !this.__ncnt||
            _content==null) return;
        _content = _content||'';
        _u._$isString(_content)
        ? this.__ncnt.innerHTML = _content
        : this.__ncnt.appendChild(_content);
        this._$dispatchEvent('oncontentready',this.__ncnt);
    };
    /**
     * 设置位置
     *
     * 脚本举例
     * ```javascript
     * // 设置浮层位置
     * _ly._$setPosition({top:100,left:200});
     * ```
     *
     * @method module:ui/layer/layer._$$Layer#_$setPosition
     * @param  {Object} arg0 - 位置信息，如{top:100,left:200}
     * @return {Void}
     */
    _pro._$setPosition = function(_offset){
        var _value = _offset.top;
        if (_value!=null){
            _value += 'px';
            _e._$setStyle(this.__body,'top',_value);
            _e._$setStyle(this.__mask,'top',_value);
        }
        var _value = _offset.left;
        if (_value!=null){
            _value += 'px';
            _e._$setStyle(this.__body,'left',_value);
            _e._$setStyle(this.__mask,'left',_value);
        }
    };
    /**
     * 显示控件
     *
     * 脚本举例
     * ```javascript
     * // 显示浮层
     * _ly._$show();
     * ```
     *
     * @method module:ui/layer/layer._$$Layer#_$show
     * @return {Void}
     */
    _pro._$show = function(){
        _e._$setStyle(this.__body,'visibility','hidden');
        this.__super();
        this.__doPositionAlign();
        _e._$setStyle(this.__body,'visibility','');
        if (!this.__nohack){
            this.__mask = _e._$mask(this.__body);
        }
    };
    /**
     * 隐藏控件
     *
     * 脚本举例
     * ```javascript
     * // 隐藏浮层
     * _ly._$hide();
     * ```
     *
     * @method module:ui/layer/layer._$$Layer#_$hide
     * @return {Void}
     */
    _pro._$hide = function(){
        this.__destroyable ? this._$recycle()
                           : this.__doHide();
    };

    if (CMPT){
        NEJ.copy(NEJ.P('nej.ui'),_p);
    }

    return _p;
},215,1,4,2,286);
I$(647,function (NEJ,_k,_e,_u,_i,_i0,_p,_o,_f,_r){
    var _pro;
    /**
     * 弹出层封装基类对象，主要实现层里面内容部分的业务逻辑
     *
     * 脚本举例
     * ```javascript
     * // 第一步：继承此基类生成新类
     * NEJ.define([
     *     'base/element',
     *     'ui/layer/wrapper/layer'
     * ],function(_e,_i0,_p,_o,_f,_r){
     *     var _seed_css = _e._$pushCSSText('.#<uispace>
     *     {position:absolute;background:#fff;}');
     *     _p._$$MyLayer = _k._$klass();
     *     _proMyLayer = _p._$$MyLayer._$extend(_i0._$$Layer);
     *
     *     _proMyLayer.__initXGui = function(){
     *        this.__seed_css = _seed_css;
     *     };
     *
     *     _proMyLayer.__initNode = function(){
     *         this.__super();
     *         // this.__ncnt作为放置卡片内容的容器
     *         this.__ncnt = this.__body;
     *     };
     * });
     * // 下面是对layerwrapper的描述
     * NEJ.define([
     *     'base/klass',
     *     'ui/layer/wrapper/layer',
     *     '/path/custom/to/layer.js'
     * ],function(_k,_i0,_i1,_p,_o,_f,_r){
     *     // 首先：继承layerwrapper基类生成的一个新类
     *     _p._$$MyCardWrapper = _k._$klass();
     *     _proMyCardWrapper = _p._$$MyCardWrapper._$extend(_i0.
     *     _$$LayerWrapper);
     *
     *     // 这里返回内容层的实例
     *     _proMyCardWrapper.__getLayerInstance = function(){
     *         return _i1._$$MyLayer._$allocate(this.__lopt);
     *     };
     *
     *     // 这里配置lopt参数，生成内容层用
     *     _proMyCardWrapper.__doInitLayerOptions = function(){
     *         this.__super();
     *         this.__lopt.top = null;
     *         this.__lopt.left = null;
     *     };
     *
     *     // 最后项目中实例化wrapper的实例
     *      var _ly = _p._$$MyLayerCard._$allocate({
     *         parent:document.body,
     *         // 隐藏浮层时，是否销毁
     *         destroyable:false,
     *         oncontentready:function(_html){
     *           // 设置浮层内容的回调
     *         }
     *     });
     * });
     * ```
     *
     * @class   module:ui/layer/wrapper/layer._$$LayerWrapper
     * @extends module:ui/base._$$Abstract
     * @param   {Object} arg0 - 可选配置参数
     *
     */
    _p._$$LayerWrapper = _k._$klass();
    _pro = _p._$$LayerWrapper._$extend(_i._$$Abstract);
    /**
     * 控件重置
     *
     * @protected
     * @method module:ui/layer/wrapper/layer._$$LayerWrapper#__reset
     * @param  {Object} arg0 - 可选配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__doInitLayerOptions();
        this.__super(this
            .__doFilterOptions(_options));
        this.__lopt.onbeforerecycle =
            this._$recycle._$bind(this);
        this.__layer = this.__getLayerInstance();
    };
    /**
     * 控件销毁
     *
     * @protected
     * @method module:ui/layer/wrapper/layer._$$LayerWrapper#__destroy
     * @return {Void}
     */
    _pro.__destroy = function(){
        this._$dispatchEvent('onbeforerecycle');
        this.__super();
        delete this.__lopt;
        _e._$removeByEC(this.__body);
        var _layer = this.__layer;
        if (!!_layer){
            delete this.__layer;
            _layer._$recycle();
        }
    };
    /**
     * 构建弹层控件实例，子类实现具体业务逻辑
     *
     * @abstract
     * @method module:ui/layer/wrapper/layer._$$LayerWrapper#__getLayerInstance
     * @return {nej.ui._$$Layer} 弹层控件实例
     */
    _pro.__getLayerInstance = _f;
    /**
     * 将配置参数拆分为两部分，一部分用于弹层控件，一部分用于本控件
     *
     * @protected
     * @method module:ui/layer/wrapper/layer._$$LayerWrapper#__doFilterOptions
     * @param  {Object} arg0 - 可选配置参数
     * @return {Object} 过滤后的配置参数
     */
    _pro.__doFilterOptions = function(_options){
        var _result = {};
        _u._$loop(_options,
            function(_item,_key){
                this.__lopt.hasOwnProperty(_key)
                ? this.__lopt[_key] = _item
                : _result[_key] = _item;
            },this);
        return _result;
    };
    /**
     * 初始化弹层控件可选配置参数
     *
     * @protected
     * @method module:ui/layer/wrapper/layer._$$LayerWrapper#__doInitLayerOptions
     * @return {Void}
     */
    _pro.__doInitLayerOptions = function(){
        this.__lopt = {
            clazz:''
           ,parent:null
           ,content:this.__body
           ,destroyable:!1
           ,oncontentready:null
           ,nohack:!1
        };
    };
    /**
     * 显示弹层
     *
     * 脚本举例
     * ```javascript
     * // 显示浮层
     * _ly._$show();
     * ```
     *
     * @method module:ui/layer/wrapper/layer._$$LayerWrapper#_$show
     * @return {Void}
     */
    _pro._$show = function(){
        if (!!this.__layer)
            this.__layer._$show();
        this._$dispatchEvent('onaftershow');
    };
    /**
     * 隐藏弹层
     *
     * 脚本举例
     * ```javascript
     * // 隐藏弹层
     * _ly._$hide();
     * ```
     *
     * @method module:ui/layer/wrapper/layer._$$LayerWrapper#_$hide
     * @return {Void}
     */
    _pro._$hide = function(){
        if (!!this.__layer)
            this.__layer._$hide();
    };

    if (CMPT){
        NEJ.copy(NEJ.P('nej.ui'),_p);
    }

    return _p;
},215,1,4,2,286,648);
I$(630,function (_t){return _t;},647);
I$(665,".#<uispace>{position:fixed;_position:absolute;z-index:100;top:0;bottom:0;left:0;right:0;width:100%;height:100%;background-image:url(#<blankimage>);}");
I$(649,function (NEJ,_k,_g,_e,_u,_i,_css,_p,_o,_f,_r){
    var _pro,
        _seed_css = _e._$pushCSSText(_css,{blankimage:_g._$BLANK_IMAGE});
    /**
     * 盖层控件
     *
     * 页面结构举例
     * ```html
     * <style type="text/css">
     *     .box{position:relative;}
     * </style>
     * <div id="mask-box" class="box"></div>
     * ```
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'ui/maks/mask'
     * ],function(_i0,_p,_o,_f,_r){
     *     var _mask = _i0._$$Mask._$allocate({
     *         parent:document.body,
     *         content:'<div style="width:100px;height:100px;margin:0 auto;margin-top:150px;">搞一点盖层的内容</div>'
     *     });
     * });
     * ```
     *
     * @class     module:ui/maks/mask._$$Mask
     * @extends   module:ui/base._$$Abstract
     * @param     {Object}      arg0    - 可选配置参数
     * @property  {String|Node} content - 内容节点或者HTML代码
     */
    _p._$$Mask = _k._$klass();
    _pro = _p._$$Mask._$extend(_i._$$Abstract);
    /**
     * 控件重置
     *
     * @protected
     * @method module:ui/maks/mask._$$Mask#__reset
     * @param  {Object} arg0 - 可选配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        var _content = _options.content||'&nbsp;';
        _u._$isString(_content)
        ? this.__body.innerHTML = _content
        : this.__body.appendChild(_content);
    };
    /**
     * 控件销毁
     *
     * @protected
     * @method module:ui/maks/mask._$$Mask#__destroy
     * @return {Void}
     */
    _pro.__destroy = function(){
        this.__super();
        this.__body.innerHTML = '&nbsp;';
    };
    /**
     * 初始化外观
     *
     * @protected
     * @method module:ui/maks/mask._$$Mask#__initXGui
     * @return {Void}
     */
    _pro.__initXGui = function(){
        this.__seed_css = _seed_css;
    };
    /**
     * 显示盖层
     *
     * ```javascript
     * // 先隐藏盖层
     * _mask._$hide();
     * // 显示盖层
     * _mask._$show();
     * ```
     *
     * @method module:ui/maks/mask._$$Mask#_$show
     * @return {Void}
     */
    _pro._$show = function(){
        _e._$fullScreen(this.__body);
        this.__super();
    };

    if (CMPT){
        NEJ.copy(NEJ.P('nej.ui'),_p);
    }

    return _p;
},215,1,227,4,2,286,665);
I$(650,function (NEJ,_k,_e,_v,_t,_p,_o,_f,_r,_pro){
    /**
     * 区域移动功能封装
     * 
     * 结构举例
     * ```html
     * <div id="box"></div>
     * ```
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/dragger/dragger'
     * ],function(_t){
     *     var _dragger = _t._$$Draggable._$allocate({
     *         body:'box',
     *         overflow:false,
     *         direction:0,
     *         onchange:function(_event){
     *             // 拖动回调获取位置信息
     *             var _postion = this._$getPosition();
     *         },
     *         ondragend:function(_event){
     *             // 拖动结束，返回当前位置，或者用_$getPosition接口取到当前位置信息
     *             var _postion = this._$getPosition();
     *         }
     *     });
     * });
     * ```
     * 
     * @class    module:util/dragger/dragger._$$Draggable
     * @extends  module:util/event._$$EventTarget
     * 
     * @param    {Object}      config    - 可选配置参数
     * @property {Node}        view      - 视窗节点，默认为documentElement或body节点
     * @property {String|Node} body      - 移动控件节点
     * @property {String|Node} mbar      - 触发移动节点ID或者对象，默认为body参数输入节点
     * @property {Boolean}     overflow  - 是否允许超出view范围
     * @property {Number}      direction - 移动方向，默认为0，0-水平+垂直、1-水平、2-垂直
     */
    /**
     * 位置变化之前触发事件
     * 
     * @event    module:util/dragger/dragger._$$Draggable#onbeforechange
     * @param    {Object} event - 位置信息
     * @property {Number} top   - 离父节点顶部距离
     * @property {Number} left  - 离父节点左边距离
     */
    /**
     * 位置变化触发事件
     * 
     * @event    module:util/dragger/dragger._$$Draggable#onchange
     * @param    {Object} event - 位置信息
     * @property {Number} top   - 离父节点顶部距离
     * @property {Number} left  - 离父节点左边距离
     */
    /**
     * 拖拽结束触发事件
     * 
     * @event    module:util/dragger/dragger._$$Draggable#ondragend
     * @param    {Object} event - 位置信息
     * @property {Number} top   - 离父节点顶部距离
     * @property {Number} left  - 离父节点左边距离
     */
    _p._$$Draggable = _k._$klass();
    _pro = _p._$$Draggable._$extend(_t._$$EventTarget);
    /**
     * 控件重置
     * 
     * @protected
     * @method module:util/dragger/dragger._$$Draggable#__reset
     * @param  {Object} arg0 - 可选配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        this.__overflow = !!_options.overflow;
        this.__body = _e._$get(_options.body);
        this.__mbar = _e._$get(_options.mbar)||this.__body;
        this.__view = _e._$get(_options.view)||_e._$getPageBox();
        this.__direction = parseInt(_options.direction)||0;
        this.__doInitDomEvent([[
            document,'mouseup',
            this.__onDragEnd._$bind(this)
        ],[
            document,'mousemove',
            this.__onDragging._$bind(this)
        ],[
            this.__mbar,'mousedown',
            this.__onDragStart._$bind(this)
        ]]);
    };
    /**
     * 控件销毁
     * 
     * @protected
     * @method module:util/dragger/dragger._$$Draggable#__destroy
     * @return {Void}
     */
    _pro.__destroy = function(){
        this.__super();
        delete this.__body;
        delete this.__mbar;
        delete this.__view;
    };
    /**
     * 取移动的最大范围
     * 
     * @protected
     * @method module:util/dragger/dragger._$$Draggable#__getMaxRange
     * @return {Object} 范围值
     */
    _pro.__getMaxRange = function(){
        return {
            x:this.__view.clientWidth-this.__body.offsetWidth,
            y:this.__view.clientHeight-this.__body.offsetHeight
        };
    };
    /**
     * 开始移动
     * 
     * @protected
     * @method module:util/dragger/dragger._$$Draggable#__onDragStart
     * @param  {Event} arg0 - 事件对象
     * @return {Void}
     */
    _pro.__onDragStart = function(_event){
        _v._$stop(_event);
        if (!!this.__offset) return;
        this.__offset = {
            x:_v._$pageX(_event),
            y:_v._$pageY(_event)
        };
        this.__maxbox = this.__getMaxRange();
    };
    /**
     * 移动过程
     * 
     * @protected
     * @method module:util/dragger/dragger._$$Draggable#__onDragging
     * @param  {Event} arg0 - 事件对象
     * @return {Void}
     */
    _pro.__onDragging = function(_event){
        if (!this.__offset) return;
        var _offset = {
            x:_v._$pageX(_event),
            y:_v._$pageY(_event)
        };
        var _deltax = _offset.x-this.__offset.x,
            _deltay = _offset.y-this.__offset.y,
            _top = parseInt(_e._$getStyle(this.__body,'top'))||0,
            _left = parseInt(_e._$getStyle(this.__body,'left'))||0,
            _value  = {
                top:_top+_deltay,
                left:_left+_deltax
            };
        this.__offset = _offset;
        this._$setPosition(_value);
    };
    /**
     * 结束移动
     * 
     * @protected
     * @method module:util/dragger/dragger._$$Draggable#__onDragEnd
     * @param  {Event} arg0 - 事件对象
     * @return {Void}
     */
    _pro.__onDragEnd = function(_event){
        if (!this.__offset) return;
        delete this.__maxbox;
        delete this.__offset;
        this._$dispatchEvent('ondragend',this._$getPosition());
    };
    /**
     * 设置位置
     * 
     * 脚本举例
     * ```javascript
     * // 在允许范围内设置盒子的位置
     * _dragger._$setPosition({top:100,left:100});
     * ```
     * 
     * @method   module:util/dragger/dragger._$$Draggable#_$setPosition
     * @param    {Object} arg0 - 位置信息
     * @property {Number} top  - 垂直位置
     * @property {Number} left - 水平位置
     * @return   {Void}
     */
    _pro._$setPosition = function(_event){
        if (!this.__overflow){
            var _maxbox = this.__maxbox||
                          this.__getMaxRange();
            _event.top  = Math.min(_maxbox.y,
                          Math.max(0,_event.top));
            _event.left = Math.min(_maxbox.x,
                          Math.max(0,_event.left));
        }
        this._$dispatchEvent('onbeforechange',_event);
        var _style  = this.__body.style;
        if (this.__direction==0||
            this.__direction==2)
            _style.top  = _event.top+'px';
        if (this.__direction==0||
            this.__direction==1)
            _style.left = _event.left+'px';
        this._$dispatchEvent('onchange',_event);
    };
    /**
     * 取当前位置
     * 
     * 脚本举例
     * ```javascript
     * _dragger._$getPosition();
     * ```
     * 
     * @method module:util/dragger/dragger._$$Draggable#_$getPosition
     * @return {Object} 当前位置，{top:100,left:100}
     */
    _pro._$getPosition = function(){
        return {
            left:parseInt(_e._$getStyle(this.__body,'left'))||0,
            top:parseInt(_e._$getStyle(this.__body,'top'))||0
        };
    };
    // alias for draggable
    _p._$$Dragger = _p._$$Draggable;

    if (CMPT){
        NEJ.copy(NEJ.P('nej.ut'),_p);
    }

    return _p;
},215,1,4,3,23);
I$(651,".#<uispace>{position:absolute;z-index:1000;border:1px solid #aaa;background:#fff;}\n.#<uispace> .zbar{line-height:30px;background:#8098E7;border-bottom:1px solid #aaa;}\n.#<uispace> .zcnt{padding:10px 5px;}\n.#<uispace> .zttl{margin-right:20px;text-align:left;}\n.#<uispace> .zcls{position:absolute;top:5px;right:0;width:20px;height:20px;line-height:20px;cursor:pointer;}\n");
I$(652,"<div>\n  <div class=\"zbar\"><div class=\"zttl\">标题</div></div>\n  <div class=\"zcnt\"></div>\n  <span class=\"zcls\" title=\"关闭窗体\">×</span>\n</div>");
I$(631,function (NEJ,_k,_e,_v,_u,_i0,_i1,_t0,_t1,_css,_html,_p,_o,_f,_r){
    var _seed_css = _e._$pushCSSText(_css),
        _seed_html = _t1._$addNodeTemplate(_html),
        _pro;
    /**
     * 窗体控件
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'ui/layer/window'
     * ],function(_i0,_p,_o,_f,_r){
     *     var _window = _i0._$$Window._$allocate({
     *         parent:document.body,
     *         title:'弹出框标题',
     *         align:'left middle',
     *         draggable:true,
     *         onclose:function(){
     *           // 窗口关闭前的回调方法
     *         }
     *     });
     *     // 显示窗口，默认实例化后会显示，如果_$hide()后需要手动调用
     *     _window._$show();
     * });
     * ```
     *
     * @class     module:ui/layer/window._$$Window 窗体控件
     * @extends   module:ui/layer/layer._$$Layer
     * @param     {Object} arg0       - 可选配置参数
     * @property  {String} title      -  窗口标题
     * @property  {String} align      -   相对于视窗位置定义，横向+空格+纵向，默认为center middle
     * |        横向             |             纵向           |
     * |        :---             |             :---           |
     * | left/center/right/auto  |    top/middle/bottom/auto  |
     * @property  {Boolean} draggable - 是否可拖拽
     * @property  {nej.ui._$$Mask|Boolean|String} mask  -     盖层信息
     * |        mask参数             |             含义   |
     * |        :---                 |             :---   |
     * | 如果是nej.ui._$$Mask的子类  |    则为盖层构造    |
     * | 如果是布尔值                |    则使用默认盖层  |
     * | 如果是字符串                |    则为盖层样式    |
     */
    /**
     * 关闭窗体触发事件
     *
     * @event  module:ui/layer/window._$$Window#onclose
     *
     */
    _p._$$Window = _k._$klass();
    _pro = _p._$$Window._$extend(_i0._$$Layer);
    /**
     * 控件初始化
     *
     * @protected
     * @method module:ui/layer/window._$$Window#__init
     * @return {Void}
     */
    _pro.__init = function(){
        this.__mopt = {};
        this.__dopt = {onchange:this.__onDragging._$bind(this)};
        this.__super();
    };
    /**
     * 控件重置
     *
     * @protected
     * @method module:ui/layer/window._$$Window#__reset
     * @param  {Object} arg0 - 可选配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        this.__setMask(_options.mask);
        this._$setAlign(_options.align);
        this._$setTitle(_options.title);
        if (!_options.draggable) return;
        this.__dragger = _t0._$$Dragger.
                         _$allocate(this.__dopt);
    };
    /**
     * 控件销毁
     *
     * @protected
     * @method module:ui/layer/window._$$Window#__destroy
     * @return {Void}
     */
    _pro.__destroy = function(){
        this.__super();
        delete this.__align;
        delete this.__mclz;
        if (!!this.__imask){
            this.__imask._$recycle();
            delete this.__imask;
        }
        if (!!this.__dragger){
            this.__dragger._$recycle();
            delete this.__dragger;
        }
    };
    /**
     * 初始化外观信息
     *
     * @protected
     * @method module:ui/layer/window._$$Window#__initXGui
     * @return {Void}
     */
    _pro.__initXGui = function(){
        this.__seed_css = _seed_css;
        this.__seed_html= _seed_html;
    };
    /**
     * 初始化节点
     *
     * @protected
     * @method module:ui/layer/window._$$Window#__initNode
     * @return {Void}
     */
    _pro.__initNode = function(){
        this.__super();
        // 0 - move bar
        // 1 - content box
        // 2 - close btn
        var _list = _e._$getChildren(this.__body);
        this.__ncnt = _list[1];
        this.__dopt.mbar = _list[0];
        this.__dopt.body = this.__body;
        _v._$addEvent(_list[2],'mousedown',
                      this.__onClose._$bind(this));
        _v._$addEvent(this.__dopt.mbar,'mousedown',
                      this.__onDragStart._$bind(this));
        this.__nttl = _e._$getChildren(this.__dopt.mbar)[0];
    };
    /**
     * 关闭窗口
     *
     * @protected
     * @method module:ui/layer/window._$$Window#__onClose
     * @param  {Event} arg0 - 事件对象
     * @return {Void}
     */
    _pro.__onClose = function(_event){
        _v._$stop(_event);
        this._$dispatchEvent('onclose');
        this._$hide();
    };
    /**
     * 窗口开始拖动过程
     *
     * @protected
     * @method module:ui/layer/window._$$Window#__onDragStart
     * @param  {Event} arg0 - 事件信息
     * @return {Void}
     */
    _pro.__onDragStart = function(_event){
        _v._$dispatchEvent(document,'click');
    };
    /**
     * 窗口拖动过程
     *
     * @protected
     * @method module:ui/layer/window._$$Window#__onDragging
     * @param  {Object} arg0 - 窗口位置信息
     * @return {Void}
     */
    _pro.__onDragging = function(_event){
        if (!this.__mask) return;
        _e._$style(this.__mask,{
            top:_event.top+'px',
            left:_event.left+'px'
        });
    };
    /**
     * 窗口位置调整
     *
     * @protected
     * @method module:ui/layer/window._$$Window#__doPositionAlign
     * @return {Void}
     */
    _pro.__doPositionAlign = (function(){
        var _func = [function(){return 0;},
                     function(_scroll,_delta,_key){
                         return Math.max(0,_scroll[_key]+_delta[_key]/2);
                     },
                     function(_scroll,_delta,_key){
                         return _scroll[_key]+_delta[_key];
                     }],
            _keys = ['left','top'];
        return function(){
            var _value = {},
                _style = this.__body.style,
                _view  = _e._$getPageBox(),
                _scroll= {left:_view.scrollLeft,top:_view.scrollTop},
                _delta = {left:_view.clientWidth-this.__body.offsetWidth
                         ,top:_view.clientHeight-this.__body.offsetHeight};
            _u._$forEach(_keys,
                function(_key,_index){
                    var _handler = _func[this.__align[_index]];
                    if (!_handler) return;
                    _value[_key] = _handler(_scroll,_delta,_key);
                },this);
            this._$setPosition(_value);
        };
    })();
    /**
     * 显示盖层
     *
     * @protected
     * @method module:ui/layer/window._$$Window#__doShowMask
     * @return {Void}
     */
    _pro.__doShowMask = function(){
        if (!this.__imask){
            if (!this.__mclz) return;
            this.__mopt.parent = this.__parent;
            this.__imask = this.__mclz
                ._$allocate(this.__mopt);
        }
        this.__imask._$show();
    };
    /**
     * 隐藏窗体
     *
     * @protected
     * @method module:ui/layer/window._$$Window#__doHide
     * @return {Void}
     */
    _pro.__doHide = function(){
        if (!!this.__imask)
            this.__imask._$hide();
        this.__super();
    };
    /**
     * 设置盖层构造
     *
     * @protected
     * @method module:ui/layer/window._$$Window#__setMask
     * @param  {nej.ui._$$Mask|Boolean} arg0 - 盖层构造
     * @return {Void}
     */
    _pro.__setMask = function(_mask){
        if (!!_mask){
            if (_mask instanceof _i1._$$Mask){
                this.__imask = _mask;
                return;
            }
            if (_u._$isFunction(_mask)){
                this.__mclz = _mask;
                return;
            }
            this.__mclz = _i1._$$Mask;
            if (_u._$isString(_mask))
                this.__mopt.clazz = _mask;
            return;
        }
        this.__mclz = null;
    };
    /**
     * 设置标题
     *
     * 脚本举例
     * ```javascript
     * _window._$setTitle('设置浮层标题');
     * ```
     *
     * @method module:ui/layer/window._$$Window#_$setTitle
     * @param  {String} arg0 - 标题
     * @return {nej.ui._$$Window}
     */
    _pro._$setTitle = function(_title,_html){
        if (!!this.__nttl){
            var _method = !_html?'innerText':'innerHTML';
            this.__nttl[_method] = _title||'标题';
        }
        return this;
    };
    /**
     * 设置窗体对齐方式
     *
     * 脚本举例
     * ```javascript
     * // 设置对齐方式，默认是center,middle
     * _window._$setAlign();
     * ```
     *
     * @method module:ui/layer/window._$$Window#_$setAlign
     * @param  {String} arg0 - 对齐方式
     * @return {nej.ui._$$Window}
     */
    _pro._$setAlign = (function(){
        var _reg = /\s+/,
            _halign = {left:0,center:1,right:2,auto:3},
            _valign = {top:0,middle:1,bottom:2,auto:3};
        return function(_align){
            this.__align = (_align||'').split(_reg);
            var _tmp = _halign[this.__align[0]];
            if (_tmp==null) _tmp = 1;
            this.__align[0] = _tmp;
            var _tmp = _valign[this.__align[1]];
            if (_tmp==null) _tmp = 1;
            this.__align[1] = _tmp;
            return this;
        };
    })();
    /**
     * 显示窗体
     *
     * 脚本举例
     * ```javascript
     * _window._$show();
     * ```
     *
     * @method module:ui/layer/window._$$Window#_$show
     * @return {nej.ui._$$Window}
     */
    _pro._$show = function(){
        this.__super();
        this.__doShowMask();
        return this;
    };

    if (CMPT){
        NEJ.copy(NEJ.P('nej.ui'),_p);
    }

    return _p;
},215,1,4,3,2,648,649,650,233,651,652);
I$(589,function (NEJ,_k,_i0,_i1,_p,_o,_f,_r){
    var _pro;
    /**
     * 弹出窗体封装基类对象，主要实现层里面内容部分的业务逻辑
     *
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'base/klass',
     *     'util/template/tpl',
     *     'ui/layer/wrapper/window',
     *     'text!./mywindow.html'
     * ],function(_k,_t,_l,_html,_p,_o,_f,_r){
     *     var _pro;
     *     // 第一步：继承此类，生成一个新类
     *     _p._$$MyWindow = _k._$klass();
     *     _pro = _p._$$MyWindow._$extend(_l._$$WindowWrapper);
     *     // 生成窗体的展示内容
     *     _pro.__initXGui = (function(){
     *         var _seed_html = _t._$addNodeTemplate(_html);
     *         return function(){
     *             this.__seed_html = _seed_html;
     *         };
     *     }
     * })();
     *
     * NEJ.define([
     *     '/path/custom/to/mywindow.js'
     * ],function(_i0,_p,_o,_f,_r){
     *     // 第二步:实例化一个窗体控件
     *     var _myCard = _i0._$$MyWindow._$allocate({
     *         parent:document.body,
     *         title:'窗口标题',
     *         draggable:false,
     *         // 是否有盖层
     *         mask:true,
     *         onclose:function(){
     *           // 关闭窗口的回调
     *         }
     *     });
     * });
     * ```
     *
     * @class   module:ui/layer/wrapper/window._$$WindowWrapper
     * @extends module:ui/layer/wrapper/layer._$$LayerWrapper
     * @param   {Object} arg0 - 可选配置参数
     *
     */
    _p._$$WindowWrapper = _k._$klass();
    _pro = _p._$$WindowWrapper._$extend(_i0._$$LayerWrapper);
    /**
     * 构建弹层控件实例，子类实现具体业务逻辑
     *
     * @protected
     * @method module:ui/layer/wrapper/window._$$WindowWrapper#__getLayerInstance
     * @return {module:ui/layer/layer._$$Layer} 弹层控件实例
     */
    _pro.__getLayerInstance = function(){
        return _i1._$$Window._$allocate(this.__lopt);
    };
    /**
     * 初始化弹层控件可选配置参数
     *
     * @protected
     * @method module:ui/layer/wrapper/window._$$WindowWrapper#__doInitLayerOptions
     * @return {Void}
     */
    _pro.__doInitLayerOptions = function(){
        this.__super();
        this.__lopt.mask  = null;
        this.__lopt.title = '标题';
        this.__lopt.align = '';
        this.__lopt.draggable = !1;
        this.__lopt.onclose = null;
    };

    if (CMPT){
        NEJ.copy(NEJ.P('nej.ui'),_p);
    }

    return _p;
},215,1,630,631);
I$(447,function (_t){return _t;},589);
I$(234,function (NEJ,_k,_u,_t0,_p,_o,_f,_r){
    // variable declaration
    var _pro;
    /**
     * 先慢后快动画
     * 
     * 结构举例
     * ```html
     * <div id='id-bounce1'></div>
     * ```
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/animation/easein'
     * ],function(_t){
     *     // 创建动画实例
     *     var _easein  = _t._$$AnimEaseIn._$allocate({
     *         from:{
     *             offset:100
     *         },
     *         to:{
     *             offset:200
     *         },
     *         duration:1000,
     *         onupdate:function(_event){
     *             _box.style.left = _event.offset + 'px';
     *         },
     *         onstop:function(){
     *             this._$recycle();
     *         }
     *     });
     *     // 开始动画
     *     _easein._$play();
     * });
     * ```
     * 
     * @class   module:util/animation/easein._$$AnimEaseIn
     * @extends module:util/animation/bezier._$$AnimBezier
     * 
     * @param   {Object} config 可选配置参数
     */
    _p._$$AnimEaseIn = _k._$klass();
    _pro = _p._$$AnimEaseIn._$extend(_t0._$$AnimBezier);
    /**
     * 控件重置
     * 
     * @protected
     * @method module:util/animation/easein._$$AnimEaseIn#__reset
     * @param  {Object} arg0 - 可选配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        _options = _u._$merge({},_options);
        _options.timing = 'easein';
        this.__super(_options);
    };

    if (CMPT){
        NEJ.copy(NEJ.P('nej.ut'),_p);
    }

    return _p;
},215,1,2,96);
I$(138,function (NEJ,_k,_u,_t0,_p,_o,_f,_r){
    // variable declaration
    var _pro;
    /**
     * 先快后慢动画
     * 
     * 结构举例
     * ```html
     * <div id='id-bounce1'></div>
     * ```
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/animation/easeout'
     * ],function(_t){
     *     // 创建动画实例
     *     var _easeout  = _t._$$AnimEaseOut._$allocate({
     *         from:{
     *             offset:100
     *         },
     *         to:{
     *             offset:200
     *         },
     *         duration:1000,
     *         onupdate:function(_event){
     *             _box.style.left = _event.offset + 'px';
     *         },
     *         onstop:function(){
     *             this._$recycle();
     *         }
     *     });
     *     // 开始动画
     *     _easeout._$play();
     * });
     * ```
     * 
     * @class   module:util/animation/easeout._$$AnimEaseOut
     * @extends module:util/animation/bezier._$$AnimBezier
     * 
     * @param   {Object} config 可选配置参数
     */
    _p._$$AnimEaseOut = _k._$klass();
    _pro = _p._$$AnimEaseOut._$extend(_t0._$$AnimBezier);
    /**
     * 控件重置
     * 
     * @protected
     * @method module:util/animation/easeout._$$AnimEaseOut#__reset
     * @param  {Object} arg0 - 可选配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        _options = _u._$merge({},_options);
        _options.timing = 'easeout';
        this.__super(_options);
    };

    if (CMPT){
        NEJ.copy(NEJ.P('nej.ut'),_p);
    }

    return _p;
},215,1,2,96);
I$(229,function (_k,_i,_t,_t1,_p, _o, _f, _r,_pro){
    // variable
    var _   = NEJ.P,
        _i  = _('nej.ui'),
        _pro,_sup;
    /**
     * 项目窗体基类
     * 
     * @class   {nm.l._$$AWWindow}
     * @extends {nej.ui._$$WindowWrapper}
     * 
     * @param   {}
     */
    _p._$$AWWindow = _k._$klass();
    _pro = _p._$$AWWindow._$extend(_i._$$WindowWrapper);
    _sup = _p._$$AWWindow._$supro;
    /**
     * 控件重置
     * @param {Object} _options
     */
    _pro.__reset = function(_options){
        _options.parent = _options.parent||document.body;
        //iDialogAniCore iDialogAnimate5 css3动画Class
        _options.clazz = (_options.clazz||'') +  ' m-window iDialogAniCore iDialogAnimate5';
        _options.mask = 'm-mask'; 
        this.__supReset(_options);

        var _layerHide = this.__layer._$hide;
        this.__layer._$hide = function(){
        	nej.e._$addClassName(this.__layer.__body, 'iDialogAnimate5')
        	window.setTimeout(function(){
                _layerHide.apply(this.__layer);
            }._$bind(this), 350);
        }._$bind(this)
        this.__layer._$setTitle(_options.title,true);
        // this.__width = _options.width;
    };
    
    _pro.__doAnimation = function(){
    	nej.e._$delClassName(this.__layer.__body, 'iDialogAnimate5')
        // window.setTimeout(_layerHide, 350);
    };
    
    _pro._$hide = function(){
        this.__super();
    	console.log('hide')
    };
    _pro.__doHide = function(){
    	var _callback = this.__super.bind(this);
        var _easeout  = _t1._$$AnimEaseOut._$allocate({
            from:{
                offset:400
            },
            to:{
                offset:0
            },
            duration:1000,
            onupdate:function(_event){
            	this.__body.parentNode.parentNode.style.width = _event.offset + 'px';
                this.__layer.__doPositionAlign();
            },
            onstop:function(){
                this._$recycle();
                _callback();
            }
        });
        // 开始动画
        _easeout._$play();
    };
    
    /**
     * 显示窗体
     */
    _pro._$show = function(){
        _sup._$show.apply(this,arguments);
        this.__body.focus();
        this.__doAnimation();
        return this;
    };
    
    return _p._$$AWWindow;
},1,447,234,138);
I$(230,".#<uispace> .testloginwin{curosr:auto;}\n");
I$(231,"<div class=\"iDialogBody\">\n\t<div class=\"iDialogMain j-flag\" style=\"width:auto;\">\n\t\t<div class=\"loginForm\">\n\t\t<div id=\"loginbox\" class=\"ph-loading\" style=\"min-height:237px;\"></div>\n\t\t<ul class=\"formList\" style=\"width:auto;\">\n\t\t\t<li class=\"regtip\">\n\t\t\t\t<em>没有网易邮箱？&nbsp;<a class=\"j-flag\" href=\"javascript:;\" target=\"_blank\">立即免费注册&gt;&gt;</a></em>\n\t\t\t</li>\n\t\t</ul>\n\t\t<ul class=\"m-thirdpart clearfix\">\n            <li class=\"text\">使用第三方账号登录：</li>\n            <li class=\"wx\">\n            \t<a href=\"http://reg.163.com/outerLogin/oauth2/connect.do?target=13&scope=snsapi_login&domains=global.163.com&product=kaola&url2=http%3A%2F%2Fglobal.163.com%2Furs%2Fredirect.html&url=http%3A%2F%2Fglobal.163.com%2Furs%2Fredirect.html\" class=\"j-flag\">\n            \t\t<i class=\"w-icon w-icon-28\"></i>\n            \t</a>\n            </li>\n            <li class=\"zfb\">\n            \t<a href=\"http://reg.163.com/outerLogin/oauth2/aliPayFastLogin.do?product=kaola&redirect_error=http%3A%2F%2Fglobal.163.com%2Furs%2Fredirect.html&redirect_url=http%3A%2F%2Fglobal.163.com%2Furs%2Fredirect.html\" class=\"j-flag\">\n            \t\t<i class=\"w-icon w-icon-28 w-icon-28-1\"></i>\n            \t</a>\n            </li>\n            <li class=\"wb\">\n            \t<a href=\"http://reg.163.com/outerLogin/oauth2/connect.do?product=kaola&url2=http%3A%2F%2Fglobal.163.com%2Furs%2Fredirect.html&domains=global.163.com&target=3&url=http%3A%2F%2Fglobal.163.com%2Furs%2Fredirect.html\" class=\"j-flag\">\n            \t\t<i class=\"w-icon w-icon-28 w-icon-28-2\"></i>\n            \t</a>\n            </li>\n            <li class=\"qq\">\n            \t<a href=\"http://reg.163.com/outerLogin/oauth2/connect.do?product=kaola&url2=http%3A%2F%2Fglobal.163.com%2Furs%2Fredirect.html&domains=global.163.com&target=1&url=http%3A%2F%2Fglobal.163.com%2Furs%2Fredirect.html\" class=\"j-flag\">\n            \t\t<i class=\"w-icon w-icon-28 w-icon-28-3\"></i>\n            \t</a>\n            </li>\n        </ul>\n\t</div>\n</div>");
I$(235,function (ut,_ut,_,_tag,_p,_o,_f,_r,_pro) {
        //预先加载所需要的JS，避免展示iframe过程中等待时间过长
        var _version = _ut._$format(new Date(), 'yyyyMMddHH')+_ut._$randNumberString(6);
        var jsurl = location.protocol + '//ursdoccdn.nosdn.127.net/webzj/message_20161017.js';
        _tag._$queueScript([jsurl],{
//            version:_version,
            onerror: function(){
                window['_gaq'] && window['_gaq'].push(['_trackEvent', '前端报错信息', 'PC', 'URS-js全站加载失败']);
                window._dapush && window._dapush('_trackEvent', '前端报错信息', 'PC', 'URS-js全站加载失败');
            }
        });

        _p._$$URSLoginModule = NEJ.C();
        pro = _p._$$URSLoginModule._$extend(ut._$$EventTarget);

        pro.__init = function(_options) {
            this.__supInit(_options);
            var jsurl = location.protocol + '//ursdoccdn.nosdn.127.net/webzj/message_20161017.js';
            //加载URS-JS  http://doc.hz.netease.com/pages/viewpage.action?pageId=53580199#
            if(window.URS){
                this.__initURS();
            }else{
                _tag._$queueScript([jsurl], {
//                    version:_version,
                    onload: function(){
                        this.__initURS();
                    }._$bind(this),
                    onerror: function(){
                        window['_gaq'] && window['_gaq'].push(['_trackEvent', '前端报错信息', 'PC', 'URS-js弹窗加载失败']);
                        window._dapush && window._dapush('_trackEvent', '前端报错信息', 'PC', 'URS-js弹窗加载失败');
                    }
                })
            }
        };

        pro.__initURS = function(){
            var _config = {
                cookieDomain:'kaola.com',
                domains:'kaola.com.hk',
                product : 'kaola',      //【必须】使用的产品ID，如urs
                promark : 'LYABFrz',    //【必须】【申请】申请的组件ID，被分派ID
                host : 'www.kaola.com', //【必须】所在的域名
                includeBox : 'loginbox',//【可选】内嵌模式需要插入的Dom ID
                isHttps : location.protocol.indexOf('https')==0 ? 1 : 0,            //【可选】是否使用HTTPS协议，默认为1
                skin : 1,               //【可选】皮肤：0、空=灰，1=红,2=橙，3=绿,4=蓝
                page : 'login',         //【可选】首屏，注册:register，登录:login，根据实际情况填入
                placeholder : {account:'网易邮箱账号',pwd:'密码'},
                needUnLogin : 1 ,       //【可选】是否需要十天免登按钮，默认为0
                defaultUnLogin:1,       //【可选】十天免登初始化状态，默认为0
                single : 1,             //【可选】是否只用注册、登录中一个模块，1是，0否；
                errMode: 1,
                lazyCheck: 1,
                cssDomain : window.__cdnBaseUrl || (location.protocol+'//www.kaola.com/'),//【可选】 自定义样式的地址，注意：必须是绝对路径，即含有完整的‘http：//’‘https://’协议头
                cssFiles : 'css/login/urslogin_new.css?v=003',//【绑定cssDomain】 自定义样式文件:使用样式覆盖方式进行样式自定义
                logincb : this.__cbLogin._$bind(this),//【可选】登录成功后回调，也可使用外部注入方式
                statecb : this.__cbState._$bind(this),
                initReady: function(){window.initURSFrame = true;}
            }
            this.__urs = new URS(_config);

            window.setTimeout(function(){
                if(!window.initURSFrame){
                    window['_gaq'] && window['_gaq'].push(['_trackEvent', '前端报错信息', 'PC', 'URS-初始化弹窗错误']);
                }
            }, 10000)
        };

        pro.__reset = function(_options){
            this.__supInit(_options);
        }

        pro.__cbLogin = function(username){
            this._$dispatchEvent('cblogin',username);
        }

        pro.__cbState = function(name, res){
            this._$dispatchEvent('cbstate',name, res);
        }

        return _p._$$URSLoginModule;
    },23,2,15,285);
I$(7,function (Window, _e,_v,_css, _html,Suggest,_e1,_t,URS,_p, _o, _f, _r,_pro) {
	
	var _seed_css = _e._$pushCSSText(_css),
	    _seed_html = _e1._$addNodeTemplate(_html);

	/*
     * @param     {Object} arg0       - 可选配置参数
     * @property  {Function} logincallback      -  实现无刷新登录，登录成功后调用此方法
     * @property  {String} backUrl    - 登录成功后跳转url 
	 * @property  {String} backUrl2   - 登录失败后跳转url 
	 */
    _p._$$LoginWindow = NEJ.C();
    _pro = _p._$$LoginWindow._$extend(Window);

    _pro.__reset = function(_options) {
        _options.clazz = _options.clazz||'m-loginWrap m-loginWrap-1';
        _options.width = _options.width||'354';
        _options.height = _options.height||'340';
        _options.title = _options.title||'登录网易邮箱账号';
        this.__super(_options);

        // 绑定点击注册 关闭弹框事件 hznirizhe 20160901
        this.__doInitDomEvent([
            [this.__regUrl,'click',this._$Close._$bind(this)]
        ]);

        //替换头部的classname
        this.__layer.__dopt.mbar.className = 'iDialogHead';
        this.__layer.__nttl.className = '';

        this.__loginAgentUrl = location.protocol + '//www.kaola.com/urs/163redirect.html?target=' + encodeURIComponent(this.__URLOrigin+'/agent/loginAgent.htm?from=iframeLogin');
        //登录方式处理
        this.__targetUrl = _options.backUrl||location.href;
        if(!!_options.logincallback){  //无刷新登录
            this.__loginAgentIframe = _e._$get('loginIframeAgent');
            if(!this.__loginAgentIframe){
                var _iframe = this.__getElement('<iframe id="loginIframeAgent" name="loginIframeAgent" frameborder="0" width="0" height="0" src=""/>');
                document.body.insertBefore(_iframe, nej.e._$getChildren(document.body)[0])
                this.__loginAgentIframe = _iframe;
            }
            this.__loginType = 1;//无刷新登录
        }

        this.__regUrl.href = 'http://reg.163.com/reg/innerDomainReg.do?product=kaola&url='+encodeURIComponent( location.protocol + '//global.163.com/urs/redirect.html?target='+encodeURIComponent(location.href))+'&loginurl='+encodeURIComponent( location.protocol + '//global.163.com/urs/redirect.html?target='+encodeURIComponent(location.href));
        this.__wxUrl.href = this.__wxUrl.href + encodeURIComponent('?target='+encodeURIComponent(this.__targetUrl));
        this.__aliPayUrl.href = this.__aliPayUrl.href + encodeURIComponent('?target='+encodeURIComponent(this.__targetUrl));
        this.__weiboUrl.href = this.__weiboUrl.href + encodeURIComponent('?target='+encodeURIComponent(this.__targetUrl));
        this.__qqUrl.href = this.__qqUrl.href + encodeURIComponent('?target='+encodeURIComponent(this.__targetUrl));
    };

    _pro.__destroy = function(_options) {
        this.__super(_options);
    };

    _pro.__initXGui = function() {
        this.__seed_css = _seed_css;
        this.__seed_html = _seed_html
    };

    _pro.__initNode = function() {
        this.__super();
        var _list = _e._$getByClassName(this.__body,'j-flag'), i=0;

        this.__wrap = _list[i++];
        this.__regUrl = _list[i++];
        this.__wxUrl = _list[i++];
        this.__aliPayUrl = _list[i++];
        this.__weiboUrl = _list[i++];
        this.__qqUrl = _list[i++];

        this.__URLOrigin =  window.location.protocol+'//'+window.location.host;

        this.__loginType = 0;//跳转登录
        window.loginCallback = this.__loginCb._$bind(this);
    };

    _pro.__loginCb = function(errCode, userId, jumpUrl){
        //登录成功，刷新topbar，并回调方法
        this._$dispatchEvent('logincallback',0);
        this._$Close();
    };

    _pro.__getElement = function(content){
        var _node = document.createElement('div');
        _node.innerHTML = content;
        return nej.e._$getChildren(_node)[0];
    };

    _pro._$show = function(){
        this.__super();
        this.__urs = URS._$allocate({
          cblogin:this.__cbLoginOk._$bind(this),
          cbstate:this.__cbState._$bind(this)
        });
    };

    _pro.__cbLoginOk = function(){
        if(this.__loginType == 1){  //无刷新登录
            this.__loginAgentIframe.src = this.__loginAgentUrl;
        }else{
            location.href = location.protocol + '//www.kaola.com/urs/163redirect.html?target='+encodeURIComponent(this.__targetUrl);
        }
    };

    _pro.__cbState = function(name, res){
        if(name == '/l' && res.ret == 423){
            _e._$addClassName(this.__wrap, 'm-loginWarning m-loginWarning-1');

            this.__layer.__dopt.mbar.innerText = '账号风险提示' 
        }
    };

    _pro._$Close = function(){
        this.__layer._$hide();
    };
    
    return _p._$$LoginWindow;
},229,4,3,230,231,232,233,234,235);
I$(26,function (_req,_j, LoginWindow) {
	var util = {
		isLogin: function(callback) {
			var _url = '/getUserName.html?t='+ (+new Date()),
				_opts = {
					method: 'get',
					norest: true,
					type: 'json',
					onload: function(_json) {
						if (!(_json && _json.retcode == 461)) {
							// 已登陆
							callback(1);
						} else {
							callback(0);
						}
					}._$bind(this),
					onerror: function() {
						callback(0);
					}._$bind(this)
				};
			_req._$request(_url, _opts);
		},
		toLogin: function(callback){
			LoginWindow._$allocate({
				logincallback: function(){
					!!window._$refreshTopbar && window._$refreshTopbar();
					!!callback && callback();
				}
			})._$show();
		},
		afterLogin: function(callback) {
			this.isLogin(function(islogin) {
				if (!islogin) {
					LoginWindow._$allocate({
						logincallback: function(){
							!!window._$refreshTopbar && window._$refreshTopbar();
							callback();
						}
					})._$show();
				} else {
					callback();
				}
			});
		},
	    getUserInfoFromCookie:function(site, _returnName) {
	    	var name = site === "163" || _j._$cookie("S_INFO") || !_j._$cookie("S_OINFO") ? "P_INFO" : "P_OINFO";
            if (_returnName) {
                return name;
            }
            var info = (_j._$cookie(name) || "").replace(/\"|\'/g, ""),
                arr  = info.split("|");
	        if (arr.length > 1 && /^.+@.+$/.test(arr[0])) {
	            var alias = arr[arr.length - 1];
                return {
                    base: arr[0],
                    alias: /^1\d{10}@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(alias) ? alias : arr[0]
                };
            }
	    },
        getAccountFromCookie:function(){
            var userinfo = util.getUserInfoFromCookie() || {},
                account = userinfo.base || '';
            return account;
        },
		/**通过同步数据（静态化页面isLogin、isOrdered同步字段失效，非静态化页面可用）
		 * 获取用户的访客分类信息，包括：
			a.已注册已下单。则参数为3
			b.已注册未下单。则参数为2
			c.未注册。则参数为1
			hzmating 20160912
		 */
		getUserType:function(){
			return window._kaolaUserType||1;
		},
		/**通过异步请求的返回值
		 * 获取用户的访客分类信息，包括：
			a.已注册已下单。则参数为3
			b.已注册未下单。则参数为2
			c.未注册。则参数为1
			hzmating 20160912
		 */
		getUserTypeInUser:function(isLogin,user){
			var user = user || {},
				isOrdered = user.isOrdered || false,
				userType = 1;
			if(isLogin){
				userType = isOrdered?3:2;
			}
			return userType;
		}
	};
	return util;
},14,11,7);
I$(219,function (_k,_u,_t,_e,_v,_q,_v1,_h,config,request,UserInfo,RightBar,Cart,_pt,_j,_t1,Search,Util,_p,_o,_f,_r,_pro){
    /**
     * 顶栏功能控件封装
     *
     * @class   _$$FrmTopBar
     * @extends _$$EventTarget
     */
    _p._$$FrmTopBar = _k._$klass();
    _pro = _p._$$FrmTopBar._$extend(_t._$$EventTarget);

    /**
     * 控件初始化
     * @param  {Object} 配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        this.__addEvent();
        this.__initRightBar();
        this.__initNotice();   // 网站下压banner
        this.__rightBar = RightBar._$allocate();
        Search._$allocate();    //搜索初始化
        this._$refreshTopbar();
        this.__fixedToptabs();    // 网站悬浮导航控制
        this.__go2Top();    // 限时购页面等的返回顶部按钮
        this.__initUserCheckIn(); // 初始化用户签到
    };
    _pro.__go2Top = function(){
    	this.__go2Top = _e._$get('j-go2Top');
    	if(this.__go2Top){
			_v._$addEvent(window,'scroll',this.__toggleGo2Top._$bind(this));
			this.__toggleGo2Top();
		}
    };
    _pro.__toggleGo2Top = function(){
    	var _top = document.body.scrollTop || document.documentElement.scrollTop;
    	
    	if(_pt._$KERNEL.browser=='ie' && _pt._$KERNEL.release<'3.0'){ // ie6(<7.0)
        	// ie6下不做处理
        } else {
            if (_top > 300) {
            	this.__go2Top.style.display = 'block';
            } else {
            	this.__go2Top.style.display = 'none';
            }
        }
    };
    /* 
     * topTabs
     * 如果该页面是首页/搜索/品牌/分类/7个主频道页，则实现固定导航功能 
     */
    _pro.__fixedToptabs = function(){
		var currentPageurl = document.URL||'', kaolaTopTabList=[];
		//if(typeof(channelUrlList)!="undefined"){
		//	kaolaTopTabList = channelUrlList;
		//	for(var i=0; i<kaolaTopTabList.length; i++){
		//		if(kaolaTopTabList[i]!="" && currentPageurl.indexOf(kaolaTopTabList[i])!=-1){
		//			hasFixedToptabs = true;
		//			break;
		//		}
		//	}
		//}
		//if(currentPageurl.indexOf("/search.html")!=-1 || !!(/\/category\/[0-9]*(\/[0-9]*)?.html/ig).test(currentPageurl) || !!(/\/brand\/[0-9-]*.html/ig).test(currentPageurl)){
		//	hasFixedToptabs = true;
		//}
		if(typeof(hasFixedToptabs)!="undefined" && hasFixedToptabs){
			this.__selfTab = _e._$get('docHead');
            this.__selfTabPlaceHolder = _e._$get('topTabPlaceHolder');
            // 如果不存在 return；有些页面没有导航
            if(!this.__selfTab){
                return;
            }
			this.__offsetTopTab = _e._$offset(this.__selfTab).y + 17;

			_v._$addEvent(window,'scroll',this.__checkToptabs._$bind(this));
			this.__checkToptabs();
		}
    };
    _pro.__checkToptabs = function(){
    	var _top = document.body.scrollTop || document.documentElement.scrollTop;
    	
    	if(_pt._$KERNEL.browser=='ie' && _pt._$KERNEL.release<'3.0'){ // ie6(<7.0)
        	// ie6下不做处理
        } else {
            if (_top <= this.__offsetTopTab) {
            	_e._$delClassName(this.__selfTab,'topTabBoxFixed');
                _e._$addClassName(this.__selfTabPlaceHolder,'f-dn');
            } else {
            	_e._$addClassName(this.__selfTab,'topTabBoxFixed');
                _e._$delClassName(this.__selfTabPlaceHolder,'f-dn');
            }
        }
    };

    // 用户签到初始化: rightTopbar & rightbar
    _pro.__initUserCheckIn = function() {
    	 var checkinBtn = _q('.checkin');
         if(checkinBtn.length) {
        	 _u._$forEach(checkinBtn,function(_item,_index,_list){
         		var _url = '/personal/my_point/index.html?',
         			_from = _e._$attr(_list[_index],"data-from");
         		if(!!_from){
             		_url += 'zn='+_from;
             	}
                 
         		_v._$addEvent(_list[_index],'click',function(){
         			Util.afterLogin(function(){this.__reqCheckIn(_url);}._$bind(this));
	    		}._$bind(this));
         	}._$bind(this));
         }
    }

    _pro.__reqCheckIn = function(_url) {
        var _callback = function(_obj) {
            setTimeout(function() {
                window.location.href = _url;
            }, 800);
        }

        request('/personal/my_sign.html',{
            method:'GET',
            type:'json',
            norest:true,
            onload:_callback,
            onerror:_callback
        });
    }

    _pro._$refreshTopbar = function(){
    	var topNavLeftNode = _e._$get('topNavLeft');
    	if(topNavLeftNode){
	    	if(!this.__userInfo){
	    		this.__userInfo = new UserInfo();
	            this.__userInfo.$on('logined',this.__userLogined._$bind(this));
	            this.__userInfo.$inject('#topNavLeft');
	    	} else{
	    		this.__userInfo.refresh();
	    	}
    	}
         this.__initGreenhandGift();
    };
    /**
     * 哪果用户登录了需要进行登录的信息处理
     */
    _pro.__userLogined = function(_user){
    	this._$dispatchEvent('login');
    	request('/getPersonalCount.html',{
    		method:'GET',
    		type:'json',
    		norest:true,
    		onload:this.__cbPersonCount._$bind(this)
    	})
    	Cart._$allocate();
    	if(_user&&_user.isInternalStaffPartner){ 
    		var mypartnerLeft = _e._$get('mypartnerLeft'),
    		mypartnerTop = _e._$get('mypartnerTop');
    		if(mypartnerLeft){
    			mypartnerLeft.style.display= 'block';
    		}
    		if(mypartnerTop){
    			mypartnerTop.style.display= 'block';
    		}
    	}
    };
    

    _pro.__initRightBar = function(){
    	// 顶栏右边  & 侧边栏的联系客服的响应
    	var rightTopBar =_e._$get('topNavRight');
    	var list = _e._$getByClassName(rightTopBar,'contact');
    	if(list&&list.length){
    		_v._$addEvent(list[0],'click',this.__onServiceClick._$bind(this))
    	}
    	var _rightBar = _e._$get('rightBarNew');
        if(!_rightBar){
        	return;
        } else{
        	var list = _e._$getByClassName(_rightBar,'servonline');
        	if(list.length){
        		_v._$addEvent(list[0],'click',this.__onServiceClick._$bind(this))
        	}
        }
        
        // 顶栏右边‘合伙人小队提示信息‘是否显示
        var _newPartnerNotice = _e._$get('j-newPartnerNotice'),
        	_dropmenuPersonal = _e._$get('j-dropmenuPersonal');
        if(!_newPartnerNotice){
        	return;
        } else{
        	var list = _e._$getByClassName(_newPartnerNotice,'close');
        	if(list.length){
        		_v._$addEvent(list[0],'click',function(){
        			_newPartnerNotice.style.display ='none';
        		}._$bind(this));
        	}
        	var list2 = _e._$getByClassName(_dropmenuPersonal,'mcDropMenuBox');
        	if(list2.length){
	        	_v._$addEvent(list2[0],'mouseover',function(){
	    			_newPartnerNotice.style.display ='none';
	    		}._$bind(this));
        	}
        }
    }
    _pro.__onServiceClick = function(){
    	var url = url || 'http://im2.gm.163.com/static/kl/index.html',
		width = width || 1024, height = height || 710,
		left = left || ((window.screen.availWidth - width) / 2), top = top || ((window.screen.availHeight - height) / 2), shareWin;

		shareWin = window.open(url,"newwin","height="+height+", width="+width+", left="+left+", top="+top+", toolbar=no, menubar=no, scrollbars=no, location=no, status=no");
		if(!!shareWin && !!shareWin.focus) {
			shareWin.focus();
		}
    }
    _pro.__onFavBtnClick = function(){
    	var url = location.protocol + '//'+location.host,
    		txt = document.title.replace(/[\/:*?"<>|]/g,'');
    	try{
    		window.external.addFavorite(url,txt);
		}catch(e){
			window.alert("请尝试点击 Ctrl + D 来添加！");
		};
    }
    _pro.__cbPersonCount = function(_json){
    	if(_json&&_json.retcode==200){
    		var personalTips = _e._$get('personalTips');
    		if(_json.unReadAfterSaleCount!=0||_json.unReadCouponCount!=0){
    			if(_json.unReadAfterSaleCount!=0){
    				_e._$get('aftersaleTip').style.display = 'block';
    			}
    			if(_json.unReadCouponCount!=0){
    				var couponTip = _e._$get('couponTip');
    				couponTip.innerText = _json.unReadCouponCount;
    				couponTip.style.display ='block';
    			}
    			personalTips.style.display ='block';
    		} else{
    			personalTips.style.display ='none';
    		}

    	}
    };
    _pro.__addEvent = function(){
    	var topNavWrap = _e._$get('topNavWrap');
    	_v._$addEvent('addFavBtn','click',this.__onFavBtnClick._$bind(this))
    	var list = _e._$getByClassName(topNavWrap,'mcDropMenuBox');
    	if(list&&list.length){
	    	for(var i=0,l=list.length;i<l;i++){
	    		_v1._$hover(list[i],'dropMenuBoxActive');
	    	}
    	}
    }
    _pro.__initNotice = function(){
    	var topNotice = _e._$get('topnotice');
    	if(topNotice){
    		var closetype = _e._$dataset(topNotice,'closetype');
    		if(closetype==1){
				var topnoticeId = _e._$dataset(topNotice,'id'),
					topNoticeCookie = _j._$cookie("NTES_KAOLA_TOPNOTICE"+topnoticeId);
				if(!!topNoticeCookie && topNoticeCookie=='-1'){
					//return;
				}else{
					topNotice.style.display='block';
					_j._$cookie("NTES_KAOLA_TOPNOTICE"+topnoticeId,{path : '/', domain: 'kaola.com', expires:365,value:'-1'})
				}
			}

    		var close = _e._$getByClassName(topNotice,'close');
    		if(close.length){
    			_v._$addEvent(close[0],'click',function(){
    				topNotice.style.display ='none';
    			})
    		}
    	}

        // 11.11大促倒计时， 2015-11-05之后可以删除此代码
        // 2015年10月30日 hzliuxinqi
        (function(){
            var counters = _e._$getByClassName(topNotice, 'timer-wrap');
            if (!counters || !counters.length) {
                return;
            }
            var counter = counters[0];
            var timePoints = counter.getAttribute('data-points').split(','), tempArr = [], time,
                systemTime = parseFloat( counter.getAttribute('data-serverTime') );
            for (var i = 0; i < timePoints.length; i++) {
                if(timePoints[i]){
                    time = parseFloat(timePoints[i]);
                    (typeof time=='number') && tempArr.push(time);
                }
            }
            timePoints = tempArr;
            if (!timePoints || !timePoints.length) {
                return;
            }
            var timer = {
              day: _e._$getByClassName(_e._$getByClassName(counter, 'day')[0], 'dgt'),
              hour: _e._$getByClassName(_e._$getByClassName(counter, 'hour')[0], 'dgt'),
              min: _e._$getByClassName(_e._$getByClassName(counter, 'min')[0], 'dgt'),
              sec: _e._$getByClassName(_e._$getByClassName(counter, 'sec')[0], 'dgt')
            },
            loadTime = +new Date(),
            delta = systemTime - loadTime,
            lastTxt={};

            // 根据毫秒数计算剩余时间对象
            var __getTimeObj = (function(){
                //转化为两位数字
                var fillZ = function( N ){
                    return (N < 10 ? "0" : "" )+N;
                };
                var onemin = 60000, onehour = 60*onemin, oneday = 24*onehour;
                return function(num, returnObj){
                    var time = +num > 0 ? +num : 0;
                    var d = parseInt(time / oneday, 10),
                        h = parseInt(time % oneday / onehour, 10),
                        m = parseInt(time % oneday % onehour / onemin, 10),
                        s = parseInt(time % oneday % onehour % onemin / 1000, 10),
                        ms = parseInt(time % oneday % onehour % onemin % 1000, 10);
                    //优化临界点显示
                    if (d === 1 && h === 0) {
                        d = 0;
                        h = 24;
                    }
                    var info = [fillZ(d),fillZ(h),fillZ(m),fillZ(s)];
                    return {
                        d : d, h : h, m: m, s : s, ms:ms,
                        dd : fillZ(d), hh: fillZ(h), mm : fillZ(m), ss : fillZ(s)
                    };
                };
            })();
            function update(){
                var now =  (+new Date())+delta, next=0,timeLeft = 0;
                for (var i = 0; i < timePoints.length; i++) {
                  if (timePoints[i] > now){
                    next = timePoints[i];
                    break;
                  }
                }
                if (next) {
                  timeLeft = next - now;
                }else{
                  timeLeft = 0;
                  !!handle && clearInterval(handle);
                }
                var txt = __getTimeObj(timeLeft, true);
                if (lastTxt.dd!=txt.dd) timer.day[0].innerHTML =txt.dd.slice(0,1);
                if (lastTxt.dd!=txt.dd) timer.day[1].innerHTML =txt.dd.slice(1,2);
                if (lastTxt.hh!=txt.hh) timer.hour[0].innerHTML =txt.hh.slice(0,1);
                if (lastTxt.hh!=txt.hh) timer.hour[1].innerHTML =txt.hh.slice(1,2);
                if (lastTxt.mm!=txt.mm) timer.min[0].innerHTML =txt.mm.slice(0,1);
                if (lastTxt.mm!=txt.mm) timer.min[1].innerHTML =txt.mm.slice(1,2);
                if (lastTxt.ss!=txt.ss) timer.sec[0].innerHTML =txt.ss.slice(0,1);
                if (lastTxt.ss!=txt.ss) timer.sec[1].innerHTML =txt.ss.slice(1,2);
                lastTxt = txt;
            }
            var handle = setInterval(update, 500);
            update();            
        })();
    };
    // 初始化页面新人礼信息
    _pro.__initGreenhandGift = function(){
        //登录通过请求获取购物车数量
        request('/newer/gift/remind.html?'+(+new Date),{
            method:'GET',
            type:'json',
            norest:true,
            onload:this.__setGreenhandGift._$bind(this)
        });
    };
    _pro.__setGreenhandGift = function(data){
        //首页默认显示， 其它页面用户点击了才显示
		var greenhand = document.getElementById('js-greenhand');
		if (greenhand ){
            if (data && data.retcode == 200 && data.img) {
                var img = document.getElementById('js-greenhandimg');
                if (img) {
                    img.src = data.img+'?imageView&thumbnail=80x80';
                }
                greenhand.style.display = 'block';
                
                // homepage
                var isIndex = parseInt(greenhand.getAttribute('data-isindex'),10)||0;
                if(isIndex){
                	var list = _e._$getByClassName(greenhand,'mcDropMenuBox');
                	//_v1._$unhover(list[0],'dropMenuBoxActive');
                	_v._$addEvent(greenhand,'mouseover',function(){
                		_e._$addClassName(list[0],'dropMenuBoxActive');
    	    		}._$bind(this));
                	_v._$addEvent(greenhand,'mouseout',function(){
                		_e._$delClassName(list[0],'dropMenuBoxActive');
    	    		}._$bind(this));
                }
            }
        }
    };

    return _p._$$FrmTopBar;
},1,2,23,4,3,25,107,15,433,6,264,434,101,78,11,93,435,26);
I$(220,function (_k,_u,_t,_e,_v,_v1,_h,config,_pt,_j,_p,_o,_f,_r,_pro){
    /**
     * footer实现
     * 原则是要找出body上的停靠的节点，
     * 主要是banner下方的那个节点，如果rightBar需要停靠到那个位置需要给那个节点加 rightBarAnchor这个样式，
     * 如果找不到这个节点就找id的兄弟节点topTabBox
     * @class   _$$Footer
     * @extends _$$EventTarget
     */
    _p._$$Footer = _k._$klass();
    _pro = _p._$$Footer._$extend(_t._$$EventTarget);

    /**
     * 控件初始化
     * @param  {Object} 配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        this.__footer = _e._$get('docFoot');
        _v._$addEvent(this.__footer,'click',this.__onContactClick._$bind(this));
    };
    _pro.__onContactClick = function(_event){
        var elm =_v._$getElement(_event);
        if(elm.innerText=='联系客服'){
    	    _v._$stop(_event);
    		var url = url || 'http://im2.gm.163.com/static/kl/index.html',
    		width = width || 1024, height = height || 710,
    		left = left || ((window.screen.availWidth - width) / 2), top = top || ((window.screen.availHeight - height) / 2), shareWin;

    		shareWin = window.open(url,"newwin","height="+height+", width="+width+", left="+left+", top="+top+", toolbar=no, menubar=no, scrollbars=no, location=no, status=no");
    		if(!!shareWin && !!shareWin.focus) {
    			shareWin.focus();
    		}
    	}
    };
   
    return _p._$$Footer;
},1,2,23,4,3,107,15,433,78,11);
I$(587,"<div class=\"m-ctgcard f-cb\">\n  <div class=\"f-fl m-ctglist\">\n    {#if navItem.childrenNodeList && navItem.childrenNodeList.length}\n    <div class=\"m-ctgtbl\">\n      {#list list as row}\n      <div class=\"f-cb\">\n        {#list row.rowItems as cat2Item}\n\t      <div class=\"litd\">\n          <div class=\"item\">\n             <p class=\"title\"><a target=\"_blank\" class=\"cat2\" href=\"//www.kaola.com/category/{cat2Item.categoryId||''}.html?zn=top&zp=category-{@(index+1)}-1-{@(cat2Item_index+1+row_index*2)}\">{@(cat2Item.categoryName||'')}</a></p>\n            <div class=\"ctgnamebox\">\n              {#if cat2Item.childrenNodeList && cat2Item.childrenNodeList.length}\n              {#list cat2Item.childrenNodeList as cat3Item}<a target=\"_blank\" class=\"f-fcred{cat3Item.specialEffect||''}\" href=\"//www.kaola.com/category/{cat2Item.categoryId||''}/{cat3Item.categoryId||''}.html?zn=top&zp=category-{@(index+1)}-1-{@(cat2Item_index+1+row_index*2)}-{@(cat3Item_index+1)}\">{cat3Item.categoryName||''}</a>{/list}\n              {/if}\n            </div>\n          </div>\n\t      </div>\n\t      {/list}\n      </div>\n      {/list}\n    </div>\n    {/if}\n  </div>\n  <div class=\"f-fl m-brandbox\">\n    <div class=\"brandlist f-cb\">\n      {#if navItem.brandList && navItem.brandList.length}\n      {#list navItem.brandList as item}\n        <a target=\"_blank\" href=\"//www.kaola.com/brand/{@(item.brandId||'')}.html?source=1&zn=top&zp=category-{@(index+1)}-2-{@(item_index+1)}\">\n          <img alt=\"{@(item.name||'')}\" src=\"{@((item.logoPic||'')|noProtocol)}\">\n        </a>\n      {/list}\n      {/if}\n    </div>\n  </div>\n  <div class=\"f-fr imgbox\">\n    <a target=\"_blank\" href=\"{@((navItem.bannerTargetUrl||'')|noProtocol|addActParam:'zn=top')}\">\n      <img class=\"u-img\" src=\"{@((navItem.bannerImageUrl||'')|noProtocol)}\">\n    </a>\n  </div>\n</div>");
I$(436,function (_,_ut, BaseComponent,tpl){
  var Category = BaseComponent.extend({
    template:tpl, //此处模板的修改涉及老框架和新框架，请一并处理
    data:{list:[]},
    config:function(data){
    	var item =[];
    	var categorList = data.navItem.childrenNodeList||[];
    	this.data.list =[];
    	for(var i=0,l=categorList.length;i<l;i++){
    		if(i%2==1){
    			item.push(categorList[i-1]);
    			item.push(categorList[i]);
    			this.data.list.push({rowItems:item});
    			item =[];
    		} else if(i==categorList.length-1){
    			this.data.list.push({rowItems:[categorList[i]]})
    		} else{

    		}
    	}
    	this.supr(data);
    }
  });

  Category.filter("addParam",function(url, insertstr){
    return _.insertParamIntoUrl(url, insertstr);
  }).filter("addActParam",function(url, insertstr){
    return _.insertParamIntoUrl(url, insertstr + "&zp=category-" + (this.data.index + 1) + "-3-1");
  });


  return Category;

},15,2,151,587);
I$(221,function (_k,_u, $,_t,_e,_v,_,request,_pt,Category,_p,_o,_f,_r,_pro){
    /**
     * footer实现
     * 原则是要找出body上的停靠的节点，
     * 主要是banner下方的那个节点，如果rightBar需要停靠到那个位置需要给那个节点加 rightBarAnchor这个样式，
     * 如果找不到这个节点就找id的兄弟节点topTabBox
     * @class   _$$Nav
     * @extends _$$EventTarget
     */
	var kernel = _pt._$KERNEL;
	var __wait = 800,
    	__remain = 0,
    	__previous = +new Date(),
    	__timeout;

    _p._$$Nav = _k._$klass();
    _pro = _p._$$Nav._$extend(_t._$$EventTarget);

    /**
     * 控件初始化
     * @param  {Object} 配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
      var topCats = $('#topCats'), childs, that = this, link;
        if(topCats.length){
            this.__getFrontCategory();
          childs = topCats._$children('.j-catli', true);
          childs._$forEach(function (li) {
            _v._$addEvent(li, 'mouseenter', that.__onNavHover._$bind(that));
            link = _e._$dataset(li,'link') || '';
            _v._$addEvent(li, 'click', that.__onNavclick._$bind(that, link));
          });
          _v._$addEvent(topCats[0], 'mousemove', that.__onNavMove._$bind(that));
          _v._$addEvent(topCats[0], 'mouseleave', that.__onNavLeave._$bind(that));
          that.__isHDpi() && that.__dealHDpiIcon(childs); // 小图标，适配@2高清屏
        }
    };
    _pro.__isHDpi = function(){
      return window.devicePixelRatio && window.devicePixelRatio > 1;
    },
    _pro.__dealHDpiIcon = function(catlis){
      var iconImgs = catlis._$children(".icon"), img, src, ar;
      for(var l = iconImgs.length; l; l--){
        img = $(iconImgs[l-1]);
        src = img._$attr("src") || '';
        ar = src.split('?');
        ar.length == 2 && img._$attr("src", ar[0]);
      }
    },
    /**
     * seo提的需求，将nav的分类数据异步化处理
     */
    _pro.__getFrontCategory = function(){
    	request('/getFrontCategory.shtml',{
    		norest:true,
    		onload:function(_json){
    			this.__injectCategoryList(_json&&_json.frontCategoryList||[]);
    		}._$bind(this),
    		onerror:function(){

    		}
    	})
    };

    _pro.__injectCategoryList = function(frontCategoryList){
    	var catList = $('.j-catmenu li');
			//获取 arr 中包含 {key: val} 的节点，返回这些节点的数组
			function getFromArray (arr, key, val) {
				var sub = [];
				_u._$forEach(arr,function(_item){
					if(_item[key] && _item[key] == val){
						sub.push(_item);
					}
				});
				return sub;
			}
			for(var i = 0, l = catList.length, cateId, oList; i < l; i++) {
				cateId = _e._$attr(catList[i], 'data-categoryId');
				oList = getFromArray(frontCategoryList, 'categoryId', cateId)[0];
				if(!!oList){
					new Category({data: {navItem: oList, index: i}}).$inject(catList[i]);
				}
			}
    };
    _pro.__onNavclick = function (link, _event) {
      _event = _event || window._event;
      __timeout && clearTimeout(__timeout);
      var tar = _event.target || _event.srcElement;
      if(!_.isInClassNode(tar, 'm-ctgcard') && !!link) {
        window.open(link, '_blank');
      }
    };
    _pro.__onNavLeave = function () {
      __timeout && clearTimeout(__timeout);
      this.__showOrHideCard(this.__hoverEle, 0);
    };
    _pro.__onNavMove = function (_event) {
      _event = _event || window._event;
      var that = this;
      __previous = +new Date();
      that.__mousePosX = _event.clientX;
    };
    //鼠标在不同tab之间切换时
    //若切换前后鼠标是向右移动，则触发等待效果；垂直和向左移动，则立即切换tab
    _pro.__onNavHover = function (_event) {
      _event = _event || window._event;
      var tar = _event.target || _event.srcElement, that = this, disx, now;
      __timeout && clearTimeout(__timeout);

      if(_.isInClassNode(tar, 'j-catli')){
        tar = _.getParentElementByClass(tar,'j-catli');

        that.__mousePosX = that.__mousePosX || _event.clientX;
        that.__hoverEle = that.__hoverEle || tar;

        disx = _event.clientX - that.__mousePosX;
        if(that.__hoverEle != tar){//鼠标切换到了其它的tab
          if(disx > 2){            //鼠标向右移动，则触发等待效果
            now = +new Date();
            __remain = __wait - (now-__previous);
            __previous = now;
            if(__remain <= 0 || __remain > __wait) {//等待时间到了，切换tab
              that.__showOrHideCard(that.__hoverEle, 0);
              that.__showOrHideCard(tar,1);
              that.__hoverEle = tar;
            }else{                                  //等待时间没到，重新计时
              __timeout = setTimeout(function () {
                that.__showOrHideCard(that.__hoverEle, 0);
                that.__showOrHideCard(tar,1);
                that.__hoverEle = tar;
              }, __remain);
            }
          }else{//鼠标向左或垂直移动，直接切换tab
            that.__showOrHideCard(that.__hoverEle, 0);
            that.__showOrHideCard(tar,1);
            that.__hoverEle = tar;
          }
        }else{
          that.__showOrHideCard(that.__hoverEle, 1);
        }
      }else{
        that.__showOrHideCard(that.__hoverEle, 0);
      }
      __previous = +new Date();
      that.__mousePosX = _event.clientX;
    };
   _pro.__showOrHideCard = function(_elm,_isShow){
	   var liNode = _.getParentElementByTag(_elm,'li');
		 var showNodes = $('.j-catmenu li .m-ctgcard'), node;
     var effect,index;
	   if(liNode){
			  effect = _e._$dataset(liNode,'effect'); //特效
			  index = _e._$dataset(liNode,'index');
			 	node = showNodes[index];
		    if(node){
			   if(_isShow){
						if(effect && effect=='0') {
             _e._$addClassName(liNode,'z-hover2');
            }
				   _e._$addClassName(liNode,'z-hover');
			   } else{
				   _e._$delClassName(liNode,'z-hover');
			   }
		    }
	   }
   };
    return _p._$$Nav;
},1,2,79,23,4,3,15,6,78,436);
I$(222,function (_k, _e, _t, _v) {
    var _$$BottomNav = _k._$klass();
    var _pro = _$$BottomNav._$extend(_t._$$EventTarget);
    _pro.__reset = function() {
        this.navNode = document.getElementById('js_bottomnav');
        if (!this.navNode) {
            return;
        }
        this.__initEvents();
    }
    _pro.__initEvents = function() {
        _v._$addEvent(this.navNode, 'click', this.__toggleOpenFold._$bind(this));
    }
    _pro.__toggleOpenFold = function(evt) {
        var e = evt || window.event,
            target = e.target || e.srcElement,
            openClass = 'm-bottomnav-open';
        if (target.className.indexOf('tg') >= 0) {
            _v._$stop(e);
            if (_e._$hasClassName(this.navNode, openClass)) {
                _e._$delClassName(this.navNode, openClass);
            } else {
                _e._$addClassName(this.navNode, openClass);
            }
        }
    }
    return _$$BottomNav;
},1,4,23,3);
I$(223,function (_k,_u,_t,_e,_,_ut,_v,$,_p,_o,_f,_r,_pro){
    /**
     * 顶栏功能控件封装
     *
     * @class   ga
     * @extends _$$EventTarget
     *  <a href="javascript:void(0);" rel="nofollow" data-category="联系客服" data-event="顶部通栏点击数" data-label="">联系客服</a>
     */
    _p._$$ActionManage = _k._$klass();
    _pro = _p._$$ActionManage._$extend(_t._$$EventTarget);

    /**
     * 控件初始化
     * @param  {Object} 配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        _v._$addEvent(document, 'click', this.__onGACheck._$bind(this));
        this.__initHrefParam();
        this.__dealAccount();
    };
    /**
     * 登录
     * @return {Void}
     */
    _pro.__onGACheck = function(_event){
    	var target = _v._$getElement(_event),
			category = _e._$dataset(target,'category'),
			trackEvent = _e._$dataset(target,'event'),
			label = _e._$dataset(target,'label'),
    		href = _e._$dataset(target,'href');
		if(category){
			if(!!href){
				window['_gaq'].push(["_trackEvent",category,trackEvent,label,{"url":href}]);
				window._dapush && window._dapush('_trackEvent', category, trackEvent, label, {"url":href});
			}else{
				window['_gaq'].push(["_trackEvent",category,trackEvent,label]);
				window._dapush && window._dapush('_trackEvent', category, trackEvent, label);
			}
		}
        //在线客服
        if(_e._$hasClassName(target,'j-openService')){
            _v._$stop(_event);
            this._$openServiceWin();
        }
    };

    //在线客服
    _pro._$openServiceWin = function(url){
      var url = url || 'http://im2.gm.163.com/static/kl/index.html',
      width = width || 1024, height = height || 710,
      left = left || ((window.screen.availWidth - width) / 2), top = top || ((window.screen.availHeight - height) / 2), shareWin;

      shareWin = window.open(url,"newwin","height="+height+", width="+width+", left="+left+", top="+top+", toolbar=no, menubar=no, scrollbars=no, location=no, status=no");
      if(!!shareWin && !!shareWin.focus) {
        shareWin.focus();
      }
    };

    _pro.__initHrefParam = function(){
        //全局拼接带有data-param属性a链接，把data-param里面的值添加到href后面
        //这里暂时不考虑#|&在方法里进行判断处理，由data-param里面处理,只处理?的方式
        //此方法只做单纯的href拼接
    	// updated by hzzhengff: process '#', '&', 结合ftl处理使用
        // 改為代理模式 hzmating 20160321 
        $('body')._$on('click a[data-param]',function(){
            var param = _e._$attr(this,'data-param'), link = this.href, href = '';
            if(!!param && link!='javascript:;'){
				link = link.split('#')[0]; //hash已在ftl中处理,此处直接去掉 hzmating
                if(link.indexOf('?')<0){
                    if(param.charAt(0)=='?'){
                        href = link+param;
                    }else{
                        href = link+"?"+param;
                    }
                }else{
                    if(link.slice(-1)!='&'){
                        link += '&';
                    }
                    if(param.charAt(0)=='#'){       
                        link = link.slice(0,-1);   // remove '&' from link (previous step)
                    }
                    href = link+param;
                }
                _e._$attr(this,'data-param','');//刪除data-param，避免多次追加
                this.href = href;
            }
        });
    };
    /**
     * 若window.account没有值，则从cookie中获取账号
     * hzmating 20160411
     */
    _pro.__dealAccount = function(){
        !window.account && (window.account = _ut.getAccountFromCookie());
    };

    return _p._$$ActionManage;
},1,2,23,4,15,26,3,25);
(function(){var a=[17,95,94,86,24,63,2,0,1423857449,-2,3,-3,3432918353,1555261956,4,2847714899,-4,5,-5,2714866558,1281953886,6,-6,198958881,1141124467,2970347812,7,-7,3110523913,8,-8,2428444049,-9,9,10,-10,828E5,11,-11,2563907772,-12,12,13,2282248934,-13,2154129355,-14,14,15,-15,16,-16,17,-17,18,-18,19,-19,20,-20,-21,21,22,-22,23,-23,24,-24,25,-25,-26,26,27,-27,-28,28,-29,29,-30,30,31,-31,-33,32,33,-32,-35,-34,34,35,37,36,-36,-37,39,-38,-39,38,-40,40,-41,41,43,-43,42,-42,44,-44,-45,45,-46,-47,46,
47,48,49,-49,-48,51,50,-50,-51,570562233,52,53,-53,-52,55,-55,54,-54,503444072,57,-56,56,-57,-59,59,-58,58,60,-60,-61,61,62,63,-63,-62,-66,711928724,67,-64,64,-65,-67,65,66,-68,68,-69,-71,71,70,69,-70,72,3686517206,-72,73,-75,-74,75,74,-73,-78,-77,-76,79,77,78,-79,76,81,3554079995,83,-82,-80,82,-83,80,-81,84,-85,-84,-87,-86,87,86,85,90,-91,88,-90,89,-88,-89,91,-93,-94,-92,-95,95,92,93,94,99,-96,-99,98,-97,-98,96,97,-101,3272380065,101,100,-100,-103,-102,102,103,-105,-106,-107,105,-104,106,107,104,
-108,109,-110,-109,110,108,111,-111,251722036,-112,115,112,-115,113,-114,114,-113,117,116,-119,-117,119,-116,118,-118,123,-122,-123,-121,121,-120,122,120,125,127,3412177804,-124,-125,124,-127,126,-126,-128,128,-129,1843258603,3803740692,984961486,3939845945,4195302755,4066508878,255,1706088902,256,1969922972,365,2097651377,376229701,853044451,752459403,1E3,426522225,3772115230,615818150,3904427059,4167216745,4027552580,3654703836,1886057615,879679996,3518719985,3244367275,2013776290,3373015174,1759359992,
285281116,1622183637,1006888145,1E4,1231636301,83908371,1090812512,2463272603,1373503546,2596254646,2321926636,1504918807,2181625025,2882616665,2747007092,864E5,3009837614,3138078467,397917763,81470997,829329135,2657392035,956543938,2517215374,2262029012,40735498,2394877945,3266489909,702138776,2808555105,2936675148,1258607687,1131014506,3218104598,3082640443,1404277552,565507253,534414190,1541320221,1913087877,2053790376,1789927666,3965973030,3826175755,4107580753,4240017532,1658658271,3579855332,
3708648649,3453421203,3317316542,1873836001,1742555852,461845907,3608007406,1996959894,3747672003,3485111705,2137656763,3352799412,213261112,3993919788,1.01,3865271297,4139329115,4275313526,282753626,1068828381,2768942443,2909243462,936918E3,3183342108,27492,141376813,3050360625,654459306,2617837225,1454621731,2489596804,2227061214,1591671054,2362670323,4294967295,1308918612,2246822507,795835527,1181335161,414664567,4279200368,1661365465,1037604311,4150417245,3887607047,1802195444,4023717930,2075208622,
1943803523,901097722,628085408,755167117,3322730930,3462522015,3736837829,3604390888,2366115317,.4,2238001368,2512341634,2647816111,-.2,314042704,1510334235,58964,1382605366,31158534,450548861,3020668471,1119000684,3160834842,2898065728,1256170817,2765210733,3060149565,3188396048,2932959818,124634137,2797360999,366619977,62317068,-.26,1202900863,498536548,1340076626,2405801727,2265490386,1594198024,1466479909,2547177864,249268274,2680153253,2125561021,3294710456,855842277,3423369109,.732134444,3705015759,
3569037538,1994146192,1711684554,1852507879,997073096,733239954,4251122042,601450431,4111451223,167816743,3855990285,3988292384,3369554304,3233442989,3495958263,3624741850,65535,453092731,-.9,2094854071,1957810842,325883990,4057260610,1684777152,4189708143,3915621685,162941995,1812370925,3775830040,783551873,3134207493,1172266101,2998733608,2724688242,1303535960,2852801631,112637215,1567103746,651767980,1426400815,906185462,2211677639,1047427035,2344532202,2607071920,2466906013,225274430,544179635,
2176718541,2312317920,1483230225,1342533948,2567524794,2439277719,1088359270,671266974,1219638859,953729732,3099436303,2966460450,817233897,2685067896,2825379669,4089016648,4224994405,3943577151,3814918930,476864866,1634467795,335633487,1762050814,1,2044508324,-1,3401237130,3268935591,3524101629,3663771856,1907459465];(function(){function N(){var c="WI1R2D5dv3Xzw8Cs".split("");this.d=function(d){if(null==d||void 0==d)return d;if(d.length%a[6]!=a[7])throw Error("1100");for(var e=[],f=a[7];f<d.length;f++){f%
a[6]==a[7]&&e.push("%");for(var g=c,K=a[7];K<g.length;K++)if(d.charAt(f)==g[K]){e.push(K.toString(a[50]));break}}return decodeURIComponent(e.join(""))}}var f=(new N).d,c=(new N).d,e=(new N).d,g=(new N).d,d=(new N).d;(function(){function N(b){if(null==b)return null;for(var d=[],h=a[7],c=b.length;h<c;h++){var e=b[h];d[h]=Ha[(e>>>a[14]&a[48])*a[50]+(e&a[48])]}return d}function fa(b){var d=[];if(null==b||void 0==b||b.length==a[7])return sa(M);if(b.length>=M){var d=a[7],c=[];if(null!=b&&b.length!=a[7]){if(b.length<
M)throw Error(g("RIRWRWRR"));for(var e=a[7];e<M;e++)c[e]=b[d+e]}return c}for(c=a[7];c<M;c++)d[c]=b[c%b.length];return d}function qa(b){var d=a[397];if(null!=b)for(var c=a[7];c<b.length;c++)d=d>>>a[29]^Ia[(d^b[c])&a[291]];b=ta(d^a[397]);d=b.length;if(null==b||d<a[7])b=new String(e(""));else{for(var c=[],f=a[7];f<d;f++)c.push(Ja(b[f]));b=c.join(e(""))}return b}function ra(b,m,h){var n,k=[f("R1"),f("R2"),e("RW"),d("5I"),e("D3"),d("2v"),d("53"),d("DI"),f("dv"),g("2w"),f("Dw"),d("DX"),e("dD"),g("55"),
g("D5"),c("5w"),g("5d"),d("Rv"),f("dR"),g("DW"),d("28"),c("D1"),d("R5"),d("52"),f("2d"),f("5z"),e("Dv"),d("d5"),c("2s"),f("1s"),d("2R"),d("51"),g("dd"),f("R3"),f("Dd"),d("22"),g("5X"),g("RI"),f("2D"),f("D2"),f("d3"),f("23"),c("DR"),d("5R"),f("58"),e("5D"),d("5s"),g("2X"),c("dX"),c("RR"),d("Rd"),f("dI"),c("d2"),c("5v"),e("21"),c("d1"),c("DD"),g("1z"),d("2z"),g("2C"),e("2I"),d("RD"),f("dW"),e("5C")],y=d("25"),l=[];if(h==a[532])h=b[m],n=a[7],l.push(k[h>>>a[6]&a[145]]),l.push(k[(h<<a[14]&a[114])+(n>>>
a[14]&a[48])]),l.push(y),l.push(y);else if(h==a[6])h=b[m],n=b[m+a[532]],b=a[7],l.push(k[h>>>a[6]&a[145]]),l.push(k[(h<<a[14]&a[114])+(n>>>a[14]&a[48])]),l.push(k[(n<<a[6]&a[140])+(b>>>a[21]&a[10])]),l.push(y);else if(h==a[10])h=b[m],n=b[m+a[532]],b=b[m+a[6]],l.push(k[h>>>a[6]&a[145]]),l.push(k[(h<<a[14]&a[114])+(n>>>a[14]&a[48])]),l.push(k[(n<<a[6]&a[140])+(b>>>a[21]&a[10])]),l.push(k[b&a[145]]);else throw Error(d("RIRWRIRW"));return l.join(e(""))}function sa(b){for(var d=[],c=a[7];c<b;c++)d[c]=a[7];
return d}function K(b,d,c,f,k){if(null!=b&&b.length!=a[7]){if(null==c)throw Error(e("RIRWRWR2"));if(b.length<k)throw Error(g("RIRWRWRR"));for(var y=a[7];y<k;y++)c[f+y]=b[d+y]}}function ta(b){var c=[];c[a[7]]=b>>>a[66]&a[291];c[a[532]]=b>>>a[50]&a[291];c[a[6]]=b>>>a[29]&a[291];c[a[10]]=b&a[291];return c}function ga(b){if(null==b||void 0==b)return b;b=encodeURIComponent(b);for(var d=[],h=b.length,g=a[7];g<h;g++)if(b.charAt(g)==f("1D"))if(g+a[6]<h)d.push(Ka(b.charAt(++g)+e("")+b.charAt(++g))[a[7]]);
else throw Error(c("RIRWRWR3"));else d.push(b.charCodeAt(g));return d}function Ka(b){if(null==b||b.length==a[7])return[];b=new String(b);for(var c=[],d=b.length/a[6],e=a[7],f=a[7];f<d;f++){var g=parseInt(b.charAt(e++),a[50])<<a[14],l=parseInt(b.charAt(e++),a[50]);c[f]=z(g+l)}return c}function Ja(b){var d=[];d.push(ha[b>>>a[14]&a[48]]);d.push(ha[b&a[48]]);return d.join(c(""))}function ia(b,d){if(null==b||null==d||b.length!=d.length)return b;for(var c=[],e=a[7],f=b.length;e<f;e++){var g=e,l;l=b[e];
var p=d[e];l=z(l);p=z(p);l=z(l^p);c[g]=l}return c}function La(a,d){return z(a+d)}function z(b){if(b<a[282])return z(a[283]-(a[282]-b));if(b>=a[282]&&b<=a[274])return b;if(b>a[274])return z(a[284]+b-a[274]);throw Error(e("RIRWRWRI"));}function Ma(b){function m(){for(var b=[e("2I515I52531W28D21W2R5s5C525D5CdR5D521W2w535d5vd2"),c("2I525s515D1W255I5C5ddR5s5C5d1WDRd252"),f("2I525s515D1W2v5D51d15Ddd"),c("2I525s515D1W28535C5d1WDRd252"),e("2I5d5D5C5Rd31W2521"),d("2Id15I51"),e("2Id15I51535R1WD2d3dW5DdR5Dd2d2535C5d"),
c("2Id1535I5w1W215w5I5R5z"),f("215Id25I5C5d"),c("215IdD5v5IdDdR1WR3RR"),e("215D5w5w1W28D2"),g("2153d2dRd2d15D5I581WD55Dd15I1WDR5Dd15355"),d("215s525s5C531W28D2"),g("215s5s5z585I5C1W2s5w521WDRd2d35w5D"),c("21d15I5d5d5I525s5R535s"),e("21d15s5I52dd5Id3"),e("2R5I5w5351d153"),f("2R5I5w53555sd15C535I5C1W2521"),f("2R5IdRd25D5w5w5Id1"),e("2R5IdRdD5I5w"),d("2R5D5Cd25IdDd1"),g("2R5D5Cd2dDd1d31W2d5sd25v535R"),d("2R5v5I5w5z52dDdRd25Dd1"),d("2R5s5w5s5C5C5I1W28D2"),c("2R5sdWdW5Dd1dW5w5Id25D1W2d5sd25v535R1W2w535d5vd2"),
e("225D5X5ID5dD1W2w2d2R1WDR5I5CdR1W285s5C5s"),f("225DdR525D585s5C5I"),e("22252z5I5318DR21"),e("225sd2dD58"),d("2D5C5dd15Id55Dd1dR1W28D2"),c("2Dd15IdR1W215s5w521W23D22R"),f("2DdDd15sdRd2535w5D"),g("255I5C5dDR5s5C5d"),g("255sd1d25D"),f("25d15I5C5z5w535C1W2d5sd25v535R1W2v5D5Id5d3"),e("25d15D5C5R5v1WDR5Rd153dWd21W28D2"),f("2d5I51d1535s5w5I"),e("2d535d53"),e("2d53dR5v5I"),c("2d5sdD52d31W2s5w521WDRd2d35w5D"),c("2ddD5w5358"),g("2ddD5C5dDR5D5s"),d("2v5I5Dd2d25D5CdR5R5vdd5D535w5Dd1"),g("2v5Id1d1535C5dd25s5C"),
f("2v53d15I5d535C5s1WDR5I5CdR1W2d21"),d("2358dW5I5Rd2"),f("235C555sd1585I5w1WD15s585I5C"),c("2z5I5RdRd22s5C5D"),e("2z535C5s1W28D2"),f("2z5sdXdD5z5I1W2d5sd25v535R1WDWd1R52C"),e("2w5s5v53d21W2ddD5X5Id15Id253"),e("2w5s585I"),d("2wdD5R53525I1W21d1535d5vd2"),d("2wdD5R53525I1W255Idv"),f("285I5d5C5Dd25s"),d("285I5w5ddD5C1W2d5sd25v535R"),d("285Id2dDd15I1W28D21WDR5Rd153dWd21W2R5IdW53d25I5wdR"),f("285D5C5w5s"),d("28535C5d2w53DD182Ddvd221"),e("285s5s5w215sd15I5C"),c("28DR1WDW28535C5R5v5s"),e("28DR1WD15D555Dd15D5C5R5D1WDR5I5CdR1WDR5Dd15355"),
g("2C5DdddR1W2d5sd25v535R1W28D2"),e("2C535I5d5Id15I1WDR5s5w5352"),d("2Cd35I5w5I"),e("DW5I5w5I5R5D1WDR5Rd153dWd21W28D2"),e("DW5IdWd3d1dDdR"),d("DW5Dd1dW5Dd2dD5I"),f("DW5w5Id351535w5w"),c("DW28535C5d2w53DD"),f("D15I5R5v5I5C5I"),e("D15s5R5zdd5D5w5w"),c("DR5Idd5IdR525D5D"),d("DR5Rd153dWd21W28D21W215s5w52"),d("DR5D5d5s5D1WDWd1535Cd2"),e("DR5v5sdd5R5Id1521W2d5sd25v535R"),e("DR53582v5D53"),d("DR5C5IdW1W23D22R"),c("D25wdd5d285s5C5s"),g("D2dd1W2R5D5C1W28D21W2R5s5C525D5CdR5D521W2Ddvd2d15I1W215s5w52"),e("DD51dD5Cd2dD"),
d("DD58dWdDdR5v"),f("DD5C53d55Dd1dR"),d("DDd25sdW535I"),c("D55w5I52535853d11WDR5Rd153dWd2"),c("Dd53525D1W2w5Id2535C"),g("C2zzzsCDXCvz"),d("CDv8vCC535vdC2zvX8CDXCvz"),e("CDv8vCC535vdC2zzzsCDXCvz"),f("CDv8vCC535vdCDXCvzC2z83R"),e("CDv8vCC535vdCDz8X3C2zX3I"),e("CDv8vCC535vdC535zWC3X8vs"),e("CDv8vCC535vdC5XDzdC2z83R"),e("CDv8vCC535vdCd3WXDCdvsvW"),d("CDv8vCC535vdCdzzv5C3zz3I"),d("CDv8vCC535vdCvXIvwC5XDzd"),d("CDv8vCC535vdC33Xz5C2z3X5"),g("CDXCvzC2z83R"),c("CDz3zwCD3wv5"),f("CDzCXCCvz8XsC33zvDC3zz3I"),
d("C535zWCDXCvzC2z83R"),g("C535z3C5X8XRCDXd3XC2z83R"),f("C535z3C5X8XRCvvv31C2z83R"),f("C5XDzdC2z83R"),e("C33Xz5C2z3X5"),d("C3zz3IC2z83R"),c("C535zWCdzzv5C53vvCC2z83R"),c("Cdzzv5C53vvCC2z83R"),e("C5XWvdC5XDzdC2z83R"),f("C2zzzsCDXCvzDs2d21R1RRRIR1"),e("C5XDzdC2z83RDs2d21R1RRRIR1"),f("CDzCXCCvz8XsC5X8XRC3zz3IC2z83R"),f("CDv8vCC535vdC3zz3IC2z83R"),f("C2zvz8C3zz3I1WDWd15s"),g("C2zvz8CDXCvz1WDWd15s"),g("Cvvzz3C53C3wC2zvz8C2zvX8C3zz3I"),d("Cvvzz3C53C3wC2zvz8Cdzzv5CDXCvz")],m=[],k=a[7];k<b.length;k++)try{var n=
b[k];h()(n)&&m.push(n)}catch(l){d("555s5Cd21W525Dd25D5Rd21W5Dd1d15sd1")}return m.join(e("Rz"))}function h(){function b(a){var d={};return l.style.fontFamily=a,n.appendChild(l),d.height=l.offsetHeight,d.width=l.offsetWidth,n.removeChild(l),d}var f=[c("585s5C5sdRdW5I5R5D"),g("dR5I5CdR18dR5Dd15355"),c("dR5Dd15355")],h=[],m=e("dddddd585858585858585858585w5w53"),k=g("RdR1dWdv"),n=t.body,l=t.createElement(c("dRdW5I5C"));l.style.fontSize=k;l.style.visibility=g("5v5352525D5C");l.innerHTML=m;for(m=a[7];m<
f.length;m++)h[m]=b(f[m]);return function(c){for(var e=a[7];e<h.length;e++){var g=b(c+d("1w")+f[e]),m=h[e];if(g.height!==m.height||g.width!==m.width)return!0}return!1}}function n(){var a=null,b=null,d=[];try{b=t.createElement(e("5R5I5Cd55IdR")),a=b[c("5d5Dd22R5s5Cd25Ddvd2")](g("dd5D515d5w"))||b[f("5d5Dd22R5s5Cd25Ddvd2")](g("5DdvdW5Dd153585D5Cd25I5w18dd5D515d5w"))}catch(h){}if(!a)return d;try{d.push(a.getSupportedExtensions())}catch(m){}try{d.push(k(a,b))}catch(n){}return d.join(f("Rz"))}function k(b,
e){try{var g=d("5Id2d2d15351dDd25D1Wd55D5RR11W5Id2d2d1D55Dd1d25DdvRz1Wd55Id1d3535C5d1Wd55D5RR11Wd55Id1d3535CD25Ddv2R5s5sd152535C5Id25DRz1WdD5C53555sd1581Wd55D5RR11WdD5C53555sd1582s5555dR5Dd2Rz1Wd55s53521W585I535C1v131Wdz1W1W1Wd55Id1d3535CD25Ddv2R5s5sd152535C5Id25D1WR81W5Id2d2d1D55Dd1d25Ddv1W1z1WdD5C53555sd1582s5555dR5Dd2Rz1W1W1W5d5wDsDW5sdR53d2535s5C1WR81Wd55D5RR21v5Id2d2d1D55Dd1d25Ddv1w1WRW1w1WRI13Rz1Wd8"),h=c("dWd15D5R53dR535s5C1W585D5253dD58dW1W555w5s5Id2Rz1Wd55Id1d3535C5d1Wd55D5RR11Wd55Id1d3535CD25Ddv2R5s5sd152535C5Id25DRz1Wd55s53521W585I535C1v131Wdz1W1W1W5d5wDs25d15I5d2R5s5w5sd11WR81Wd55D5RR21vd55Id1d3535CD25Ddv2R5s5sd152535C5Id25D1w1WRW1w1WRI13Rz1Wd8"),
m=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,m);var k=new Float32Array([a[424],a[479],a[7],a[420],a[444],a[7],a[7],a[459],a[7]]);b.bufferData(b.ARRAY_BUFFER,k,b.STATIC_DRAW);m.k=a[10];m.l=a[10];var n=b.createProgram(),l=b.createShader(b.VERTEX_SHADER);b.shaderSource(l,g);b.compileShader(l);var y=b.createShader(b.FRAGMENT_SHADER);return b.shaderSource(y,h),b.compileShader(y),b.attachShader(n,l),b.attachShader(n,y),b.linkProgram(n),b.useProgram(n),n.n=b.getAttribLocation(n,d("5Id2d2d1D55Dd1d25Ddv")),
n.m=b.getUniformLocation(n,c("dD5C53555sd1582s5555dR5Dd2")),b.enableVertexAttribArray(n.o),b.vertexAttribPointer(n.n,m.k,b.FLOAT,!a[532],a[7],a[7]),b.uniform2f(n.m,a[532],a[532]),b.drawArrays(b.TRIANGLE_STRIP,a[7],m.l),T(e[c("d25s225Id25IDDD12w")]())}catch(p){return f("dd5D515d5w1W5Ddv5R5DdWd2535s5C")}}function y(){var b=t.createElement(g("5253d5")),h=[],m=[d("2I5Rd253d55D215sd1525Dd1"),e("2I5Rd253d55D2R5IdWd2535s5C"),g("2IdWdWDd5sd15zdRdW5I5R5D"),f("215I5R5z5dd15sdD5C52"),c("21dDd2d25s5C255I5R5D"),
g("21dDd2d25s5C2v535d5v5w535d5vd2"),f("21dDd2d25s5CDR5v5I525sdd"),d("21dDd2d25s5CD25Ddvd2"),d("2R5IdWd2535s5CD25Ddvd2"),g("2dd15Id3D25Ddvd2"),e("2v535d5v5w535d5vd2"),d("2v535d5v5w535d5vd2D25Ddvd2"),f("235C5I5Rd253d55D215sd1525Dd1"),g("235C5I5Rd253d55D2R5IdWd2535s5C"),c("235C5I5Rd253d55D2R5IdWd2535s5CD25Ddvd2"),g("235C555s215I5R5z5dd15sdD5C52"),g("235C555sD25Ddvd2"),f("285D5CdD"),c("285D5CdDD25Ddvd2"),f("DR5Rd15s5w5w515Id1"),g("D25vd15D5D22225Id15zDR5v5I525sdd"),c("D25vd15D5D22255I5R5D"),g("D25vd15D5D222v535d5v5w535d5vd2"),
f("D25vd15D5D222w535d5vd2DR5v5I525sdd"),f("D25vd15D5D22DR5v5I525sdd"),e("Dd535C525sdd"),c("Dd535C525sdd25d15I585D"),e("Dd535C525sddD25Ddvd2")];if(!window[f("5d5Dd22R5s58dWdDd25D52DRd2d35w5D")])return h.join(c(""));for(var k=a[7];k<m.length;k++)try{t.body.appendChild(b),b.style.color=m[k],h.push(m[k]),h.push(window[g("5d5Dd22R5s58dWdDd25D52DRd2d35w5D")](b).getPropertyValue(e("5R5s5w5sd1"))),t.body.removeChild(b)}catch(n){h.push(c("5d5Dd21WdRd3dRd25D581W5R5s5w5sd1dR1W5Ddv5R5DdWd2535s5C"))}return h.join(g("RX"))}
function l(){try{var b=t.createElement(g("5R5I5Cd55IdR")),h=b[f("5d5Dd22R5s5Cd25Ddvd2")](f("R152")),m=g("58dd2R1W5C5z515I555X5sd1521WdW5vdR5d5wd31W5Ddvd5d21WdXdI53dD1w1WCIz8XW1Wd2dW5vdRd21sRX1sdD5v515dd2535R1C585s1s5w5Dd5d55I");h.textBaseline=c("d25sdW");h.font=d("RdRWdWdv1W1d2Id1535I5w1d");h.textBaseline=d("5I5wdW5v5I515Dd2535R");h.fillStyle=d("1R55R5RW");h.fillRect(a[273],a[532],a[144],a[58]);h.fillStyle=c("1RRWR5R3");h.fillText(m,a[6],a[48]);h.fillStyle=f("d15d515I1vRIRWR11w1WR1RWR21w1WRW1w1WRW1CRd13");
h.fillText(m,a[14],a[52]);return b[f("d25s225Id25IDDD12w")]()}catch(k){return e("5R5I5Cd55IdR1W5IdW531W5Ddv5R5DdWd2535s5C")}}function p(){try{return window[f("2I5Rd253d55DDv2s515X5D5Rd2")]&&w.h?r():q()}catch(a){return f("5d5Dd21WdW5wdD5d535C1WdRd2d1535C5d1W5Ddv5R5DdWd2535s5C")}}function q(){if(!J[c("dW5wdD5d535CdR")])return e("");var b=[e("R25d5I585D"),d("2I52515w5s5R5zDW5wdD5d535C"),c("2I525s515D2Ddv285I5C2R2R225Dd25D5Rd2"),c("2I525s515D2Ddv285I5C225Dd25D5Rd2"),d("2I5w5Idd5Id11W2CDW2IDW231WdDd2535wdR"),
d("2I5w535D5253d21WDW5wdD5d18235C"),e("2I5w53dW5Id31WDR5D5RdDd153d2d31W2R5s5Cd2d15s5w1WRR"),d("2I5w53DRDR2s2w5s5d535C1WdW5wdD5d535C"),c("2I585IdX5s5C28DWRR225sdd5C5w5s5I525Dd1DW5wdD5d535C"),d("2I2s2w1W285D52535I1WDW5w5Id3515I5R5z1WDW5wdD5d535C"),e("2IdWdWDDdW"),e("2Id15R5v532R2I22"),d("2ID52d1WDR53d25DDR5I555Dd2d31WdW5wdD5d535C"),e("215I51d35w5s5C1WD25s5s5w215Id1"),c("215Id2d25w5D5w5s5d1W2d5I585D1W2w5IdD5C5R5v5Dd1"),g("2153d22R5s585Dd22I5d5D5Cd2"),g("2153d2525D555D5C525Dd11WDIdD535R5zDR5R5I5C"),f("215wdD5DDRd25I5R5zdR1W235CdRd25I5w5w1W225Dd25D5Rd25sd1"),
f("2R5Id25I5w535C5I2dd15sdDdW1WDDdW525Id25D"),d("2R53d2d153dv1W232R2I1W2R5w535D5Cd2"),e("2R53d2d153dv1W5s5C5w535C5D1WdW5wdD5d18535C"),d("2R53d2d153dv1WD15D5R5D53d55Dd11WDW5wdD5d18535C"),c("2R5s5sdd5s5C1WDDdW525Id25D"),c("225D5I5wDW5wd32w53d55D1WDDdW525Id25D"),e("225D555IdD5wd21W21d15sdddR5Dd11W2v5D5wdW5Dd1"),e("2253d5Dv1W21d15sdddR5Dd11WDW5wdD5d18235C"),f("2253d5Dv1WDW5wdDdR1WDd5D511WDW5w5Id35Dd1"),g("2253d5Dv1WD52s221W2v5D5wdW5Dd11WDW5wdD5d18535C"),e("525sdD515w5DD2dd53dRd21WDd5D511WDW5wdD5d535C"),
f("225sdd5C5w5s5I525Dd1dR1WdW5wdD5d535C"),c("525sdd5C5w5s5I52DDdW525Id25Dd1"),f("5D28dDdR535RDW5wdD5d535C1W222w28R5"),d("2DDR2C1W2w5IdD5C5R5v1W285sdX535w5w5I1WDW5wdD5d535C"),g("2DDR2C1WDR5s5C5Id11W2IDW23"),d("2Ddv53551W2Dd55Dd1d3dd5v5Dd15D"),d("255I5R5D515s5s5z1WDW5wdD5d535C"),c("25535w5D1W225sdd5C5w5s5I525Dd11WDW5wdD5d18535C"),g("25535w5D2w5I511WdW5wdD5d535C"),f("255wd32sd122535D1W2d5I585DdR1WDW5wdD5d535C"),c("255s5wdv1WRR1W21d15sdddR5Dd11WDW5wdD5d535C"),f("25DDDX2DDR5v5Id15D"),c("2d222w1W2s515X5D5Rd21WDd5D511WDW5wdD5d18535C1WRIR51CRWRW"),
e("2d252I2R2D1WDW5wdD5d535C"),c("2d535C5d5Dd1"),f("2d5C5s585D1WDR5v5D5w5w1W235Cd25D5dd15Id2535s5C"),c("2d5s5s5d5w5D1W2D5Id1d25v1WDW5wdD5d535C"),e("2d5s5s5d5w5D1W2D5Id1d25v1WDW5wdD5d18535C"),f("2d5s5s5d5w5D1W2d5D5Id1dR1WRW1CRD1CRRRR1CRW"),c("2d5s5s5d5w5D1WD25I5w5z1W2D55555D5Rd2dR1WDW5wdD5d535C"),c("2d5s5s5d5w5D1WDDdW525Id25D"),e("2v5Id1585s5Cd31W2553d15D555sdv1WDW5wdD5d535C"),f("2v5Id1585s5Cd31WDW5wdD5d18235C"),c("2v5Dd15s5DdR1W151W2d5D5C5Dd15I5wdR1W5w53d55D"),f("2vDW225Dd25D5Rd2"),c("2vd2585wRD1W5w5s5R5Id2535s5C1WdWd15sd553525Dd1"),
e("232D1WD25I511WdW5wdD5d535C"),e("532d5Dd2d25Dd1DR5Rd153dWd25I515w5DDW5wdD5d535C"),d("53285DdR5v1WdW5wdD5d535C"),e("2z5IdRdW5Dd1dR5zd31WDW5IdRdRdd5sd1521W285I5C5I5d5Dd1"),g("2w5IdRd2DW5IdRdR"),d("2w5s5d285D235C1WDW5wdD5d535C1WRI1CRW1CRW1CR3RRRD"),g("2w5s5d285D235C1WDW5wdD5d535C1WRI1CRW1CRW1CR3R5RI"),e("285I182R5s5C55535d1C5R5s581WdW5wdD5d535C"),f("28535Rd15sdR5s55d21W2s5555535R5D1WR1RWRIRR"),f("28535C53515Id1DW5wdD5d535C"),e("2C5Id253d55D1W2R5w535D5Cd2"),g("2C53d2d15s1WDW22251WDW5wdD5d18235C"),e("2C5s5z535I1WDRdD53d25D1W2D5C5I515w5Dd11WDW5wdD5d535C"),
e("2C5sd1d25s5C1W23525D5Cd253d2d31WDR5I555D"),g("5CdW2IDW231WDW5wdD5d535C"),f("2CDW2w5IdRd2DW5IdRdR"),g("2CDWDW5w5Id35Dd1DR5v5D5w5w"),g("5CdWD25s5C5d51dD2I5252535C"),e("2Cd3dv2w5IdD5C5R5v5Dd1"),g("2s5Rd25sdR5v5IdW5D1WDRd2d15D5I58535C5d1WDR5Dd1d5535R5DdR"),c("2s5C5w535C5D1WDRd25sd15I5d5D1WdW5wdD5d18535C"),e("2sd15153d21W225sdd5C5w5s5I525Dd1"),e("DW5I5C525s1WDd5D511WDW5wdD5d535C"),c("DW5Id15s581CD2D51WdW5w5Id35Dd11WdW5wdD5d535C"),c("DW22251W535Cd25D5dd15I525s1W525s1WDd5D512z53d2"),f("DW222518Dv2R5v5I5C5d5D1WD5535Ddd5Dd1"),
f("DW5v5sd25s2R5D5Cd25Dd1DW5wdD5d535CRI1CRI1CR11CR1"),d("DW535R5IdR5I"),d("DW5w5Id32s5C1WDW5wdD5d18535C"),d("DIDIR1RWRIRR1W2553d15D555sdv1WDW5wdD5d535C"),d("DIDI225sdd5C5w5s5I521WDW5wdD5d535C"),g("DIDI28535C53222w1WDW5wdD5d535C"),f("DIDI28dDdR535R"),f("D15D5I5w225sdd5C5w5s5I525Dd11WDW5wdD5d535C"),c("D15s515w5sdv1W2w5IdD5C5R5v5Dd11WDW5wdD5d535C"),f("D15s5R5z285D5wd21WDDdW525Id25D"),e("DR5I555Dd11WDDdW525Id25D"),g("DR5I555DDR5D5Id15R5v"),g("DR5Rd153dWd2535C5d1C22535Rd2535s5C5Id1d3"),d("DR5D552R5w535D5Cd21WDW5wdD5d535C"),
d("DR5v5D5w5w1CDD232v5D5wdW5Dd1"),f("DR535wd55Dd15w535d5vd21WDW5wdD5d18235C"),d("DR5358dW5w5D1WDW5IdRdR"),c("DR5zd3dW5D1WDd5D511WDW5wdD5d535C"),g("DRdD585Id2d15IDW22251W21d15sdddR5Dd11WDW5wdD5d535C"),d("DRd3585I5Cd25D5R1WDW2z231W2R5w535D5Cd2"),g("D25D5C5R5D5Cd21W25D22C1WdW5wdD5d18535C"),d("D25vdD5C525Dd11W225IdW2Rd2d15w1W2CDW2IDW231WDW5wdD5d535C"),g("D25sd15R5v2v5D5wdW5Dd1"),e("DD5C53d2d31WDW5w5Id35Dd1"),e("DDdW5w5Id31WDW2R"),c("D5225sdd5C5w5s5I525Dd1"),d("D55D5Dd25w5D1WD2D51W2R5sd15D"),c("D52w2R1W28dD5wd253585D52535I1WDW5wdD5d535C"),
d("Dd5D511W2R5s58dW5s5C5D5Cd2dR"),c("Dd5D512z53d218535Cd25D5dd1535Dd1d25D1WDW2225"),g("Dd2D21DX2D2C1W21d15sdddR5Dd11W2Ddvd25D5CdR535s5C"),f("Dd5s5w55d15I581W285Id25v5D585Id2535R5I"),g("Dd5sd1522R5IdWd2dDd15DDv"),f("DdDW231W225Dd25D5Rd25sd11WRI1CR2"),e("D35I5C525Ddv1W285D52535I1WDW5wdD5d535C"),f("D35I5C525Ddv1WDW22251WD5535Ddd5Dd1"),f("D35sdDD2dD515D1WDW5wdD5d18535C"),c("dX5I5z5s")],h=[],m={};h.push(u(J[f("dW5wdD5d535CdR")],function(b){m[b.name]=a[532];var d=u(b,function(a){return[a.type,a.suffixes].join(g("dC"))}).join(f("1w"));
return[b.name,b.description,d].join(c("RXRX"))},this).join(c("12")));h.push(u(b,function(a){if(m[a])return d("");a=J[e("dW5wdD5d535CdR")][a];if(!a)return d("");var b=u(a,function(a){return[a.type,a.suffixes].join(c("dC"))}).join(d("1w"));return[a.name,a.description,b].join(c("RXRX"))},this).join(f("Rz")));return h.join(f("Rz"))}function r(){if(window[e("2I5Rd253d55DDv2s515X5D5Rd2")]){var a=[f("2I5Rd15sDW22251CDW2225"),g("2I525s52511CDRd2d15D5I58"),d("2I5d2R5s5Cd2d15s5w1C2I5d2R5s5Cd2d15s5w"),g("225Dd55I5wD5D1Dv2Rd2d15w1C225Dd55I5wD5D1Dv2Rd2d15w1CRI"),
d("285I5Rd15s585D52535I255w5IdR5vDW5IdW5Dd11C285I5Rd15s585D52535I255w5IdR5vDW5IdW5Dd1"),d("28dRdv585wR11C222s28225s5RdD585D5Cd2"),d("28dRdv585wR11CDv282w2vD2D2DW"),c("DW22251CDW52552Rd2d15w"),e("DIdD535R5zD253585D1CDIdD535R5zD253585D"),c("DIdD535R5zD253585D2R5v5D5R5z2s515X5D5Rd21CDIdD535R5zD253585D2R5v5D5R5z1CRI"),e("d1585s5Rdv1CD15D5I5wDW5w5Id35Dd11W2dR11W2R5s5Cd2d15s5w"),c("d1585s5Rdv1CD15D5I5wDW5w5Id35Dd11W2dR11W2R5s5Cd2d15s5w1CRI"),g("D15D5I5wDW5w5Id35Dd1"),d("D15D5I5wDW5w5Id35Dd11CD15D5I5wDW5w5Id35Dd11vd258131W2I5Rd253d55DDv1W2R5s5Cd2d15s5w1W1vRRR1185153d213"),
g("D15D5I5wD553525D5s1CD15D5I5wD553525D5s1vd258131W2I5Rd253d55DDv1W2R5s5Cd2d15s5w1W1vRRR1185153d213"),f("d1585s5Rdv1CD15D5I5wDW5w5Id35Dd11W2dR11W2R5s5Cd2d15s5w"),g("DR5Rd153dWd2535C5d1C22535Rd2535s5C5Id1d3"),f("DR5v5D5w5w1CDD232v5D5wdW5Dd1"),g("DR5v5s5R5zdd5Id55D255w5IdR5v1CDR5v5s5R5zdd5Id55D255w5IdR5v"),c("DRDd2Rd25w1CDRDd2Rd25w"),f("DR5zd3dW5D1C225Dd25D5Rd2535s5C"),e("D2222R2Rd25w1CD2222R2Rd25w"),c("Dd28DW5w5Id35Dd11C2s2RDv")];return u(a,function(a){try{return new (window[e("2I5Rd253d55DDv2s515X5D5Rd2")])(a),
a}catch(b){return null}}).join(g("Rz"))}return d("")}function A(){try{return!!window[e("dR5DdRdR535s5CDRd25sd15I5d5D")]}catch(a){return!0}}function D(){try{return!!window[f("5w5s5R5I5wDRd25sd15I5d5D")]}catch(a){return!0}}function u(a,b,d){var c=[];if(null==a)return c;if(B&&a.map===B)return a.map(b,d);Na(a,function(a,e,h){c[c.length]=b.call(d,a,e,h)});return c}function Na(b,d){if(null!==b)if(x&&b.forEach===x)b.forEach(d,void 0);else if(b.length===+b.length)for(var c=a[7],e=b.length;c<e&&d.call(void 0,
b[c],c,b)!=={};c++);else for(c in b)if(b.hasOwnProperty(c)&&d.call(void 0,b[c],c,b)==={})break}var x=Array.prototype.forEach,B=Array.prototype.map,w={e:T,j:!0,i:!0,h:!0,b:!0,a:!0};typeof b==g("55dD5C5Rd2535s5C")?w.e=b:(null!=b.b&&void 0!=b.b&&(w.b=b.b),null!=b.a&&void 0!=b.a&&(w.a=b.a));this.get=function(){var b=[],h=[];if(Oa){b.push(A());b.push(D());b.push(!!window[g("535C525Ddv5D522221")]);t.body?b.push(typeof t.body[d("5I5252215D5v5Id5535sd1")]):b.push("undefined");b.push(typeof window[c("5sdW5D5C225Id25I515IdR5D")]);
b.push(J[f("5RdWdD2R5w5IdRdR")]);b.push(J[d("dW5w5Id2555sd158")]);var k;if(k=w.i)try{var u=t.createElement(c("5R5I5Cd55IdR"));k=!(!u[f("5d5Dd22R5s5Cd25Ddvd2")]||!u[g("5d5Dd22R5s5Cd25Ddvd2")](d("R152")))}catch(x){k=!1}if(k)try{b.push(l()),w.b&&b.push(n())}catch(q){b.push(d("5R5I5Cd55IdR1W5Ddv5R5DdWd2535s5C"))}b.push(y());w.a&&h.push(m());h.push(J[d("dDdR5Dd12I5d5D5Cd2")]);h.push(J[f("5w5I5C5ddD5I5d5D")]);h.push(window[f("dR5Rd15D5D5C")][c("5R5s5w5sd1225DdWd25v")]);w.j&&(k=window[e("dR5Rd15D5D5C")]?
[window[c("dR5Rd15D5D5C")].height,window[f("dR5Rd15D5D5C")].width]:[a[7],a[7]],typeof k!==f("dD5C525D55535C5D52")&&h.push(k.join(f("dv"))));h.push((new Date)[d("5d5Dd2D253585DdX5s5C5D2s5555dR5Dd2")]());h.push(J[c("525s2C5sd2D2d15I5R5z")]);h.push(p())}k=[];w.e?(k.push(w.e(b.join(d("1R1R1R")))),k.push(w.e(h.join(d("1R1R1R"))))):(k.push(T(b.join(d("1R1R1R")))),k.push(T(h.join(d("1R1R1R")))));return k}}function T(b){var f=a[80],h,n,k,y,l,p;h=b.length&a[10];n=b.length-h;k=f;f=a[12];y=a[368];for(p=a[7];p<
n;)l=b.charCodeAt(p)&a[291]|(b.charCodeAt(++p)&a[291])<<a[29]|(b.charCodeAt(++p)&a[291])<<a[50]|(b.charCodeAt(++p)&a[291])<<a[66],++p,l=(l&a[477])*f+(((l>>>a[50])*f&a[477])<<a[50])&a[397],l=l<<a[48]|l>>>a[52],l=(l&a[477])*y+(((l>>>a[50])*y&a[477])<<a[50])&a[397],k^=l,k=k<<a[42]|k>>>a[56],k=(k&a[477])*a[17]+(((k>>>a[50])*a[17]&a[477])<<a[50])&a[397],k=(k&a[477])+a[387]+(((k>>>a[50])+a[427]&a[477])<<a[50]);l=a[7];switch(h){case a[10]:l^=(b.charCodeAt(p+a[6])&a[291])<<a[50];case a[6]:l^=(b.charCodeAt(p+
a[532])&a[291])<<a[29];case a[532]:l^=b.charCodeAt(p)&a[291],l=(l&a[477])*f+(((l>>>a[50])*f&a[477])<<a[50])&a[397],l=l<<a[48]|l>>>a[52],l=(l&a[477])*y+(((l>>>a[50])*y&a[477])<<a[50])&a[397],k^=l}k^=b.length;k^=k>>>a[50];k=(k&a[477])*a[399]+(((k>>>a[50])*a[399]&a[477])<<a[50])&a[397];k^=k>>>a[42];k=(k&a[477])*a[342]+(((k>>>a[50])*a[342]&a[477])<<a[50])&a[397];k^=k>>>a[50];b=k>>>a[7];h=[];h.push(b);try{for(var q,r=b+g(""),A=a[7],D=a[7],u=a[7];u<r.length;u++)try{var B=parseInt(r.charAt(u)+d("")),A=B||
B===a[7]?A+B:A+a[532];D++}catch(x){A+=a[532],D++}D=D==a[7]?a[532]:D;q=Z(A*a[532]/D,O);for(var t,w=Math.floor(q/Math.pow(a[34],O-a[532])),E=b+c(""),C=a[7],G=a[7],H=a[7],I=a[7],v=a[7];v<E.length;v++)try{var z=parseInt(E.charAt(v)+g(""));z||z===a[7]?z<w?(G++,C+=z):(I++,H+=z):(I++,H+=w)}catch(F){I++,H+=w}I=I==a[7]?a[532]:I;G=G==a[7]?a[532]:G;t=Z(H*a[532]/I-C*a[532]/G,P);h.push(ua(q,O,c("RW")));h.push(ua(t,P,c("RW")))}catch(K){h=[],h.push(b),h.push(V(O,g("18")).join(e(""))),h.push(V(P,g("18")).join(c("")))}return h.join(c(""))}
function Z(b,d){if(b<a[7]||b>=a[34])throw Error(c("RIRIRIRW"));for(var h=V(d,f("RW")),n=g("")+b,k=a[7],p=a[7];k<h.length&&p<n.length;p++)n.charAt(p)!=f("1C")&&(h[k++]=n.charAt(p));return parseInt(h.join(e("")))}function ua(a,d,c){a=f("")+a;if(a.length>d)throw Error(g("RIRIRIRI"));if(a.length==d)return a;for(var n=[],k=a.length;k<d;k++)n.push(c);n.push(a);return n.join(e(""))}function V(b,d){if(b<=a[7])return[a[7]];for(var c=[],e=a[7];e<b;e++)c.push(d);return c}function q(a){return null==a||void 0==
a}function p(a,d,c){this.f=a;this.c=d;this.g=q(c)?!0:c}function Pa(a){if(q(a)||q(a.f)||q(a.c))return!1;try{if(q(window[a.f]))return!1}catch(d){return!1}return!0}function v(b,d){if(q(b))return g("");for(var c=a[7];c<b.length;c++){var e=b[c];if(!q(e)&&e.f==d)return e}}function va(){var b;a:{if(!q(r))for(b=a[7];b<r.length;b++){var m=r[b];if(m.g&&!Pa(m)){b=m;break a}}b=null}var h;if(q(b)){try{h=window.parseFloat(g("RI1CRWRI"))===a[377]&&window.isNaN(window.parseFloat(e("2v2D2w2w2s")))}catch(n){h=!1}if(h){var k;
try{k=window.parseInt(e("RIR1RR"))===a[265]&&window.isNaN(window.parseInt(c("2v2D2w2w2s")))}catch(p){k=!1}if(k){var l;try{l=window.decodeURI(g("1DR1R1"))===e("11")}catch(B){l=!1}if(l){var z;try{z=window.decodeURIComponent(c("1DR1R5"))===d("15")}catch(t){z=!1}if(z){var A;try{A=window.encodeURI(d("11"))===d("1DR1R1")}catch(D){A=!1}if(A){var u;try{u=window.encodeURIComponent(e("15"))===e("1DR1R5")}catch(F){u=!1}if(u){var x;try{x=window.escape(e("15"))===g("1DR1R5")}catch(K){x=!1}if(x){var w;try{w=window.unescape(e("1DR1R5"))===
e("15")}catch(E){w=!1}if(w){var C;try{C=window.eval(d("1v55dD5C5Rd2535s5C1v13dzd15Dd2dDd15C1WRIR1RRRzd8131v13Rz"))===a[265]}catch(G){C=!1}h=C?null:v(r,g("5Dd55I5w"))}else h=v(r,c("dD5C5DdR5R5IdW5D"))}else h=v(r,f("5DdR5R5IdW5D"))}else h=v(r,f("5D5C5R5s525DDDD1232R5s58dW5s5C5D5Cd2"))}else h=v(r,f("5D5C5R5s525DDDD123"))}else h=v(r,d("525D5R5s525DDDD1232R5s58dW5s5C5D5Cd2"))}else h=v(r,f("525D5R5s525DDDD123"))}else h=v(r,e("dW5Id1dR5D235Cd2"))}else h=v(r,e("dW5Id1dR5D255w5s5Id2"))}else h=b;return h}function Qa(){var a=
va();if(!q(a))return a.c;try{a=q(window[c("dW5v5I5Cd25s58")])||q(window[c("dW5v5I5Cd25s58")][e("535C5X5D5Rd22XdR")])?null:v(r,c("dW5v5I5Cd25s581C535C5X5D5Rd22XdR"))}catch(f){a=null}if(!q(a))return a.c;try{a=q(context)||q(context[d("5v5IdR5v2R5s525D")])?null:v(r,c("5R5s5Cd25Ddvd21C5v5IdR5v2R5s525D"))}catch(h){a=null}return q(a)?null:a.c}function wa(b){for(var d=[],e=a[7];e<b;e++){var f=Math.random()*Ra,f=Math.floor(f);d.push(xa.charAt(f))}return d.join(c(""))}function W(b){for(var c=(t[e("5R5s5s5z535D")]||
d("")).split(f("Rz1W")),h=a[7];h<c.length;h++){var g=c[h].indexOf(e("R8"));if(g>=a[7]){var k=c[h].substring(g+a[532],c[h].length);if(c[h].substring(a[7],g)==b)return window.decodeURIComponent(k)}}return null}function ya(b){var m=[c("d5"),f("55dW"),g("dD"),c("5v"),e("5D5R"),c("5D58"),c("535RdW")],h=c("");if(null==b||void 0==b)return b;if(typeof b==[d("5s51"),f("5X5D"),c("5Rd2")].join(e(""))){for(var h=h+d("dz"),n=a[7];n<m.length;n++)if(b.hasOwnProperty(m[n])){var k=g("1d")+m[n]+f("1dRX1d"),p;p=f("")+
b[m[n]];p=null==p||void 0==p?p:p.replace(/'/g,g("Dw1d")).replace(/"/g,d("11"));h+=k+p+c("1d1w")}h.charAt(h.length-a[532])==c("1w")&&(h=h.substring(a[7],h.length-a[532]));return h+=d("d8")}return null}function ja(a,m,h,n){var k=[];k.push(a+c("R8")+encodeURIComponent(m));h&&(a=new Date,a=new Date(n),n=a[d("d25s2d28D2DRd2d1535C5d")](),k.push(e("Rz1W")),k.push(e("5Ddv")),k.push(e("dW53")),k.push(f("d15D")),k.push(f("dRR8")),k.push(n));k.push(g("Rz1W"));k.push(g("dW5I"));k.push(g("d25vR81s"));null!=F&&
void 0!=F&&F!=e("")&&(k.push(f("Rz1W")),k.push(e("525s")),k.push(e("585I53")),k.push(g("5CR8")),k.push(F));t[d("5R5s5s5z535D")]=k.join(g(""))}function za(a){window[ka]=a}function Aa(a){window[la]=a}function Ba(b,c){for(var e=[],f=a[7];f<c;f++)e.push(b);return e.join(d(""))}function Ca(a,d){var e=W(a);null!==e&&void 0!==e&&e!==c("")||ja(a,d,!1)}function Da(){var a=W(X);if(null==a||void 0==a||a==f(""))a=window[la];return a}function Sa(){var a=Da();if(null==a||void 0==a||a==c(""))return!1;try{return(a=
parseInt(a))&&a>=aa?!0:!1}catch(d){return!1}}function Ea(b){if(null==b||void 0==b||b==f(""))return null;b=b.split(d("RX"));return b.length<a[6]||!/[0-9]+/gi.test(b[a[532]])?null:parseInt(b[a[532]])}function Q(){var a=W(U);if(null==a||void 0==a||a==c(""))a=window[ka];return a}function Ta(){var b=Q();if(null==b||void 0==b||b==d(""))return a[7];b=Ea(b);return null==b?a[7]:b-(ma-na)-(new (window[g("225Id25D")]))[d("5d5Dd2D253585D")]()}function Fa(b,m){var h=new (window[e("225Id25D")]);h[d("dR5Dd2D253585D")](h[g("5d5Dd2D253585D")]()-
a[318]);null==m||void 0==m||m==c("")?window[d("525s5RdD585D5Cd2")][f("5R5s5s5z535D")]=b+d("R85CdD5w5wRz1WdW5Id25vR81sRz1W5DdvdW53d15DdRR8")+h[d("d25s2d28D2DRd2d1535C5d")]():window[d("525s5RdD585D5Cd2")][c("5R5s5s5z535D")]=b+d("R85CdD5w5wRz1WdW5Id25vR81sRz1W525s585I535CR8")+m+c("Rz1W5DdvdW53d15DdRR8")+h[e("d25s2d28D2DRd2d1535C5d")]()}function Ga(){if(!(null==L||void 0==L||L.length<=a[7]))for(var b=a[7];b<L.length;b++){var d=L[b];(null!=F&&void 0!=F&&F!=e("")||null!=d&&void 0!=d&&d!=e(""))&&F!=d&&(Fa(U,
d),Fa(X,d))}}function oa(){Ga();window[la]=null;window[ka]=null;var b=!0,m={v:c("d5RI1CRI")},h=Qa();h&&(m[g("535RdW")]=h);h=null;m[f("5v")]=Ua;var n=(new (window[c("225Id25D")]))[e("5d5Dd2D253585D")]()+ma,k=n+a[300]*a[140]*a[140]*a[66]*a[295]*a[17];m[d("dD")]=wa(a[10])+n+wa(a[10]);try{var p=(new Ma({b:Va,a:Wa})).get();null!=p&&void 0!=p&&p.length>a[7]?m[f("55dW")]=p.join(e("1w")):(m[d("55dW")]=Ba(d("RW"),a[34]),m[f("5D5R")]=d("RI"),b=!1)}catch(l){m[g("55dW")]=Ba(g("RW"),a[34]),m[e("5D5R")]=f("RI"),
b=!1}try{var q=h=ya(m),m=Xa;if(null==m||void 0==m)throw Error(d("RIRWRWRv"));if(null==q||void 0==q)q=c("");var p=q,r;r=null==q?qa([]):qa(ga(q));var t=ga(p+r),A=ga(m);null==t&&(t=[]);r=[];for(var D=a[7];D<pa;D++){var u=Math.random()*a[293],u=Math.floor(u);r[D]=z(u)}var A=fa(A),A=ia(A,fa(r)),D=A=fa(A),v;if(null==t||void 0==t||t.length==a[7])v=sa(B);else{var x=t.length,F=a[7],F=x%B<=B-ba?B-x%B-ba:B*a[6]-x%B-ba,u=[];K(t,a[7],u,a[7],x);for(var w=a[7];w<F;w++)u[x+w]=a[7];K(ta(x),a[7],u,x+F,ba);v=u}x=v;
if(null==x||x.length%B!=a[7])throw Error(e("RIRWRWRD"));v=[];for(var E=a[7],C=x.length/B,G=a[7];G<C;G++){v[G]=[];for(var H=a[7];H<B;H++)v[G][H]=x[E++]}E=[];K(r,a[7],E,a[7],pa);for(var I=v.length,J=a[7];J<I;J++){var L;var M=v[J];if(null==M)L=null;else{for(var S=z(a[84]),C=[],T=M.length,O=a[7];O<T;O++)C.push(La(M[O],S++));L=C}var P=ia(L,A),ca;C=P;G=D;if(null==C)ca=null;else if(null==G)ca=C;else{for(var H=[],V=G.length,Y=a[7],W=C.length;Y<W;Y++)H[Y]=z(C[Y]+G[Y%V]);ca=H}var P=ia(ca,D),da=N(P),da=N(da);
K(da,a[7],E,J*B+pa,B);D=da}var ea;if(null==E||void 0==E)ea=null;else if(E.length==a[7])ea=f("");else{var Q=a[10];try{for(var I=[],R=a[7];R<E.length;)if(R+Q<=E.length)I.push(ra(E,R,Q)),R+=Q;else{I.push(ra(E,R,E.length-R));break}ea=I.join(c(""))}catch(ha){throw Error(c("RIRWRIRW"));}}h=ea}catch(Z){h=ya({ec:e("R1"),em:Z.message}),b=!1}h=h+c("RX")+n;ja(U,h,b,k);Ca(U,h);za(h);ja(X,aa,b,k);Ca(X,aa);Aa(aa);window[c("dR5Dd2D253585D5sdDd2")]&&window[c("dR5Dd2D253585D5sdDd2")](oa,na)}p.prototype={toString:function(){return g("dz1d5C5I585D1dRX")+
this.f+c("1w1W1d5R5s525D1dRX")+this.c+e("1w1W1d51d15sdddR5Dd1DWd15sdW1dRX")+this.g+c("d8")}};var r=[new p(d("dd535C525sdd"),e("RWRWRWRW")),new p(e("525s5RdD585D5Cd2"),c("RWRWRWRI")),new p(g("5C5Id5535d5Id25sd1"),e("RWRWRWR1")),new p(d("5w5s5R5Id2535s5C"),f("RWRWRWRR")),new p(c("5v53dRd25sd1d3"),c("RWRWRWR2")),new p(c("dR5Rd15D5D5C"),g("RWRWRWRd")),new p(d("dW5Id15D5Cd2"),e("RWRWRWRv")),new p(g("d25sdW"),e("RWRWRWR3")),new p(g("dR5D5w55"),c("RWRWRIRW")),new p(f("dW5Id1dR5D255w5s5Id2"),c("RWRIRWRW")),
new p(g("dW5Id1dR5D235Cd2"),d("RWRIRWRI")),new p(c("525D5R5s525DDDD123"),e("RWRIRWR1")),new p(g("525D5R5s525DDDD1232R5s58dW5s5C5D5Cd2"),e("RWRIRWRR")),new p(c("5D5C5R5s525DDDD123"),f("RWRIRWR2")),new p(f("5D5C5R5s525DDDD1232R5s58dW5s5C5D5Cd2"),d("RWRIRWRD")),new p(c("5DdR5R5IdW5D"),c("RWRIRWR5")),new p(e("dD5C5DdR5R5IdW5D"),f("RWRIRWRd")),new p(g("5Dd55I5w"),c("RWRIRWRv")),new p(c("DsdW5v5I5Cd25s58"),f("RWR1RWRW"),!1),new p(e("5R5I5w5wDW5v5I5Cd25s58"),g("RWR1RWRI"),!1),new p(e("dW5v5I5Cd25s58"),c("RWR1RWR1"),
!1),new p(g("dW5v5I5Cd25s581C535C5X5D5Rd22XdR"),c("RWR1RWRR"),!1),new p(d("5R5s5Cd25Ddvd21C5v5IdR5v2R5s525D"),g("RWR1RIRI"),!1)],Oa=va()?!1:!0,Ua=window&&window[d("5w5s5R5Id2535s5C")]&&window[e("5w5s5R5Id2535s5C")].host||d("5C5sd2Ds5Ddv53dRd2Ds5v5sdRd2"),t=window[e("525s5RdD585D5Cd2")],J=window[c("5C5Id5535d5Id25sd1")],O=a[6],P=a[6],ha=[g("RW"),c("RI"),g("R1"),c("RR"),d("R2"),c("RD"),e("R5"),c("Rd"),e("Rv"),c("R3"),g("5I"),c("51"),c("5R"),d("52"),c("5D"),f("55")],Ia=[a[7],a[370],a[376],a[513],a[440],
a[308],a[486],a[336],a[453],a[533],a[302],a[452],a[487],a[455],a[407],a[31],a[446],a[356],a[524],a[394],a[430],a[285],a[359],a[502],a[482],a[484],a[467],a[325],a[530],a[404],a[289],a[419],a[465],a[20],a[362],a[494],a[317],a[346],a[537],a[383],a[412],a[432],a[166],a[434],a[298],a[492],a[460],a[328],a[499],a[323],a[473],a[348],a[351],a[392],a[372],a[519],a[516],a[450],a[415],a[25],a[400],a[511],a[311],a[437],a[462],a[429],a[39],a[409],a[539],a[497],a[454],a[304],a[312],a[248],a[338],a[489],a[373],a[388],
a[514],a[378],a[408],a[528],a[421],a[290],a[488],a[478],a[327],a[469],a[292],a[425],a[504],a[360],a[361],a[442],a[396],a[525],a[495],a[287],a[329],a[461],a[435],a[405],a[436],a[183],a[347],a[309],a[384],a[538],a[24],a[457],a[496],a[363],a[512],a[390],a[438],a[313],a[451],a[508],a[28],a[416],a[395],a[343],a[520],a[374],a[326],a[490],a[349],a[474],a[472],a[324],a[443],a[481],a[288],a[423],a[334],a[411],a[527],a[393],a[507],a[355],a[358],a[506],a[470],a[296],a[306],a[449],a[131],a[531],a[406],a[45],
a[301],a[464],a[380],a[510],a[381],a[367],a[485],a[341],a[333],a[316],a[418],a[19],a[518],a[447],a[310],a[441],a[382],a[517],a[476],a[345],a[501],a[321],a[371],a[523],a[335],a[401],a[275],a[433],a[413],a[428],a[458],a[332],a[122],a[500],a[365],a[493],a[466],a[13],a[536],a[389],a[299],a[353],a[505],a[357],a[294],a[340],a[391],a[526],a[354],a[320],a[422],a[286],a[410],a[375],a[322],a[471],a[480],a[23],a[339],a[483],a[314],a[352],a[509],a[379],a[366],a[402],a[43],a[403],a[463],a[315],a[448],a[305],a[529],
a[297],a[522],a[369],a[398],a[337],a[344],a[475],a[319],a[503],a[439],a[307],a[515],a[385],a[15],a[417],a[445],a[521],a[386],a[535],a[350],a[303],a[491],a[364],a[8],a[468],a[331],a[456],a[498],a[149],a[431],a[224],a[426],a[414]],Ha=[a[165],a[257],a[276],a[223],a[249],a[60],a[199],a[207],a[174],a[215],a[277],a[141],a[148],a[32],a[140],a[94],a[110],a[146],a[111],a[58],a[250],a[232],a[123],a[157],a[167],a[200],a[150],a[266],a[17],a[168],a[151],a[191],a[192],a[90],a[193],a[240],a[70],a[225],a[115],a[118],
a[86],a[226],a[48],a[208],a[62],a[169],a[267],a[40],a[76],a[152],a[216],a[68],a[184],a[95],a[9],a[106],a[241],a[6],a[74],a[82],a[242],a[124],a[132],a[116],a[278],a[251],a[194],a[112],a[102],a[103],a[80],a[217],a[104],a[72],a[37],a[195],a[274],a[133],a[46],a[209],a[22],a[175],a[233],a[268],a[107],a[81],a[196],a[153],a[210],a[145],a[44],a[211],a[534],a[201],a[51],a[127],a[71],a[158],a[87],a[234],a[10],a[269],a[91],a[34],a[41],a[119],a[182],a[258],a[47],a[52],a[218],a[88],a[170],a[35],a[154],a[98],a[26],
a[89],a[83],a[117],a[252],a[259],a[61],a[202],a[203],a[77],a[185],a[66],a[125],a[265],a[30],a[33],a[16],a[282],a[42],a[260],a[7],a[219],a[186],a[144],a[155],a[96],a[14],a[261],a[253],a[227],a[105],a[159],a[254],a[97],a[128],a[136],a[187],a[137],a[54],a[160],a[235],a[57],a[176],a[75],a[236],a[84],a[279],a[138],a[55],a[280],a[99],a[73],a[139],a[129],a[171],a[59],a[237],a[100],a[220],a[281],a[212],a[243],a[177],a[161],a[244],a[134],a[178],a[114],a[162],a[108],a[532],a[163],a[238],a[147],a[228],a[179],
a[78],a[18],a[27],a[229],a[188],a[262],a[63],a[156],a[197],a[245],a[69],a[270],a[204],a[255],a[273],a[189],a[142],a[11],a[109],a[101],a[164],a[271],a[130],a[53],a[113],a[180],a[85],a[190],a[230],a[120],a[121],a[246],a[181],a[247],a[21],a[79],a[38],a[231],a[67],a[263],a[92],a[205],a[213],a[221],a[214],a[239],a[135],a[222],a[264],a[256],a[172],a[143],a[64],a[173],a[272],a[29],a[65],a[198],a[206],a[50],a[56],a[49],a[93],a[126]],B=a[152],M=a[152],ba=a[14],pa=a[14],Xa=g("RIR2RdR1RW5R55R2R1RI225D2121RW22RD5525Rv5D2I2I2D52225IRRRR2IRR22RvRDRvR12I22RWR15I51RWRRRW"),
U=e("2XDR2DDRDR232s2C232218Dd2z2w18Rv232s"),X=c("Ds5z5w5vd2dv52Ds"),aa=a[80],xa=e("5IDX51D3RW5RDv52DdRI5DD555R1DD5dRRD25vR2DR53D1RD5XDI5zR5DW5w2sRd582C5CRv285s2wR3dW2zdI2Xd123dR2vd22ddD25d52Ddd22dv2Rd321dX2I"),Ra=xa.length,ma=a[330],na=a[36],Wa=!1,Va=!1,S=window&&window[g("5w5s5R5Id2535s5C")]&&window[d("5w5s5R5Id2535s5C")][d("5v5sdRd25C5I585D")]||d("5C5sd2Ds5Ddv53dRd2Ds5v5sdRd25C5I585D"),F=d("1C5z5I5s5w5I1C5R5s58Rz1C5z5I5s5w5I1C5R5s581C5v5z"),F=function(b,e){if(null==b||void 0==b||b==f("")||null==
e||void 0==e||e.length<=a[7])return null;e=e.split(c("Rz"));for(var h=a[7];h<e.length;h++){var n=new RegExp(e[h].replace(/\./g,d("Dw1C"))+g("12"));if(null!=b.match(n))return e[h]}return null}(S,F),ka=U.replace(/[^a-zA-Z0-9$]/g,c("")).toLowerCase(),la=X.replace(/[^a-zA-Z0-9$]/g,e("")).toLowerCase(),L=function(b){var c=[];if(!b)return c;b=b.split(d("1C"));for(var f=e(""),n=a[7];n<b.length;n++)n<b.length-a[532]&&(f=g("1C")+b[b.length-a[532]-n]+f,c.push(f));return c}(S);L.push(null);L.push(d("1C")+S);
(function(b){for(var c=a[7],h=(t[d("5R5s5s5z535D")]||f("")).split(g("Rz1W")),n=a[7];n<h.length;n++){var k=h[n].indexOf(e("R8"));k>=a[7]&&h[n].substring(a[7],k)==b&&(c+=a[532])}return c})(U)>a[532]&&Ga();(function(){var a=Q();if(null==a||void 0==a||a==g(""))a=!1;else{var c;if(c=Sa())a=Ea(a),c=!(null==a||a-(new (window[e("225Id25D")]))[d("5d5Dd2D253585D")]()<=ma-na);a=c}return a})()?(za(Q()),Aa(Da()),S=Ta(),window[d("dR5Dd2D253585D5sdDd2")]&&window[f("dR5Dd2D253585D5sdDd2")](oa,S)):oa()})()})()})();
I$(5,function (_t,_ut,j,BaseComponent,Topbar,Footer,Nav, Bottomnav,ActionManage, fingerprint,_p,_o,_f,_r,_pro) {

        _p._$$Module = NEJ.C();
        pro = _p._$$Module._$extend(_t._$$EventTarget);

        pro.__init = function(_options) {
            this.__supInit(_options);
            this.__initTopBar();
            // Footer._$allocate();
            ActionManage._$allocate();
            Nav._$allocate();

            Bottomnav._$allocate();
            this.__initDspCookie();
        };
        pro.__initTopBar = function(){
        	this.__topbar = Topbar._$allocate({'login':this.__login._$bind(this)});
          this.__rightBar = this.__topbar.__rightBar;
          window._$refreshTopbar = this.__topbar._$refreshTopbar._$bind(this.__topbar);
        };

        pro._$refreshTopbar = function(){
        	this.__topbar._$refreshTopbar();
        };

        pro.__initDspCookie = function(){
          var str = location.search.replace(/^\?/g, "");
          //gtm保存渠道标识，存入cookie
          if(/__da_.+/g.test(str)){
            var params = str.split('&');
            _ut._$forEach(params,function(s){
              if(/^__da_/g.test(s)){
                j._$cookie('gtm_dsp_tag',{value:s, path : '/', domain: 'kaola.com', expires:7});
              }
            });
          }
        };

        pro.__login = _f;
        return _p._$$Module;
    },23,2,11,151,219,220,221,222,223,224);
var QRCode;!function(){function a(a){this.mode=c.MODE_8BIT_BYTE,this.data=a,this.parsedData=[];for(var b=[],d=0,e=this.data.length;e>d;d++){var f=this.data.charCodeAt(d);f>65536?(b[0]=240|(1835008&f)>>>18,b[1]=128|(258048&f)>>>12,b[2]=128|(4032&f)>>>6,b[3]=128|63&f):f>2048?(b[0]=224|(61440&f)>>>12,b[1]=128|(4032&f)>>>6,b[2]=128|63&f):f>128?(b[0]=192|(1984&f)>>>6,b[1]=128|63&f):b[0]=f,this.parsedData=this.parsedData.concat(b)}this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function b(a,b){this.typeNumber=a,this.errorCorrectLevel=b,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function i(a,b){if(void 0==a.length)throw new Error(a.length+"/"+b);for(var c=0;c<a.length&&0==a[c];)c++;this.num=new Array(a.length-c+b);for(var d=0;d<a.length-c;d++)this.num[d]=a[d+c]}function j(a,b){this.totalCount=a,this.dataCount=b}function k(){this.buffer=[],this.length=0}function m(){return"undefined"!=typeof CanvasRenderingContext2D}function n(){var a=!1,b=navigator.userAgent;return/android/i.test(b)&&(a=!0,aMat=b.toString().match(/android ([0-9]\.[0-9])/i),aMat&&aMat[1]&&(a=parseFloat(aMat[1]))),a}function r(a,b){for(var c=1,e=s(a),f=0,g=l.length;g>=f;f++){var h=0;switch(b){case d.L:h=l[f][0];break;case d.M:h=l[f][1];break;case d.Q:h=l[f][2];break;case d.H:h=l[f][3]}if(h>=e)break;c++}if(c>l.length)throw new Error("Too long data");return c}function s(a){var b=encodeURI(a).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return b.length+(b.length!=a?3:0)}a.prototype={getLength:function(){return this.parsedData.length},write:function(a){for(var b=0,c=this.parsedData.length;c>b;b++)a.put(this.parsedData[b],8)}},b.prototype={addData:function(b){var c=new a(b);this.dataList.push(c),this.dataCache=null},isDark:function(a,b){if(0>a||this.moduleCount<=a||0>b||this.moduleCount<=b)throw new Error(a+","+b);return this.modules[a][b]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(a,c){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++){this.modules[d]=new Array(this.moduleCount);for(var e=0;e<this.moduleCount;e++)this.modules[d][e]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(a,c),this.typeNumber>=7&&this.setupTypeNumber(a),null==this.dataCache&&(this.dataCache=b.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,c)},setupPositionProbePattern:function(a,b){for(var c=-1;7>=c;c++)if(!(-1>=a+c||this.moduleCount<=a+c))for(var d=-1;7>=d;d++)-1>=b+d||this.moduleCount<=b+d||(this.modules[a+c][b+d]=c>=0&&6>=c&&(0==d||6==d)||d>=0&&6>=d&&(0==c||6==c)||c>=2&&4>=c&&d>=2&&4>=d?!0:!1)},getBestMaskPattern:function(){for(var a=0,b=0,c=0;8>c;c++){this.makeImpl(!0,c);var d=f.getLostPoint(this);(0==c||a>d)&&(a=d,b=c)}return b},createMovieClip:function(a,b,c){var d=a.createEmptyMovieClip(b,c),e=1;this.make();for(var f=0;f<this.modules.length;f++)for(var g=f*e,h=0;h<this.modules[f].length;h++){var i=h*e,j=this.modules[f][h];j&&(d.beginFill(0,100),d.moveTo(i,g),d.lineTo(i+e,g),d.lineTo(i+e,g+e),d.lineTo(i,g+e),d.endFill())}return d},setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++)null==this.modules[a][6]&&(this.modules[a][6]=0==a%2);for(var b=8;b<this.moduleCount-8;b++)null==this.modules[6][b]&&(this.modules[6][b]=0==b%2)},setupPositionAdjustPattern:function(){for(var a=f.getPatternPosition(this.typeNumber),b=0;b<a.length;b++)for(var c=0;c<a.length;c++){var d=a[b],e=a[c];if(null==this.modules[d][e])for(var g=-2;2>=g;g++)for(var h=-2;2>=h;h++)this.modules[d+g][e+h]=-2==g||2==g||-2==h||2==h||0==g&&0==h?!0:!1}},setupTypeNumber:function(a){for(var b=f.getBCHTypeNumber(this.typeNumber),c=0;18>c;c++){var d=!a&&1==(1&b>>c);this.modules[Math.floor(c/3)][c%3+this.moduleCount-8-3]=d}for(var c=0;18>c;c++){var d=!a&&1==(1&b>>c);this.modules[c%3+this.moduleCount-8-3][Math.floor(c/3)]=d}},setupTypeInfo:function(a,b){for(var c=this.errorCorrectLevel<<3|b,d=f.getBCHTypeInfo(c),e=0;15>e;e++){var g=!a&&1==(1&d>>e);6>e?this.modules[e][8]=g:8>e?this.modules[e+1][8]=g:this.modules[this.moduleCount-15+e][8]=g}for(var e=0;15>e;e++){var g=!a&&1==(1&d>>e);8>e?this.modules[8][this.moduleCount-e-1]=g:9>e?this.modules[8][15-e-1+1]=g:this.modules[8][15-e-1]=g}this.modules[this.moduleCount-8][8]=!a},mapData:function(a,b){for(var c=-1,d=this.moduleCount-1,e=7,g=0,h=this.moduleCount-1;h>0;h-=2)for(6==h&&h--;;){for(var i=0;2>i;i++)if(null==this.modules[d][h-i]){var j=!1;g<a.length&&(j=1==(1&a[g]>>>e));var k=f.getMask(b,d,h-i);k&&(j=!j),this.modules[d][h-i]=j,e--,-1==e&&(g++,e=7)}if(d+=c,0>d||this.moduleCount<=d){d-=c,c=-c;break}}}},b.PAD0=236,b.PAD1=17,b.createData=function(a,c,d){for(var e=j.getRSBlocks(a,c),g=new k,h=0;h<d.length;h++){var i=d[h];g.put(i.mode,4),g.put(i.getLength(),f.getLengthInBits(i.mode,a)),i.write(g)}for(var l=0,h=0;h<e.length;h++)l+=e[h].dataCount;if(g.getLengthInBits()>8*l)throw new Error("code length overflow. ("+g.getLengthInBits()+">"+8*l+")");for(g.getLengthInBits()+4<=8*l&&g.put(0,4);0!=g.getLengthInBits()%8;)g.putBit(!1);for(;;){if(g.getLengthInBits()>=8*l)break;if(g.put(b.PAD0,8),g.getLengthInBits()>=8*l)break;g.put(b.PAD1,8)}return b.createBytes(g,e)},b.createBytes=function(a,b){for(var c=0,d=0,e=0,g=new Array(b.length),h=new Array(b.length),j=0;j<b.length;j++){var k=b[j].dataCount,l=b[j].totalCount-k;d=Math.max(d,k),e=Math.max(e,l),g[j]=new Array(k);for(var m=0;m<g[j].length;m++)g[j][m]=255&a.buffer[m+c];c+=k;var n=f.getErrorCorrectPolynomial(l),o=new i(g[j],n.getLength()-1),p=o.mod(n);h[j]=new Array(n.getLength()-1);for(var m=0;m<h[j].length;m++){var q=m+p.getLength()-h[j].length;h[j][m]=q>=0?p.get(q):0}}for(var r=0,m=0;m<b.length;m++)r+=b[m].totalCount;for(var s=new Array(r),t=0,m=0;d>m;m++)for(var j=0;j<b.length;j++)m<g[j].length&&(s[t++]=g[j][m]);for(var m=0;e>m;m++)for(var j=0;j<b.length;j++)m<h[j].length&&(s[t++]=h[j][m]);return s};for(var c={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},d={L:1,M:0,Q:3,H:2},e={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},f={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){for(var b=a<<10;f.getBCHDigit(b)-f.getBCHDigit(f.G15)>=0;)b^=f.G15<<f.getBCHDigit(b)-f.getBCHDigit(f.G15);return(a<<10|b)^f.G15_MASK},getBCHTypeNumber:function(a){for(var b=a<<12;f.getBCHDigit(b)-f.getBCHDigit(f.G18)>=0;)b^=f.G18<<f.getBCHDigit(b)-f.getBCHDigit(f.G18);return a<<12|b},getBCHDigit:function(a){for(var b=0;0!=a;)b++,a>>>=1;return b},getPatternPosition:function(a){return f.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,b,c){switch(a){case e.PATTERN000:return 0==(b+c)%2;case e.PATTERN001:return 0==b%2;case e.PATTERN010:return 0==c%3;case e.PATTERN011:return 0==(b+c)%3;case e.PATTERN100:return 0==(Math.floor(b/2)+Math.floor(c/3))%2;case e.PATTERN101:return 0==b*c%2+b*c%3;case e.PATTERN110:return 0==(b*c%2+b*c%3)%2;case e.PATTERN111:return 0==(b*c%3+(b+c)%2)%2;default:throw new Error("bad maskPattern:"+a)}},getErrorCorrectPolynomial:function(a){for(var b=new i([1],0),c=0;a>c;c++)b=b.multiply(new i([1,g.gexp(c)],0));return b},getLengthInBits:function(a,b){if(b>=1&&10>b)switch(a){case c.MODE_NUMBER:return 10;case c.MODE_ALPHA_NUM:return 9;case c.MODE_8BIT_BYTE:return 8;case c.MODE_KANJI:return 8;default:throw new Error("mode:"+a)}else if(27>b)switch(a){case c.MODE_NUMBER:return 12;case c.MODE_ALPHA_NUM:return 11;case c.MODE_8BIT_BYTE:return 16;case c.MODE_KANJI:return 10;default:throw new Error("mode:"+a)}else{if(!(41>b))throw new Error("type:"+b);switch(a){case c.MODE_NUMBER:return 14;case c.MODE_ALPHA_NUM:return 13;case c.MODE_8BIT_BYTE:return 16;case c.MODE_KANJI:return 12;default:throw new Error("mode:"+a)}}},getLostPoint:function(a){for(var b=a.getModuleCount(),c=0,d=0;b>d;d++)for(var e=0;b>e;e++){for(var f=0,g=a.isDark(d,e),h=-1;1>=h;h++)if(!(0>d+h||d+h>=b))for(var i=-1;1>=i;i++)0>e+i||e+i>=b||(0!=h||0!=i)&&g==a.isDark(d+h,e+i)&&f++;f>5&&(c+=3+f-5)}for(var d=0;b-1>d;d++)for(var e=0;b-1>e;e++){var j=0;a.isDark(d,e)&&j++,a.isDark(d+1,e)&&j++,a.isDark(d,e+1)&&j++,a.isDark(d+1,e+1)&&j++,(0==j||4==j)&&(c+=3)}for(var d=0;b>d;d++)for(var e=0;b-6>e;e++)a.isDark(d,e)&&!a.isDark(d,e+1)&&a.isDark(d,e+2)&&a.isDark(d,e+3)&&a.isDark(d,e+4)&&!a.isDark(d,e+5)&&a.isDark(d,e+6)&&(c+=40);for(var e=0;b>e;e++)for(var d=0;b-6>d;d++)a.isDark(d,e)&&!a.isDark(d+1,e)&&a.isDark(d+2,e)&&a.isDark(d+3,e)&&a.isDark(d+4,e)&&!a.isDark(d+5,e)&&a.isDark(d+6,e)&&(c+=40);for(var k=0,e=0;b>e;e++)for(var d=0;b>d;d++)a.isDark(d,e)&&k++;var l=Math.abs(100*k/b/b-50)/5;return c+=10*l}},g={glog:function(a){if(1>a)throw new Error("glog("+a+")");return g.LOG_TABLE[a]},gexp:function(a){for(;0>a;)a+=255;for(;a>=256;)a-=255;return g.EXP_TABLE[a]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},h=0;8>h;h++)g.EXP_TABLE[h]=1<<h;for(var h=8;256>h;h++)g.EXP_TABLE[h]=g.EXP_TABLE[h-4]^g.EXP_TABLE[h-5]^g.EXP_TABLE[h-6]^g.EXP_TABLE[h-8];for(var h=0;255>h;h++)g.LOG_TABLE[g.EXP_TABLE[h]]=h;i.prototype={get:function(a){return this.num[a]},getLength:function(){return this.num.length},multiply:function(a){for(var b=new Array(this.getLength()+a.getLength()-1),c=0;c<this.getLength();c++)for(var d=0;d<a.getLength();d++)b[c+d]^=g.gexp(g.glog(this.get(c))+g.glog(a.get(d)));return new i(b,0)},mod:function(a){if(this.getLength()-a.getLength()<0)return this;for(var b=g.glog(this.get(0))-g.glog(a.get(0)),c=new Array(this.getLength()),d=0;d<this.getLength();d++)c[d]=this.get(d);for(var d=0;d<a.getLength();d++)c[d]^=g.gexp(g.glog(a.get(d))+b);return new i(c,0).mod(a)}},j.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],j.getRSBlocks=function(a,b){var c=j.getRsBlockTable(a,b);if(void 0==c)throw new Error("bad rs block @ typeNumber:"+a+"/errorCorrectLevel:"+b);for(var d=c.length/3,e=[],f=0;d>f;f++)for(var g=c[3*f+0],h=c[3*f+1],i=c[3*f+2],k=0;g>k;k++)e.push(new j(h,i));return e},j.getRsBlockTable=function(a,b){switch(b){case d.L:return j.RS_BLOCK_TABLE[4*(a-1)+0];case d.M:return j.RS_BLOCK_TABLE[4*(a-1)+1];case d.Q:return j.RS_BLOCK_TABLE[4*(a-1)+2];case d.H:return j.RS_BLOCK_TABLE[4*(a-1)+3];default:return void 0}},k.prototype={get:function(a){var b=Math.floor(a/8);return 1==(1&this.buffer[b]>>>7-a%8)},put:function(a,b){for(var c=0;b>c;c++)this.putBit(1==(1&a>>>b-c-1))},getLengthInBits:function(){return this.length},putBit:function(a){var b=Math.floor(this.length/8);this.buffer.length<=b&&this.buffer.push(0),a&&(this.buffer[b]|=128>>>this.length%8),this.length++}};var l=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],o=function(){var a=function(a,b){this._el=a,this._htOption=b};return a.prototype.draw=function(a){function g(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg",a);for(var d in b)b.hasOwnProperty(d)&&c.setAttribute(d,b[d]);return c}var b=this._htOption,c=this._el,d=a.getModuleCount();Math.floor(b.width/d),Math.floor(b.height/d),this.clear();var h=g("svg",{viewBox:"0 0 "+String(d)+" "+String(d),width:"100%",height:"100%",fill:b.colorLight});h.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),c.appendChild(h),h.appendChild(g("rect",{fill:b.colorDark,width:"1",height:"1",id:"template"}));for(var i=0;d>i;i++)for(var j=0;d>j;j++)if(a.isDark(i,j)){var k=g("use",{x:String(i),y:String(j)});k.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),h.appendChild(k)}},a.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},a}(),p="svg"===document.documentElement.tagName.toLowerCase(),q=p?o:m()?function(){function a(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function d(a,b){var c=this;if(c._fFail=b,c._fSuccess=a,null===c._bSupportDataURI){var d=document.createElement("img"),e=function(){c._bSupportDataURI=!1,c._fFail&&_fFail.call(c)},f=function(){c._bSupportDataURI=!0,c._fSuccess&&c._fSuccess.call(c)};return d.onabort=e,d.onerror=e,d.onload=f,d.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==",void 0}c._bSupportDataURI===!0&&c._fSuccess?c._fSuccess.call(c):c._bSupportDataURI===!1&&c._fFail&&c._fFail.call(c)}if(this._android&&this._android<=2.1){var b=1/window.devicePixelRatio,c=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(a,d,e,f,g,h,i,j){if("nodeName"in a&&/img/i.test(a.nodeName))for(var l=arguments.length-1;l>=1;l--)arguments[l]=arguments[l]*b;else"undefined"==typeof j&&(arguments[1]*=b,arguments[2]*=b,arguments[3]*=b,arguments[4]*=b);c.apply(this,arguments)}}var e=function(a,b){this._bIsPainted=!1,this._android=n(),this._htOption=b,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=b.width,this._elCanvas.height=b.height,a.appendChild(this._elCanvas),this._el=a,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return e.prototype.draw=function(a){var b=this._elImage,c=this._oContext,d=this._htOption,e=a.getModuleCount(),f=d.width/e,g=d.height/e,h=Math.round(f),i=Math.round(g);b.style.display="none",this.clear();for(var j=0;e>j;j++)for(var k=0;e>k;k++){var l=a.isDark(j,k),m=k*f,n=j*g;c.strokeStyle=l?d.colorDark:d.colorLight,c.lineWidth=1,c.fillStyle=l?d.colorDark:d.colorLight,c.fillRect(m,n,f,g),c.strokeRect(Math.floor(m)+.5,Math.floor(n)+.5,h,i),c.strokeRect(Math.ceil(m)-.5,Math.ceil(n)-.5,h,i)}this._bIsPainted=!0},e.prototype.makeImage=function(){this._bIsPainted&&d.call(this,a)},e.prototype.isPainted=function(){return this._bIsPainted},e.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},e.prototype.round=function(a){return a?Math.floor(1e3*a)/1e3:a},e}():function(){var a=function(a,b){this._el=a,this._htOption=b};return a.prototype.draw=function(a){for(var b=this._htOption,c=this._el,d=a.getModuleCount(),e=Math.floor(b.width/d),f=Math.floor(b.height/d),g=['<table style="border:0;border-collapse:collapse;">'],h=0;d>h;h++){g.push("<tr>");for(var i=0;d>i;i++)g.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+e+"px;height:"+f+"px;background-color:"+(a.isDark(h,i)?b.colorDark:b.colorLight)+';"></td>');g.push("</tr>")}g.push("</table>"),c.innerHTML=g.join("");var j=c.childNodes[0],k=(b.width-j.offsetWidth)/2,l=(b.height-j.offsetHeight)/2;k>0&&l>0&&(j.style.margin=l+"px "+k+"px")},a.prototype.clear=function(){this._el.innerHTML=""},a}();QRCode=function(a,b){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:d.H},"string"==typeof b&&(b={text:b}),b)for(var c in b)this._htOption[c]=b[c];"string"==typeof a&&(a=document.getElementById(a)),this._android=n(),this._el=a,this._oQRCode=null,this._oDrawing=new q(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},QRCode.prototype.makeCode=function(a){this._oQRCode=new b(r(a,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(a),this._oQRCode.make(),this._el.title=a,this._oDrawing.draw(this._oQRCode),this.makeImage()},QRCode.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel=d}();
I$(236,".#<uispace> .cntbox{width:400px;padding:20px;}\n.#<uispace> .cntbox p{padding:20px 40px 0;font-size:18px;color:#333;text-align:center;}\n\n.#<uispace> .btnbox{padding:20px;text-align:center;}\n.#<uispace> .btnbox .u-btn{display:inline-block;min-width:100px;height:20px; padding:10px; text-align:center;line-height:100%;color:#fff;font-size:18px;background:#D22147;}\n\n.#<uispace> .btnbox .u-btn:hover{text-decoration:none; }\n");
I$(237,"<textarea name=\"txt\" id=\"#<seedTxt>\">\n\t<div>\n\t\t<div class=\"j-flag\">\n\t\t</div>\n\t</div>\n</textarea>\n<textarea name=\"jst\" id=\"#<seedMessage>\">\n\t<div class=\"cntbox\">\n\t\t<p>${message}</p>\n\t</div>\n\t<div class=\"btnbox\">\n\t\t<a href=\"javascript:void(0);\" class=\"u-btn j-tag\">${btntext}</a>\n\t</div>\n</textarea>");
I$(449,"<div class=\"m-notify m-notify-{position}\">\n  {#list messages as msg}\n  <div class=\"notify notify-{msg.type||'info'}\" r-animation='on: enter; class: animated fadeInX; on: leave; class: animated bounceOut fast; '>\n    <div class=\"glyphicon glyphicon-{this.iconMap[msg.type]}\"></div>\n    <span class=\"notify_close\" on-click={this.clear(msg)}>×</span>\n    <h4 class=\"notify_title\" r-hide={!msg.title}>{msg.title}</h4>\n    <p class=\"notify_message\">{msg.message}</p>\n  </div>\n  {/list}\n</div>");
I$(238,function (tpl, R, _ ){

  var Notify = Regular.extend({
    template: tpl,
    //默认时间
    duration: 3000,

    // icon对应
    iconMap: {
      "error": "remove-circle",
      "success": "ok-sign",
      "warning": "warning-sign",
      "info": "info-sign",
      "loading": "info-sign"
    },
    config: function(data){
      _.extend(data, {
        messages: [],
        position: 'right'
      })
    },
    // 初始化后的函数
    init: function(){
      // 证明不是内嵌组件
      if(this.$root == this) this.$inject(document.body);
    },
    /**
     * 增加一个提醒，添加到队伍前方
     * @param  {String|Object} message 消息或消息对象
     *      -type: error, info ,warning, success, 默认为info
     *      -title: 信息标题，默认为空
     *      -message: notify的内容
     *      -duration: 信息停留时间，-1 为无限. 默认2秒
     * @return {Function}              不等待定时器，删除掉此提醒
     */
    notify: function(message){
      if(typeof message === "string"){
        message = {
          message: message
        }
      }
      _.extend(message,{
        type: 'info',
        duration: this.duration
      })
      this.$update(function(data){
        data.messages.unshift(message)
      })
      var clearFn = this.clear.bind(this, message);
      this.$timeout(clearFn, message.duration==-1? 1000*3600 * 1000: message.duration );
      return clearFn;
    },
    /**
     * 与notify一致，但是会清理所有消息，用于唯一的消息提醒
     * @param  {String|Object} message 消息或消息对象
     * @return {Function}              不等待定时器，删除掉此提醒
     */
    show: function(message){
      this.clearTotal();
      return this.notify(message);
    },
    /**
     * 与notify一致，但是会清理所有消息，用于唯一的消息提醒
     * @param  {String|Object} message 消息或消息对象
     * @return {Function}              不等待定时器，删除掉此提醒
     */

    showError: function(message,options){
      options = _.extend(options||{}, {
        type: 'error'
      })
      return this.show(message, options);
    },
    clear: function(message){
      var messages = this.data.messages,
        len = messages.length;

      for( ;len--; ){
        if(message === messages[len]) messages.splice(len, 1);
      }
      this.$update();
    },
    clearTotal: function(){
      this.$update("messages", []);
    }
    // 使用timeout模块
  }).use('timeout');


  // 单例, 直接初始化
  var notify = new Notify({});

  notify.Notify = Notify;

  return notify;



  /**
   * 使用:
   *    notify.notify(msg) 开始进度条
   *    notify.show(msg)   显示信息
   *    notify.showError(msg) 显示错误 , show的简便接口
   */

},449,247,15);
I$(8,function (Window, _e,_v,_css, _html,_e1,_t,_e2,_p, _o, _f, _r,_pro) {
	
	var _seed_css = _e._$pushCSSText(_css),
        _seed_ui = _e1._$parseUITemplate(_html),
        _seed_txt = _seed_ui['seedTxt'],
        _seed_message = _seed_ui['seedMessage'],
	    _seed_html = _e1._$addNodeTemplate(_e1._$getTextTemplate(_seed_txt));
	
    _p._$$PromptWindow = NEJ.C();
    _pro = _p._$$PromptWindow._$extend(Window);

    _pro.__reset = function(_options) {
    	_options.title = _options.title||'提示';
    	_options.btnType = _options.btnType||'close';
        var btntext = _options.btntext||'确定';
        this.__super(_options);
        _e2._$render(this.__box, _seed_message, {message: _options.message, btntext: btntext});
        // jst模版事件监听
        var list = _e._$getByClassName(this.__box, 'j-tag');
        this.__okBtn = list[0];
        _v._$addEvent(this.__okBtn, 'click', this.__onOK._$bind(this, _options.btnType));

    };
    _pro.__destroy = function(_options) {
        this.__super(_options);
    };

    _pro.__initXGui = function() {
        this.__seed_css = _seed_css;
        this.__seed_html = _seed_html
    };

    _pro.__initNode = function() {
        this.__super();
        var _list = _e._$getByClassName(this.__body,'j-flag');
        this.__box = _list[0];
    };
    /**
     * 点击"确定"按钮事件响应
     * */
    _pro.__onOK = function(btnType, _event) {
        _v._$stop(_event);
        this._$dispatchEvent('onok');
        if(btnType == 'close'){
            this._$hide();
        }else if(btnType == 'custom'){
        }
    };
    
    return _p._$$PromptWindow;
},229,4,3,236,237,233,238,239);
I$(325,"<table class=\"m-modaltbl\">\n\t<tbody>\n\t\t<tr>\n\t\t  <td class=\"cell\">\n\t\t  <div class=\"modal iDialogContent {modalName||''} iDialogAniCore iDialogAnimate5\" ref=\"modal\" style=\"width: {width||640}px;\">\n\t\t\t  <div class=\"modal-row\">\n\t\t\t      <div class=\"modal-dialog modal-cell\">\n\t\t\t        <div class=\"modal-content\">\n\t\t\t          <div class=\"iDialogHead\">\n\t\t\t            <h4 class=\"modal-title\" id=\"myModalLabel\">{title || 'Modal title'}</h4>\n\t\t\t\t\t\t{#if !hideCloseBtn}<a class=\"iDialogClose\" href=\"javascript:void(0);\"  on-click={this.close()}></a>{/if}\n\t\t\t          </div>\n\t\t\t          <div class=\"modal-body\">\n\t\t\t            {#include content ||this.content }\n\t\t\t          </div>\n\t\t\t        </div>\n\t\t\t      </div>\n\t\t\t   </div>\n\t\t\t</div>\n\t\t  </td>\n\t\t</tr>\n\t</tbody>\n</table>\n<div class=\"m-modalmask\">\n</div>");
I$(128,function (_, _e ,_v, BaseComponent,tpl, p,o,f,r){

	var Modal = BaseComponent.extend({
	    template: tpl,
	    init:function(){
	    	this.supr();
	    	var destroy = this.destroy._$bind(this);
    	    _v._$addEvent(document,'keydown', function keydownCb(event){
    	    	var event = event||window.event;
    	    	if(event.keyCode==27){
    	    		destroy();
    	    		_v._$delEvent(document,'keydown',keydownCb);
    	    	}
	    	})
	    	if(this.$root == this) this.$inject(document.body);
    	    setTimeout(function(){
    	    	_e._$delClassName(this.$refs['modal'],'iDialogAnimate5');
    	    }._$bind(this),10)
    	},
	    confirm: function(){
	      this.$emit("confirm", this.data);
	      this.destroy();
	    },
	    close: function(){
	      this.$emit("close", this.data);
	      this.destroy();
	    },
	    timeout: function(timeout){
	    	this.destroyTimeout = setTimeout(function(){
                this.$emit("close", this.data);
	    		this.destroy();
	    	}._$bind(this), timeout);
	    },
	    destroy:function(){
	    	_e._$addClassName(this.$refs['modal'],'iDialogAnimate5');
	    	if(!!this.destroyTimeout){
	    		clearTimeout(this.destroyTimeout);
	    		this.destroyTimeout = null;
	    	}
	    	var destroy = this.supr;
	    	setTimeout(function(){
	    		destroy.apply(this);
	    	}._$bind(this),300)
	    }
	    // 使用timeout模块
	  });

  return Modal;

},15,4,3,151,325);
I$(269,function (_k,_e,_u,_t,_p,_o,_f,_r,_pro){
    /**
     * 延时加载控件基类
     * 
     * @class   module:util/lazy/loading._$$LazyLoading
     * @extends module:util/event._$$EventTarget
     * 
     * @config   {Object}      config - 配置信息
     * @property {Node|String} parent - 滚动条所在容器，默认为根结点
     * @property {String}      attr   - 属性标识名称，多个值用逗号分隔，如src则表示需要用到的信息在data-src上
     */
    /** 
     * 资源检测触发事件
     * 
     * @event    module:util/lazy/loading._$$LazyLoading#oncheck
     * @param    {Object}  event   - 事件信息
     * @property {Node}    target  - 资源节点
     * @property {Object}  config  - 滚动容器信息，scrollTop/clientHeight...
     * @property {Number}  value   - 操作标识，-1 - 移除，0 - 不做处理， 1 - 追加到页面
     */
    /** 
     * 资源从页面移除触发事件
     * 
     * @event    module:util/lazy/loading._$$LazyLoading#onremove
     * @param    {Object}  event   - 事件信息
     * @property {Node}    target  - 资源节点
     * @property {Object}  config  - attr属性指定的配置信息
     * @property {Boolean} stopped - 是否阻止后续逻辑
     */
    /** 
     * 资源追加到页面触发事件
     * 
     * @event    module:util/lazy/loading._$$LazyLoading#onappend
     * @param    {Object}  event   - 事件信息
     * @property {Node}    target  - 资源节点
     * @property {Object}  config  - attr属性指定的配置信息
     * @property {Boolean} stopped - 是否阻止后续逻辑
     */
    _p._$$LazyLoading = _k._$klass();
    _pro = _p._$$LazyLoading._$extend(_t._$$EventTarget);
    /**
     * 控件重置
     * 
     * @protected
     * @method module:util/lazy/loading._$$LazyLoading#__reset
     * @param  {Object} arg0 - 配置信息
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        this.__name = _options.attr||'';
        this.__parent = _e._$get(_options.parent);
        this.__doInitDomEvent([[
            this.__parent||window,'scroll',
            this.__doCheckScrollPosition._$bind(this)
        ]]);
        this._$refresh();
    };
    /**
     * 控件销毁
     * 
     * @protected
     * @method module:util/lazy/loading._$$LazyLoading#__destroy
     * @return {Void}
     */
    _pro.__destroy = function(){
        delete this.__parent;
        this.__super();
    };
    /**
     * 取滚动视图
     * 
     * @protected 
     * @method module:util/lazy/loading._$$LazyLoading#__getScrollViewPort
     * @return {Object} 滚动视图信息
     */
    _pro.__getScrollViewPort = function(){
        return this.__parent||_e._$getPageBox();
    };
    /**
     * 取配置信息
     * 
     * @protected
     * @method module:util/lazy/loading._$$LazyLoading#__getSettingInfo
     * @param  {Node} arg0 - 节点
     * @return {Object}      配置信息
     */
    _pro.__getSettingInfo = function(_node){
        var _ret = {};
        _u._$forEach(
            this.__name.split(','),function(_name){
                _ret[_name] = _e._$dataset(_node,_name);
            }
        );
        return _ret;
    };
    /**
     * 滚动检测
     * 
     * @protected
     * @method module:util/lazy/loading._$$LazyLoading#__doCheckScrollPosition
     * @return {Void}
     */
    _pro.__doCheckScrollPosition = (function(){
        var _nmap = {
            '-1':'onremove',
             '1':'onappend'
        };
        return function(_event){
            var _list = this.__getResourceList(
                this.__parent||document
            );
            var _pbox = this.__getScrollViewPort();
            _u._$forEach(
                _list,function(_node){
                    // check node
                    var _eobj = {
                        target:_node,
                        config:_pbox
                    };
                    this._$dispatchEvent('oncheck',_eobj);
                    // check action result
                    var _ret = _eobj.value;
                    if (_ret==null){
                        _ret = this.__doCheckResource(_node,_pbox);
                    }
                    var _name = _nmap[_ret];
                    if (!_name){
                        return;
                    }
                    // check action
                    var _eobj = {
                        target:_node,
                        config:this.__getSettingInfo(_node)
                    };
                    this._$dispatchEvent(_name,_eobj);
                    if (!!_eobj.stopped){
                        return;
                    }
                    // do action
                    if (_ret==-1){
                        this.__doRemoveResource(_node);
                    }else{
                        this.__doAppendResource(
                            _node,_eobj.config
                        );
                    }
                },this
            );
        };
    })();
    /**
     * 取待验证资源列表，子类实现具体逻辑
     * 
     * @abstract
     * @method module:util/lazy/loading._$$LazyLoading#__getResourceList
     * @param  {Node} arg0 - 滚动条所在容器节点
     * @return {Void}
     */
    _pro.__getResourceList = _f;
    /**
     * 验证资源是否需要做处理，子类实现具体逻辑
     * 
     * @abstract
     * @method module:util/lazy/loading._$$LazyLoading#__getResourceList
     * @param  {Node}   arg0 - 资源节点
     * @param  {Object} arg1 - 滚动容器节点
     * @return {Number}        操作标识，-1 - 移除，0 - 不做处理， 1 - 追加到页面
     */
    _pro.__doCheckResource = _f;
    /**
     * 移除资源，子类实现具体逻辑
     * 
     * @abstract
     * @method module:util/lazy/loading._$$LazyLoading#__doRemoveResource
     * @param  {Node} arg0 - 资源节点
     * @return {Void}
     */
    _pro.__doRemoveResource = _f;
    /**
     * 添加资源，子类实现具体逻辑
     * 
     * @abstract
     * @method module:util/lazy/loading._$$LazyLoading#__doAppendResource
     * @param  {Node}   arg0 - 资源节点
     * @param  {Object} arg1 - 配置信息
     * @return {Void}
     */
    _pro.__doAppendResource = _f;
    /**
     * 强制刷新检测资源
     * 
     * @method module:util/lazy/loading._$$LazyLoading#_$refresh
     * @return {Void}
     */
    _pro._$refresh = function(){
        this.__doCheckScrollPosition();
    };
},1,4,2,23);
I$(51,function (_k,_g,_e,_t,_p,_o,_f,_r,_pro){
    /**
     * 延时加载图片
     * 
     * @class   module:util/lazy/image._$$LazyImage
     * @extends module:util/lazy/loading._$$LazyLoading
     * 
     * @param    {Object} config - 配置信息
     * @property {String} holder - 图片占位地址，默认为空白图片
     * 
     */
    _p._$$LazyImage = _k._$klass();
    _pro = _p._$$LazyImage._$extend(_t._$$LazyLoading);
    /**
     * 控件重置
     * 
     * @protected
     * @method module:util/lazy/image._$$LazyImage#__reset
     * @param  {Object} arg0 - 配置信息
     * @return {Void}
     */
    _pro.__reset = function(_options){
        this.__super(_options);
        this.__holder = _options.holder||_g._$BLANK_IMAGE;
    };
    /**
     * 取待验证资源列表
     * 
     * @protected
     * @method module:util/lazy/image._$$LazyImage#__getResourceList
     * @param  {Node} arg0 - 滚动条所在容器节点
     * @return {Void}
     */
    _pro.__getResourceList = function(_parent){
        return _parent.getElementsByTagName('img');
    };
    /**
     * 验证资源是否需要做处理
     * 
     * @protected
     * @method module:util/lazy/image._$$LazyImage#__getResourceList
     * @param  {Node}   arg0 - 资源节点
     * @param  {Object} arg1 - 滚动容器节点
     * @return {Number}        操作标识，-1 - 移除，0 - 不做处理， 1 - 追加到页面
     */
    _pro.__doCheckResource = function(_target,_parent){
        var _ch = _parent.clientHeight,
            _top = _e._$offset(_target,_parent).y-_parent.scrollTop,
            _bottom = _top+_target.offsetHeight,
            _config = this.__getSettingInfo(_target),
            // not src
            // src is blank image
            // src not equal to data-src
            _holded = !_target.src||
                       _target.src.indexOf(this.__holder)>=0||
                       _target.src.indexOf(_config.src)<0;
        // check resource append
        if (_holded&&0<=_bottom&&_top<=_ch){
            return 1;
        }
        // check resource remove
        if (!_holded&&(_bottom<0||_top>_ch)){
            return -1;
        }
        // do nothing
        return 0;
    };
    /**
     * 移除资源
     * 
     * @protected
     * @method module:util/lazy/image._$$LazyImage#__doRemoveResource
     * @param  {Node} arg0 - 资源节点
     * @return {Void}
     */
    _pro.__doRemoveResource = function(_node){
        _node.src = this.__holder;
    };
    /**
     * 添加资源
     * 
     * @protected
     * @method module:util/lazy/image._$$LazyImage#__doAppendResource
     * @param  {Node}   arg0 - 资源节点
     * @param  {Object} arg1 - 配置信息
     * @return {Void}
     */
    _pro.__doAppendResource = function(_node,_conf){
        _node.src = _conf.src||this.__holder;
    };
},1,227,4,269);
I$(24,function (_k,_u,_v,_e,_g,LazyImage,_,$,_p,_o,_f,_r,_pro) {
        var pro;
        _p._$$LazyImage = _k._$klass();
        pro = _p._$$LazyImage._$extend(LazyImage._$$LazyImage);
        
        pro.__reset = function(_options){
        	_options = _options||{};
            _options.attr ='src';//图片真正url保存的地方，data-src
            _options.loadedClass = _options.loadedClass||'img-lazyloaded';//图片load后添加的class
            _options.exploreDist = _options.exploreDist||100;//屏幕上下边缘外开始加载的距离
        	_options.onappend =function(_event){
        		var target = _event.target;
        		if(!_e._$dataset(target,'src')){
        			_event.stopped = 1;
        		}
        	};
            this.__initCacheDate(_options);
            this.__super(_options);
        };

        pro.__initCacheDate = function(_options){
            //配置
            this._options = _options;
            //生成控制scroll的函数
            this.__throtteScroll = _.throttle(this.__doCheckScrollFunc._$bind(this),300,{trailing: true});
        };

        pro.__getResourceList = function(_parent){
            return $(_parent)._$children('[data-'+this._options.attr+']:not(.'+this._options.loadedClass+')',true);
        };

        /**
         * 验证资源是否需要做处理 mt 0416
         * 去掉了 removeResource 操作
         * 采用getBoundingClientRect判断是否在视口中
         */
        pro.__doCheckResource = function(_target,_parent){
            // not src
            // src is blank image
            // src not equal to data-src
            var _config = this.__getSettingInfo(_target),
            _holded = !_target.src||
                       _target.src.indexOf(this.__holder)>=0||
                       _target.src.indexOf(_config.src)<0;
            // check resource append
            if (_holded&&this.__isInViewPort(_target)){
                return 1;
            }
            // do nothing
            return 0;
        };

        /**
         * 是否在视口中
         */
        pro.__isInViewPort = function(node){
            var rect = node.getBoundingClientRect(),
            top = rect.top || 0,
            bottom = rect.bottom || 0,
            exploreDist = this._options.exploreDist,
            viewportH = document.documentElement.clientHeight + exploreDist;
            if((top > -exploreDist && top < viewportH) ||
                (bottom > -exploreDist && bottom < viewportH) ||
                (top < -exploreDist && bottom > viewportH)){
                return true;
            }else{
                return false;
            }
        };
        
        pro.__doAppendResource = function(_node,_conf){
            if(_node.src != _conf.src){
                this.__addImgTrack(_node);
                _node.src = _conf.src||this.__holder;
                _e._$addClassName(_node,this._options.loadedClass);  // updated by hzzhengff
            }
        };

        pro.__addImgTrack = function(node){
            _v._$addEvent(node,'error',this.__doImgTrack,false);
        };
        pro.__doImgTrack = function(evt){
            _v._$clearEvent(evt.target,'error');
            function throwExp(name, msg){
                throw {
                    name: name,
                    message: msg,
                    toString: function(){
                        return this.name +
                               ' :::: MSG: ' +
                               this.message +
                               ' :::: PAGE_URL: ' +
                               document.URL.split('?')[0]
                    }
                };
            }
            if (evt.type == 'load') {
                //正常加载
                //暂无处理逻辑
            }else if (evt.type == 'error'){
                //加载出错
                //通过抛出错误的方式，来让apm记录加载错误信息
                throwExp('imgloaderror', 'image src: '+evt.target.src);
                NRUM && NRUM.measure("imgloaderror"); //apm 打个点
            }
        };
        /**
         * 重写父类方法，增加scroll降频处理，修复滚动卡顿问题
         * hzmaitng 20160325
         */
        pro.__doCheckScrollPosition = function(){
            this.__throtteScroll();
        };
        /**
         * 滚动检测
         */
        pro.__doCheckScrollFunc = (function(){
            var _nmap = {
                '-1':'onremove',
                 '1':'onappend'
            };
            return function(){
                var _list = this.__getResourceList(
                    this.__parent||document
                );
                var _pbox = this.__getScrollViewPort();
                _u._$forEach(
                    _list,function(_node){
                        // check node
                        var _eobj = {
                            target:_node,
                            config:_pbox
                        };
                        this._$dispatchEvent('oncheck',_eobj);
                        // check action result
                        var _ret = _eobj.value;
                        if (_ret==null){
                            _ret = this.__doCheckResource(_node,_pbox);
                        }
                        var _name = _nmap[_ret];
                        if (!_name){
                            return;
                        }
                        // check action
                        var _eobj = {
                            target:_node,
                            config:this.__getSettingInfo(_node)
                        };
                        this._$dispatchEvent(_name,_eobj);
                        if (!!_eobj.stopped){
                            return;
                        }
                        // do action
                        if (_ret==-1){
                            this.__doRemoveResource(_node);
                        }else{
                            this.__doAppendResource(
                                _node,_eobj.config
                            );
                        }
                    },this
                );
            }
        })();

        return _p._$$LazyImage;
    },1,2,3,4,227,51,15,25);
I$(254,".#<uispace> .cntbox{width:400px;padding:20px;}\n.#<uispace> .cntbox .tip{margin:10px 0;font-size:24px;color:#333;}\n.#<uispace> .cntbox .warning{color:#D12147;font-family:\"iconfont\" !important;font-size:28px;padding-right:10px;}\n.#<uispace> .cntbox .smalltip{margin-left:36px;}\n\n.#<uispace> .btnbox{padding:20px;text-align:center;}\n.#<uispace> .btnbox .u-btn{display:inline-block;width:120px;height:40px;text-align:center;line-height:40px;color:#fff;font-weight:700;font-size:18px;background:#D22147;}\n.#<uispace> .btnbox .u-btn:hover{text-decoration:none;}");
I$(255,"<textarea name=\"txt\" id=\"#<seedTxt>\">\n\t<div>\n\t\t<div class=\"cntbox j-flag\">\n\t\t</div>\n\t\t<div class=\"btnbox\">\n\t\t\t<a href=\"javascript:void(0);\" class=\"u-btn j-flag\">确定</a>\n\t\t</div>\n\t</div>\n</textarea>\n<textarea name=\"jst\" id=\"#<seedMessage>\">\n\t<p class=\"tip\"><i class=\"warning\">&#xe609;</i>${message}</p>\n\t<p class=\"smalltip\">${smalltip}</p>\n</textarea>");
I$(28,function (Window, _e,_v,_css, _html,_e1,_t,_e2,_p, _o, _f, _r,_pro) {
	
	var _seed_css = _e._$pushCSSText(_css),
        _seed_ui = _e1._$parseUITemplate(_html),
        _seed_txt = _seed_ui['seedTxt'],
        _seed_message = _seed_ui['seedMessage'],
	    _seed_html = _e1._$addNodeTemplate(_e1._$getTextTemplate(_seed_txt));
	
    _p._$$PromptWindow = NEJ.C();
    _pro = _p._$$PromptWindow._$extend(Window);

    _pro.__reset = function(_options) {
    	_options.title=_options.title || '提示';
        this.__okBtn.innerHTML = _options.btntext || '确定';
        this.__super(_options);
        _e2._$render(this.__box, _seed_message, {message: _options.message, smalltip: _options.smalltip});
    };
    _pro.__destroy = function(_options) {
        this.__super(_options);
    };

    _pro.__initXGui = function() {
        this.__seed_css = _seed_css;
        this.__seed_html = _seed_html
    };

    _pro.__initNode = function() {
        this.__super();
        var _list = _e._$getByClassName(this.__body,'j-flag');
        this.__box = _list[0];
        this.__okBtn = _list[1];
        _v._$addEvent(this.__okBtn, 'click', this.__onOK._$bind(this));
    };
    /**
     * 点击"确定"按钮事件响应
     * */
    _pro.__onOK = function(_event) {
    	_v._$stop(_event);
    	this._$dispatchEvent('onok');
		this._$hide();
    };
    
    return _p._$$PromptWindow;
},229,4,3,254,255,233,238,239);
I$(29,function (_k,_ut,_v,_t,_e,_q,_,_p,_o,_f,_r,_pro) {
        var _pro;

        _p._$$OutDateLayer = _k._$klass();
        _pro = _p._$$OutDateLayer._$extend(_t._$$EventTarget);

        _pro.__init = function(_options) {
            this.__supInit(_options);
            //静态化统计
            this.__initLayer();
        };

        _pro.__initLayer = function(){
            var outDateJumpUrl = _e._$get('outdatejumpurl');
            if(!!outDateJumpUrl){
                var redCount = Number(_.getUrlParam('redCount')||0);
                if(redCount > 2){
                    outDateJumpUrl.href = '/index.html';
                }else{
                    redCount++;
                    outDateJumpUrl.href = _.insertParamIntoUrl(outDateJumpUrl.href, ('redCount='+redCount))
                }
            }
        };

        return _p._$$OutDateLayer;
    },1,2,3,23,4,25,15);
I$(106,function (_k,_ut,_v,_t,_e,_t0,_p,_o,_f,_r,_pro) {
        var pro;

        _p._$$Slider = _k._$klass();
        _pro = _p._$$Slider._$extend(_t._$$EventTarget);
        
        /**
         * 首页逻辑模块初始化
         * @param  {Object} 配置参数
         * @return {Void}
         * list:list,			图片节点
		   icons:indexIcons,	图片的下标点
		   preBtn:btns[0],		前一张按钮
		   nextBtn:btns[1],		后一张按钮
		   duragion,			间隔时间
           thumbnail            显示缩略图的一些配置
                                {
                                    wrap:wrapNode, //包含缩略图功能的父节点
                                    itemGroups:groupNodeArr, //items组节点的数组，左右切换时按组显示，分组是为了最后一组节点的定位
                                    items:thumbnailNodeArr //所有items的数组
                                    preArrow:arrowNode, //显示前一组的按钮
                                    nextArrow:arrowNode //显示后一组的按钮
                                }
            thumbnailAni            显示缩略图的一些配置，切换到下一组时有动画
                                {
                                    wrap:wrapNode, //包含缩略图功能的父节点
                                    itemGroups:groupNodeArr, //items组节点的数组，左右切换时按组显示
                                    items:thumbnailNodeArr //所有items的数组
                                    preArrow:arrowNode, //显示前一组的按钮
                                    nextArrow:arrowNode //显示后一组的按钮
                                }
         */
        _pro.__reset = function(_options){
            this.__super(_options);
            this.__list = _options.list;
            this.__length = this.__list.length;
            this.__icons = _options.icons||[];
            this.__preBtn = _options.preBtn;
            this.__nextBtn = _options.nextBtn;
            this.__zIndex = _options.zIndex||10;    // zIndex: add by hzzhengff
            this.__box = _options.box||this.__list[0].parentNode;
            this.__initListNode(this.__list);
            this.__duragion = _options.duragion||5000;
            this.__thumbnail = _options.thumbnail;
            this.__thumbnailAni = _options.thumbnailAni;
            //增加显示缩略图功能 hzmating 20160308
            if(this.__thumbnailAni){//有切换下一组的动画
                this.__initThumbnailAni(this.__thumbnailAni);
            }else if(this.__thumbnail){//没有动画，dom结构也稍有不同
                this.__initThumbnail(this.__thumbnail);
            }
            this.__current = 0;
            this.__timeOut = setTimeout(this.__doSlide._$bind(this,this.__current,this.__current+1),this.__duragion);
            
        };

        _pro.__initListNode = function(_list){
        	_list[0].style.cssText='opacity:1;filter:alpha(opacity=100);z-index:'+this.__zIndex;
        	for(var i=1,l=_list.length;i<l;i++){
        		_list[i].style.cssText='opacity:0;filter:alpha(opacity=0);z-index:'+(this.__zIndex-1);
        		_e._$delClassName(_list[i],'hide');
        	}
        	for(var i=0,l=this.__icons.length;i<l;i++){
        		_v._$addEvent(this.__icons[i],'mouseover',this.__onIconHover._$bind(this,i));
        	}
        	_v._$addEvent(this.__preBtn,'click',this.__onButtonClick._$bind(this,-1))
        	_v._$addEvent(this.__nextBtn,'click',this.__onButtonClick._$bind(this,1))
        	_v._$addEvent(this.__box,'mouseenter',this.__onBoxMouseOver._$bind(this))
        	_v._$addEvent(this.__box,'mouseleave',this.__onBoxMouseOut._$bind(this))
        	
        };

        _pro.__initThumbnailAni = function(options){
            var items = options.items;
            var itemNum = items.length;
            var itemGroups = options.itemGroups;
            var groupNum = itemGroups.length;
            var groupWrap = itemGroups[0].parentNode;
            var itemsPerGroup = 6;//每个group包含多少个items
            var itemWidth = 174;//每个item的宽度px
            var lastGroupItemNum = itemNum%itemsPerGroup;//最后一个group包含的item数
            var index = 0;//当前itemGroup的index
            this._isBelowIE9 = nej.p._$KERNEL.browser=='ie'&&nej.p._$KERNEL.version<9;
            if(lastGroupItemNum==0){
                lastGroupItemNum = itemsPerGroup;
            }
            if(itemGroups.length>1){
                //显示左右切换按钮
                options.preArrow.style.display = 'inline-block';
                options.nextArrow.style.display = 'inline-block';
                _v._$addEvent(options.preArrow,'click',function(){
                    index--;
                    if(index>=0){
                        var marginLeft = parseFloat(groupWrap.style.marginLeft)||0;
                        if(index+2==groupNum){
                            groupWrap.style.marginLeft = marginLeft+lastGroupItemNum*itemWidth+'px';
                        }else{
                            groupWrap.style.marginLeft = marginLeft+itemsPerGroup*itemWidth+'px';
                        }
                        this.__controlArrow(options,index,groupNum);
                        this.__onIconHover(index*itemsPerGroup);
                    }else{
                        index++;//若index超出下限，则还原index的值
                    }
                }._$bind(this));
                _v._$addEvent(options.nextArrow,'click',function(){
                    index++;
                    if(index+1<=groupNum){
                        var marginLeft = parseFloat(groupWrap.style.marginLeft)||0;
                        if(index+1==groupNum){
                            groupWrap.style.marginLeft = marginLeft-lastGroupItemNum*itemWidth+'px';
                        }else{
                            groupWrap.style.marginLeft = marginLeft-itemsPerGroup*itemWidth+'px';
                        }
                        this.__controlArrow(options,index,groupNum);
                        this.__onIconHover(index*itemsPerGroup);
                    }else{
                        index--;//若index超出上限，则还原index的值
                    }
                }._$bind(this));
            }
            //绑定缩略图的鼠标事件
            this.__thumbnailItemMouseEvent(items);
        };
        /**
         * 控制缩略图arrow的状态
         */
        _pro.__controlArrow = function(options,index,groupNum){
            var preArrow = options.preArrow,
                nextArrow = options.preArrow;
            _e[index==0?'_$addClassName':'_$delClassName'](options.preArrow,'arrow-left-dis');
            _e[index==groupNum-1?'_$addClassName':'_$delClassName'](options.nextArrow,'arrow-right-dis');
        };

        _pro.__initThumbnail = function(options){
            var items = options.items;
            var itemGroups = options.itemGroups;
            var groupNum = itemGroups.length;
            var itemsPerGroup = 6;//每个group包含多少个items
            var index = 0;//当前itemGroup的index
            //处理itemGroup的index小于0和大于len的情况
            function amendGroupIndex(i){
                index = i<0?(i%groupNum+groupNum):(i%groupNum);
                return index;
            }
            if(itemGroups.length>1){
                //显示左右切换按钮
                options.preArrow.style.display = 'inline-block';
                options.nextArrow.style.display = 'inline-block';
                _v._$addEvent(options.preArrow,'click',function(){
                    itemGroups[index].style.display = 'none';
                    amendGroupIndex(--index);
                    itemGroups[index].style.display = 'block';
                    this.__onIconHover(index*itemsPerGroup);
                }._$bind(this));
                _v._$addEvent(options.nextArrow,'click',function(){
                    itemGroups[index].style.display = 'none';
                    amendGroupIndex(++index);
                    itemGroups[index].style.display = 'block';
                    this.__onIconHover(index*itemsPerGroup);
                }._$bind(this));
            }
            //绑定缩略图的鼠标事件
            this.__thumbnailItemMouseEvent(items);
        };
        /**
         * 绑定缩略图的鼠标事件
         */
        _pro.__thumbnailItemMouseEvent = function(items){
            // 每个item事件
            _ut._$forEach(items,function(itm,i){
                _v._$addEvent(itm,'mouseenter',function(){
                    itm.firstChild.style.display = 'none';
                    this.__onIconHover(i);
                }._$bind(this));
                _v._$addEvent(itm,'mouseleave',function(){
                    itm.firstChild.style.display = 'inline-block';
                }._$bind(this));
            }._$bind(this));
        };
        /**
         * 鼠标移入停止滚动
         */
        _pro.__onBoxMouseOver = function(){
            if(this.__thumbnailAni){
                this.__showThumbnail(this.__thumbnailAni);
            }else if(this.__thumbnail){
                this.__showThumbnail(this.__thumbnail);
            }
        	clearTimeout(this.__timeOut);
        };
        _pro.__onBoxMouseOut = function(){
            if(this.__thumbnailAni){
                this.__hideThumbnail(this.__thumbnailAni);
            }else if(this.__thumbnail){
                this.__hideThumbnail(this.__thumbnail);
            }
        	this.__timeOut = setTimeout(this.__doSlide._$bind(this,this.__current,this.__current+1),this.__duragion);
        };
        _pro.__onButtonClick = function(index,_event){
        	this.__doSlide(this.__current,this.__current+index);
        };
        _pro.__onIconHover = function(index,_event){
        	if(index==this.__current){
        		return;
        	}
        	this.__doSlide(this.__current,index);
        };
        _pro.__getOpacityCSSText = function(opacity){
        	var list = ['opacity:'+opacity];
        	list.push('filter:alpha(opacity='+opacity*100+')');
        	return list.join(';');
        }
        /**
         * 如果没有这个方法，在鼠标切换的过程中会把其他的image给显示出来，在中间变化过程中
         */
        _pro.__resetOtherImages = function(preIndex,newIndex){
        	for(var i=0,l=this.__list.length;i<l;i++){
        		if(i!=preIndex&&i!=newIndex){
        			this.__list[i].style.cssText = this.__getOpacityCSSText(0);
        		}
        	}
        };
        _pro.__doSlide = function(preIndex,newIndex){
        	if(newIndex<0){
        		newIndex = this.__length-1;
        	}
        	if(newIndex==this.__length){
        		newIndex = 0;
        	}
        	this.__setIndexIcon(this.__current,newIndex);
        	if(this.__animation){
        		this.__animation = this.__animation._$recycle();
        		this.__list[preIndex].style.cssText = this.__getOpacityCSSText(0);//把之前的那一项数据的透明度高为0
        	}
        	this.__resetOtherImages(preIndex,newIndex);
        	if(this.__timeOut){
        		clearTimeout(this.__timeOut);
        	}
        	this.__current = newIndex;
        	this.__animation = _t0._$$AnimEaseIn._$allocate({
					        		from:{offset:0},
					        		to:{offset:1},
					        		duration:400,
					        		onupdate:function(_event){
					        			this.__list[newIndex].style.cssText = this.__getOpacityCSSText(_event.offset);
					        			this.__list[newIndex].style.zIndex = this.__zIndex;
					        			this.__list[preIndex].style.cssText = this.__getOpacityCSSText(1-_event.offset);
					        			this.__list[preIndex].style.zIndex = this.__zIndex-1;
					        		}._$bind(this),
					        		onstop:function(){
					        			this.__animation = this.__animation._$recycle();
					        			this.__timeOut = setTimeout(this.__doSlide._$bind(this,this.__current,this.__current+1),this.__duragion);
					        		}._$bind(this)
					        	})
        	this.__animation._$play();
        };
        _pro.__setIndexIcon = function(_current,_newIndex){
        	for(var i=0,l=this.__icons.length;i<l;i++){
        		_e._$delClassName(this.__icons[i],'active')
        	}
        	if(this.__icons.length){
        		_e._$addClassName(this.__icons[_newIndex],'active');
        	}
        };
        _pro.__showThumbnail = function(option){
            if(this._isBelowIE9){
                this.__comOpacityAni(option.wrap,0,1);
            }else{
                option.wrap.style.cssText='opacity:1;filter:alpha(opacity=100);';
            }
        };
        _pro.__hideThumbnail = function(option){
            if(this._isBelowIE9){
                this.__comOpacityAni(option.wrap,1,0);
            }else{
                option.wrap.style.cssText='opacity:0;filter:alpha(opacity=0);';
            }
        };
        _pro.__comOpacityAni = function(node,from,to){
            if(this.__comOpaAni){
                this.__comOpaAni = this.__comOpaAni._$recycle();
            }
            this.__comOpaAni = _t0._$$AnimEaseIn._$allocate({
                                    from:{offset:from},
                                    to:{offset:to},
                                    duration:400,
                                    onupdate:function(_event){
                                        node.style.cssText = this.__getOpacityCSSText(_event.offset);
                                    }._$bind(this),
                                    onstop:function(){
                                        this.__comOpaAni = this.__comOpaAni._$recycle();
                                    }._$bind(this)
                                })
            this.__comOpaAni._$play();
        };
        return _p._$$Slider;
    },1,2,3,23,4,234);
I$(30,function (_k,_ut,_v,_t,_e,_q,Slider,_v1,_p,_o,_f,_r,_pro) {
        var _pro;

        _p._$$ActivSlide = _k._$klass();
        _pro = _p._$$ActivSlide._$extend(_t._$$EventTarget);

        _pro.__init = function(_options) {
            this.__supInit(_options);
            this.__getNodes();
            this.__addEvent();
            // slider
            this.__initSlide();
        };
        
        /**
         * 轮播slider
         */
        _pro.__initSlide = function(){
        	var slideBox = _q('.sliderBox');
        	if(!!slideBox.length) {
            	_ut._$forEach(slideBox,function(_item,_index,_list){
                	var listContainer = _e._$getByClassName(_list[_index],'show_pic');
                	var list = _e._$getChildren(listContainer[0])||[];
                	if(list.length<2){
                		if(list.length==0){
                			_item.style.display = 'none';
                		}
                		return;
                	}
                	var indexIcons = _e._$getByClassName(_list[_index],'idxicon');
                	var btns = _e._$getByClassName(_list[_index],'cons');
                	
                	_v1._$hover(_item,'j-sliderBoxhover');//ie 6下hover
                	Slider._$allocate({
                		list:list,
                		icons:indexIcons,
                		preBtn:btns[0],
                		nextBtn:btns[1]
                	});
            	});
            }
        };
        
        _pro.__getNodes = function(){
            
        };
        
        _pro.__addEvent = function(){
           
        };
        
        return _p._$$ActivSlide;
    },1,2,3,23,4,25,106,107);
I$(31,function (_k, _ut, _, _v, _t, _e, $, _p, _o, _f, _r, _pro) {
        var _pro;

        _p._$$ActivSlide = _k._$klass();
        _pro = _p._$$ActivSlide._$extend(_t._$$EventTarget);

        _pro.__init = function (_options) {
            this.__supInit(_options);
            this.__extendTool();
            this.__getNodes();
            this.__addEvent();
            this.__initSlide();
        };

        /**
         * 侧滑快速侧滑
         */
        _pro.__initSlide = function () {

            var sidesLip = $(".m-sideslip, .m-qsideslip");

            if(!!sidesLip.length) {
                sidesLip._$forEach(function (_item, _i, _list) {
                    var item = $(_item), offsetTop,
                        startShowId = "#" + item._$attr("startShow"),
                        // startShowElem = item._$attr("startShow") == "" ? $($("#body article")[0]) : $("#" + item._$attr("startShow")),
                        topDistance = ~~item._$attr("topDistance"),
                        imgLocation = ~~item._$attr("imgLocation"),
                        isShow = ~~item._$attr("isShow") == 0 ? "none" : "block",
                        docFoot = $("#docFoot"),
                        _itemBox = _pro.__getBoundingClientRect(_item),
                        sidesLipHeight = _itemBox.height,
                        onScroll, protectedFn,
                        _startShowElemBox, _docFootBox, windowH,
                    //页面可视高度
                        winClientHeight = _e._$getPageBox().clientHeight;
                    //若为快速侧滑
                    var isQuick = (item._$attr('class')||'').indexOf("m-qsideslip") > -1;
                    if(isQuick) {
                        var hoverColor = item._$attr("hoverColor");
                        var bgColor = item._$attr("bgColor");
                        var hoverEvt = {
                            "mouseenter": function () {
                                $(this)._$style({backgroundColor: hoverColor});
                            },
                            "mouseleave": function () {
                                $(this)._$style({backgroundColor: bgColor});
                            }
                        };
                        item._$children(".mainPart")._$children("a")._$on(hoverEvt);
                        item._$children(".bottomPart")._$on(hoverEvt);
                    }
                    if(imgLocation == 2) {
                        onScroll = function () {
                            _itemBox = _pro.__getBoundingClientRect(_item);
                            _startShowElemBox = _pro.__getBoundingClientRect($(startShowId)[0]);
                            _docFootBox = _pro.__getBoundingClientRect(docFoot[0]);
                            windowH = document.documentElement.scrollTop || document.body.scrollTop;
                            offsetTop = _startShowElemBox.y;

                            if($.isIE6) {
                                item._$style({
                                    position: "absolute",
                                    top: offsetTop + "px"
                                });
                                item._$children('*', false)._$trigger("hover");
                            } else {
                                if(_itemBox.scrollTop + winClientHeight <= offsetTop + topDistance + sidesLipHeight) {
                                    item._$style({
                                        position: "absolute",
                                        top: offsetTop + "px",
                                        bottom: "auto",
                                        display: isShow
                                    });
                                } else {
                                    item._$style({
                                        position: "fixed",
                                        top: "auto",
                                        bottom: topDistance + "px",
                                        display: "block"
                                    });
                                }
                                //距离底部最少60px
                                if(_docFootBox && (_itemBox.scrollTop + winClientHeight - topDistance >= _docFootBox.y - 60)) {
                                    item._$style({
                                        position: "absolute",
                                        top: (_docFootBox.y - 60 - sidesLipHeight) + "px",
                                        display: "block"
                                    });
                                }
                            }
                        }
                    } else {
                        onScroll = function () {
                            _itemBox = _pro.__getBoundingClientRect(_item);
                            _startShowElemBox = _pro.__getBoundingClientRect($(startShowId)[0]);
                            _docFootBox = _pro.__getBoundingClientRect(docFoot[0]);
                            offsetTop = _startShowElemBox.y;
                            if($.isIE6) {
                                item._$style({
                                    position: "absolute",
                                    top: offsetTop + "px"
                                });
                                item._$children('*', false)._$trigger("hover");
                            } else {
                                if(_itemBox.scrollTop + topDistance <= offsetTop) {
                                    item._$style({
                                        position: "absolute",
                                        top: offsetTop + "px",
                                        display: isShow
                                    });
                                } else {
                                    item._$style({
                                        position: "fixed",
                                        top: topDistance + "px",
                                        display: "block"
                                    });
                                }
                                //è·ç¦»åº•éƒ¨æœ€å°‘60px
                                if(_docFootBox && (_itemBox.scrollTop + topDistance + sidesLipHeight >= _docFootBox.y - 60)) {
                                    item._$style({
                                        position: "absolute",
                                        top: (_docFootBox.y - 60 - sidesLipHeight) + "px",
                                        display: "block"
                                    });
                                }
                            }
                        }
                    }
                    protectedFn = _.throttle(onScroll, 5);
                    _v._$addEvent(window, "scroll", function () {
                        protectedFn();
                    });
                    _v._$dispatchEvent(window, "scroll");
                });
            }
        };

        _pro.__getNodes = function () {
        };

        _pro.__addEvent = function () {
        };

        /**
         * èŽ·å–DOMèŠ‚ç‚¹çš„ä½ç½®ä¿¡æ¯
         *
         * æ³¨æ„ï¼šå¦‚æžœåœ¨é™¤äº†bodyå¤–çš„çˆ¶èŠ‚ç‚¹ä¸­å­˜åœ¨æ»šåŠ¨æ¡ï¼Œåˆ™scrollTop/scrollLeft/x/yä¸å†å‡†ç¡®
         *
         * @param elem DOMèŠ‚ç‚¹
         *
         * @returns {{top: Number, bottom: Number, left: Number, right: Number, width: (Number|number), height: (Number|number), scrollTop: (*|number), scrollLeft: (*|number|HTMLElement.scrollLeft), x: *, y: *}}
         *      top/bottom/left/right: è·viewportçš„ä¸Šä¸‹å·¦å³è·ç¦»
         *      width/height: å®½é«˜
         *      scrollTop/scrollLeft: bodyä¸Šçš„æ»šåŠ¨æ¡é®ä½çš„ä¸Š/å·¦è·ç¦»
         *      x/y: bodyå·¦ä¸Šè§’ä¸ºåæ ‡ç³»åŽŸç‚¹ï¼Œxyå€¼
         */
        _pro.__getBoundingClientRect = function (elem) {
            if(!elem) return false;
            var rect = elem.getBoundingClientRect(),
                scroll_top = document.documentElement.scrollTop || document.body.scrollTop,
                scroll_left = document.documentElement.scrollLeft || document.body.scrollLeft;
            return {
                top: rect.top,
                bottom: rect.bottom,
                left: rect.left,
                right: rect.right,
                width: rect.width || rect.right - rect.left,
                height: rect.height || rect.bottom - rect.top,
                scrollTop: scroll_top,
                scrollLeft: scroll_left,
                x: rect.left + scroll_left,
                y: rect.top + scroll_top
            };
        };

        _pro.__extendTool = function () {
            //isIE678, æ¥æºï¼šeaseCore.js
            $.isIE678 = "\v" == "v";
            if($.isIE678) {
                $.isIE8 = !!'1'[0];
                $.isIE6 = !$.isIE8 && (!document.documentMode || document.compatMode == "BackCompat");
                $.isIE7 = !$.isIE8 && !$.isIE6
            }
        };

        return _p._$$ActivSlide;
    },1,2,15,3,23,4,25);
I$(108,function (_k, _ut, _t, _v, _e, _p, _o, _f, _r, _pro) {

    /**
     * å€’è®¡æ—¶æŽ§ä»¶å°è£…
     *
     * @extends module:util/event._$$EventTarget
     *
     * @param    {Object}  config   - å¯é€‰é…ç½®å‚æ•°
     * @property {Number}  leftMs   - å‰©ä½™çš„æ¯«ç§’æ•°ï¼Œ[å¿…éœ€]
     * @property {Node}  parent    - çˆ¶èŠ‚ç‚¹ï¼Œ[éžå¿…éœ€],è‹¥æ— ï¼Œåˆ™å½“åšåŽå°è®¡æ—¶å™¨ä½¿ç”¨
     * @property {String}  format    - æ—¶é—´æ˜¾ç¤ºçš„æ ¼å¼[éžå¿…éœ€],é»˜è®¤hh:mm:ss,è‹¥æœ‰å¤©æ•°ï¼Œåˆ™æ¢ç®—æˆ24å°æ—¶åŠ åˆ°å°æ—¶æ•°
     *                                 å¦‚ï¼š<b>{hh}</b><b>{mm}</b><b>{ss}</b>ï¼Œ
     *                                     {hh:1}è¡¨ç¤ºå–hhçš„ç¬¬1ä¸ªæ•°å­—ï¼Œ{hh:2}è¡¨ç¤ºå–hhçš„ç¬¬2ä¸ªæ•°å­—
     * @property {Function}   onUpdate - æ—¶é—´æ›´æ–°æ—¶çš„å›žè°ƒ[éžå¿…éœ€]ï¼Œ500msåˆ·æ–°ä¸€æ¬¡ï¼Œè¿”å›žæ—¶é—´å¯¹è±¡timeobj
     * @property {Function}   onZero - åˆ°0æ—¶çš„å›žè°ƒå‡½æ•°[éžå¿…éœ€]
     *
     * Example:
     *  //åˆ›å»ºå€’è®¡æ—¶
     *  var countZero = CountZero._$allocate({
     *      parent:parentNode,
     *      leftMs:60000,
     *      format:"<b>{d}</b><b>{hh}</b><b>{mm}</b><b>{ss}</b>",
     *      onUpdate:function(){
     *          
     *      },
     *      onZero:function(){
     *          alert(0);
     *      }
     *  });
     *  //å½“å‰é¡µé¢å¢žåŠ å€’è®¡æ—¶
     *  countZero._$addCount({
     *      parent:parentNode1,
     *      leftMs:100000,
     *      format:"{d}å¤©{hh}æ—¶{mm}åˆ†{ss}ç§’</b>",
     *      onUpdate:function(){
     *          
     *      },
     *      onZero:function(){
     *          alert(1);
     *      }
     *  });
     * 
     */

  	// æ ¹æ®æ¯«ç§’æ•°è®¡ç®—å‰©ä½™æ—¶é—´å¯¹è±¡
    var __getTimeObj = (function(){
        var onemin = 60000, onehour = 60*onemin, oneday = 24*onehour;
        return function(num){
            var time = +num > 0 ? +num : 0;
            var d = parseInt(time / oneday, 10),
                h = parseInt(time % oneday / onehour, 10),
                m = parseInt(time % oneday % onehour / onemin, 10),
                s = parseInt(time % oneday % onehour % onemin / 1000, 10),
                ms = parseInt(time % oneday % onehour % onemin % 1000, 10);
            //ä¼˜åŒ–ä¸´ç•Œç‚¹æ˜¾ç¤º
            if (d === 1 && h === 0) {
                d = 0;
                h = 24;
            }
            return {
                d : d, h : h, m: m, s : s, ms:ms,
                dd : __fillZ(d), hh : __fillZ(h), mm : __fillZ(m), ss : __fillZ(s)
            };
        };
    })();
    //è½¬åŒ–ä¸ºä¸¤ä½æ•°å­—
    var __fillZ = function( N ){
        return (N < 10 ? "0" : "" )+N;
    };
    
    _p._$$CountZero = _k._$klass();
    _pro = _p._$$CountZero._$extend(_t._$$EventTarget);

    _pro.__reset = function(_options) {
    	this.__super(_options);
        this.__initCountZero(_options);
    };

    _pro.__initCountZero = function(_options){
        this._cache = [];
        this.__addOptionsObj(_options);
        this._timer = null;
        //å¼€å¯å®šæ—¶å™¨
        this.__startPolling();
    };

    _pro.__addOptionsObj = function(obj){
        obj.leftMs = Number(obj.leftMs)||0;
        this._cache.push(obj);
    };

    _pro.__startPolling = function(){
        this.__update.call(this);
        this._timer = window.setInterval(this.__update._$bind(this),500);
    };

    _pro.__update = function(){
        var _finishNum = 0;
        _ut._$forEach(this._cache,function(opt,index){
            if(!!opt._finish){
                _finishNum++;
                return;
            }
            if(opt.leftMs<=0){
                opt._finish = true;
                opt.leftMs = 0;
                this.__showLeftTime(opt);
                if(!!opt.onZero && _ut._$isFunction(opt.onZero)){
                    opt.onZero();
                }
                // console.dir(this._cache);
            }else{
                this.__showLeftTime(opt);
            }
            opt.leftMs-=500;
        }._$bind(this));
        //æ˜¯å¦æ‰€æœ‰å€’è®¡æ—¶éƒ½å·²ç»ç»“æŸ
        if(_finishNum==this._cache.length){
            // console.log('finish');
            this._cache = null;
            window.clearInterval(this._timer);
            this._timer = null;
        }
    };

    _pro.__showLeftTime = function(opt){
        var timeobj = __getTimeObj(opt.leftMs);
        if(!!opt.onUpdate && _ut._$isFunction(opt.onUpdate)){
            opt.onUpdate(timeobj);
        }
        //è‹¥æ²¡æœ‰çˆ¶èŠ‚ç‚¹ï¼Œåˆ™å½“åšåŽå°è®¡æ—¶å™¨ä½¿ç”¨
        if(!opt.parent){
            return;
        }
        if(!opt.format){
            opt.parent.innerText = __fillZ(timeobj.d*24+timeobj.h)+":"+__fillZ(timeobj.m)+":"+__fillZ(timeobj.s);
        }else{
            var hasD = opt.format.indexOf('{d')!=-1;//是否有日期的坑位
            opt.parent.innerHTML = opt.format.replace(/{[dhms]{1,2}(\:[12]{1})?}/gi,function(str){
                var time = str.replace(/{|}/g,''),//'hh:1' or 'hh'
                    timeArr = time.split(':'),//['hh','1'] or ['hh']
                    arr0 = timeArr[0],//'hh' or 'hh'
                    arr1 = +timeArr[1],//1 or NaN
                    timeArr0 = timeobj[arr0];
                //hh 或 h，并且没有 d占位符 的情况，把d加入到h，（超出100，并且有：的情况不处理）20160725 mt
                if(str.indexOf('h')!=-1 && timeobj.d>0 && !hasD){
                    timeArr0 = +timeArr0 + timeobj.d*24 + '';
                }
                return !arr1?timeArr0:timeArr0.slice(arr1-1,arr1);
            });
        }
    };
    // 当前页面增加倒计时
    _pro._$addCount = function(_options){
        if(this._timer === null){
            this.__initCountZero(_options);
        }else{
            this.__addOptionsObj(_options);
        }
    };

    return _p._$$CountZero;

  },1,2,23,3,4);
I$(256,function (_k,_ut,_v,_t,_e,$,Bezier,_p,_o,_f,_r,_pro) {
        var _pro;

        _p._$$BrandAni = _k._$klass();
        _pro = _p._$$BrandAni._$extend(_t._$$EventTarget);

        /**
         * 品牌一排三、一排四动效控件
         * @param  {Object} config   - 配置参数
         * @property {String}  wrapElem   - 触发动画的节点，调用nej链式接口选择器
         * @property {String}  aniElem   - 运动的节点，必须是wrapElem的子节点，设置position:relative，调用nej链式接口选择器
         * @property {String|Number}  to   - 运动终点，默认50px
         * @property {String|Number}  from   - 运动起点，默认0px
         * @property {String|Number}  duration   - 运动过程时间，从from到to的运动时间，默认300m
         * @property {String|Number}  timing   - 时间函数，默认easeinout
         * @property {Function}  onTo   - 到达运动终点时触发
         * @property {Function}  onFrom   - 到达运动起点时触发
         * @return {Void}
         */
        _pro.__reset = function(_options) {
            this.__super(_options);
            this.__configAni(_options);
            if(this.__validConfig()){
                this.__bindAni();
            }
        };

        _pro.__configAni = function(_options){
            this._wrapElem = _options.wrapElem||'';
            this._aniElem = _options.aniElem||'';
            this._to = parseFloat(_options.to)||50;
            this._from = parseFloat(_options.from)||0;
            this._dur = parseFloat(_options.duration)||300;
            this._timing = _options.timing||'easeinout';
            this._mspp = Math.abs(this._dur/(this._to-this._from));//ms per pixel
            this._onTo = 'onTo';
            this._onFrom = 'onFrom';
            this._brandAni = {};//动画缓存
        };

        _pro.__validConfig = function(){
            if(!this._wrapElem){
                console.error('没有传入触发动画的节点！');
                return false;
            }
            if(!this._wrapElem){
                console.error('没有传入运动的节点！');
                return false;
            }
            return true;
        };

        _pro.__bindAni = function(){
            $(this._wrapElem)._$filter(":not([ani=bind])")
            ._$on({
                'mouseenter':this.__doAni._$bind(this,true),
                'mouseleave':this.__doAni._$bind(this,false)
            })
            ._$attr({ani:"bind"});//通过ani=bind标记已经绑定过事件，避免分页加载等情况导致重复绑定
        };

        _pro.__doAni = function(upward,e){
            var self = this,
                elem = $(e.target)._$children(this._aniElem,true)[0],
                top = parseFloat(elem.style.top) || this._from,
                dur = Math.abs(upward ? (this._to - top)*this._mspp : (top - this._from)*this._mspp),
                preAniTime = _e._$dataset(elem,'ani');
            if(this._brandAni[preAniTime]){
                this._brandAni[preAniTime]._$recycle();
            }
            delete this._brandAni[preAniTime];
            var curAniTime = _e._$dataset(elem,'ani',+new Date);
            this._brandAni[curAniTime] = Bezier._$$AnimBezier._$allocate({
                from: {
                    offset: top
                },
                to:{
                    offset:(upward ? self._to : self._from)
                },
                duration:dur,
                timing:self._timing,
                onupdate:function(_event){
                    elem.style.top = _event.offset + 'px';
                },
                onstop:function(){
                    self._$dispatchEvent(upward?self._onTo:self._onFrom);
                    this._$recycle();
                    delete self._brandAni[curAniTime];
                }
            });
            // 开始动画
            this._brandAni[curAniTime]._$play();
        };

        return _p;
    },1,2,3,23,4,25,96);
I$(257,function (_k,_ut,_v,_t,_e,request,LoginWindow,PromptWin,_q,_t0,_p,_o,_f,_r,_pro) {
	var that;

    var followbrand = {
        		
        addFav : function(_event, bid, target, loginObj){
            if(!target||!!this.sending){
            	return;
            }
            
            var url = '/personal/brand/follow.html', status = 1;  //status 0:取消关注 1:关注
//          if(target.className.indexOf('followed') != -1){  // 目前没有取消关注，交互同活动落地页
//              status = 0;
//          }
            this.sending=1;
            request(url, {
                method: 'POST',
                data: {id:bid, status:status||1},
                type: 'json',
                norest: true,
                onload: function(json){
                	//json.retcode = 200;
                    if(json.retcode == 200){
                        //修改状态
                    	this.toast("成功关注",target,-44);
                        this.__changeFavStatus(target);
                    }else if(json.retcode == 461){
                        this.__loginWin = LoginWindow._$allocate({logincallback: this.__getLoginOK2._$bind(this, bid, target, loginObj)})._$show();
                        this.sending=0;
                    }else if(json.retcode == 491){
                        //已关注,修改状态
                    	this.toast("已关注",target);
                        this.__changeFavStatus(target);
                    }else{
                        //错误提示
                        this.toast("关注失败",target,-44);
                    }
                }._$bind(this),
                onerror: function(json){
                    PromptWin._$allocate({message: '系统错误'})._$show();
                    this.sending=0;
                }._$bind(this)
            });
        },
        __changeFavStatus : function(target){
//          target.className = target.className.indexOf('followed')<0?'follow followed':'follow';
        	target.className = 'follow followed';
        },
        //收藏登录回调
        __getLoginOK2 : function(bid, target, loginObj, _state){
            if(_state==0){
                this.addFav(null, bid, target, loginObj);
                loginObj._$dispatchEvent('cbloginOk');
            }
        },
        // toast 方法
        toast : (function(){
            function Toast(){
                this.cnt = 1;
            }
            Toast.prototype.getOpacityCSSText = function(opacity){
            	var list = ['opacity:'+opacity];
            	list.push('filter:alpha(opacity='+opacity*100+')');
            	return list.join(';');
            }
            Toast.prototype.animate = function(_toast,_from,_to){
            	var _easein = _t0._$$AnimEaseIn._$allocate({
	        		from:{offset:_from},
	        		to:{offset:_to},
	        		duration:500,
	        		onupdate:function(_event){
	        			_toast.style.cssText = this.getOpacityCSSText(_event.offset);
	        		}._$bind(this),
	        		onstop:function(){
	        			this._$recycle();
	        		}
	        	});
	        	_easein._$play();
            }
            Toast.prototype.show = function(text,target,marginLeft){
                if(!target||!!this.loading){
                    return;
                }
                this.loading=1;
                var toast = _q(target)._$next(".toast")[0];
                toast.innerHTML = text;
                if(!!marginLeft){
                    toast.style.marginLeft = marginLeft + 'px';
                }
                
                this.animate(toast,0,0.75);
                setTimeout(function(){
                	this.animate(toast,0.75,0);
                	this.loading=0;
                	that.sending=0;
                }._$bind(this),2000);
            }
            var toast = new Toast();
            return function(text,target,marginLeft){
            	if(!that) 
                	that = this;
                toast.show(text,target,marginLeft);
            }
        }._$bind(this))()
        
    };  
        
    return followbrand;
},1,2,3,23,4,6,7,8,25,234);
I$(258,function (_k,_ut,_v,_t,_e,_p,_o,_f,_r,_pro) {
        var _pro = {};

        /**
         * 品牌领券成功回调
         */
        _pro._$onSuccess = function(e,coupon){
            var target = _v._$getElement(e,'c:j-brandcoupon');
            this._$disableBtn(target,'已领');
        };
        /**
         * 品牌领券已领过券回调
         */
        _pro._$onExchanged = function(e,coupon){
            var target = _v._$getElement(e,'c:j-brandcoupon')
            this._$disableBtn(target,'已领');
        };
        /**
         * 品牌领券置灰按钮
         */
        _pro._$disableBtn = function(node,text){
            if(_e._$hasClassName(node,'j-brandcoupon')){//通过j-brandcoupon，判断是否是品牌领券
                _e._$addClassName(node,'text-gray');
                _e._$delClassName(node,'couponExchange');
                _e._$getByClassName(node,'j-kind')[0].innerText = text;
            }
        }
        
        return _pro;
    },1,2,3,23,4);
I$(32,function (_k,_ut,_v,_t,_e,_q,_j,CountZero,BrandAni,followBrand,BrandCouponStatus,_p,_o,_f,_r,_pro) {
        var _pro;

        _p._$$BrandArea = _k._$klass();
        _pro = _p._$$BrandArea._$extend(_t._$$EventTarget);

        _pro.__init = function(_options) {
            this.__supInit(_options);
            // 父节点
            this._parent = _options.parent || 'body';
            // 品牌区域事件
            this.__brandAreaEvent(_options);
            // 查询品牌领券的状态
            this.__queryStatus();
        };
        
        /**
         * 品牌区域事件
         */
        _pro.__brandAreaEvent = function(_options){
            // 一排一，一排二：距开始/距结束倒计时
            this.__StartCountDown(_options);
            // 一排三、一排四动效
            this.__delegateBrandAni();
            // 品牌收藏功能
            this.__followBrand();
        };
        // 一排一，一排二：距开始/距结束倒计时
        _pro.__StartCountDown = function(_options){
            var kaolaSystemTime = _options.kaolaSystemTime || window.kaolaSystemTime || +new Date(),
                brandTime = _q(this._parent)._$children('.brandTime',true);
            if(brandTime.length) {
                _ut._$forEach(brandTime,function(_item,_index,_list){
                    var time = +(_e._$attr(_item,"time")) || 0;
                    if(time==0){
                        return;
                    }
                    
                    var list = _e._$getByClassName(_item,'timeArea');
                    if(list && list.length){
                        var opt = {
                            parent:list[0],
                            leftMs:time-kaolaSystemTime,
                            format:'{dd}天{hh}时{mm}分{ss}秒'
                        };
                        if(this._CZ){
                            this._CZ._$addCount(opt);
                        }else{
                            this._CZ = CountZero._$allocate(opt);
                        }
                    }
                },this);
            }
        };
        // 一排三、一排四动效
        _pro.__delegateBrandAni = function(){
            BrandAni._$$BrandAni._$allocate({
                wrapElem:_q(this._parent)._$children('.brandWrap[ani=need]',true),
                aniElem:'.brandDesc',
                to:-48,
                from:0,
                duration:300
            });
        };
        // 品牌收藏功能
        _pro.__followBrand = function(){
        	var followlist = _q(this._parent)._$children('.rowOfSix .follow',true);
            if(followlist.length){
            	followlist._$on('click', function(event){
            		_v._$stop(event);
            		
            		var target = _v._$getElement(event),
            			bid = _e._$attr(target,'brandId');
            		followBrand.addFav(event, bid, target, this);
	            }._$bind(this));
            }
        };
        /**
         * 品牌领券状态查询
         */
        _pro.__queryStatus = function(){
            var bcList = _q(this._parent)._$children('.j-brandcoupon',true),
                schemeIdArr = [];
            if(bcList.length==0){
                return;
            }
            //获取需要查询状态的品牌领券
            bcList._$forEach(function(node){
                var schemeId = _e._$attr(node,'schemeId');
                if(!!schemeId && schemeIdArr.indexOf(schemeId)==-1){
                    schemeIdArr.push(schemeId);
                }
            });
            //查询请求
            _j._$request('/coupon/redeemCode/getBatchCouponRemainder.html', {
                method: 'post',
                headers:{"X-Requested-With":'XMLHttpRequest'},
                data: _ut._$object2query({
                    redeemCodes: schemeIdArr.join(',')
                }),
                type: 'json',
                onload: function (_json) {
                    var json = _json||{};
                    if(json.code==200){
                        var data = json.data||{};
                        for(var key in data){
                            if(!data[key]){
                                _q('.j-brandcoupon[schemeId='+key+']')._$forEach(function(node){
                                    BrandCouponStatus._$disableBtn(node,'抢光');
                                }._$bind(this));
                            }
                        }
                    }
                }._$bind(this),
                onerror: function () {
                    
                }
            });
        };
        
        return _p._$$BrandArea;
    },1,2,3,23,4,25,14,108,256,257,258);
I$(95,function (_k, _ut, _t, _v, _e, Bezier, _p, _o, _f, _r, _pro) {

    /**
     * 页面滚动到某节点顶部的控件封装
     *
     * @extends module:util/event._$$EventTarget
     *
     * @param    {Object}  config   - 可选配置参数
     * @property {Node}  scrollTo    - 滚动的目的节点[必需]
     * @property {Number}  offset   - 目的节点的上下偏移量[非必需]，默认500ms
     * @property {Number}  duration   - 滚动的时间间隔[非必需]，默认500ms
     * @property {String}  timing    - 滚动的时间函数[非必需]，默认'easeinout'
     * @property {Function}   onEnd - 滚动结束时的回调[非必需]
     *
     * Example:
     *  //页面滚动到Node节点的顶部
     *  var scrollTo = ScrollTo._$allocate({
     *      scrollTo:Node,
     *      offset:0,
     *      duration:500,
     *      timing:'easeinout',
     *      onEnd:function(){
     *          alert('reach');
     *      }
     *  });
     * 
     */
    
    _p._$$ScrollTo = _k._$klass();
    _pro = _p._$$ScrollTo._$extend(_t._$$EventTarget);

    _pro.__reset = function(_options) {
    	this.__super(_options);
        this._scrollTo = _options.scrollTo;
        this._offset = +_options.offset||0;
        this._duration = +_options.duration||500;
        this._timing = _options.timing||'easeinout';
        this._onEnd = _options.onEnd;
        if(!!this._scrollTo){
            this.__startAni(_options);
        }
    };

    _pro.__startAni = function(_options){
        var self = this;
        var scrollTop = document.body.scrollTop||document.documentElement.scrollTop;
        var destination = _e._$offset(this._scrollTo).y+this._offset;
        if(scrollTop==destination){
            this.__callback();
            return;
        }
        var scroll2Tab = Bezier._$$AnimBezier._$allocate({
            from: {
                offset: scrollTop
            },
            to:{
                offset: destination
            },
            duration:this._duration,
            timing:this._timing,
            onupdate:function(_event){
                window.scrollTo(0,_event.offset);
            },
            onstop:function(){
                self.__callback();
                this._$recycle();
            }
        });
        scroll2Tab._$play();
    };

    _pro.__callback = function(){
        if(!!this._onEnd && _ut._$isFunction(this._onEnd)){
            this._onEnd();
        }
    }

    return _p._$$ScrollTo;

  },1,2,23,3,4,96);
I$(33,function (_k,_ut,_v,_t,_e,_q,_,ScrollTo,_p,_o,_f,_r,_pro) {
        var _pro;

        _p._$$SwitchTabs = _k._$klass();
        _pro = _p._$$SwitchTabs._$extend(_t._$$EventTarget);

        _pro.__init = function(_options) {
            this.__supInit(_options);
            // Tab切换
            this.__switchTabs();
            // 电梯tab切换 从秒杀活动模板迁移功能 hzmating 20160826
            this.__liftTabs();
        };
        
        // Tab切换
        _pro.__switchTabs = function(){
        	_ut._$forEach(_q('.tabChange'), function(_item,_index,_list){
        		var tabs = _e._$getByClassName(_item,'tab'),
                	tabsNum = tabs.length;
        		var _table = _q(_item)._$children('table',true)[0];
        		
        		//相应的block移到tabChange下面
        		var _conts = _e._$getByClassName(_item,'contentArea'),
        			_childs = _e._$getChildren(_conts[0]);
        		if(_childs && _childs.length){
        			_ut._$forEach(_childs,function(_item,_index,_list){
            			var _locateId = _e._$attr(_item,'locateId');
            			_q('#'+_locateId)._$delClassName('m-goodsarea')._$insert2(_item);
            		});
        		}
        		
        		if(tabs && tabsNum){
        			//绑定标签切换的事件
        			_q(tabs)._$on('mouseenter', function(event) {
	        			var self = _v._$getElement(event),
	        				prev = _q(self)._$siblings('.active'),
	        				idx = _ut._$indexOf(tabs, self)+1;
	        			clearTimeout(this.tabTimer);
	        			this.tabTimer = setTimeout(function(){
                            var actColor =  _e._$attr(self,'activeColor'),
                                preColor = prev._$attr('color');
                            if(_e._$hasClassName(self,'j-showtype2')){
                                _q(self)._$children('.j-tabtxt')._$style({'color':actColor,'borderColor':actColor});
                                prev._$children('.j-tabtxt')._$style({'color':preColor,'borderColor':'#fff'});
                            }else{
                                _q(self)._$style({'backgroundColor': actColor, 'borderColor': actColor});
                                prev._$style({'backgroundColor':preColor , 'borderColor': '#ddd'});
                            }
	        				_q(self)._$addClassName('active');
		                    prev._$delClassName('active')._$parent('.tabChange')._$children('.contentArea')._$children()._$addClassName('hide')
		                      	._$filter(':nth-child('+idx+')')._$delClassName('hide');

		                    //触发lazyLoad事件
		                    _v._$dispatchEvent(window,'scroll');
	        			}, 200);

	        		}._$bind(this));
        			//离开时保留active状态
        			_q(_table)._$on('mouseleave', function(event) {
	        			var self = _v._$getElement(event),
	        				activeTab = _q(self)._$children('th.active',true)[0],
                            actColor = _e._$attr(activeTab,'activeColor');
	        			clearTimeout(this.tabTimer);
                        if(_e._$hasClassName(activeTab,'j-showtype2')){
                            _q(activeTab)._$children('.j-tabtxt')._$style({
                                'color': actColor,
                                'borderColor': actColor
                            });
                        }else{
                            _q(activeTab)._$style({
                                'backgroundColor': actColor,
                                'borderColor': actColor
                            });
                        }
	        		}._$bind(this));
        			
        			//先填充默认背景色, 确保每个tab长度一致
        			_ut._$forEach(tabs,function(_item,_index,_list){
            			if(!(_e._$hasClassName(_item,'active')) && !(_e._$hasClassName(_item,'j-showtype2'))){
            				_e._$style(_item,{'backgroundColor':_e._$attr(_item,'color')});
            			}
            			_e._$style(_item,{'width':(1000 / tabsNum).toFixed(1) + "px"});
            		});
        		}
        		
        	}._$bind(this));
        };
        /**
         * 电梯tab切换
         */
        _pro.__liftTabs = function(){
            if(_q('.m-tabbar-wrap .tabbar-bg').length){
                this.__lifttabNavFix();
                this.__bindliftTab();
                this.__bindliftTabScroll();
            }
        };
        /**
         * 滚动后固定到窗口顶部
         */
        _pro.__lifttabNavFix = function(){
            var tabbarbg = _q(".m-tabbar-wrap .tabbar-bg"),
                tabbarWrap = tabbarbg[0].parentNode,
            check = function(){
                var t = document.documentElement.scrollTop || document.body.scrollTop,
                    navTop = t + tabbarWrap.getBoundingClientRect().top;
                if( t >= navTop ){
                    _e._$addClassName(tabbarbg[0],'tabbar-bg-fix');
                    if( tabbarbg._$style("position") == "absolute" ){
                        tabbarbg._$style("top", t-navTop-3);
                    }
                }else if(t < navTop ){
                    _e._$delClassName(tabbarbg[0],'tabbar-bg-fix');
                    tabbarbg._$attr('style','');
                }
            }._$bind(this);
            var checkThrotte = _.throttle(check, 50, {leading: false});
            _v._$addEvent(window,'scroll',checkThrotte);
            checkThrotte();
        };
        /**
         * 导航tab 按位置按网页滚动跟随切换
         */
        _pro.__bindliftTab = function(){
            var tabbar = _q('.m-tabbar-wrap .tabbar');
            this.__isScrolling = false;
            tabbar._$on('click .tab',function(evt){
                var tab = _v._$getElement(evt,'c:tab');
                var prevTab = _q(tab)._$parent()._$children('.tab.active',true);
                if (prevTab.length===0 || prevTab[0]!=tab) {
                    _e._$delClassName(prevTab[0],'active');
                    _e._$addClassName(tab,'active');
                    this.__switchliftTabStyle(tabbar);
                }
                this.__isScrolling = true;
                ScrollTo._$allocate({
                    scrollTo:_e._$get(_e._$attr(tab,'data-rel')),
                    offset:-tab.offsetHeight,
                    duration:400,
                    timing:'easeinout',
                    onEnd:function(){
                        this.__isScrolling = false;
                    }._$bind(this)
                });
            }._$bind(this));
        };
        /**
         * 导航随页面滚动自动切换
         */
        _pro.__bindliftTabScroll = function(){
            var tabbar = _q('.m-tabbar-wrap .tabbar'),
                blocks,
                tabHeight = tabbar[0].offsetHeight,
                tabbarDisplay = function(display){
                    return !!display?tabbar[0].style.display=display:tabbar[0].style.display;
                };
            var scroll = function(){
                if (this.__isScrolling) { return; }
                var tops = [], top,
                    wTop = document.documentElement.scrollTop||document.body.scrollTop,
                    blocks = tabbar._$children('.tab')._$map(function(tab){
                        return _e._$get(_e._$attr(tab,'data-rel'));
                    });
                for (var i = 0; i < blocks.length; i++) {
                    if(!blocks[i]){continue;}//过滤过期异常的模块
                    top = _e._$offset(blocks[i]).y;
                    if (top <= wTop+tabHeight) {
                        tops.push( top );
                    }else{
                        break;
                    }
                }
                var actTab = tabbar._$children('.active'),
                    nextTab = tabbar._$children()[tops.length>0?tops.length-1:0];
                if (actTab.length===0 || nextTab != actTab[0]) {
                    _e._$delClassName(actTab[0],'active');
                    _e._$addClassName(nextTab,'active');
                    this.__switchliftTabStyle(tabbar);
                }
                //如果滚动超出区域，隐藏tab
                if (tops.length === blocks.length) {
                    // debugger;
                    var last = blocks[blocks.length-1];
                    if (_e._$offset(last).y+last.offsetHeight <= wTop+tabHeight+200) {
                        tabbarDisplay()!=='none' && tabbarDisplay('none');
                    }else{
                        tabbarDisplay()!=='block' && tabbarDisplay('block');
                    }
                }else{
                    tabbarDisplay()!=='block' && tabbarDisplay('block');
                }
            }._$bind(this);
            var scrollThrotte = _.throttle(scroll, 100, {leading: false});
            _v._$addEvent(window,'scroll',scrollThrotte);
            scrollThrotte();
        };

        _pro.__switchliftTabStyle = function(tabbar){
            var showType = tabbar._$attr('showType')||1;
            tabbar._$children()._$forEach(function(node){
                var tab = _q(node),
                    color = tab._$attr('color');
                if(showType==2){
                    tab._$children('em')._$style({
                        color:color,
                        borderColor:'#fff'
                    });
                }else{
                    tab._$style('background-color',color);
                }
            });
            tabbar._$children('.active')._$forEach(function(node){
                var tab = _q(node),activeColor = tab._$attr('activeColor');
                if(showType==2){
                    tab._$children('em')._$style({
                        color:activeColor,
                        borderColor:activeColor
                    });
                }else{
                    tab._$children('span')._$style('border-top-color', activeColor);
                    tab._$style('background-color',activeColor);
                }
            });
            
        };
        
        return _p._$$SwitchTabs;
    },1,2,3,23,4,25,15,95);
I$(259,function (_k,_ut,_v,_t,_e,_q,_j,_p,_o,_f,_r,_pro) {
        var _pro;

        _p._$$RollComment = _k._$klass();
        _pro = _p._$$RollComment._$extend(_t._$$EventTarget);

        _pro.__init = function(_options) {
            this.__supInit(_options);
            this.__initComment(_options);
        };
        
        _pro.__initComment = function(_options){
            //评论出现定时器
            this.commentTimer = null,
            //评论滚动定时器
            this.rollTextTimer = null;
            var parent = _options.parent||'body';
            _q(parent)._$children('.detailWrap',true)._$on({
                'mouseenter':this.__showComment._$bind(this),
                'mouseleave':this.__hideComment._$bind(this)
            });
        };

        _pro.__showComment = function(e){
            var elem = _q(e.target);
            var goodsId = elem._$attr("goodsId"); 
            var proComment = elem._$children(".proComment",true);
            var hasComment = proComment._$attr("hasComment")==1;//是否有评论
            var hasGotComment = proComment._$attr("gotComment")==1;//是否已经异步获取到评论
            //标示已经进入节点
            proComment._$attr('leave','0');
            //后台设置不显示评论
            if(proComment.length==0){
                return;
            }
            //没有评论，显示'新品上线，赶快来试试吧！'
            if(!hasComment){
                this.__showElem(proComment);
                return;
            }
            if(hasGotComment){
                //直接显示评论
                this.__showElem(proComment);
                //滚动评论
                this.__rollComment(proComment);
            }else{
                //150ms后异步获取评论
                this.commentTimer = setTimeout(this.__getCommentList._$bind(this,proComment,goodsId), 150);
            }
        };

        _pro.__getCommentList = function(proComment,goodsId){
            _j._$request('/commentAjax/comment_list.html',{
                sync:false,
                type:'json',
                headers:{"X-Requested-With":'XMLHttpRequest'},
                data:_ut._$object2query({
                    goodsId: goodsId,
                    grade: 1,
                    hasContent: 1,
                    hasImg: 0,
                    pageNo: 1,
                    pageSize:10
                }),
                method:'post',
                timeout:0,
                onload:function(_data){
                    var data = _data || {};
                    var commentList = [];
                    var hasLeft = proComment._$attr('leave')==1;//鼠标是否在请求返回前就已经离开节点
                    if (data.retcode == 200) {
                        //标记已经成功获取过评论
                        proComment._$attr("gotComment",1);
                        _ut._$forEach(data.commentPage.result,function(value){
                            //不等于2说明之后的评论都不是精品评论
                            if(value.commentStatus!=2){
                                return false;
                            }
                            //将精品评论插入评论列表
                            commentList.push((value.accountShow||"")+"："+(value.commentContent||""));
                        });
                    }
                    //显示评论
                    if(!hasLeft){
                        this.__showElem(proComment);
                    }
                    if(commentList.length>0){
                        _e._$addClassName(proComment._$children(".data")[0],"hasDetail");
                        proComment._$children(".detail")._$style('display','block');
                        proComment._$children(".rollText",true)._$html(commentList.join("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"));
                        //滚动评论
                        if(!hasLeft){
                            this.__rollComment(proComment);
                        }
                    }
                }._$bind(this),
                onerror:function(){
                    
                }._$bind(this)
            });
        };

        _pro.__rollComment = function(proComment){
            var rollText = proComment._$children(".rollText",true);
            var w = rollText[0].offsetWidth - 10;//评论的长度
            var finish = false;//判断评论是否已经滚到头
            this.rollTextTimer = setInterval(function(){
                var marginLeft = parseFloat(rollText._$style('marginLeft'))||0;
                if(w<=-marginLeft){
                    finish = true;
                }
                rollText._$style('marginLeft',(marginLeft-1)+'px');
                if(finish){
                    //重新开始滚动
                    rollText._$style('marginLeft',w+'px');
                    finish = false;
                }
            },30);
        };

        _pro.__showElem = function(elem){
            elem._$style('display','inline-block');
        };

        _pro.__hideComment = function(e){
            var self = this;
            var elem = _q(e.target);
            var proComment = elem._$children(".proComment",true);
            if(proComment.length==0){
                return;
            }
            clearTimeout(this.commentTimer);
            clearTimeout(this.rollTextTimer);
            //标示已经离开节点
            proComment._$attr('leave','1');
            proComment._$style('display','none');
        };

        return _p;
    },1,2,3,23,4,25,14);
I$(328,"<div class=\"m-skucard\" style=\"left: {left || 'auto'}px;\">\n\t<h2 class=\"titlebox f-cb\">\n\t\t<span class=\"title f-fl\">加入购物车</span>\n\t\t<span on-click={this.close()} class=\"close f-fr\">×</span>\n\t</h2>\n\t<div class=\"cntbox\">\n\t\t<ul class=\"namelist\">\n\t\t\t{#if skuGoodsPropertyList.length != 0}\n\t\t\t{#list skuGoodsPropertyList as item}\n\t\t\t<li class=\"item\">\n\t\t\t\t<p class=\"propname\">{item.propertyNameCn}：</p>\n\t\t\t\t<p class=\"proptlist f-cb\">\n\t\t\t\t\t{#if item.propertyValues.length != 0}\n\t\t\t\t\t{#list item.propertyValues as item2}\n\t\t\t\t\t{#if item2.showTag == 0}\n\t\t\t\t\t\t<a href=\"javascript:void(0)\" class=\"propt disable\">{item2.propertyValue}</a>\n\t\t\t\t\t{#else}\n\t\t\t\t\t\t<a href=\"javascript:void(0)\" class=\"propt {item2.showTag == 1 ? 'propt-2' : ''} {item2.showTag == 2 ? 'propt-1' : ''}\" on-click={this.changePropt(item2)}>{item2.propertyValue}</a>\n\t\t\t\t\t{/if}\n\t\t\t\t\t{/list}\n\t\t\t\t\t{/if}\n\t\t\t\t</p>\n\t\t\t</li>\n\t\t\t{/list}\n\t\t\t{/if}\n\t\t</ul>\n\t\t<div class=\"foot f-cb\">\n\t\t\t{#if !!price}\n\t\t\t<span class=\"price f-fl\">¥{price}</span>\n\t\t\t<a href=\"javascript:void(0)\" on-click={this.confirm()} class=\"u-wbtn f-fr\">确定</a>\n\t\t\t{#else}\n\t\t\t<a href=\"javascript:void(0)\" class=\"u-wbtn u-wbtn-1 disable f-fr\">确定</a>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n</div>");
I$(139,function (tpl, BaseComponent){

  var SkuCard = BaseComponent.extend({
    name: "skucard",
    template: tpl,
    config: function(){
      this.selectedValues = [];
      this.setCard();
    },
    init: function(){
      this.supr();
    },
    /**
     * 根据所选的属性来设置sku卡片的属性显示情况
     * this.selectedValues 选中的属性id列表
     * this.filteredSku 根据选中的属性过滤出的sku列表
     * 
     */
    setCard: function(){
      for(var i=0, len=this.data.skuGoodsPropertyList.length; i<len; i++){
        for(var j=0, len1=this.data.skuGoodsPropertyList[i].propertyValues.length; j<len1; j++){
          var propObj = this.data.skuGoodsPropertyList[i].propertyValues[j];
          if(!this.checkisSelected(propObj)){
            this.setProperty(propObj);
          }
        }
      }
    },
    /**
     * 设置某个属性的显示情况
     * propObj  属性对象
     * 
     */
    setProperty: function(propObj){
      var skuList = this.filteredSku || this.data.skuList;
      var propId = propObj.propertyValueId;
      propObj.showTag = 0; // showTag = 1 可选， =2 选中， =0 不可选
      for(var i=0, len=skuList.length; i<len; i++){
        for(var j=0, len1=skuList[i].skuPropertyValueIdList.length; j<len1; j++){
          if(propId == skuList[i].skuPropertyValueIdList[j] && !!skuList[i].storageStatus && !!skuList[i].storeForView){
            propObj.showTag = 1;
          }
        }
      }
    },
    // 改变整个sku卡片属性状态
    changePropt: function(item){
      if(item.showTag == 1){
        this.setSinglePropValue(item);
        this.filterSelectedVal(item);
        item.showTag = 2;
      }else if(item.showTag == 2){
        item.showTag = 1;
      }
      this.checkSelectProp(item);
      this.getSelectPropt();
      this.getSkuList();
      this.setCard();
      this.showPrice();
      this.$update();
    },
    // 检查sku是否缺货  true---有货
    checkSku: function(valIds){
      for(var j=0, len1=this.data.skuList.length; j<len1; j++){
        var tag = 0;
        for(var i=0, len=valIds.length; i<len; i++){
          var id = new RegExp(valIds[i]);
          if(id.test(this.data.skuList[j].skuPropertyValueId4View)){
            tag += 1;
          }
        }
        if(tag == valIds.length && !!this.data.skuList[j].storageStatus && !!this.data.skuList[j].storeForView){
          return true;
        }
      }
      return false;
    },
    // 如果选中某一属性值，需要清除此属性其他选中状态
    setSinglePropValue: function(item){
      var propNameId = item.propertyNameId;
      for(var i=0, len=this.data.skuGoodsPropertyList.length; i<len; i++){
        for(var j=0, len1=this.data.skuGoodsPropertyList[i].propertyValues.length; j<len1; j++){
          var propObj = this.data.skuGoodsPropertyList[i].propertyValues[j];
          if(propObj.showTag == 2 && propObj.propertyNameId == item.propertyNameId){
            propObj.showTag = 1;
          }
        }
      }
    },
    // 过滤已选中的属性，根据刚选中的属性值，过滤其他已选中的属性值是否有交集
    filterSelectedVal: function(item){
      this.uselessVals = [];
      for(var i=0, len=this.data.skuGoodsPropertyList.length; i<len; i++){
        for(var j=0, len1=this.data.skuGoodsPropertyList[i].propertyValues.length; j<len1; j++){
          var propObj = this.data.skuGoodsPropertyList[i].propertyValues[j];
          if(item.propertyNameId != propObj.propertyNameId){
            this.getSkuList1(item);
            this.getUselessVals(propObj);
          }
        }
      }
      // 检查之前选中的属性值是不是在不可点的属性列表中, 如果存在设置其不可点
      for(var k=0, len2=this.uselessVals.length; k<len2; k++){
        for(var h=0, len3=this.selectedValues.length; h<len3; h++){
          if(this.uselessVals[k].propertyValueId == this.selectedValues[h].propertyValueId){
            // 设置已选中属性的标记为0
            this.selectedValues[h].showTag = 0;
          }
        }
      }
    },
    // 根据刚选的sku过滤出包含刚才选中属性值的skulist
    getSkuList1: function(item){
      // 仅根据刚选的属性过滤出的sku集合
      this.filteredSku1 = [];
      var skuList = this.data.skuList;
      for(var i=0, len=skuList.length; i<len; i++){
        for(var j=0, len1=skuList[i].skuPropertyValueIdList.length; j<len1; j++){
          if(item.propertyValueId == skuList[i].skuPropertyValueIdList[j]){
            this.filteredSku1.push(skuList[i]);
          }
        }
      }
    },
    // 获取属性不可点的属性列表
    getUselessVals: function(propObj){
      var skuList = this.filteredSku1 || this.data.skuList,
        propId = propObj.propertyValueId,
        showTag = 0;
      for(var i=0, len=skuList.length; i<len; i++){
        for(var j=0, len1=skuList[i].skuPropertyValueIdList.length; j<len1; j++){
          if(propId == skuList[i].skuPropertyValueIdList[j] && !!skuList[i].storageStatus && !!skuList[i].storeForView){
            showTag = 1;
          }
        }
      }
      if(!showTag){
        propObj.showTag = 0;
        this.uselessVals.push(propObj);
      }else if(!propObj.showTag){
        // 原先不亮的属性设为可点
        propObj.showTag = 1;
      }
    },
    // 每次操作完，对已选中属性的其他值进行一次遍历，重新设值
    checkSelectProp: function(item){
      this.getSelectPropt();
      for(var i=0, len=this.data.skuGoodsPropertyList.length; i<len; i++){
        for(var j=0, len1=this.data.skuGoodsPropertyList[i].propertyValues.length; j<len1; j++){
          var proptyObj = this.data.skuGoodsPropertyList[i].propertyValues[j];
          // 首先排除刚操作的属性名
          if(item.propertyNameId != proptyObj.propertyNameId){
            var tag = 0;
            for(var k=0, len2=this.selectedValues.length; k<len2; k++){
              if(this.selectedValues[k].propertyValueId == proptyObj.propertyValueId){
                tag = 1;
              }
            }
            // 根据tag排除被选中的属性对象
            if(!tag){
              // 传入拼接的sku数组 id-arr
              var selectedProptyVals = this.getSelectPropt(1);
              this.getSelectPropt();
              for(var h=0,len3=this.selectedValues.length;h<len3;h++){
                if(proptyObj.propertyNameId == this.selectedValues[h].propertyNameId){
                  selectedProptyVals[h] = proptyObj.propertyValueId;
                }
              }
              if(!this.checkSku(selectedProptyVals)){
                proptyObj.showTag = 0;
              }else{
                proptyObj.showTag = 1;
              }
            }
          }
        }
      }

    },
    // 是否为已选属性-且为不可选属性
    isSelectedProp: function(propObj){
      this.getSelectPropt();
      for(var i=0, len=this.selectedValues.length; i<len; i++){
        if(propObj.propertyNameId == this.selectedValues[i].propertyNameId && propObj.showTag == 0){
          this.selectedValues[i].propertyValueId = propObj.propertyValueId;
          return true;
        }
      }
      return false;
    },
    // 获取选中的sku属性对象列表
    getSelectPropt: function(tag){
      var arr = [];
      this.selectedValues = []; // 清空列表
      for(var i=0, len=this.data.skuGoodsPropertyList.length; i<len; i++){
        for(var j=0, len1=this.data.skuGoodsPropertyList[i].propertyValues.length; j<len1; j++){
          var propObj = this.data.skuGoodsPropertyList[i].propertyValues[j];
          if(propObj.showTag == 2){
            if(!tag){
              this.selectedValues.push(propObj);
            }else{
              arr.push(propObj.propertyValueId);
            }
          }
        }
      }
      return arr;
    },
    // 检查某个属性值是否在所选属性列表的同一属性中
    // propertyNameId 用来判断是否为同一属性名
    checkisSelected: function(propObj){
      var propNameId = propObj.propertyNameId;
      for(var i=0, len=this.selectedValues.length; i<len; i++){
        if(propNameId == this.selectedValues[i].propertyNameId){
          return true;
        }
      }
      return false;
    },
    // 获取符合条件的sku列表, 过滤掉不包含选中属性的sku
    getSkuList: function(){
      this.filteredSku = [];  // 清空列表
      for(var i=0, len=this.data.skuList.length; i<len; i++){
        if(!!this.filterSkuList(i)){
          this.filteredSku.push(this.data.skuList[i]);
        }
      }
    },
    // 根据选中的属性过滤sku
    filterSkuList: function(i){
      var tag = 0;  // 如果tag=1, 则放入skulist
      for(var j=0, len1=this.data.skuList[i].skuPropertyValueIdList.length; j<len1; j++){
        for(var k=0, len2=this.selectedValues.length; k<len2; k++){
          if(this.selectedValues[k].propertyValueId == this.data.skuList[i].skuPropertyValueIdList[j]){
            tag += 1;
          }
        }
      }
      if(tag == this.selectedValues.length){
        return true;
      }else{
        return false;
      }
    },
    // 判断是否显示价格
    showPrice: function(){
      if(this.selectedValues.length == this.data.skuGoodsPropertyList.length && this.filteredSku.length == 1){
        this.data.price = this.filteredSku[0].actualCurrentPrice;
      }else{
        this.data.price = 0;
      }
    },
    close: function(){
      this.$emit('close');
      this.destroy();
    },
    confirm: function(){
      this.$emit('confirm', this.filteredSku[0].skuId);
      this.destroy();
    }
    
  });
  
  return SkuCard;

},328,151);
I$(260,function (_k,_ut,_v,_t,_e,_q,_j,Cart,SkuCard,PromptWin,_p,_o,_f,_r,_pro) {
        var _pro;

        _p._$$AddToCart = _k._$klass();
        _pro = _p._$$AddToCart._$extend(_t._$$EventTarget);

        _pro.__init = function(_options) {
            this.__supInit(_options);
            this.__bindCartBtn(_options);
        };
        
        _pro.__bindCartBtn = function(_options){
            var body = _e._$get(_options.parent||'body');
            _v._$addEvent(body,"click",this.__onBodyClick._$bind(this));
        };

        _pro.__onBodyClick = function(e){
            var elem = _v._$getElement(e),
                self = this;
            if(_e._$hasClassName(elem, 'j-cart-btn')){
                var goodsId = _e._$dataset(elem, 'goodsid'),
                    imageUrl = _e._$dataset(elem, 'imageurl');
                // card实例存在，清除card实例
                if(!!this.skuCard){
                    this.skuCard.destroy();
                }
                _j._$request('/goodsAjax/querySkuById.html',{
                    method: 'post',
                    data: _ut._$object2query({goodsIdStr: goodsId}),
                    type: 'json',
                    headers:{"X-Requested-With":'XMLHttpRequest'},
                    onload: function(json){
                        if(json.retcode == 200){
                            json = json.object;
                            if(json.skuList.length > 1){  // 多SKU, 需要弹层选择sku
                                self.skuCard = new SkuCard({data: json});
                                self.skuCard.$on('confirm',self.__addCart._$bind(self, elem, imageUrl, goodsId));
                                self.skuCard.$inject(_q(elem)._$parent(".proinfo",true)[0]);
                            }else if(json.skuList.length == 1){  // 单SKU, 直接加入购物车
                                var sku = json.skuList[0].skuId;
                                self.__addCart(elem, imageUrl, goodsId, sku);
                            }
                        }else{
                            PromptWin._$allocate({message: json.retdesc})._$show();
                        }
                    },
                    onerror: function(json){
                        PromptWin._$allocate({message: '获取商品属性信息失败！'})._$show();
                    }
                })
            }
        };
        
        _pro.__addCart = function(elem, imageUrl, goodsId, skuId){
            var sidesCart = _e._$get('sidesCart'),
                flyCfg = false;
            if(!!sidesCart){
                flyCfg = {
                    from:elem,
                    imageUrl:imageUrl,
                    to:sidesCart
                }
            }
            if(!this.__cart){
                this.__cart = Cart._$allocate({onsuccess:this.__onAddCartSuccess._$bind(this)})
            } 
            this.__cart._$addCart({
                count: 1,
                goodsId: goodsId || 0,
                skuId: skuId || 0,
                source:'activity'
            },flyCfg);
        };

        _pro.__onAddCartSuccess = function(){
            
        };

        return _p;
    },1,2,3,23,4,25,14,101,139,8);
I$(462,function (_k,_ut,_v,_t,_e,_j,_user,_p,_o,_f,_r,_pro) {
        var _pro;

        _p._$$AddFavAjax = _k._$klass();
        _pro = _p._$$AddFavAjax._$extend(_t._$$EventTarget);

        /**
         * 控件初始化
         * @param  {Object} config   - 配置参数
         * @property {String}  operate   - 控件执行的操作 'add':添加收藏，'del':删除收藏，'check'：检查是否已经收藏
         * @property {String}  goodsId   - 商品ID
         * @property {Function}  onsuccess   - 操作成功
         * @property {Function}  onfail   - 操作失败
         * @return {Void}
         */
        _pro.__reset = function(_options) {
            this.__super(_options);
            this.__startAjax(_options);
        };

        _pro.__urls = {
            'add' : '/favoriteAjax/add.html',
            'del' : '/favoriteAjax/delete.html',
            'check' : '/favoriteAjax/isFavorite.html'
        };
        
        _pro.__startAjax = function(_options){
            this._operate = _options.operate||'';
            var _url = this.__urls[this._operate];
            var _goodsId = _options.goodsId||"";
            if(!_url || !_goodsId){
                console.error('favAjax : no '+(!_url?'operate':'goodsId')+'!');
                return false;
            }
            _user.afterLogin(this.__doAjax._$bind(this,_url,_goodsId)); 
        };

        _pro.__doAjax = function(_url,_goodsId){
            _j._$request(_url,{
                sync:false,
                type:'json',
                headers:{"X-Requested-With":'XMLHttpRequest'},
                data:_ut._$object2query({goodsId:_goodsId}),
                method:'post',
                onload:this.__onSuccess._$bind(this),
                onerror:this.__onFail._$bind(this)
            });
        };

        _pro.__onSuccess = function(_json){
            var data = _json || {},
                ret = data.retcode,
                operate = this._operate;
            if(operate=="add"){//增加收藏
                if(ret===200 || ret===491){
                    this._$dispatchEvent('onsuccess',data);
                }else{
                    this._$dispatchEvent('onfail',data);
                }
            }else if(operate=="del"){//删除收藏
                if(ret===200){
                    this._$dispatchEvent('onsuccess',data);
                }else{
                    this._$dispatchEvent('onfail',data);
                }
            }else{//检查是否收藏
                if(ret===200 && data && data.result){
                    this._$dispatchEvent('onsuccess',true);
                }else{
                    this._$dispatchEvent('onfail',false);
                }
            }
        };

        _pro.__onFail = function(){
            this._$dispatchEvent('onfail',false);
        };

        return _p;
    },1,2,3,23,4,14,26);
I$(310,"<div class=\"m-dialogmodal iDialogMain {customClass}\">\n\t<div class=\"m-dlgcont cnt\">\n     <p class=\"title\"><i class=\"iconfont main-icon {icon||'yes'}\" r-html=\"icon=='yes'?'&#xe612;':'&#xe604;'\"></i>{text}</p>\n     {#if !!detail}\n     <p class=\"detail\">{detail}</p>\n     {/if}\n </div>\n \t{#if !!btnText}\n\t<div class=\"btnbar f-tac\">\n\t  <a class=\"btn\" href=\"javascript:void(0)\" on-click={this.confirm()}>{btnText}</a>\n\t</div>\n\t{/if}\n</div>\n\n");
I$(115,function (ut, e,v,ut1, Modal, tpl){

	var Dialog = Modal.extend({
	    content:tpl,
	    data:{title:'到货提醒',width:520,icon:'yes',text:'设置成功',detail:'',btnText:'确认',customClass:'',timeout:0},
	    init:function(){
	    	this.supr();
	    	//增加定时关闭 hzmating
	    	var timeout = this.data.timeout;
	    	if(timeout!=0){
	    		this.timeout(timeout);
	    	}
	    },
	    confirm: function(){
	    	this.destroy();
	    }
	});

	// 绑定Modal
  	return Dialog;
},15,4,3,2,128,310);
I$(261,function (_k,_ut,_v,_t,_e,_q,_j,GoodsFavAjax,Modal,_p,_o,_f,_r,_pro) {
        var _pro;

        _p._$$AddFavorite = _k._$klass();
        _pro = _p._$$AddFavorite._$extend(_t._$$EventTarget);

        /**
         * 收藏功能包装
         * 收藏成功后要弹出提示，提示2s后消失，如果用户鼠标在提示上，则暂时不消失，离开1s后消失
         */

        _pro.__reset = function(_options) {
            this.__super(_options);
            // 初始化
            this.__bindBtn(_options);
        };
        
        _pro.__notice = (function(){
            function FavNotice(el, first){
                this._txt = !!first ? '收藏成功':'您已收藏';
                this._anchor = el;
                this.createNotice();
                this.calcPos();
                this.show();
            }
            FavNotice.prototype.createNotice = function(){
                var html = '<div class="m-favsucc">\
                    <span class="arr0 arr">&nbsp;</span>\
                    <span class="arr1 arr">&nbsp;</span>\
                    <i class="iconfont ic">&#xe62e;</i>'+this._txt+'。<a href="/personal/listfavorite.html" class="color-blue" target="_blank">去个人中心查看&thinsp;&gt;</a>\
                </div>';
                this._notice = _q(html);
                _q(document.body)._$insert(this._notice,'bottom');
            };
            FavNotice.prototype.calcPos = function(){
                var aOffset = _e._$offset(this._anchor,document.body);
                    aRect = {'width': this._anchor.offsetWidth, 'height': this._anchor.offsetHeight},
                    noticeOffset = {left:0, top: 0},
                    noticeRect = {'width': this._notice[0].offsetWidth, 'height': this._notice[0].offsetHeight};
                noticeOffset.left = aOffset.x + aRect.width/2 - noticeRect.width/2;
                noticeOffset.top = aOffset.y + aRect.height + 6;
                this._notice._$style({
                    'left': noticeOffset.left+'px',
                    'top': noticeOffset.top + 'px'
                });
            };
            FavNotice.prototype.bindEvents = function(){
                var self = this;
                // 隐藏并销毁提示
                function clear(){
                    self._timeout = 0;
                    _e._$addClassName(self._notice[0],'m-favsucc-fadeOut');
                    setTimeout(function(){
                        self._notice._$style({'display':'none'});
                        self.remove();
                    }, 300);
                }
                this._timeout = setTimeout(clear, 2000);
                this._notice._$on('mouseenter',function(){
                    clearTimeout(self._timeout);
                    self._timeout = 0;
                });
                this._notice._$on('mouseleave',function(){
                    self._timeout = setTimeout(clear, 1000);
                });
            };
            FavNotice.prototype.show = function(){
                this._notice._$style({'visibility':'visible'});
                this.bindEvents();
            };
            FavNotice.prototype.remove = function(){
                clearTimeout(this._timeout);
                this._notice[0].parentNode.removeChild(this._notice[0]);
                this._notice = null;
                this._anchor = null;
            };
            return function(elem,isSuccess){
                new FavNotice(elem, isSuccess);
            }
        })();

        _pro.__addFavorite = function(e){
            var self = this;
            var elem = e.target;
            // 点击icon的时候
            if(_e._$hasClassName(elem,'iconfont')){
                elem = elem.parentNode;
            }
            if(_e._$hasClassName(elem,'j-adding') || _e._$hasClassName(elem,'added')){
                return;
            }
            _e._$addClassName(elem,'j-adding');
            setTimeout(function(){
                _e._$delClassName(elem,'j-adding');
            }, 2000);
            var goodsId = _e._$attr(elem,'data-goodsId');
            var favAjax = GoodsFavAjax._$$AddFavAjax._$allocate({
                operate:'add',
                goodsId:goodsId,
                onsuccess:function(data){//成功
                    _e._$addClassName(elem,'added');
                    elem.innerHTML = '<i class="iconfont">&#xe62f;</i>已收藏';
                    _e._$attr(elem,'title','已收藏')
                    var notice = self.__notice(elem,data.retcode===200);
                    //回收控件
                    favAjax = favAjax._$recycle();
                },
                onfail:function(data){//其他各种意外情况
                    new Modal({
                        data:{
                            title:'提示',
                            icon:'fail',
                            text:data.retdesc||'加入收藏失败',
                            btnText:'',
                            timeout:3000
                        }
                    });
                    //回收控件
                    favAjax = favAjax._$recycle();
                }
            });
        };

        _pro.__bindBtn = function(_options){
            var parentNode = _options.parentNode || document.body;
            //绑定按钮点击事件
            _q(parentNode)._$children('.j-favbtn',true)._$on({
                'click':this.__addFavorite._$bind(this)
            });
        };

        return _p;
    },1,2,3,23,4,25,14,462,115);
I$(34,function (_k,_ut,_v,_t,_e,_q,_j,RollComment,AddToCart,AddFavorite,_p,_o,_f,_r,_pro) {
        var _pro;

        _p._$$GoodsArea = _k._$klass();
        _pro = _p._$$GoodsArea._$extend(_t._$$EventTarget);

        _pro.__init = function(_options) {
            this.__supInit(_options);
            this.__getNodes();
            this.__addEvent();
            var parent = _options.parent;
            // 初始化评论相关事件
            RollComment._$$RollComment._$allocate({
              parent:parent
            });
            // 加入购物车相关事件
            AddToCart._$$AddToCart._$allocate({
              parent:parent
            });
            //初始化收藏商品相关事件
            AddFavorite._$$AddFavorite._$allocate({
              parentNode:parent
            });
        };
        
        _pro.__getNodes = function(){
            
        };
        
        _pro.__addEvent = function(){
           
        };

        return _p._$$GoodsArea;
    },1,2,3,23,4,25,14,259,260,261);
I$(35,function (_k,_ut,_v,_t,_e,_q,_j,_p,_o,_f,_r,_pro) {
        var _pro;

        _p._$$Statistics = _k._$klass();
        _pro = _p._$$Statistics._$extend(_t._$$EventTarget);

        _pro.__init = function(_options) {
            this.__supInit(_options);
            // da打点
            this.__initActDa();
            //静态化统计
            this.__initShtml();
        };

        _pro.__initActDa = function(){
            var actPageLink = window.actPageLink||window.location.href;
            _q('body')._$on('click a[data-actda]', function(){
                var account = window.account || '',
                    actda = this.getAttribute('data-actda'),
                    daArr = actda.split("@@"),
                    zn = daArr[0]||'',//zname
                    zl = daArr[1]||'',//zlocation
                    zp = daArr[2]||'',//zposition
                    tu = daArr[3]||'';//target url
                if(actda!="" && !!window._dapush && tu!="javascript:;"){
                    window._dapush("_trackEvent","活动页",actPageLink,zn,{'userAccount':account,'userId':account,customData:[tu,zl,zp].join('|')});
                }
            });
        };

        _pro.__initShtml = function(){
            var url = '/stat/activity.html',param={},querystr = location.search.split('?')[1];
            if(location.href.indexOf('.shtml')>-1){
                if(querystr){
                    param = _ut._$query2object(querystr);
                }
                param.activityRefer = encodeURIComponent(document.referrer);
                param.activityShowId = window.activityId;
                _j._$request(url,{
                    sync:false,
                    type:'json',
                    data:_ut._$object2query(param),
                    method:'post',
                    headers:{"X-Requested-With":'XMLHttpRequest'},
                    timeout:0,
                    onload:function(_data){
                        // do nothing
                    }
                });
            }
        };

        return _p._$$Statistics;
    },1,2,3,23,4,25,14);
I$(36,function (_k, _ut, _, _v, _t, _e, $, _p, _o, _f, _r, _pro) {
        var _pro;

        _p._$$ActivSlide = _k._$klass();
        _pro = _p._$$ActivSlide._$extend(_t._$$EventTarget);

        _pro.__init = function (_options) {
            this.__supInit(_options);
            this.__extendTool();
            this.__getNodes();
            this.__addEvent();
            this.__initVideo();
        };

        /**
         * 图片热区视频功能
         */
        _pro.__initVideo = function () {
            $(document)._$on("click .closeVideo", function () {
                _e._$remove($(this)._$parent()[0], false);
            });

            $(".video163")._$forEach(function (_item, _i, _list) {
                var item = $(_item),
                    topic = item._$attr("topic"),
                    sid = item._$attr("sid"),
                    vid = item._$attr("vid");

                //// 针对<=IE6平台的处理逻辑
                //NEJ.patch('TR<=2.0', function () {});
                var parentNode = item._$parent()[0];
                if(!!$.isIE6 && _e._$hasClassName(parentNode, 'countryVideo')) {
                    _e._$remove(parentNode, false);
                }

                var UA = navigator.userAgent;
                var tplflash1 = ['<object  classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="{width}" height="{height}" >',
                    '<param name="bgcolor" value="{background_color}" >',
                    '<param name="allowFullScreen" value="{full_screen}">',
                    '<param name="allowscriptaccess" value="always">',
                    '<param name="allownetworking" value="all" />',
                    '<param name="wmode" value="{wmode}">',
                    '<param name="movie" value="{flash_src}" >',
                    '<param name="flashvars" value="pltype={pltype}&topicid={topicid}&sid={sid}&vid={vid}&threadCountPath={threadCountPath}&threadListPath={threadListPath}&coverpic={coverpic}&videoadv={videoadv}&autoplay={autoplay}&openSub={openSub}&iplimit={iplimit}" >',
                    '</object>'].join("");
                var tplflash2 = ['<object width="{width}" height="{height}" data="{flash_src}" type="application/x-shockwave-flash">',
                    '<param name="bgcolor" value="{background_color}" >',
                    '<param name="allowFullScreen" value="{full_screen}">',
                    '<param name="allowscriptaccess" value="always">',
                    '<param name="allownetworking" value="all" />',
                    '<param name="wmode" value="{wmode}">',
                    '<param name="flashvars" value="pltype={pltype}&topicid={topicid}&sid={sid}&vid={vid}&threadCountPath={threadCountPath}&threadListPath={threadListPath}&coverpic={coverpic}&videoadv={videoadv}&autoplay={autoplay}&openSub={openSub}&iplimit={iplimit}" >',
                    '</object>'].join("");

                var _param = {
                    topicid: "0085",
                    coverpic: "",
                    autoplay: true,
                    sid: sid || "",
                    vid: vid || "",
                    flash_src: "//v.163.com/swf/video/NetEaseFlvPlayerV3.swf",
                    background_color: '#000000',
                    wmode: "opaque",
                    full_screen: true,
                    iplimit: 0,
                    threadCountPath: '',
                    threadListPath: '',
                    pltype: "",
                    videoadv: '',
                    openSub: "",
                    width: '100%',
                    height: '100%'
                };
                if(topic == "paike") {
                    _param.topicid = "1000";
                }
                var isIe = UA.toLowerCase().indexOf('msie') > -1 ? true : false;
                var flash_str;

                if(isIe) {
                    flash_str = tplParse(tplflash1, _param);
                } else {
                    flash_str = tplParse(tplflash2, _param)
                }

                _item.innerHTML = flash_str;

                function tplParse(template, data, regexp) {
                    if(!(Object.prototype.toString.call(data) === "[object Array]")) {
                        data = [data]
                    }
                    var ret = [];
                    for(var i = 0, j = data.length; i < j; i++) {
                        ret.push(replaceAction(data[i]));
                    }
                    return ret.join("");
                    function replaceAction(object) {
                        return template.replace(regexp || (/\\?\{([^}]+)\}/g), function (match, name) {
                            if(match.charAt(0) == '\\')
                                return match.slice(1);
                            return (object[name] != undefined) ? object[name] : '';
                        });
                    }
                }

            });
        };

        _pro.__getNodes = function () {

        };

        _pro.__addEvent = function () {

        };

        _pro.__extendTool = function () {
            //isIE678, 来源：easeCore.js
            $.isIE678 = "\v" == "v";
            if($.isIE678) {
                $.isIE8 = !!'1'[0];
                $.isIE6 = !$.isIE8 && (!document.documentMode || document.compatMode == "BackCompat");
                $.isIE7 = !$.isIE8 && !$.isIE6
            }
        };

        return _p._$$ActivSlide;
    },1,2,15,3,23,4,25);
I$(37,function (_k, _ut, _, _v, _t, _e, LoginWindow, PromptWin, Modal, $, _j, BrandCouponStatus, _p, _o, _f, _r, _pro) {
        var _pro;

        _p._$$ActivSlide = _k._$klass();
        _pro = _p._$$ActivSlide._$extend(_t._$$EventTarget);

        _pro.__init = function (_options) {
            this.__supInit(_options);
            this.__extendTool();
            this.__initCoupon();
        };

        /**
         * 图片区域中的兑换优惠券热区
         */
        _pro.__initCoupon = function () {
            var self = this;
            var items = $(".couponExchange,.rowOfThree-coupon,.rowOfFour-coupon,.m-couponarea,.m-brandcoupon, .m-brandcoupon1");//这些模块都有领券功能
            if(items.length==0) return;
            _pro.checkCodeTimer = null;
            //_pro.__phoneValidation('111111');//手机号码验证弹窗
            //_pro.__exchangeSuccess('20元优惠券！');//获得优惠券弹窗
            //_pro.__exchangeFail('您可能已经领取过该优惠券了');//优惠券兑换失败弹窗
            $("body")._$on({
                "click #phoneNum,#checkCode": function (_e) {
                    $(this)._$attr("id") == "checkCode" ? $(".checkCodeErr")._$html("&nbsp;") : $(".phoneNumErr")._$html("&nbsp;");
                },
                "click .sendCheckCode": function (e) {
                    //手机号码是否正确
                    if(!_pro.__validatePhoneNum()) {
                        return false;
                    }
                    //获取验证码
                    var $phoneNum = $("#phoneNum"), phoneNumVal = $phoneNum._$val().trim();
                    _j._$request('/personal/phone/getVerifyCode.html', {
                        method: 'post',
                        headers:{"X-Requested-With":'XMLHttpRequest'},
                        data: _ut._$object2query({
                            schemeId: _pro.currentSchemeId,
                            phoneNum: phoneNumVal
                        }),
                        type: 'json',
                        onload: function (json) {
                            if(json.retcode == 200) {
                                _e._$remove($(".sendCheckCode")[0], false);
                                $("#phoneNum")._$insert($("<span id='checkCodeTimer'>再次发送(60)</span>")[0], 'after');
                                var timerElem = $("#checkCodeTimer");
                                var seconds = 0;
                                _pro.checkCodeTimer = setInterval(function () {
                                    seconds += 1;
                                    timerElem._$text("再次发送(" + (60 - seconds) + ")");
                                    if(seconds >= 60) {
                                        clearInterval(_pro.checkCodeTimer);
                                        _e._$remove(timerElem[0], false);
                                        $("#phoneNum")._$insert($('<a href="javascript:;" class="sendCheckCode">获取验证码</a>')[0], 'after');
                                    }
                                }, 1000);
                            } else if(json.retcode == 445) {
                                $(".phoneNumErr")._$html("<i>&#xe606;</i>该手机号已经被账号" + (json.accountId || "其它账号") + "绑定了哦，请使用该绑定账号登录领取，或选择使用其它手机号进行绑定");
                            } else {
                                $(".checkCodeErr")._$html("<i>&#xe606;</i>" + (json.retdesc || "获取验证码失败！"));
                            }
                        },
                        onerror: function () {
                            $(".checkCodeErr")._$html("<i>&#xe606;</i>获取验证码失败！");
                        }
                    });
                },
                "click .couponExchange": function (e) {
                    var item = $(this),
                        phoneValidation = item._$attr("phoneValidation");
                    _pro.currentSchemeId = item._$attr("schemeId"),     
                    _pro.currentCouponId = item._$attr("couponId");     

                    _j._$request('/personal/obtain_coupon.html', {
                        method: 'post',
                        headers:{"X-Requested-With":'XMLHttpRequest'},
                        data: _ut._$object2query({
                            schemeId: _pro.currentSchemeId,
                            phoneValidation: phoneValidation == "true"
                        }),
                        type: 'json',
                        onload: function (json) {
                            
                            // 登录的状态下进行打点有效
                            if(json.retcode != 461){
                                self._$dispatchEvent('cbclickcoupon');
                            }

                            if(json.retcode == 200) {
                                var coupon = json.coupon || {"couponScheme": {"schemeName": "优惠券"}};
                                var couponScheme = coupon.couponScheme || {"schemeName": "优惠券"};
                                self.__exchangeSuccess(couponScheme.schemeName);
                                //若是品牌领券，则改变品牌领券的状态
                                BrandCouponStatus._$onSuccess(e,coupon);
                            } else if(json.retcode == 444) {
                                _pro.__phoneValidation(json.accountId || "");
                            } else if(json.retcode == 461) {
                                LoginWindow._$allocate({
                                    logincallback: function (state) {
                                        if(state == 0){
                                            self._$dispatchEvent('cbloginOk', _pro.currentSchemeId);
                                            item._$trigger('click');
                                        }else{
                                            window.location.reload();
                                        }
                                    }
                                })._$show();
                            } else if(json.retcode == -12){//已经领取过该优惠券了
                                self.__exchangeFail(json.retdesc || '您可能已经领取过该优惠券了');
                                //若是品牌领券，则改变品牌领券的状态
                                BrandCouponStatus._$onExchanged(e,coupon);
                            } else {
                                self.__exchangeFail(json.retdesc || '您可能已经领取过该优惠券了');
                            }
                        },
                        onerror: function () {
                            var win = PromptWin._$allocate({
                                clazz: 'commTipsPop',
                                title: '提示',
                                width: 520,
                                message: '<div class="staDialogStyle"><i class="alert">&#xe609;</i>领取失败，请您刷新页面重试！</div>'
                            })._$show();
                            setTimeout(function () {
                                win._$hide();
                            }, 3000);
                        }
                    });
                }
            });

        };

        _pro.__validatePhoneNum = function () {
            var testPhone = new RegExp("^1[3|4|5|7|8]\\d{9}$");
            var phoneNum = $("#phoneNum")._$val().trim();
            if(phoneNum == "") {
                $(".phoneNumErr")._$html("<i>&#xe606;</i>" + "手机号码不能为空！");
                return false;
            }
            if(!testPhone.test(phoneNum)) {
                $(".phoneNumErr")._$html("<i>&#xe606;</i>" + "手机号码格式错误！");
                return false;
            }
            return true;
        };

        //手机号码验证弹窗
        _pro.__phoneValidation = (function () {
            var phoneValidationBox =
                '<div class="prompt phoneValidation">\
                    <ul>\
                        <li class="hint">小考拉需要您将登录账号{accountId}与手机号进行绑定，才能顺利给您发放哦：</li>\
                        <li class="phone clearfix">手机号码：<input id="phoneNum" type="text" value="" maxLength=11 placeholder="请输入手机号" /><a href="javascript:;" class="sendCheckCode">获取验证码</a></li>\
                        <li class="phoneNumErr"></li>\
                        <li class="checkCode">短信验证码：<input id="checkCode" type="text" value="" placeholder="请输入验证码" /></li>\
                        <li class="checkCodeErr"></li>\
                        <li class="cantUnbind"><b>&#xe609;</b>手机号与登录账号绑定后暂时无法解绑哦~如有疑问可联系考拉客服：<br>400-088-8188</li>\
                    </ul>\
                </div>';
            return function (accountId) {
                _pro.phoneValidWin = PromptWin._$allocate({
                    message: _pro.__tplParse(phoneValidationBox, {"accountId": accountId}),
                    title: '绑定手机号领取',
                    width: 520,
                    clazz: 'commTipsPop commTipsPop-tip',
                    btntext: '提交',
                    btnType: 'custom',
                    onok: _pro.__submitPhoneValidation._$bind(this),
                    onclose: function () {
                        clearInterval(_pro.checkCodeTimer);
                    }
                })._$show();
            };
        })();

        _pro.__submitPhoneValidation = function (_event) {
            var win = _pro.phoneValidWin,
                self = this;
                
            if(!_pro.__validatePhoneNum()) return;
            clearInterval(_pro.checkCodeTimer);
            var $checkCode = $("#checkCode"),
                checkCodeVal = $checkCode._$val().trim(),
                phoneNumVal = $("#phoneNum")._$val().trim();
            if(checkCodeVal == "") {
                $(".checkCodeErr")._$html("<i>&#xe606;</i>" + "验证码不能为空！");
                return false;
            }
            _j._$request('/personal/phone/verify.html', {
                method: 'post',
                headers:{"X-Requested-With":'XMLHttpRequest'},
                data: _ut._$object2query({
                    schemeId: _pro.currentSchemeId,
                    phoneNum: phoneNumVal,
                    code: checkCodeVal
                }),
                type: 'json',
                onload: function (json) {
                    if(json.retcode == 445) {
                        var retdesc = json.retdesc || "未知错误";
                        if(retdesc.indexOf("手机") != -1) {
                            $(".phoneNumErr")._$html("<i>&#xe606;</i>" + retdesc);
                        } else {
                            $(".checkCodeErr")._$html("<i>&#xe606;</i>" + retdesc);
                        }
                    } else if(json.retcode == 200) {
                        var coupon = json.coupon || {"couponScheme": {"schemeName": "优惠券"}};
                        var couponScheme = coupon.couponScheme || {"schemeName": "优惠券"};
                        win._$hide();
                        setTimeout(function () {
                            self.__exchangeSuccess(couponScheme.schemeName);
                        }, 200);
                    } else {
                        win._$hide();
                        setTimeout(function () {
                            self.__exchangeFail(json.retdesc || '您可能已经领取过该优惠券了');
                        }, 200);
                    }
                },
                onerror: function () {
                    win._$hide();
                    setTimeout(function () {
                        var win = PromptWin._$allocate({
                            clazz: 'commTipsPop',
                            width: 520,
                            message: '<div class="staDialogStyle"><i class="alert">&#xe609;</i>领取失败，请您刷新页面重试！</div>'
                        })._$show();
                        setTimeout(function () {
                            win._$hide();
                        }, 3000);
                    }, 200);
                }
            });
        };

        //优惠券兑换失败弹窗
        _pro.__exchangeFail = (function () {
            var exchangeFail =
                '<div class="prompt">\
                    <ul>\
                        <li class="icon alert"><i>&#xe609;</i>啊哦！肿么回事！优惠券领取失败啦...</li>\
                        <li class="failReason">出错原因：{failReason}</li>\
                    </ul>\
                </div>';
            
            return function (failReason) {
                
                // 失败回调
                this._$dispatchEvent('cbexchangefail', failReason);

                PromptWin._$allocate({
                    message: _pro.__tplParse(exchangeFail, {"failReason": failReason}),
                    title: '提示',
                    width: 520,
                    clazz: 'commTipsPop',
                    btntext: '确定'
                })._$show();
            };
        })();

        //获得优惠券弹窗
        _pro.__exchangeSuccess = (function () {
            var exchangeSuccess =
                '<div class="prompt promptSuccess">\
                  <ul>\
                    <li class="icon success"><i>&#xe612;</i>恭喜您！领取成功！</li>\
                    <li>\
                      <a href="/personal/my_coupon.html" target="_blank" class="seeMyCoupon">查看我的优惠券</a>\
                    </li>\
                  </ul>\
                </div>';
            return function (couponName) {
                
                // 成功回调
                this._$dispatchEvent('cbexchangesuccess', _pro.currentCouponId);

                PromptWin._$allocate({
                    message: _pro.__tplParse(exchangeSuccess, {"couponName": couponName}),
                    title: '提示',
                    width: 520,
                    clazz: 'commTipsPop',
                    btntext: '确定'
                })._$show();
            };
        })();

        _pro.__tplParse = function (template, data, regexp) {
            if(!(Object.prototype.toString.call(data) === "[object Array]")) {
                data = [data]
            }
            var ret = [];
            for(var i = 0, j = data.length; i < j; i++) {
                ret.push(replaceAction(data[i]));
            }
            return ret.join("");
            function replaceAction(object) {
                return template.replace(regexp || (/\\?\{([^}]+)\}/g), function (match, name) {
                    if(match.charAt(0) == '\\')
                        return match.slice(1);
                    return (object[name] != undefined) ? object[name] : '';
                });
            }
        };

        _pro.__extendTool = function () {
            //isIE678, 来源：easeCore.js
            $.isIE678 = "\v" == "v";
            if($.isIE678) {
                $.isIE8 = !!'1'[0];
                $.isIE6 = !$.isIE8 && (!document.documentMode || document.compatMode == "BackCompat");
                $.isIE7 = !$.isIE8 && !$.isIE6
            }
        };

        return _p._$$ActivSlide;
    },1,2,15,3,23,4,7,8,115,25,14,258);
I$(40,function (_k,_ut,_,_v,_t,_e,$,_j,_p,_o,_f,_r,_pro) {
        var _pro;

        _p._$$CountDown = _k._$klass();
        _pro = _p._$$CountDown._$extend(_t._$$EventTarget);

        _pro.__init = function(_options) {
            this.__supInit(_options);
            this.__startTimer();
        };

        _pro.__startTimer = function(){
            this.__timeArr = [];
            $('.js-countdown')._$forEach(this.__setCountTimer._$bind(this));
        };

        _pro.__setCountTimer = function(counter,i){
            var timeNodes,endTime,systemTime,loadTime,delta,timer;
            counter = $(counter);
            endTime = parseFloat(counter._$attr('data-endTime'));
            systemTime = parseFloat(counter._$attr('data-serverTime'));
            if(!endTime || !systemTime || endTime <= systemTime){
                return;
            }
            timeNodes = counter._$children('.js-time');
            loadTime = +new Date();
            delta = systemTime - loadTime;

            function update(){
                var now =  (+new Date())+delta, timeArr,timeLeft = 0;
                if(endTime > now){
                    timeLeft = endTime - now;
                }else{
                    location.reload();
                }

                timeArr = _.millisecond2LeftTime(timeLeft, false);
                _ut._$forEach(timeArr,function(val,i){
                    $(timeNodes[i])._$text(val=='00'?'0':val);
                });
            }
            timer = setInterval(update, 500);
            this.__timeArr.push(timer);
            update();
        };
        /**
         * åˆ·æ–°å€’è®¡æ—¶æ¨¡å—çš„æ•°æ®ï¼Œé‡æ–°è®¡ç®—æ—¶é—´
         */
        _pro._$refresh = function(){
            _ut._$forEach(this.__timeArr,function(time){
                window.clearInterval(time);
            });
            this.__startTimer();
        };

        return _p._$$CountDown;
    },1,2,15,3,23,4,25,14);
I$(252,".#<uispace> .m-phonecheck{padding:18px 40px;max-width:450px;}\n.#<uispace> .m-phonecheck .cntbox{padding:0 0 10px 20px;}\n.#<uispace> .m-phonecheck .u-ipt{padding-left:8px;width:242px;height:34px;line-height:34px;\n\tfont-size:14px;border:1px solid #D5D5D5;}\n.#<uispace> .m-phonecheck .remind{margin:5px 0;min-height:10px;line-height:20px;font-size:14px;color:#D22147;}\n.#<uispace> .m-phonecheck .u-checkbtn{display:inline-block;margin-left:18px;text-align:center;width:130px;height:34px;line-height:34px;\n\tborder:1px solid #F3F3F3;cursor:pointer;text-decoration:none;font-size:16px;color:#666;}\n.#<uispace> .m-phonecheck .u-checkbtn:hover{color:#fff;background:#D22147;}\n.#<uispace> .m-phonecheck .u-checkbtn-1{background-color:#C1C1C1;color:#fff;border-color:#C1C1C1;cursor:not-allowed;}\n.#<uispace> .m-phonecheck .u-checkbtn-1:hover{background-color:#C1C1C1;}\n.#<uispace> .m-phonecheck .btnbox{text-align:center;}\n.#<uispace> .m-phonecheck .u-btn{display:inline-block;width:120px;height:40px;line-height:40px;background:#D22147;cursor:pointer;text-decoration:none;color:#fff;font-size:18px;}\n.#<uispace> .m-phonecheck .text{margin:20px 20px;line-height:24px;font-size:14px;text-align:left;color:#333;}\n.#<uispace> .m-phonecheck .u-link{margin-left:10px;font-size:14px;}\n.#<uispace> .m-phonecheck .alarm{padding:10px 20px 20px;height:18px;line-height:18px;color:#999;font-size:12px;}\n.#<uispace> .m-phonecheck .alarm .icon{display:inline-block;width:16px;height:16px;background:url(http://mm.bst.126.net/images/index/icon1.png) no-repeat -5px -350px;}");
I$(253,"<textarea name=\"txt\" id=\"#<seedTxt>\">\n\t<div>\n\t\t<div class=\"m-phonecheck\">\n\t\t\t<div class=\"j-flag\">\n\n\t\t\t</div>\n\t\t\t<div class=\"cntbox\">\n\t\t\t\t<div class=\"f-cb\">\n\t\t\t\t\t<input type=\"text\" placeholder=\"è¯·è¾“å…¥æ‰‹æœºå·\" class=\"u-ipt f-fl j-flag\">\n\t\t\t\t\t<a class=\"u-checkbtn f-fl j-flag\">èŽ·å–éªŒè¯ç </a>\n\t\t\t\t</div>\n\t\t\t\t<p class=\"remind\"><span class=\"f-dn j-flag\">è¯·å¡«å†™æ­£ç¡®çš„æ‰‹æœºå·ç ï¼</span></p>\n\t\t\t\t<div>\n\t\t\t\t\t<input type=\"text\" placeholder=\"è¯·è¾“å…¥æ­£ç¡®çš„éªŒè¯ç \" class=\"u-ipt j-flag\">\n\t\t\t\t</div>\n\t\t\t\t<p class=\"remind\"><span class=\"f-dn j-flag\">è¯·è¾“å…¥éªŒè¯ç ï¼</span></p>\n\t\t\t</div>\n\t\t\t<div class=\"btnbox\">\n\t\t\t\t<a class=\"u-btn j-flag\">æäº¤</a>\n\t\t\t\t<a class=\"u-link f-dn j-flag\" href=\"/\">åŽ»é¦–é¡µ&gt;</a>\n\t\t\t</div>\n\t\t\t<div class=\"alarm j-flag f-dn\">\n\t\t\t\t<p><span class=\"icon\">&nbsp;</span>ç»‘å®šåŽä¸å¯è§£ç»‘ä¸”3ä¸ªæœˆå†…ä¸å¯æ›´æ¢ï¼Œ3ä¸ªæœˆåŽå¯åœ¨ä¸ªäººä¸­å¿ƒæ›´æ¢ç»‘å®šå…¶ä»–æ‰‹æœºã€‚æœ‰ç–‘é—®è¯·è”ç³»è€ƒæ‹‰å®¢æœï¼š400-088-8188</p>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</textarea>\n<textarea name=\"jst\" id=\"#<seedMessage>\">\n\t<p class=\"text\">${message}</p>\n</textarea>");
I$(27,function (Window, _e,_v,_css, _html,_e1,_e2,_p, _o, _f, _r,_pro) {
	
	var _seed_css = _e._$pushCSSText(_css),
        _seed_ui = _e1._$parseUITemplate(_html),
        _seed_txt = _seed_ui['seedTxt'],
        _seed_message = _seed_ui['seedMessage'],
	    _seed_html = _e1._$addNodeTemplate(_e1._$getTextTemplate(_seed_txt));
	
    _p._$$PhoneCheckWindow = NEJ.C();
    _pro = _p._$$PhoneCheckWindow._$extend(Window);

    _pro.__reset = function(_options) {
    	_options.title= _options.title || 'ç»‘å®šæ‰‹æœºå·é¢†å–';
        this.__super(_options);
        // åˆ¤æ–­æ˜¯å¦éœ€è¦æ˜¾ç¤ºæ‰‹æœºç»‘å®šè¯´æ˜Ž
        if(!!_options.title){
            _e2._$render(this.__textbox, _seed_message, {message: _options.text});
        }
        // åˆ¤æ–­æ˜¯å¦éœ€è¦æ˜¾ç¤ºâ€œåŽ»é¦–é¡µâ€æŒ‰é’®
        if(!!_options.showLinkBtn){
            _e._$delClassName(this.__linkBtn, 'f-dn');
        }
        // åˆ¤æ–­æ˜¯å¦éœ€è¦åº•éƒ¨çš„ç»‘å®šæç¤º
        if(!!_options.showbtAlarm){
            _e._$delClassName(this.__alarmBox, 'f-dn');
        }
    };
    _pro.__destroy = function(_options) {
        this.__super(_options);
    };

    _pro.__initXGui = function() {
        this.__seed_css = _seed_css;
        this.__seed_html = _seed_html
    };

    _pro.__initNode = function() {
        this.__super();
        var _list = _e._$getByClassName(this.__body,'j-flag');
        this.__textbox = _list[0];
        this.__phoneipt = _list[1];
        this.__checkbtn = _list[2];
        this.__remindnum = _list[3];
        this.__checkipt = _list[4];
        this.__remindcode = _list[5];
        this.__submitbtn = _list[6];
        this.__linkBtn = _list[7];
        this.__alarmBox = _list[8];
        _v._$addEvent(this.__checkbtn, 'click', this.__onCheckBtnClick._$bind(this));
        _v._$addEvent(this.__submitbtn, 'click', this.__onSubmitBtnClick._$bind(this));
        _v._$addEvent(this.__phoneipt, 'focus', this.__onPhoneIptFocus._$bind(this));
        _v._$addEvent(this.__checkipt, 'focus', this.__onCheckIptFocus._$bind(this));
    };

    _pro.__onCheckBtnClick = function(){
        var phoneNum = this.__phoneipt.value.trim();
        if(this.__checkPhone(phoneNum)){
            _e._$addClassName(this.__remindnum, 'f-dn');
            // æŠ›å‡ºç‚¹å‡»å‘é€éªŒè¯ç äº‹ä»¶
            if(!this.isSending){
                this._$dispatchEvent('oncheckcode', phoneNum);
            }

        }else{
            this.__remindnum.innerText = 'è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·ç ï¼';
            _e._$delClassName(this.__remindnum, 'f-dn');
        }
    };

    // å…³é—­éªŒè¯ç å‘é€å…¥å£ 
    _pro._$closeCheckCode = function(){
        if(!this.time){
            // 60såŽæ‰èƒ½å†æ¬¡å‘é€
            _e._$addClassName(this.__checkbtn, 'u-checkbtn-1');
            this.isSending = true;
            this.time = 59;
            this.timer = window.setInterval(function(){
                this.__onShowLefTime(this.time);
            }._$bind(this),1000);
        }
    }

    _pro.__onShowLefTime = function(i){
        if(i>=10){
            this.__checkbtn.innerText = 'å†æ¬¡å‘é€(' + i + ')';
        }else{
            this.__checkbtn.innerText = 'å†æ¬¡å‘é€(0' + i + ')';
        }
        this.time = i - 1;
        if(this.time < 0){
            window.clearInterval(this.timer);
            _e._$delClassName(this.__checkbtn,'u-checkbtn-1');
            this.__checkbtn.innerText = 'å†æ¬¡å‘é€';
            this.isSending = false;
            // ç»“æŸæ—¶é—´ç½®0
            this.time = 0;
        }
    };

    _pro.__onSubmitBtnClick = function(){
        var phoneNum = this.__phoneipt.value.trim(),
            code = this.__checkipt.value.trim();
        if(this.__checkPhone(phoneNum) && this.__checkCode(code)){
            _e._$addClassName(this.__remindnum, 'f-dn');
            _e._$addClassName(this.__remindcode, 'f-dn');
            // æŠ›å‡ºç‚¹å‡»æäº¤äº‹ä»¶
            this._$dispatchEvent('onsubmit', phoneNum, code);
        }else{
            if(!this.__checkPhone(phoneNum)){
                _e._$delClassName(this.__remindnum, 'f-dn');
            }
            if(!this.__checkCode(code)){
                _e._$delClassName(this.__remindcode, 'f-dn');
            }
        }
    };

    _pro.__onPhoneIptFocus = function(){
        _e._$addClassName(this.__remindnum, 'f-dn');
    };

    _pro.__onCheckIptFocus = function(){
        _e._$addClassName(this.__remindcode, 'f-dn');
    };

    // æ‰‹æœºå·æ£€æŸ¥
    _pro.__checkPhone = function(phonenum){
        return /0?(13|14|15|17|18)[0-9]{9}/.test(phonenum) ? true : false;
    };
    // 验证码检查
    _pro.__checkCode = function(code){
        return !!code ? true : false;
    };
    // 手机和验证码错误提示
    // obj.type  code|phonenum 表示错误字段
    // obj.message  表示错误提示文案
    _pro._$showError = function(obj){
        if(!!obj && !!obj.type && obj.type == 'code'){
            this.__remindcode.innerText = obj.message || '请输入正确的验证码！';
            _e._$addClassName(this.__remindnum, 'f-dn');
            _e._$delClassName(this.__remindcode, 'f-dn');
        }else if(!!obj && !!obj.type && obj.type == 'phonenum'){
            this.__remindnum.innerText = obj.message || '请输入正确的手机号码！';
            _e._$delClassName(this.__remindnum, 'f-dn');
            _e._$addClassName(this.__remindcode, 'f-dn');
        }
    };
    
    return _p._$$PhoneCheckWindow;
},229,4,3,252,253,233,239);
I$(464,"{#if hasTimeline}\n  <date-timeline timelineData=\"{timelineData}\" on-goodsChange=\"{this._$goodsChange($event)}\" kaolaSystemTime=\"{kaolaSystemTime}\"></date-timeline>\n{/if}\n\n<!-- 商品列表 -->\n<section class=\"m-seckillGoodsList {typeClass} {typeExraClass}\">\n  <div class=\"goodsListWrap clearfix\">\n    {#list goodsList as goods}\n    <!-- goods.status //0'未开始',1'进行中',2'已结束',3'已开抢',4'距离开始不到15分钟',5'已抢光' -->\n    <!-- 一排一 -->\n    <div class=\"goodsw clearfix\">\n      <a class=\"goodsimg\" href=\"/product/{goods.goodsId}.html\" title=\"{goods.title}\" target=\"_blank\">\n        {#if !!goods.lazyreload}\n        <img class=\"img-lazyload\"\n             src=\"{__cdnBaseUrl}images/blank.gif\"\n             lazyload=\"{goods.imageUrl|imgThumbnailUrl:imgWidth,imgHeight}\"\n             data-src=\"{goods.imageUrl|imgThumbnailUrl:imgWidth,imgHeight}\"\n             alt=\"{goods.title}\">\n        {#else}\n        <img src=\"{goods.imageUrl|imgThumbnailUrl:imgWidth,imgHeight}\" alt=\"{goods.title}\">\n        {/if}\n        <span class=\"m-sqarricon\">\n          <p>限量<br>{goods.limitGoodsStore||0}件</p>\n          <i></i>\n        </span>\n        {#if goods.status == 5}<span class=\"w-icon w-icon-13\">&nbsp;</span>{/if}\n        {#if goods.status == 2}<span class=\"w-icon w-icon-over\">&nbsp;</span>{/if}\n        {#if !!goods.skuList && goods.skuList.length > 1} <!-- 多sku标识 -->\n          <span class=\"u-multiicon\">&nbsp;</span>\n        {/if}\n      </a>\n\n      <div class=\"goodsinfo\">\n        <a class=\"tit\" href=\"/product/{goods.goodsId}.html\" title=\"{goods.title}\" target=\"_blank\" r-html=\"{goods.titleHtml||goods.title}\"></a>\n        {#if showType == 1}\n        <a class=\"subtit\" href=\"/product/{goods.goodsId}.html\" title=\"{goods.desc}\" target=\"_blank\">{goods.desc}</a>\n        {#elseif showType == 2}\n        <a class=\"subtit f-ellipsis\" href=\"/product/{goods.goodsId}.html\" title=\"{goods.introduce}\" target=\"_blank\">{goods.introduce}</a>\n        {/if}\n\n        <!-- 一排一+无时间轴+未开始或不到15分钟 -->\n        {#if !hasTimeline && showType == 1 && (goods.status == 0 || goods.status == 4)}\n          <span class=\"sectime\">{goods.noTimelineTimeShow.str}</span>\n        {/if}\n        <div class=\"statusw\">\n          <span class=\"pricetit\">秒杀价：</span>\n          <span class=\"seckillprice\">￥<em>{goods.seckillPrice}</em></span>\n          <span class=\"marketprice\">￥<del>{goods.marketPrice}</del></span>\n          {#if goods.status == 0}<!-- 0未开始 -->\n            {#if hasTimeline || showType == 1}\n            <a class=\"smsnotice f-trans j-activityTplSmsNotice\"\n               on-click=\"{this.__onSmsNotice(goods.startTimeShow, goods)}\">开抢提醒</a>\n            {#else} <!-- 无时间轴+非一排一 -->\n            <a class=\"smsnotice z-notimeline f-trans j-activityTplSmsNotice\"\n               on-click=\"{this.__onSmsNotice(goods.startTimeShow, goods)}\">\n              <i class=\"s1\">{goods.noTimelineTimeShow.month}{#if showType==5}<br/>{/if}{goods.noTimelineTimeShow.time}开始秒杀</i>\n              <i class=\"s2\">开抢提醒</i>\n            </a>\n            {/if}\n          {#elseif goods.status == 4}<!-- 4距离开始不到15分钟 -->\n            {#if hasTimeline || showType == 1}\n              <span class=\"about2seckill\">即将秒杀...</span>\n            {#else} <!-- 无时间轴+非一排一 -->\n              <span class=\"about2seckill z-notimeline\">\n                <i class=\"s1\">{goods.noTimelineTimeShow.str}</i>\n                <i class=\"s2\">即将秒杀..</i>\n              </span>\n            {/if}\n          {#elseif goods.status == 1 || goods.status == 3}<!-- 1进行中 3已开抢 -->\n          <a class=\"buyimd f-trans\"\n             href=\"/product/{goods.goodsId}.html\"\n             target=\"_blank\"\n             title=\"马上去抢\"\n            >马上去抢</a>\n          {#elseif goods.status == 2 || goods.status == 5}<!-- 2已结束 or 5已抢光 -->\n            <a class=\"original2buy f-trans\"\n               href=\"/product/{goods.goodsId}.html\"\n               target=\"_blank\"\n               title=\"原价商品仍有优惠哦~\"\n              >原价商品仍有优惠哦~</a>\n          {/if}\n        </div>\n      </div>\n    </div>\n    {/list}\n  </div>\n</section>");
I$(594,"<div class=\"m-smsnotice\">\n  <div r-hide=\"{!!successDialog || !!errorDialog}\">\n    <div class=\"m-smsnotice-msg\" r-html=\"{msg}\"></div>\n    <div class=\"m-smsnotice-number\">\n      <label>\n        <input class=\"m-smsnotice-numberCheck\" type=\"checkbox\" r-model=\"{phoneCheck}\" {#if !appCheck}disabled{/if} />\n        <span class=\"m-smsnotice-title\">手机号码：</span>\n      </label>\n      <input class=\"m-smsnotice-phoneNumber\" type=\"text\" placeholder=\"请输入手机号\"\n             r-model=\"{phoneNumber}\" maxlength=11 autocomplete=\"off\"\n             on-focus=\"{this.__phoneNumFocus()}\" on-blur=\"{this.__phoneNumBlur()}\"/>\n\n      <div class=\"m-smsnotice-error\">{errMsg}</div>\n    </div>\n    <div class=\"m-smsnotice-app\">\n      <label>\n        <input class=\"m-smsnotice-appReceive\" type=\"checkbox\" r-model=\"{appCheck}\" {#if !phoneCheck}disabled{/if} />\n        <span class=\"m-smsnotice-title\">考拉客户端接收提醒</span>\n        <br>\n        <span class=\"m-smsnotice-appmsg\">没安装立即扫描二维码下载吧！下载后请登录设置提醒的账号</span>\n      </label>\n\n      <div class=\"m-smsnotice-qrcode\">\n        <img src=\"//mm.bst.126.net/images/index/2dcode-app.jpg\" alt=\"手机版考拉客户端二维码\">\n      </div>\n      <i class=\"m-smsnotice-qrcodearr\"></i>\n    </div>\n  </div>\n\n  <!-- 成功窗口 -->\n  <div class=\"m-smsnotice-success\" r-hide=\"{!successDialog}\">\n    <div class=\"title\"><i class=\"ft\" r-html=\"{'&#xe612;'}\"></i>设置成功!</div>\n    <div class=\"msg\">\n      考拉将在开抢前通过<em class=\"red\">免费短信或考拉app</em>通知您\n      <br>\n      （<em>{counter}</em>秒后自动关闭）\n    </div>\n  </div>\n\n  <!-- 失败窗口 -->\n  <div class=\"m-smsnotice-failure\" r-hide=\"{!errorDialog}\">\n    <div class=\"title\"><i class=\"ft\" r-html=\"{'&#xe604;'}\"></i>设置失败!</div>\n    <div class=\"msg\">因为网络等原因，设置失败。请重试。</div>\n  </div>\n\n  <!-- 短信提醒确认 -->\n  <div class=\"m-smsnotice-confirm\" r-hide=\"{!!successDialog || !!errorDialog}\">\n    <span class=\"m-smsnotice-error\">{errMsg2}</span>\n    <span class=\"m-smsnotice-confirmBtn\" on-click=\"{this.__confirm()}\">确定</span>\n    <span class=\"m-smsnotice-cancelBtn\" on-click=\"{this.__hide()}\">取消</span>\n  </div>\n\n  <!-- 失败确认 -->\n  <div class=\"m-smsnotice-confirm\" r-hide=\"{!errorDialog}\" on-click=\"{this.__hide()}\">\n    <span class=\"m-smsnotice-confirmBtn\">确认</span>\n  </div>\n</div>");
I$(465,function (_k, _ut, _, _ck, _v, _t, _e, Modal, tpl, $, _j, _p, _o, _f, _r, _pro) {

        /**
         * 使用：
         *
         * `````````
         * var notice = SmsNotice._$allocate({
         *      msg: "该商品将于*4月1日 12:00*开始秒抢，我们将在开抢前通过手机发送通知提醒您。",
         *      confirm: function (params) {
         *          params.goodsId = goodsId;
         *          _j._$request('/product/seckill/notify.html', {
         *              method: 'GET',
         *              query: params,
         *              type: 'json',
         *              onload: function (json) {
         *                  if(json && json.code == 0) {
         *                      notice._$successDialog();
         *                      return;
         *                  }
         *                  notice._$errorDialog();
         *              },
         *              onerror: function () {
         *                  notice._$errorDialog();
         *              }
         *          });
         *      },
         *      //登录成功后，刷新头部工具栏
         *      refreshTopbar: function () {
         *          //登录成功后回调
         *          self.$emit("cbloginOk");
         *      }
         *  })._$show();
         *
         * `````````
         *
         * 参数：
         * msg：字符串中**之间的文本会置为红色
         * confirm：短信通知弹窗中，用户点击确定键，数据校验通过之后，触发的回调
         *          - confirm中的参数params:{phoneNum：短信通知手机号, appNotification：考拉客户端是否接收提醒}
         *          - confirm中的参数params中的2参数至少必填一项
         * refreshTopbar：登录成功后，通过回调方法，刷新头部工具栏（需要调用组件的模块实现这个逻辑，因为topbar实例化多次会有问题）
         *
         * 方法：
         * _$successDialog()：展示成功弹出框
         * _$errorDialog()：展示失败弹出框
         * _$hide()：销毁弹出层
         *
         *
         */

        var PHONE_REG = /(^1[3|4|5|7|8|]\d{9}$)|(^1[3|4|5|7|8|][0-9]{1}[*]{4}[0-9]{4}$)/;

        var SmsNoticeModal = Modal.extend({
            content: tpl,
            data: {title: "开抢提醒", width: 520},
            init: function (data) {
                var self = this;
                self.supr();

                //数据初始化
                self.__initDate();

                //绑定事件
                self.$on("success", function () {
                    self.__successDialog();
                });
                self.$on("error", function () {
                    self.__errorDialog();
                });
                self.$on("hide", function () {
                    self.__hide();
                });
            },
            __initDate: function () {
                var self = this, data = self.data;
                data.title = data.title || "开抢提醒";

                //该商品将于*明天12:10*开始秒抢，我们将在开抢前通过手机发送通知提醒您。
                // -「明天12:10」红色
                data.msg = data.msg || '我们将在开抢前通过手机发送通知提醒您。';
                var msgs = data.msg.split('*');
                if(msgs.length % 2 == 1 || msgs.length > 1) {
                    data.msg = '';
                    _ut._$forEach(msgs, function (str, idx) {
                        data.msg += (idx % 2 == 1 ? "<em>" + str + "</em>" : str);
                    });
                }

                self.__initPhoneNumber();

                data.phoneCheck = data.phoneCheck || true;
                data.appCheck = data.appCheck || true;

                data.errorDialog = false;
                data.successDialog = false;

                self.$update();
            },
            //销毁弹窗
            __hide: function () {
                if(!!this.$refs && !!this.$refs['modal']) {
                    this.destroy();
                }
            },
            //通知请求成功
            __successDialog: function () {
                var self = this, data = self.data;
                data.successDialog = true;
                data.errorDialog = false;
                // 登记成功后保存号码到cookie
                if(!!data.phoneNumber && !!data.phoneCheck) {
                    _ck._$cookie('NTES_KAOLA_NUMREG', {
                        value: data.phoneNumber,
                        path: '/',
                        domain: '.kaola.com',
                        expires: 7
                    });
                }
                var i = 2, itv;
                data.counter = 3;
                itv = setInterval(function () {
                    if(i == -1) {
                        clearInterval(itv);
                        self.__hide();
                        return;
                    }
                    data.counter = i--;
                    self.$update();
                }, 1000);
                self.$update();
            },
            //通知请求失败
            __errorDialog: function () {
                var data = this.data;
                data.errorDialog = true;
                data.successDialog = false;
                this.$update();
            },
            //发起通知
            __confirm: function () {
                var self = this, data = self.data;
                var phoneCheck = data.phoneCheck,
                    appCheck = data.appCheck,
                    phoneNumber = data.phoneNumber,
                    params = {};
                if(!phoneCheck && !appCheck) {
                    return;
                }
                //验证手机号码
                if(!!phoneCheck) {
                    if(self.__checkPhoneNumber(phoneNumber)) {
                        params.phoneNum = phoneNumber;
                    } else {
                        return;
                    }
                }
                //考拉客户端接收提醒
                if(!!appCheck) {
                    params.appNotification = true;
                }
                //通知请求交给调用者
                self.$emit("sending", params);
            },
            //校验手机号码，成功true，失败false
            __checkPhoneNumber: function (num) {
                var ret, data = this.data;
                ret = num != '' && PHONE_REG.test(num);
                if(!ret) {
                    data.errMsg = num == '' ? "手机号不能为空" : "请填写正确的手机号码";
                } else {
                    data.errMsg = '';
                }
                return ret;
            },
            __phoneNumFocus: function () {
                this.data.errMsg = '';
            },
            __phoneNumBlur: function () {
                this.__checkPhoneNumber(this.data.phoneNumber || '');
            },
            //获取手机号码
            __initPhoneNumber: function () {
                var self = this, data = self.data;

                //首先尝试从cookies中取，没有取到再从线上取，cookies失效时间设定为1周
                var num = _ck._$cookie('NTES_KAOLA_NUMREG');
                if(num && self.__checkPhoneNumber(num)) {
                    data.phoneNumber = num;
                } else {
                    _j._$request('/getUserMobile.html', {
                        method: 'GET',
                        type: 'json',
                        onload: function (json) {
                            if(json && json.retcode == 200) {
                                num = json.result.userMobile;
                                if(self.__checkPhoneNumber(num)) {
                                    data.phoneNumber = num;
                                    self.$update();
                                    return;
                                }
                            }
                            data.phoneNumber = '';
                            self.$update();
                        },
                        onerror: function () {
                            data.phoneNumber = '';
                            self.$update();
                        }
                    });
                }
            }
        });

        _p._$$smsNoticeTpl = _k._$klass();
        _pro = _p._$$smsNoticeTpl._$extend(_t._$$EventTarget);

        _pro.__init = function (_options) {
            var self = this;
            self.__supInit(_options);
            self.__confirm = _options.confirm || function () {
                };
            self.__refreshTopbar = _options.refreshTopbar || function () {
                };
            self.__msg = _options.msg || '';
            self.__title = _options.title || '';
        };
        _pro._$show = function () {
            var self = this;
            //登录校验
            _.afterLogin(function () {
                self.__refreshTopbar();//登录成功后，刷新头部工具栏
                self._smsNotice = new SmsNoticeModal({
                    data: {
                        title: self.__title,
                        msg: self.__msg
                    }
                });
                self._smsNotice.$on("sending", self.__confirm);
            });
            return self;
        };
        _pro._$hide = function () {
            this._smsNotice.$emit("hide");
        };
        _pro._$successDialog = function () {
            this._smsNotice.$emit("success");
        };
        _pro._$errorDialog = function () {
            this._smsNotice.$emit("error");
        };
        return _p._$$smsNoticeTpl;

    },1,2,26,11,3,23,4,128,594,25,14);
I$(595,"<!-- 日期时间轴（1天1时间点 不显示） -->\n{#if hasTimeline && !day1time1}\n<div class=\"m-seckillTimeline\">\n\n  <!--日期轴-->\n  {#if dayNtimeN}\n  <div class=\"m-seckillTimelineDate\" style=\"background-color: {timeLineDateBgColor};\">\n    <ul class=\"{days.bigCls}\">\n      {#list days as day}\n      <!-- .z-act .z-last -->\n      <li class=\"{day.classAct} {day.classLast}\" style=\"width: {100/days.length}%;\"\n          on-click=\"{this.__dayClick($event, day_index)}\">\n        {day.seckillDate|format:'M月d日'}\n        <i></i>\n      </li>\n      {/list}\n    </ul>\n  </div>\n  {/if}\n\n  <!--时间轴-->\n  {#if !dayNtime1}\n  <!-- 多天多场次 -->\n  <div class=\"m-seckillTimelineTime\">\n    <ul class=\"{today.bigCls}\">\n      {#list today.seckillEventList as time}\n      <!-- .z-done .z-act .z-last -->\n      <li class=\"{time.classAct} {time.classLast} {time.classDone}\"\n          on-mouseenter=\"{this.__timeMouseenter($event)}\" on-mouseleave=\"{this.__timeMouseleave($event)}\"\n          on-click=\"{this.__timeClick($event, time_index)}\"\n          style=\"width: {time.width}px;border-right:1px solid {hoverTimeLineTimeBgColor};background:{timeLineTimeBgColor};\">\n        {time.startTime|format:'H:mm'}{time.statusStr}\n      </li>\n      {/list}\n    </ul>\n  </div>\n\n  <!-- 多天一个场次 -->\n  {#elseif dayNtime1}\n  <div class=\"m-seckillTimelineTime {mutiCls||''}\">\n    <ul class=\"{days.bigCls}\">\n      {#list days as day}\n        {#list day.seckillEventList as time}\n        <!-- .z-done .z-act .z-last -->\n        <li class=\"{day.classAct} {day.classLast} {time.classDone}\"\n            on-mouseenter=\"{this.__timeMouseenter($event)}\" on-mouseleave=\"{this.__timeMouseleave($event)}\"\n            on-click=\"{this.__dayClick($event, day_index)}\"\n            style=\"width: {day.width}px;border-right:1px solid {hoverTimeLineTimeBgColor};background:{timeLineTimeBgColor};\">\n          {time.datetime|format:'M月d日'}{#if !!dayNtime1N}<br>{time.startDatetime|format:'H:mm'}{/if}{time.statusStr}\n        </li>\n        {/list}\n      {/list}\n    </ul>\n  </div>\n  {/if}\n\n</div>\n{/if}\n");
I$(466,function (_k, _ut, _v, _t, _e, $, _j, tpl, BaseComponent, _p, _o, _f, _r, _pro) {

        /**
         *
         * 控件在「初始化完成」、「切换场次」之后，会触发goodsChange：self.$emit("goodsChange", data.seckillEvent);
         *
         * jira:http://jira6.hz.netease.com/browse/KJDS-7561
         *
         * 日期时间轴的 5 中情况：
         * 日期/时间均可以为1个可以为N个，对应有5种情况
         * 1、一个日期对应一个时间：不展示日期时间轴
         * 2、一个日期对应多个时间：只展示时间轴
         * 3、多个日期对应一个时间（时间相同）：日期时间轴合并，只展示时间轴
         * 4、多个日期对应一个时间（时间不同）：日期时间轴合并，只展示时间轴
         * 5、多个日期对应多个时间：日期时间轴均展示
         *
         *
         * 日期轴、时间轴，默认选中的规则：
         * 1、日期轴：
         * 默认为「今日」（根据系统时间）
         * 否则根据每日的「第一个场次」（时间点）的状态（已结束、已开始、进行中、未开始），优先选择：最后一个已开始、第一个未开始
         * 否则选中第一天
         * 2、时间轴：
         * 默认选中「进行中」的场次
         * 否则根据场次的状态（已结束、已开始、进行中、未开始），优先选择：最后一个已开始、第一个未开始
         *
         */

        return BaseComponent.extend({
            name: "date-timeline",
            template: tpl,
            config: function (data) {
                var self = this;
                data.config = data.timelineData.config;
                data.days = data.timelineData.days;

                //当前选中的 天
                data.today = {"seckillEventList": []};

                //当前展示时间点的 数据(包含商品列表)
                data.seckillEvent = {goodsList: []};

                //系统时间
                data.sysTime = new Date(parseInt(data.kaolaSystemTime || window.__kaolaSeckillServerTime || +new Date()));

                //获取日期时间对应关系 1天1时间点 -> N天N时间点 + 初始化日期轴数据
                self.__dealDate2Time();

                //设置参数
                var config = data.config;
                data.hasTimeline = (config.templateType || 1) == 1;//1有时间轴 2无时间轴
                data.timeLineDateBgColor = config.timeLineDateBgColor || "#fff";//时间轴日期背景色
                data.timeLineTimeBgColor = config.timeLineTimeBgColor || "#333";//时间轴时间点背景色
                data.hoverTimeLineTimeBgColor = config.hoverTimeLineTimeBgColor || "#262626";//时间轴时间点hover背景色

                //初始化时间轴数据
                self.__initTimelineData();

            },
            __initTimelineData: function () {
                var self = this, data = self.data, days = data.days;
                days.bigCls = days.length < 5 ? "z-big" : '';
                var tomorrow = self.__getTomorrow();
                //初始化全部场次数据
                _ut._$forEach(days, function (day, idx, list) {
                    var doingNum = 0,//正在进行中
                        hasDoingNum = 0,//已开抢
                        lastHasDoing = undefined,//最新的已开抢
                        firstNotBegin = undefined;//第一个未开始
                    day.bigCls = day.seckillEventList.length < 5 ? "z-big" : '';
                    _ut._$forEach(day.seckillEventList, function (time, idx2, times) {
                        time.statusStr = "";
                        time.classAct = "";
                        time.classLast = "";
                        //0:未开始，1进行中，2已结束，3已开抢
                        if(time.status == 0) {
                            time.statusStr = "开始秒杀";
                            if(!firstNotBegin) {
                                firstNotBegin = time;
                            }
                        } else if(time.status == 1) {
                            time.statusStr = "进行中";
                            doingNum++;
                            time.classAct = "z-act";
                        } else if(time.status == 2) {
                            time.statusStr = "已结束";
                            time.classDone = "z-done";
                        } else if(time.status == 3) {
                            time.statusStr = "已开抢";
                            hasDoingNum++;
                            lastHasDoing = time;
                        }
                        if(times.length == idx2 + 1) {
                            time.classLast = "z-last";
                            time.width = 1000 / day.seckillEventList.length;
                        }else{
                            time.width = 1000 / day.seckillEventList.length - 1;
                        }
                        time.datetime = day.seckillDate;
                        time.startTime = day.seckillDateStr + " " + time.startTime;
                        time.startDatetime = _ut._$var2date(time.startTime.replace(/-/g, '/'));//日期对象
                        time.endTime = day.seckillDateStr + " " + time.endTime;
                    });
                    //没有「进行中」的场次
                    if(doingNum == 0) {
                        //有「已开抢」的场次，则设置当前场次为「最新的已开抢」
                        if(hasDoingNum > 0){
                            lastHasDoing.classAct = "z-act";
                        }
                        //没有「已开抢」的场次，则设置「第一个未开始」
                        else if(!!firstNotBegin){
                            firstNotBegin.classAct = "z-act";
                        }
                        //如果也没有，说明今天的所有场次全都「已结束」
                        else {
                            //设最后一场次为当前场次
                            day.seckillEventList[day.seckillEventList.length - 1].classAct = "z-act";
                            //遍历到「今天」，如果今天不是最后一天，设明天的第一场为当前场次
                            if(day == data.today && !!tomorrow){
                                data.today.classAct = "";
                                tomorrow.classAct = "z-act";
                                data.today = tomorrow;
                            }
                        }
                    }
                });
                //初始化今日场次数据
                _ut._$forEach(data.today.seckillEventList, function (time, idx, times) {
                    if(time.classAct == "z-act"){
                        data.seckillEvent = time;
                    }
                });
                //初始化当前场次商品
                self.$root.$on("inject", function () {
                    //切换日期时间轴触发回调
                    self.$emit("goodsChange", data.seckillEvent);
                });
            },
            //返回「明天」，没有返回null
            __getTomorrow: function () {
                var self = this, data = self.data;
                var today = data.today,
                    days = data.days,
                    tomorrow = null, prepare = false;
                _ut._$forEach(days, function (day, idx) {
                    if(prepare){
                        prepare = false;
                        tomorrow = day;
                    }
                    if(day == today){
                        prepare = true;
                    }
                });
                return tomorrow;
            },
            __dealDate2Time: function () {
                var self = this, data = self.data, sysTime = data.sysTime, days = data.days, hasToday = false;
                //ã€Œå¤šå¤©ä¸€åœºæ¬¡ã€çš„æ•°æ®ç»Ÿè®¡
                var firstTime,
                    isDoing,//ç¬¬ä¸€ä¸ªåœºæ¬¡ä¸ºè¿›è¡Œä¸­çš„æœ€åŽä¸€å¤©ï¼Œå¯¹åº”çš„å¤©å¯¹è±¡
                    lastHasDoing,//ç¬¬ä¸€ä¸ªåœºæ¬¡ä¸ºå·²å¼€æŠ¢çš„æœ€åŽä¸€å¤©ï¼Œå¯¹åº”çš„å¤©å¯¹è±¡
                  firstNotBegin,//ç¬¬ä¸€ä¸ªåœºæ¬¡ä¸ºæœªå¼€å§‹ç¬¬ä¸€å¤©ï¼Œå¯¹åº”çš„å¤©å¯¹è±¡
                  firstTimeEveryDay = [];
                data.day1time1 = days.length == 1 && (days[0].seckillEventList || []).length == 1;
                data.day1timeN = days.length == 1 && (days[0].seckillEventList || []).length > 1;
                data.dayNtime1 = days.length > 1;
                data.dayNtimeN = days.length > 1;
                _ut._$forEach(days, function (day, idx, list) {
                    //ã€Œå¤šå¤©ä¸€åœºæ¬¡ã€çš„æ•°æ®ç»Ÿè®¡
                    firstTime = day.seckillEventList[0];
                    if(!!firstTime){
                        //0:æœªå¼€å§‹ï¼Œ1è¿›è¡Œä¸­ï¼Œ2å·²ç»“æŸï¼Œ3å·²å¼€æŠ¢
                        if(firstTime.status == 1){
                            isDoing = day;
                        } else if(firstTime.status == 3){
                            lastHasDoing = day;
                        }else if(firstTime.status == 0){
                            if(!firstNotBegin){
                                firstNotBegin = day;
                            }
                        }
                    }
                    //åˆ¤æ–­ã€Œå¤šå¤©ä¸€åœºæ¬¡ã€
                    if((day.seckillEventList || []).length > 1) {
                        data.dayNtime1 = false;
                    }
                    //æ¯ä¸€å¤©çš„ç¬¬ä¸€åœºæ¬¡çš„startTime
                    !!firstTime && firstTimeEveryDay.push(firstTime.startTime || '');
                    //è®¡ç®—æ˜¯å¦ä¸ºã€Œä»Šæ—¥ã€
                    day.seckillDateStr = day.seckillDate;//"2016-03-01"
                    var date = day.seckillDate = _ut._$var2date(day.seckillDateStr.replace(/-/g, '/'));//æ—¥æœŸå¯¹è±¡
                    var isToday = date.getFullYear() == sysTime.getFullYear() &&
                        date.getMonth() == sysTime.getMonth() &&
                        date.getDate() == sysTime.getDate();
                    day.classAct = isToday ? "z-act" : "";
                    if(isToday) {
                        data.today = day;//æ—¶é—´
                        hasToday = true;
                    }
                    //è®¡ç®—æœ€åŽä¸€å¤©
                    if(days.length == idx + 1) {
                        day.classLast = "z-last";
                        day.width = 1000 / days.length;//å½“ã€Œå¤šå¤©ä¸€åœºæ¬¡ã€çš„æ—¶å€™ä¼šç”¨åˆ°ï¼Œæ­¤æ—¶æ—¥æœŸè½´æ—¶é—´è½´åˆå¹¶
                    }else{
                        day.width = 1000 / days.length - 1;//å½“ã€Œå¤šå¤©ä¸€åœºæ¬¡ã€çš„æ—¶å€™ä¼šç”¨åˆ°ï¼Œæ­¤æ—¶æ—¥æœŸè½´æ—¶é—´è½´åˆå¹¶
                    }
                });
                //å¦‚æžœæ—¥æœŸåˆ—è¡¨ä¸­æ²¡æœ‰ã€Œä»Šæ—¥ã€ï¼Œé€šè¿‡æ¯å¤©çš„ç¬¬ä¸€åœºæ¬¡åˆ¤æ–­
                if(!hasToday) {
                    if(!!isDoing){
                        data.today = isDoing;
                    }
                    //å¦‚æžœæœ‰ç¬¬ä¸€åœºä¸ºã€Œå·²å¼€æŠ¢ã€
                    else if(!!lastHasDoing){
                        data.today = lastHasDoing;
                    }
                    //å¦‚æžœæœ‰ç¬¬ä¸€åœºä¸ºã€Œæœªå¼€å§‹ã€
                    else if(!!firstNotBegin){
                        data.today = firstNotBegin;
                    } else{
                        data.today = days[0];
                    }
                    data.today.classAct = "z-act";
                }
                //åˆ¤æ–­ã€Œå¤šå¤©å¤šåœºæ¬¡ã€
                if(data.dayNtime1) {
                    data.dayNtimeN = false;
                }
                //åŒºåˆ†ï¼š
                //å¤šä¸ªæ—¥æœŸå¯¹åº”ä¸€ä¸ªæ—¶é—´ï¼ˆæ—¶é—´ç›¸åŒï¼‰data.dayNtime1N == false;
                //å¤šä¸ªæ—¥æœŸå¯¹åº”ä¸€ä¸ªæ—¶é—´ï¼ˆæ—¶é—´ä¸åŒï¼‰data.dayNtime1N == true;
                if(!!data.dayNtime1) {
                    data.dayNtime1N = !self.__firstTimeEveryDayIsEq(firstTimeEveryDay);
                    if(data.dayNtime1N) {
                        data.mutiCls = 'z-muti';
                    }
                }
            },
            //æ˜¯å¦ï¼šæ¯ä¸€å¤©çš„ç¬¬ä¸€ä¸ªæ—¶é—´ç‚¹éƒ½ç›¸ç­‰
            __firstTimeEveryDayIsEq: function (firstTimeEveryDay) {
                if(firstTimeEveryDay.length == 0) return true;
                var tmpTime = firstTimeEveryDay[0], ret = true;
                _ut._$forEach(firstTimeEveryDay, function (time) {
                    if(tmpTime != time) {
                        ret = false;
                    }
                });
                return ret;
            },
            __timeMouseenter: function (e) {
                var elem = _v._$getElement(e), data = this.data;
                _e._$setStyle(elem, "background", data.hoverTimeLineTimeBgColor);
            },
            __timeMouseleave: function (e) {
                var elem = _v._$getElement(e), data = this.data;
                _e._$setStyle(elem, "background", data.timeLineTimeBgColor);
            },
            __timeClick: function (e, idx, fromDayClick) {
                var self = this, data = self.data;
                var times = data.today.seckillEventList,
                    newTime = times[idx];
                if((!newTime || newTime.classAct == "z-act") && !fromDayClick) return;
                _ut._$forEach(times, function (time) {
                    time.classAct = "";
                });
                newTime.classAct = "z-act";
                data.seckillEvent = newTime;
                self.$emit("goodsChange", newTime);
            },
            __dayClick: function (e, idx) {
                var self = this, data = self.data,
                    days = data.days,
                    newToday = days[idx];
                if(newToday == data.today) return;
                data.today.classAct = "";
                data.today = newToday;
                data.today.classAct = "z-act";
                _ut._$forEach(data.today.seckillEventList, function (time, idx) {
                    if(time.classAct == "z-act") {
                        self.__timeClick(null, idx, true);
                    }
                });
            },
            init: function (data) {
                var self = this;
            }
        }).use("timeout");

    },1,2,3,23,4,25,14,595,151);
I$(266,function (_k, _, _ut, _v, _t, _e, $, _j, tpl, BaseComponent, SmsNotice, _p, _o, _f, _r, _pro) {

        return BaseComponent.extend({
            template: tpl,
            config: function (data) {
                data.timelineData = {
                    days: data.days,
                    config: data.config
                };
                data.__cdnBaseUrl = window.__cdnBaseUrl || '/';
                data.hasTimeline = (data.config.templateType || 1) == 1;//1æœ‰æ—¶é—´è½´ 2æ— æ—¶é—´è½´
            },
            init: function (data) {
                var self = this;

                //ç³»ç»Ÿæ—¶é—´
                data.sysTime = new Date(parseInt(data.kaolaSystemTime || window.__kaolaSeckillServerTime || +new Date()));
                data.sysTimeMills = +data.sysTime;

                //å¤„ç†å•†å“æŽ’åˆ—æ ·å¼ï¼š1ä¸€æŽ’ä¸€ 2一排二 3一排三 4一排四 5一排五
                self.__dealGoodsClass();

                //无时间轴情况下，遍历&展示所有场次的所有商品
                if(!data.hasTimeline) {
                    self.__dealNoTimelineGoods(data.days);
                }
            },
            __dealNoTimelineGoods: function (days) {
                var goodsList = [], self = this, data = self.data;
                //遍历所有场次商品并初始化数据
                _ut._$forEach(days, function (day, idx) {
                    var seckillDate = day.seckillDate;
                    _ut._$forEach(day.seckillEventList, function (time, idx, timeList) {
                        //处理每个商品的数据
                        time.startTime = seckillDate + " " + time.startTime;
                        time.endTime = seckillDate + " " + time.endTime;
                        self._$goodsChange(time);
                        goodsList = goodsList.concat(time.goodsList || []);
                    });
                });
                data.goodsList = goodsList;
                self.$update();
                //console.log(data.goodsList);
            },
            //初始化样式
            __dealGoodsClass: function () {
                var self = this, data = self.data, config = data.config;
                var showType = config.showType = parseInt(config.showType || -1);
                data.showType = showType;
                //一排几
                data.typeClass = "secKillLineOf" + showType;
                data.typeExraClass = "";
                //图片宽度
                if(showType == 1){
                    data.imgWidth = 488;
                    data.imgHeiht = 300;
                }else if(showType == 2){
                    data.imgWidth = data.imgHeiht = 200;
                } else if(showType == 3 || showType == 4 || showType == 5){
                    data.imgWidth = data.imgHeiht = 328;
                    //一排345共用样式
                    data.typeExraClass = "secKillLineOf345";
                }
            },
            //初始化商品数据
            // 1、切换日期时间的回调函数
            // 2、无时间轴，初始化商品数据
            _$goodsChange: function (seckillEvent) {
                //console.log(seckillEvent);
                var self = this, data = self.data, config = data.config;
                data.status = seckillEvent.status;//0:未开始，1进行中，2已结束,3'已开抢'（还没结束的最近开抢场次之前的场次）
                data.startTime = seckillEvent.startTime.replace(/-/g, '/');//格式："2015-08-19 13:00:00"
                data.endTime = seckillEvent.endTime.replace(/-/g, '/');//"2015-08-19 13:00:00"

                var startTimeMills = +_ut._$var2date(data.startTime),
                    toStartMills = startTimeMills - data.sysTimeMills,
                    in15Min = toStartMills > 0 && toStartMills < 15 * 60 * 1000;

                //初始化待处理的商品
                _ut._$forEach(seckillEvent.goodsList, function (goods, idx, list) {
                    //每次都要执行

                    //只有第一次执行
                    if(!goods._prepared) {
                        goods._prepared = true;

                        //计算开始时间展示文案：13:00、明日13:00、2015年08月19日 13:00
                        goods.startTimeShow = self.__calcStartTimeShow(data.startTime);

                        //计算无时间轴展示的文案
                        goods.noTimelineTimeShow = self.__calcNoTimelineTimeShow(data.startTime);

                        //商品状态：
                        // - 0'未开始',1'进行中',2'已结束',3'已开抢'（还没结束的最近开抢场次之前的场次）
                        // - 前端逻辑判断，新增：4'距离开始不到15分钟',5'已抢光'(针对单个商品) 两个状态
                        goods.status = data.status;
                        if(goods.status == 0 && in15Min) {
                            goods.status = 4;
                        }
                        //limitGoodsStore限量xx件
                        goods.limitGoodsStore = parseInt(goods.limitGoodsStore) || 0;

                        //合并数据结构，方便取数据
                        _.extend(goods, goods.goods);

                        if(data.showType == 1) {
                            goods.imageUrl = goods.onePaiOneGoodsImg || goods.imageUrl;//一排一图片使用ms后台定制的，其他使用原有的商品图
                        }

                        //组合商品
                        if(typeof goods.memberCount == "number" && goods.memberCount > 0) {
                            goods.titleHtml = "<b>"+goods.memberCount + (goods.memberUnitName || '件') + "装</b>&nbsp;|&nbsp;" + goods.title;
                            goods.title = goods.memberCount + (goods.memberUnitName || '件') + "装 | " + goods.title;
                        }


                        //已结束/已抢光判断逻辑：
                        // 1.进行中/已开抢的场次，已抢光/已结束统一展示位已抢光
                        // 2.已结束的场次，已抢光/已结束统一展示位已结束
                        // 3.未开始的场次，不展示已抢光

                        //是否有货：1有 0无
                        if(!!goods.isSeckGoodsSoldOut) {
                            if(goods.status != 2 && goods.status != 0 && goods.status != 4) {//如果已结束或未开始，则不展示已抢光
                                goods.status = 5;
                            }
                        }

                        //进行中/已开抢的商品，也有可能已结束(根据商品的endTime)
                        //这种情况下的已结束，展示为已抢光
                        if(goods.status == 1 || goods.status == 3) {
                            if(!!goods.endTime &&
                                +_ut._$var2date(goods.endTime) < data.sysTimeMills) {
                                goods.status = 5;
                            }
                        }

                        //商品是否在前三行（不进行lazyload）
                        if(parseInt((idx + 1) / (config.showType || 1)) > 3) {
                            goods.lazyreload = true;
                        }
                    }

                });
                //有时间轴则绑定数据
                if(data.hasTimeline) {
                    data.goodsList = seckillEvent.goodsList;
                }
            },
            __calcNoTimelineTimeShow: function (startTime) {
                var start = _ut._$var2date(startTime),
                    ret = {
                        month: _ut._$format(start, "M月d日"),
                        time: _ut._$format(start, "HH:mm"),
                        str: _ut._$format(start, "M月d日 HH:mm") + "开始秒杀"
                    },
                    sysTime = this.data.sysTime;
                //今天
                if(start.getYear() == sysTime.getYear() &&
                    start.getMonth() == sysTime.getMonth() &&
                    start.getDate() == sysTime.getDate()) {
                    ret.month = _ut._$format(start, "今天");
                    ret.time = _ut._$format(start, "HH:mm");
                    ret.str = _ut._$format(start, "今天HH:mm") + "开始秒杀"
                }
                return ret;
            },
            //计算开始时间展示文案：13:00、明日13:00、2015年08月19日 13:00
            __calcStartTimeShow: function (startTime) {
                //startTime，格式："2015-08-19 13:00:00"
                var self = this, data = self.data,
                    start = _ut._$var2date(startTime),
                    startDate = start.getDate(),//19
                    startMills = +start,

                    now = data.sysTime,
                    nowDate = now.getDate(),
                    nowMills = +now,

                    _diffMills = startMills - nowMills,
                    _24hmills = 24 * 60 * 60 * 1000,
                    _48hmills = 48 * 60 * 60 * 1000,

                    tomorrow = new Date(nowMills + _24hmills),
                    tomorrowDate = tomorrow.getDate(),

                    show = '';

                function _2digit(num) {
                    return (num < 10 ? '0' : '') + num;
                }
                var hours = _2digit(start.getHours()),
                    minus = _2digit(start.getMinutes());

                //秒杀在当天
                if(_diffMills > 0 && _diffMills < _24hmills && nowDate == startDate) {
                    show = hours + ":" + minus;
                }
                //秒杀在明天
                else if(_diffMills > 0 && _diffMills < _48hmills && tomorrowDate == startDate) {
                    show = "明天" + hours + ":" + minus;
                } else {
                    show = _ut._$format(start, "yyyy年MM月dd日 HH:mm");
                }
                return show;
            },
            __onSmsNotice: function (startTimeShow, goods) {
                var self = this, data =self.data, startdate;
                var notice = SmsNotice._$allocate({
                    msg: "该商品将于*" + startTimeShow + "*开始秒抢，我们将在开抢前通过手机发送通知提醒您。",
                    confirm: function (params) {//params:{phoneNum:短信通知手机号,appNotification:考拉客户端是否接收提醒}
                        // 活动类型：秒杀、特卖（zone级别）
                        var zone = data.zone = data.zone || {};
                        var activityType = zone.activityType || -1, // 9-特卖，其他（包括不存在）-秒杀
                          isTemai = activityType == 9,
                          url = isTemai ? '/short/message/temai/temaiNotify.html' : '/short/message/seckill/notify.html'; // 特卖url、秒杀url
                        if(isTemai){ //特卖
                            params.price = goods.seckillPrice;
                            if(!!goods.startTime && typeof goods.startTime == 'number'){
                                startdate = new Date(parseInt(goods.startTime));
                                params.startTime = _ut._$format(startdate, 'yyyy-MM-dd HH:mm:ss');
                            }
                            params.tabId = zone.activitySchemeId || ''; //活动方案号
                        }
                        params.goodsId = goods.goodsId;
                        function isSuc(json, isTemai){
                            if(!json) return false;
                            return isTemai ? json.retcode == 200 : json.code == 0;
                        }
                        _j._$request(url, {
                            method: 'GET',
                            query: params,
                            headers:{"X-Requested-With":'XMLHttpRequest'},
                            type: 'json',
                            onload: function (json) {
                                if(isSuc(json, isTemai)) {
                                    notice._$successDialog();
                                    return;
                                }
                                notice._$errorDialog();
                            },
                            onerror: function () {
                                notice._$errorDialog();
                            }
                        });
                    },
                    //登录成功后，刷新头部工具栏
                    refreshTopbar: function () {
                        //登录成功后回调
                        self.$emit("cbloginOk");
                    }
                })._$show();
            }
        }).use('timeout');

    },1,15,2,3,23,4,25,14,464,151,465,466);
I$(46,function (_k, _ut, _v, _t, _e, $, _j, SeckillModule, _p, _o, _f, _r, _pro) {

        _p._$$seckillArea = _k._$klass();
        _pro = _p._$$seckillArea._$extend(_t._$$EventTarget);

        _pro.__init = function (_options) {
            var self = this;
            self.__supInit(_options);

            var seckillList = window.__kaolaSeckillModuleJsonList || [];
            for(var i = 0, l = seckillList.length, seckill; i < l; i++) {
                seckill = seckillList[i];
                //秒杀模板
                var module = new SeckillModule({
                    data: {
                        zone: seckill.json || {},
                        days: seckill.json.groupList || [],
                        config: seckill.config || {}
                    }
                });
                //商品加载触发回调
                module.$on("inject", function () {
                    _options.goodsChange();
                });
                //商品切换触发回调
                module.$on("goodsChange", function () {
                    _options.goodsChange();
                });
                //登录成功后回调
                module.$on("cbloginOk", function () {
                    _options.cbloginOk();
                });
                var area = document.getElementById(seckill.id);
                //清除模块loading效果
                area.innerHTML = "";
                //加载模块
                module.$inject(area);

            }

        };

        return _p._$$seckillArea;
    },1,2,3,23,4,25,14,266);
I$(467,"<div class=\"iDialogMain couponModal\">\n\t<div class=\"cnt\">\n\t    <div class=\"noticeText\">{#if hasGot}您已经领取了10元优惠券，依然可以喊好友领券哦{#else}分享我的2015，领取<b>10元优惠券</b>{/if}</div>\n\t    <div class=\"qrCodeWrap clearfix\">\n\t    \t<span ref=\"QRCode\" class=\"qrCode\"></span>\n\t    \t{#if hasGot}\n\t    \t<div class=\"hasGot\">扫码分享到微信</div>\n\t    \t{#else}\n\t    \t<div class=\"notGet\">\n\t    \t\t<p class=\"tit\">微信扫一扫</p>\n\t    \t\t<p>分享后，10元券</p>\n\t    \t\t<p>会自动派发到您的账户中</p>\n\t    \t\t<p><a class=\"myCoupon\" href=\"/personal/my_coupon.html\" target=\"_blank\">查看我的优惠券&nbsp;&gt;</a></p>\n\t    \t</div>\n\t    \t{/if}\n\t    </div>\n\t</div>\n\t<div class=\"btnbar f-tac\">\n\t  <a class=\"btn\" href=\"javascript:void(0)\" on-click={this.confirm()}>确认</a>\n\t</div>\n</div>");
I$(270,function (ut, e,v,ut1, Modal, tpl,Q){
	/**
	 * qrCode	二维码参数
	 */
	var CouponModal = Modal.extend({
	    content:tpl,
	    data:{title:'分享领10元券',width:520},
	    init:function(){
	    	this.supr();
	    	this.makeQRCode(this.$refs.QRCode,"http://m.kaola.com/newyear/timemachine.html?from=pcScan&QRCode="+(this.data.QRCode||""),120,120,'#000000','#ffffff');
	    },
	    config:function(){
	    	
	    },
	    confirm: function(){
	    	this.destroy();
	    },
	    makeQRCode: function(container,text,w,h,dark,light){
	      new QRCode(container, {
	          text: text,
	          width: w,
	          height: h,
	          colorDark : dark,
	          colorLight : light,
	          correctLevel : QRCode.CorrectLevel.H
	      });
	    }
	});

	// 绑定Modal
  	return CouponModal;
},15,4,3,2,128,467,20);
I$(461,function (_k,_ut,_v,_t,e,_t0,_p,_o,_f,_r,_pro) {
        var pro;

        _p._$$Marquee = _k._$klass();
        _pro = _p._$$Marquee._$extend(_t._$$EventTarget);

        /**
         * 首页逻辑模块初始化
         * @param  {Object} 配置参数
         * 			box		容器节点
         * 			duration	一次个动画的持续时间
         * 			interval	每个动画的时间间隔
         * 			offset		一次滚动的条数
         * 			isRegularjs	是否是regular组件，如果是的话，是通过组件来调整box里的数据，
         * 						如果不是regularjs组件，由控件完成数据的头插到尾的过程，无需外部观注
         * @return {Void}
         */
        _pro.__reset = function(options){
            this.__super(options);
            this.__box = options.box;
            this.__duration = options.duration||800;
            this.__interval = options.interval||3000;
            this.__offset = options.offset||1;
            var _children = e._$getChildren(this.__box);
            this.__children = [];
            for(var i=0,l=_children.length;i<l;i++){
                if(_children[i].nodeType==1){
                    this.__children.push(_children[i])
                }
            }
            this.__height = this.__children[0].clientHeight;
            this.__index = 0;
            this.__isRegularjs = options.isRegularjs;
            this.__initMarquee();
        };
        _pro.__initMarquee = function(){
            this.__timer = setInterval(this.__doMarquee._$bind(this),this.__interval)
        };
        _pro._$resetData = function(){
            if(this.__timer){
                clearInterval(this.__timer);
            }
            this.__initMarquee();
        };
        _pro.__doMarquee = function(preIndex,newIndex){
            this.__animation = _t0._$$AnimEaseIn._$allocate({
                from:{offset:0},
                to:{offset:1},
                duration:this.__duration,
                onupdate:function(event){

                    this.__box.style.top = -(this.__height * this.__offset*event.offset) +'px';
                }._$bind(this),
                onstop:function(){
                    if(!!this.__animation) this.__animation = this.__animation._$recycle();
                    if(this.__isRegularjs){
                        this._$dispatchEvent('onIntervalDataChange',this.__offset)
                    } else{
                        var list = this.__box.children;
                        for(var i=0,l=this.__offset;i<l;i++){
                            this.__box.appendChild(list[i]);
                        }
                    }
                    this.__box.style.top = 0 +'px';

                }._$bind(this)
            })
            this.__animation._$play();
        };
        return _p._$$Marquee;
    },1,2,3,23,4,234);
I$(504,"{#if total > 1}<ul class=\"m-pagination f-cb\" r-hide=\"!total\"><li on-click={ this.nav(current-1)} class='pageprv {current==1? \"disabled\": \"\"}'><a  href='javascript:void(0);' >上一页</a></li>{#if total - 5 > show * 2}<li  on-click={ this.nav(1)} class={current==1? 'active': ''}><a href='javascript:void(0);'>1</a></li>{#if begin > 2}<li><a>...</a></li>{/if}{#list begin..end as i}<li on-click={ this.nav(i)} class={current==i? 'active': ''}><a href='javascript:void(0);'>{i}</a></li>{/list}{#if (end < total-1)}<li><a>...</a></li>{/if}<li on-click={ this.nav(total)} class={current==total? 'active': ''}><a href='javascript:void(0);'>{total}</a></li>{#else}{#list 1..total as i}<li on-click={ this.nav(i)} class={current==i? 'active': ''}><a href='javascript:void(0);'>{i}</a></li>{/list}{/if}<li on-click={ this.nav(current + 1)} class='pagenxt {current==total? \"disabled\": \"\"}'><a  href='javascript:void(0);' >下一页</a></li></ul>{/if}\n\n");
I$(308,function (tpl, BaseComponent){

  // <pager total=3 current=1></pager>
  var Pager = BaseComponent.extend({
    name: "pager",
    template: tpl,
    // is called before compile. 一般用来处理数据
    config: function(data){
      var count =  5;
      var show = data.show = Math.floor( count/2 );
      data.current = parseInt(data.current || 1);
      data.total = parseInt(data.total || 1);

      this.$watch(['current', 'total'], function( current, total ){
        data.begin = current - show;
        data.end = current + show;
        if(data.begin < 2) data.begin = 2;
        if(data.end > data.total-1) data.end = data.total-1;
        if(current-data.begin <= 1) data.end = data.end + show + data.begin- current;
        if(data.end - current <= 1) data.begin = data.begin-show-current+ data.end;
      });
    },
    nav: function(page){
      var data = this.data;
      if(page < 1) return;
      if(page > data.total) return;
      if(page === data.current) return;
      data.current = page;
      this.$emit('nav', page);
    }
  });
  
  return Pager;

},504,151);
I$(268,function (_, _ut, BaseComponent) {

    // ###data
    //  - pager
    //    * total: 列表总数 
    //    * list : 列表数组
    // ###example
    // <div>
    //  {{#list list as item}}
    //     
    //  {{/item}}
    // </div>

    var ListComponent = BaseComponent.extend({
        // 配置链接
        // @子类必须提供
        // dwr: {beanName:'xxx',method:'yyy'},
        // 任意一个监听列表发生改变时，判断更新列表 
        // @子类修改
        watchedAttr: ['current'],
        config: function(data) {
            _.extend(data, {
                total: 1,
                current: 1,
                limit: 10,
                list: []
            });

            this.$watch(this.watchedAttr, function() {
                if (this.shouldUpdateList()) {
                    this.__getList();
                }
            })
        },
        init: function() {
            //if(!this.url) throw 'ListModule未指定url';

            // 需要自定义复杂的更新策略, $emit('updatelist')事件即可
            this.$on('updatelist', this.__getList.bind(this));

        },
        // @子类修改
        shouldUpdateList: function(data) {
            return true;
        },
        getExtraParam: function() {
            return this.data.condition;
        },
        refresh: function(_data) {
            this.data.current = 1;
            this.data.condition = _data;
            this.$emit('updatelist');
        },
        getListParam: function() {
            var data = this.data;
            return _.extend({
                limit: data.limit,
                offset: data.limit * (data.current - 1),
                lastId: data.lastId
            }, this.getExtraParam(data));
        },
        __bodyResolver: function(json) {
            var result = json.body,
                list = result.list || [];
            _.mergeList(list, this.data.list, this.data.key || 'id')

            this.data.total = result.total;
            this.data.list = list;
        },
        // update loading
        __getList: function() {
            var data = this.data;
            var option = {
                progress: true,
                data: this.getListParam(),
                onload: function(json) {
                    this.__bodyResolver(json);
                }._$bind(this),
                onerror: function(json) {
                    // @TODO: remove
                    var _handle = this.__errorHandler;
                    _handle && _handle(json);
                }
            };
            if (this.xdrOption) {
                _.extend(option, this.xdrOption);
            }
            if (option.norest && !_ut._$isString(option.data)) {
                option.data = _ut._$object2query(option.data);
            }
            if (option.method.toUpperCase() == 'GET') {
                option.query = option.data;
            }
            this.$request(this.url, option)
        }
    })


    return ListComponent;

},15,2,151,308);
I$(44,function (_,User,_u,UserInfo,_p,_o,_f,_r,_pro) {
        var g = {};
        /**
         * GTM 数据收集方法
         * @author hzmating 20160909
         * @param  {Object}
         * @return null
         */
        g.gtmCollect = function(obj){
            window.dataLayer = window.dataLayer || [];
            window.dataLayer.push(obj);
        };
        /**
         * GTM 方法触发器 默认触发'gtmReady'
         * @author hzmating 20160909
         * @param  {string}
         * @return null
         */
        g.gtmTrigger = function(triggerName){
            triggerName = triggerName || 'gtmReady';
            window.dataLayer = window.dataLayer || [];
            window.dataLayer.push({
            'event':triggerName
            });
        };
        /**
         * 常用收集方法
         * @author hzmating 20160909
         * @param  {Object}
         * @return null
         */
        g.gtmReady = function(obj){
            g.gtmGo(obj,User.getUserType());
        };
        /**
         * 常用收集方法 用于静态化页面
         * @param  {Object}
         * @return null
         */
        g.gtmReadyAsync = function(obj){
            //为了等待userinfo.js中的异步请求返回，延时2s执行。
            //若执行时发现请求仍未返回，则单独发请求获取isLogin、isOrdered
            setTimeout(function(){
                if(window.isLogin===undefined){
                    var userInfo = new UserInfo();
                    userInfo.$on('logined',function(user){
                        var userType = User.getUserTypeInUser(window.isLogin,user);
                        g.gtmGo(obj,userType);
                        userInfo = userInfo.destroy();
                    });
                }else{
                    var userType = User.getUserTypeInUser(window.isLogin,window.user);
                    g.gtmGo(obj,userType);
                }
            },2000);
        };
        /**
         * 组合数据并触发
         * @param  {Object}
         * @return null
         */
        g.gtmGo = function(obj,userType){
            var account = User.getAccountFromCookie(),
                data = _.merge({
                    com_data:{
                        user_type:userType,//1未登录，2注册未下过单，3注册并下过单
                        account:account,
                        account_md5:_u._$md52hex(account)
                    }
                },obj);
            g.gtmCollect(data);
            g.gtmTrigger('gtmReady');
            // console.dir(data);//本地调试用
        };

        return g;
    },15,26,245,264);
I$(265,"<div class=\"cntbox\">\n\t<div class=\"u-close\" on-click={this.close()} data-category=\"新人推广\" data-event=\"推广弹框\" data-label=\"关闭\"></div>\n\t<img on-click={this.goSite()} width=\"100%\" src={imageUrl|noProtocol} ref=\"bgimg\"/>\n</div>");
I$(45,function (tpl, _ut, _u, _c, request, Modal) {
	var Novicepop = Modal.extend({
		content:tpl,
		data:{width:760,modalName:'m-onlyimgwin m-novicewin'},
		config: function(data) {
			var paraname = "showNovicePop",
				urlparams = _ut._$query2object(location.search.slice(1)),
				_popid = urlparams[paraname];
			this.data.popid = _popid;
			this.data.isHidden = true;
			this.data.paraname = paraname;
			this.data.cookiename = "NTES_KAOLA_NOVICEPOP_" + this.data.popid;
		},
		init: function() {
			this.needShow(this.data.popid);
			this.supr();
			this.$inject(false);
		},
		//判断用户是否登录，如果在未登录状态下就通过cookie判断是否弹窗
		needShow: function(_popid) {
			if(_popid === undefined) return;
			_u.isLogin(function(status) {
				if(!status) {
					this.data.__needShow = this.getCookieStat();
				}
				if(this.data.__needShow === false) {
					return;
				};
				this.getNovicePopDataReq(_popid);
			}._$bind(this));
		},
		// ajax获取弹窗图片url和跳转url
		getNovicePopDataReq: function(popid) {
			request('/outer/window/user/info.html', {
				method:'POST',
				norest:true,
				data:{id:popid},
				type:'json',
				onload: function(_data) {
					if( _data && _data.retcode == 200) {
						var obj = _data.retdata,
							status = obj.paidStatus + obj.popupStatus;
						if(obj.url && obj.imageUrl && status === 0) {
							this.data.url = obj.url;
							this.data.imageUrl = obj.imageUrl;
							this.$update();
							this.hasPopConfirmReq(popid);
							this.$inject(document.body);
						} else {
							this.resetCookieStat();
						}
					} else {
						this.resetCookieStat();
					}
				}._$bind(this),
				onerror: function() {
					this.resetCookieStat();
				}._$bind(this)
			});
		},
		// 获取及设置cookie("NTES_KAOLA_NOVICEPOP")，过期时间24h
		getCookieStat: function() {
			var _name = this.data.cookiename, _cookie = _c._$cookie(_name);
			if(!!_cookie) {
				return false;
			} else {
				_c._$cookie(_name, {value:true, expires: 1});
				return true;
			};
		},
		resetCookieStat: function() {
			var _name = this.data.cookiename;
			_c._$cookie(_name, {value:false, expires: -1});
		},
		// 向服务器确认已弹窗
		hasPopConfirmReq: function(popid) {
			request('/outer/window/user/popup.html', {
				method:'POST',
				norest:true,
				data:{id:popid},
				type:'json'
			});
		},
		goSite: function() {
			var data = this.data,
				location = window.location,
				pathname = location.pathname,
				pagePath = pathname.substring(1, pathname.lastIndexOf("."));
			window._dapush && window._dapush('_trackEvent', '外推弹窗', '点击', '弹窗', {path:pagePath, win_id:data.popid});
			setTimeout(function() {
				data.url && (location.href = data.url);
			},250);
		},
		preventMove: function(evt){
			evt.preventDefault();
		}
	});
	return Novicepop;
},265,2,15,11,6,128);
I$(47,function (_k,_ut,_,_v,_t,_e,$,Request,LoginWindow,PromptWin,_p,_o,_f,_r,_pro) {
        var _pro;

        _p._$$CodeExchange = _k._$klass();
        _pro = _p._$$CodeExchange._$extend(_t._$$EventTarget);

        _pro.__init = function(_options) {
            this.__supInit(_options);
            // 口令红包兑换
            this.__addEvent();
        };

        _pro.__addEvent = function(){
            $('.j-exchangbtn')._$on("click",function(evt){
                var node = this;
                var codeNode = $(this)._$parent('.j-exchangbox',true)._$children('.j-codetxt',true),
                    val = codeNode._$val().trim();
                if(_e._$hasClassName(node,'z-clicked')){
                  return;
                }
                if(!val){
                  PromptWin._$allocate({message: '请输入口令！'})._$show();
                  return;
                }

                Request('/personal/exchange_coupon_by_password.html', {
                    method: 'POST',
                    data: {redeemCode:val},
                    norest: true,
                    type: 'json',
                    onload: function (_json) {
                        _e._$delClassName(node,'z-clicked');
                        if(_json.retcode==200){
                            var str = '<span class="succdesc"><i class="succ"></i>恭喜，口令兑换成功啦!</span>\
                                        <a href="/" target="_blank" class="link">立即去逛逛&gt;</a>';

                            PromptWin._$allocate({message: str,clazz:'m-dhsuccwin'})._$show();
                            codeNode._$val('');
                        }else if(_json.retcode==461){
                          LoginWindow._$allocate({logincallback: function(){
                            $(node)._$trigger('click');
                          }})._$show();
                        }else{
                            PromptWin._$allocate({message: _json.retdesc||"兑换出错"})._$show();
                        }
                    }._$bind(this)
                });
                _e._$addClassName(node,'z-clicked');

            });
        };

        return _p._$$CodeExchange;
    },1,2,15,3,23,4,25,6,7,8);
I$(471,function (_, request) {
    var t = {};
    _.extend(Number.prototype,{
        // dot 保留几位小数
        // step 逢几进位，默认5（四舍五入）
        Round : function(dot, step){var a = Math.pow(10, dot || 0); return step == 0 ? Math.ceil( this*a )/a : Math.round( this*a + (5 - (step || 5))/10 )/a; },
        // 同上
        Cint : function(step){ return this.Round(0, step); }
    })
    /**
     * 用于jst模板整合
     */
    t.merge = function(data,item){
        for(var i in item){
            if(item.hasOwnProperty(i)){
                data[i]= item[i]
            }
        }
    };
    /**
     * encodeURIComponent
     */
    t.encode = function(str){
        if(!!str){
            return window.encodeURIComponent(str);
        }else{
            return '';
        }
    };
    /**
     * nos处理
     */
    t.imgThumbnailUrl = function(url, width, height, quality){
        var quality = quality || 75;//默认75，与不加参数时效果一致
        return _.imgThumbnailUrl(url, width, height, quality);
    };
    /*
    * 毫秒数转为相应格式的时间
    * @param {Number} num 毫秒数
    * @param {Boolean} needObj 是否返回剩余时间的对象格式
    * add by hzmating 2016/10/08
    */
    t.formatTime = _.formatTime;
    /**
     * 为URL增加参数
     */
    t.addParam = function(url, name, value){
        if(url==''){
            return 'javascript:;';
        }
        if(url.indexOf('?')!=-1){
            return url.replace('?','?'+name+'='+value+'&');
        }else if(url.indexOf('#')!=-1){
            return url.replace('#','?'+name+'='+value+'#');
        }else{
            return url+'?'+name+'='+value;
        }
    };
    /**
     * 判断str是否为空字符串，不为空则返回str，如果为空则返回default值
     */
    t.defStr = function(str, defstr){
        var str = str || '';
        return str==''?defstr:str;
    };
    /**
     * 功能同split("#")[flag] flag: 0取前半段，1取参数 
     * 用于优化SEO，将链接参数暂时分离,通过js拼接
     */
    t.splitUrlHash = function(url, flag){
        var url = url || '';
        if(flag==1){
            return '#'+(url.split('#')[1]||'');
        }else{
            return url.split('#')[0];
        }
    };
    /**
     * 在链接中拼接统计参数
     */
    t.jointTjQuery = function(url, referId, referType, zid, zposition, zname){
        var urlHash = '',
            retUrl = '';
        if(url.indexOf('#')!=-1){
            urlHash = url.split('#')[1];
        }
        // 拼接search
        retUrl = "ri="+referId+"&rt="+referType+"&zid="+zid+"&zp="+referType+zposition+"&zn="+t.encode(zname);
        // 拼接hash
        if(urlHash!=''){
            retUrl = retUrl+"#"+urlHash;
        }
        return retUrl;
    };
    /**
     * 拼接dapush的参数
     */
    t.jointDaLabel = function(zname, zlocation, zposition, targetUrl){
        return t.encode(zname)+"@@"+zlocation+"@@"+zposition+"@@"+targetUrl;
    };
    /**
     * 加空格
     */
    t.addNbsp = function(str, num){
        if(!str){
            return '';
        }else{
            if(num==1){
                return str+"&nbsp;"
            }else{
                return str+"&nbsp;&nbsp;"
            }
        }
    };
    /**
     * 删除包邮价
     */
    t.removeBaoYou = function(str){
        return (str||'').replace("包邮价","");
    };
    /**
     * 获取背景样式
     * bgrepeat: 5 4 1 0  分别代表  平铺、居中、居左、居右
     */
    t._get_background = function(bgimg,bgcolor,bgrepeat,bgPaddingTop){
        var bgimg = bgimg || '',
            bgcolor = bgcolor || '',
            bgrepeat = +(bgrepeat || '4'),
            bgPaddingTop = +(bgPaddingTop || '0'),
            style = '';
        if(bgcolor!='' && bgcolor.indexOf('#')==-1){
            bgcolor = '#'+bgcolor;
        }
        if(bgimg!=''){
            style = style+'background-image:url('+bgimg+');';
        }
        if(bgcolor!=''){
            style = style+'background-color:'+bgcolor+';';
        }
        switch(bgrepeat){
            case 5:style = style+'background-repeat:repeat;';break;
            case 4:style = style+'background-position:center top;background-repeat:no-repeat;';break;
            case 1:style = style+'background-position:left top;background-repeat:no-repeat;';break;
            case 0:style = style+'background-position:right top;background-repeat:no-repeat;';break;
            default:style = style+'background-position:center top;background-repeat:no-repeat;';break;
        }
        //商品距离模块顶部距离
        if(bgPaddingTop!=0){
            style = style+'padding-top:'+bgPaddingTop+'px;';
        }
        return style;
    };
    /**
     * 删除html注释
     */
    t.removeComment = function(str){
        return str.replace(/<!--[\w\W\r\n]*?-->/gmi,'');
    };
    /**
     * 删除换行
     */
    t.removeCRLF = function(str){
        return str.replace(/\r\n/gmi,'');
    };
    /**
     * 删除模板中的注释并压缩
     */
    t.minifyHtml = function(str){
        return t.removeCRLF(t.removeComment(str));
    };

    t.noProtocol = function(url){
        return _.noProtocol(url);
    };

    return t;

},15,6);
I$(596,"<div class=\"act-module\"></div>");
I$(472,function (k,_e,u,i,_t,html,t1,p,o,f,r){
    var pro,
    	seed_html = t1._$addNodeTemplate(html);

    p._$$Module = k._$klass();
    pro = p._$$Module._$extend(_t._$$EventTarget);
    /**
     * options:{
     *  id:'nodeid'//要被替换的节点
     * }
     */
    pro.__reset = function(options){
        this.__super(options);
        this.__body = t1._$getNodeTemplate(seed_html);
        this.__placeholder = _e._$get(options.id)||'';
    };

    pro._$getBody = function(){
        return this.__body;
    };
    /**
     * 整理模板数据
     */
    pro.__initData = function(){

    };
    /**
     * 渲染模板
     */
    pro.__render = function(){
        this._$replaceNode(this.__body,this.__placeholder);
        //去掉过渡效果
        // if(this.__supportTransition()){
        //     //插入过渡蒙层
        //     var mask = _e._$create('div','act-mask act-mask-matte',this.__body);
        //     this._$replaceNode(this.__body,this.__placeholder);
        //     setTimeout(function(){
        //         _e._$delClassName(mask,'act-mask-matte');
        //     },0);
        //     setTimeout(function(){
        //         _e._$remove(mask);
        //     },500);
        // }else{
        //     this._$replaceNode(this.__body,this.__placeholder);
        // }
    };
    /**
     * 模板插入后的操作
     */
    pro.__afterRender = function(){
        
    };

    pro._$replaceNode = function(newNode,oldNode){
        oldNode.parentNode.replaceChild(newNode,oldNode);
    };

    pro._$insertAfter = function(insertNode,targetNode){
        var parent = targetNode.parentNode;
        if(parent.lastChild==targetNode){
            parent.appendChild(insertNode);
        }else{
            parent.insertBefore(insertNode,node.nextSibling);
        }
    };

    pro.__supportTransition = (function(){
        var support = false,
            div = document.createElement('div'),
            prefixs = ['transition','webkitTransition','msTransition','mozTransition'] ; 
        for (var i = 0; i < prefixs.length; i++) {
            if (div.style[prefixs[i]] !== undefined){
                support = true;
                break;
            }                
        }
        div = null;
        return function(){
            return support;
        }
    })();
    
    return p._$$Module;
},1,4,2,286,23,596,233);
I$(473,"<article class=\"m-drainage {if showType==1}m-drainage-2{elseif showType==2}m-drainage-3{else}m-drainage-4{/if}\">\n<section class=\"imgWrap clearfix\">\n{list list as item}\n  <a class=\"imgLink\" href=\"${item.siteUrl||''}\" data-actda=\"${jointDaLabel('底部引流','',item_index+1,item.siteUrl||'')}\" target=\"{if type==1}_self{else}_blank{/if}\"><img src=\"${(item.imageUrl||'')|noProtocol}\" title=\"\" alt=\"\"></a>\n{/list}\n</section>\n</article>");
I$(282,function (k,_e,_u,_v,t0,_,_$$TplModule,html,p,o,f,r){
    var pro,
    	seed_html = t0._$add(_.minifyHtml(html));
    
    p._$$Drainage = k._$klass();
    pro = p._$$Drainage._$extend(_$$TplModule);
    
    pro.__reset = function(options){
        var list = options.list||[];
        if(list.length==0){
            return;
        }
        this.__super(options);
        this.__parent = _e._$get(options.parent||'');
        //整理数据
        var data = this.__initData(list);
        //渲染模板
        this.__renderDrainage(data);
    };

    pro.__initData = function(list){
        this.__super();
        //模块变量
        var type = list[0].configMap.type||1,//1.公共模板 2.其他模板
            showType = +(list[0].configMap.showType||1); //1.一排二 2.一排三 3.一排四
        //模板变量
        var data = {
            list:list,
            type:type,
            showType:showType
        }
        //模板中添加jointDaLabel方法
        _.merge(data,{
            jointDaLabel:_.jointDaLabel
        });
        return data;
    };

    pro.__renderDrainage = function(data){
        //插入底部引流
        this.__parent.appendChild(this._$getBody());
        t0._$render(this._$getBody(),seed_html,data, _);
    };
    
    return p._$$Drainage;
},1,4,2,3,239,471,472,473);
I$(70,function (_k,_ut,_v,_t,_e,_j,Drainage,_p,_o,_f,_r) {
        var _pro;

        _p._$$Drainage = _k._$klass();
        _pro = _p._$$Drainage._$extend(_t._$$EventTarget);

        _pro.__init = function(_options) {
            this.__supInit(_options);
            this.__parent = _options.parent||'body';
            //ms配置是否展示底部引流
            var showDefaultBottomModules = window.syncData.showDefaultBottomModules||0;
            if(showDefaultBottomModules==1){
                // 请求底部引流数据
                this.__getDrainage();
            }
        };
        /**
         * 请求底部引流数据
         */
        _pro.__getDrainage = function(){
            _j._$request('/activity/detail/getActivityBottomModule4PC.shtml',{
                type:'json',
                headers:{"X-Requested-With":'XMLHttpRequest'},
                method:'get',
                onload:this.__onDrainageLoaded._$bind(this)
            });
        };
        
        _pro.__onDrainageLoaded = function(_json){
            var json = _json || {},
                list = json.data || [];
            if(json.success && list.length>0){
                Drainage._$allocate({
                    parent:this.__parent,
                    list:list
                });
            }
        };
        
        return _p._$$Drainage;
    },1,2,3,23,4,14,282);
I$(474,"<div class=\"m-modalmask\"></div>\n<div class=\"m-outdate\">\n  <div class=\"imgwrap\">\n    <img src=\"${cdnBaseUrl}images/activity/activityTemplate/over.jpg\">\n    <a class=\"btn\" id=\"outdatejumpurl\" href=\"${redirectUrl}\">${redirectTitle}</a>\n  </div>\n</div>");
I$(283,function (k,_e,_u,_v,t0,OutDateLayer,_,_$$TplModule,html,p,o,f,r){
    var pro,
    	seed_html = t0._$add(_.minifyHtml(html));
    
    p._$$EndMask = k._$klass();
    pro = p._$$EndMask._$extend(_$$TplModule);
    
    pro.__reset = function(options){
        this.__super(options);
        var kaolaSystemTime = options.kaolaSystemTime||0,
            activityShowEndDate = window.syncData.activityShowEndDate||0;
        // 判断是否已过期，过期则显示活动结束弹窗
        if(activityShowEndDate!=0 && activityShowEndDate < kaolaSystemTime){
            //整理数据
            var data = this.__initData();
            //渲染模板
            this.__renderEndMask(data);
            //渲染后处理
            this.__afterRenderEndMask();
        }
    };

    pro.__initData = function(){
        this.__super();
        //全局变量
        var cdnBaseUrl = window.cdnBaseUrl||'/',
            redirectUrl = window.syncData.redirectUrl||'',
            redirectTitle = window.syncData.redirectTitle||'';
        //模板变量
        var data = {
            cdnBaseUrl:cdnBaseUrl,
            redirectUrl:redirectUrl,
            redirectTitle:redirectTitle
        }
        return data;
    };

    pro.__renderEndMask = function(data){
        document.body.appendChild(this._$getBody());
        t0._$render(this._$getBody(),seed_html,data);
    };

    pro.__afterRenderEndMask = function(){
        // 处理活动过期弹层 按钮点击链接
        OutDateLayer._$allocate();
    }
    
    return p._$$EndMask;
},1,4,2,3,239,29,471,472,474);
I$(71,function (_k,_ut,_v,_t,_e,_j,$,EndMask,_p,_o,_f,_r,_pro) {
        var _pro;

        _p._$$GetServerTime = _k._$klass();
        _pro = _p._$$GetServerTime._$extend(_t._$$EventTarget);

        _pro.__reset = function(_options) {
            this.__super(_options);
            this.__countDown = _options.countDown;
            this.__doAjax(_options);
        };

        _pro.__doAjax = function(_options){
            _j._$request('/activity/detail/getSystemTime.html',{
                type:'json',
                method:'post',
                headers:{"X-Requested-With":'XMLHttpRequest'},
                onload:this.__onSuccess._$bind(this),
                onerror:this.__onFail._$bind(this)
            });
        };

        _pro.__onSuccess = function(_json){
            var json = _json || {};
            if(json.success){
                var kaolaSystemTime = json.data||0;
                this.__updateCountDown(kaolaSystemTime);
                this.__activityEndMask(kaolaSystemTime);
                this._$dispatchEvent('onsuccess',kaolaSystemTime);
            }else{
                this._$dispatchEvent('onfail',false);
            }
        };

        _pro.__onFail = function(){
            this._$dispatchEvent('onfail',false);
        };
        /**
         * 更新倒计时模块
         */
        _pro.__updateCountDown = function(kaolaSystemTime){
            if(!!this.__countDown){
                $('.js-countdown')._$forEach(function(node){
                    _e._$attr(node,'data-serverTime',kaolaSystemTime);
                });
                this.__countDown._$refresh();
            }
        };
        /**
         * 确定过期蒙层是否展示
         */
        _pro.__activityEndMask = function(kaolaSystemTime){
            EndMask._$allocate({
                kaolaSystemTime:kaolaSystemTime
            });
        };

        return _p._$$GetServerTime;
    },1,2,3,23,4,14,25,283);
I$(676,"{if (!isActivityStart || hasPrePrice) && !!preBuyType.type}\n    <!-- 预售期、并且勾选了预热期间按钮 -->\n    {if preBuyType.type==1}\n        <a class=\"cart-btn cart-btn-1 j-favbtn\" \n             data-goodsid=\"${saleGoods.goods.goodsId}\" \n             href=\"javascript:;\"\n             title=\"${preBuyType.value|defStr:'提前收藏'}\"\n             rel=\"nofollow\"\n             {if buyButtonBgColor!=\"\" && buyButtonTextColor!=\"\"}\n             style=\"background-color:${buyButtonBgColor};color:${buyButtonTextColor}\"\n             {/if}\n          >${preBuyType.value|defStr:'提前收藏'}{if isBigAction}<b class=\"icon-action\"></b>{/if}</a>\n    {elseif preBuyType.type==2}\n        <a class=\"to-start u-btn\" \n             href=\"${goodsLink}\"\n             data-param=\"from=${zone.locateId}\"\n             data-actda=\"${actDaParam}\"\n             target=\"_blank\"\n             title=\"${preBuyType.value|defStr:'即将开始'}\"\n             {if buyButtonBgColor!=\"\" && buyButtonTextColor!=\"\"}\n             style=\"background-color:${buyButtonBgColor};color:${buyButtonTextColor}\"\n             {/if}\n          >${preBuyType.value|defStr:'即将开始'}{if isBigAction}<b class=\"icon-action\"></b>{/if}</a>\n    {/if}\n{else}\n    {if isActivityStart && saleGoods.goods.actualStorageStatus==0}\n    <a class=\"cart-btn cart-btn-1 cart-btn-dis\" href=\"javascript:;\" title=\"已抢光\" rel=\"nofollow\">已抢光</a>\n    {else}\n        {if buyType.type==1}\n            <a class=\"cart-btn cart-btn-1\" \n               href=\"${goodsLink}\" \n               data-param=\"${dataParam}\" \n               data-actda=\"${actDaParam}\"\n               target=\"_blank\" \n               title=\"${buyType.value|defStr:'立即购买'}\" \n               rel=\"nofollow\"\n               {if buyButtonBgColor!=\"\" && buyButtonTextColor!=\"\"}\n               style=\"background-color:${buyButtonBgColor};color:${buyButtonTextColor}\"\n               {/if}\n            >${buyType.value|defStr:'立即购买'}</a>\n        {elseif buyType.type==2}\n            <a class=\"cart-btn cart-btn-1 j-cart-btn\" \n               href=\"javascript:;\" \n               title=\"${buyType.value|defStr:'加入购物车'}\"\n               data-goodsid=\"${saleGoods.goods.goodsId}\"\n               data-imageurl=\"${saleGoods.goods.imageUrl}\"\n               rel=\"nofollow\"\n               {if buyButtonBgColor!=\"\" && buyButtonTextColor!=\"\"}\n               style=\"background-color:${buyButtonBgColor};color:${buyButtonTextColor}\"\n               {/if}\n            >${buyType.value|defStr:'加入购物车'}</a>\n        {/if}\n    {/if}\n{/if}");
I$(666,function (e1,_,html,p,o,f,r){
    var pro,
        seed_html = e1._$add(_.minifyHtml(html));
    return {
        g_actions:function(zone,zoneIndex,saleGoods,pIndex,kaolaSystemTime){
            //全局变量
            var domainUrl = window.domainUrl || '//www.kaola.com/',
                activityId = window.activityId || '',
                activityShowStartDate = window.syncData.activityShowStartDate;
            //模块变量
            var cfg = zone.zoneConfigMap || {},
                priceSetting = cfg.priceSetting || {},
                hasPrePrice = !!priceSetting.prePrice && priceSetting.prePrice.type==1,
                buyType = cfg.buyType || {},
                preBuyType = cfg.preBuyType || {},
                buyButtonBgColor = cfg.buyButtonBgColor||"",
                buyButtonTextColor = cfg.buyButtonTextColor||""
                isBigAction = cfg.buyButtonStyle==1,
                goodsLink = domainUrl + "product/"+saleGoods.goods.goodsId+".html",
                dataParam = _.jointTjQuery(goodsLink,activityId,'product',zone.locateId,pIndex,cfg.zoneName),
                actDaParam = _.jointDaLabel(cfg.zoneName,zoneIndex,pIndex,goodsLink);
            //模板变量
            var data ={
                zone:zone,
                saleGoods:saleGoods,
                isActivityStart:activityShowStartDate<=kaolaSystemTime,
                hasPrePrice:hasPrePrice,
                buyType:buyType,
                preBuyType:preBuyType,
                buyButtonBgColor:buyButtonBgColor,
                buyButtonTextColor:buyButtonTextColor,
                isBigAction:isBigAction,
                goodsLink:goodsLink,
                dataParam:dataParam,
                actDaParam:actDaParam
            };
            return e1._$get(seed_html,data,_);
        }
    }
},239,471,676);
I$(677,"{macro getStarWidth(commPoint,isEmpty)}\n    ${(isEmpty?'e':'w')+Math.round(commPoint*2)}\n{/macro}\n\n<!-- 后台配置是否显示商品评论 -->\n{if showComment}\n<span class=\"proComment\" hasComment=\"${hasComment?1:0}\">\n  <span class=\"bg\"></span>\n  {if hasComment}\n  <span class=\"data clearfix\">\n    {if type!=\"lineOfFive\"}\n    <span class=\"prefect\">\n      {if hasComment}\n      ${(commentGoodCount/commentCount*100).toFixed(1)}\n      {else}100{/if}%好评</span>\n    {/if}\n    <span class=\"percentStar clearfix\">\n        <span class=\"fullStar {if commentPoint!=0 && hasComment}${getStarWidth(commentPoint,false)}{else}w10{/if}\">&#xe60c;&#xe60c;&#xe60c;&#xe60c;&#xe60c;</span>\n        <span class=\"emptyStar {if commentPoint!=0 && hasComment}${getStarWidth(commentPoint,true)}{else}e10{/if}\">&#xe60c;&#xe60c;&#xe60c;&#xe60c;&#xe60c;</span>\n    </span>\n    <span class=\"num\">${commentCount}条评论</span>\n  </span>\n  <span class=\"detail\"><b class=\"rollText\"></b></span>\n  {else}\n  <span class=\"noComment\">新品上线，赶快来试试吧！</span>\n  {/if}\n</span>\n{/if}\n");
I$(667,function (e1,_,html,p,o,f,r){
    var pro,
        seed_html = e1._$add(_.minifyHtml(html));
    return {
        g_comment:function(zone,saleGoods,type){
            //模块变量
            var cfg = zone.zoneConfigMap || {},
                showComment = cfg.isDisplayable || false,//后台配置是否显示商品评论
                hasComment = (saleGoods.goods.commentCount||0)!=0,//是否有评论
                commentGoodCount = saleGoods.goods.commentGoodCount || 0,//好评数
                commentCount = saleGoods.goods.commentCount || 1,//评论数
                commentPoint = saleGoods.goods.commentPoint || 0;//评论星级
            //模板变量
            var data ={
                type:type,
                showComment:showComment,
                hasComment:hasComment,
                commentGoodCount:commentGoodCount,
                commentCount:commentCount,
                commentPoint:commentPoint
            };
            return e1._$get(seed_html,data,_);
        }
    }
},239,471,677);
I$(678,"<img class=\"w-brand-img{if rectFlag} rect{/if}\" src=\"${flag|noProtocol}\" alt=\"原产国国旗\" />");
I$(668,function (e1,_,html,p,o,f,r){
    var pro,
        seed_html = e1._$add(_.minifyHtml(html));
    return {
        g_flag:function(saleGoods){
            //全局变量
            var switchRectFlag = !!window.syncData.switchRectFlag;
            //模块变量
            var originCountryRectFlag = saleGoods.goods.originCountryRectFlag || '',
                originCountryFlag = saleGoods.goods.originCountryFlag || '',
                rectFlag = switchRectFlag && originCountryRectFlag!='',
                flag = rectFlag ? originCountryRectFlag : originCountryFlag;
            //模板变量
            var data ={
                rectFlag:rectFlag,
                flag:flag
            };
            return e1._$get(seed_html,data,_);
        }
    }
},239,471,678);
I$(679,"{if giftList.length>0}\n<dl class=\"giftList f-cb\">\n  <dt class=\"giftTit\">${giftText}</dt>\n  {list giftList as gift}\n  {if gift_index < showNum}\n    {var giftGoodsId = gift.giftGoodsId||0 }\n    {var giftGoodsImg = gift.giftGoodsImg||'' }\n    {var isSoldOut = (gift.actualStorageStatus||0)==0 }\n    {var giftLink = domainUrl+ \"product/\"+giftGoodsId+\".html\" }\n    <dd class=\"gift\">\n      <a href=\"${giftLink}\" target=\"_blank\"><img src=\"${giftGoodsImg|noProtocol}\"></a>{if isSoldOut}<span class=\"none\">赠完</span>{/if}\n    </dd>\n    {if (gift_index+1 < gift_length) && (gift_index < showNum-1)}\n    <dd class=\"division\">+</dd>\n    {/if}\n  {/if}\n  {/list}\n</dl>\n{/if}");
I$(669,function (e1,_,html,p,o,f,r){
    var pro,
        seed_html = e1._$add(_.minifyHtml(html));
    return {
        g_gift:function(saleGoods,type){
            //全局变量
            var domainUrl = window.domainUrl || '//www.kaola.com/';
            //模块变量
            var goodsConfigMap = saleGoods.goodsConfigMap || {},
                giftText = goodsConfigMap.giftText || '',//赠品标题
                giftList = goodsConfigMap.giftList || [],//赠品列表
                showNum = type=='maizeng-5'?2:3;//赠品展示的个数
            //模板变量
            var data ={
                type:type,
                giftText:giftText,
                giftList:giftList,
                showNum:showNum
            };
            return e1._$get(seed_html,data,_);
        }
    }
},239,471,679);
I$(680,"<img class=\"proImg img-lazyload\" \n       src=\"${goodsImg|noProtocol}\" \n       alt=\"${goodsTit}\" \n       title=\"${goodsTit}\" >");
I$(670,function (e1,_,html,p,o,f,r){
    var pro,
        seed_html = e1._$add(_.minifyHtml(html));
    return {
        g_img:function(saleGoods,width,height,quality){
            //全局变量
            var cdnBaseUrl = window.cdnBaseUrl || '//mm.bst.126.net/';
            //模块变量
            var gImg = saleGoods.goodsImage||'',
                gUrl = saleGoods.goods.imageUrl||'',
                goodsImg = _.imgThumbnailUrl(gImg!=''?gImg:gUrl,width,height,quality),
                goodsTit = saleGoods.goods.title||'';
            //模板变量
            var data ={
                cdnBaseUrl:cdnBaseUrl,
                goodsImg:goodsImg,
                goodsTit:goodsTit
            };
            return e1._$get(seed_html,data,_);
        }
    }
},239,471,680);
I$(681,"<p class=\"w-price\">\n<!-- 有预告价则显示预告价不显示在线售价-->\n{if hasPrePrice && prePrice>0}\n{var showGuidePrice = prePrice < guidePrice}\n<strong{if priceColor!=\"\" && priceColor!=\"#d22147\"} style=\"color:${priceColor}\"{/if}><span class=\"symbol\"><b>${prePriceValue|removeBaoYou|addNbsp}</b>¥</span>${prePrice}</strong>\n{else}\n{var showGuidePrice = onlinePrice < guidePrice }\n<strong{if priceColor!=\"\" && priceColor!=\"#d22147\"} style=\"color:${priceColor}\"{/if}><span class=\"symbol\"><b>${onlinePriceValue|removeBaoYou|addNbsp}</b>¥</span>${onlinePrice}</strong>\n{/if}\n{if hasMarketPrice}\n<i class=\"tl\">${marketPriceValue|addNbsp:1}¥<del>${marketPrice}</del></i>\n{/if}\n{if hasGuidePrice && showGuidePrice}\n<i>${guidePriceValue|addNbsp:1}¥${guidePrice}</i>\n{/if}\n</p>");
I$(671,function (e1,_,html,p,o,f,r){
    var pro,
        seed_html = e1._$add(_.minifyHtml(html));
    return {
        g_prices:function(zone,saleGoods){
            //模块变量
            var cfg = zone.zoneConfigMap || {},
                priceSetting = cfg.priceSetting || {},
                textColor = priceSetting.textColor||'',
                priceColor = textColor!=''?textColor:'#d22147',//价格颜色
                //四个价格的设置
                prePriceSetting = priceSetting.prePrice||{},
                onlinePriceSetting = priceSetting.onlinePrice||{},
                guidePriceSetting = priceSetting.guidePrice||{},
                marketPriceSetting = priceSetting.marketPrice||{},
                //四种价格是否显示
                hasPrePrice = prePriceSetting.type==1,
                hasOnlinePrice = onlinePriceSetting.type==1,
                hasGuidePrice = guidePriceSetting.type==1,
                hasMarketPrice = marketPriceSetting.type==1,
                //四个价格的文案
                prePriceValue = prePriceSetting.value||'',
                onlinePriceValue = onlinePriceSetting.value||'',
                guidePriceValue = guidePriceSetting.value||'',
                marketPriceValue = marketPriceSetting.value||'',
                //四个价格的值
                prePrice = saleGoods.prePrice||0,
                onlinePrice = saleGoods.goods.actualCurrentPrice||0,
                guidePrice = saleGoods.goods.suggestPrice||0,
                marketPrice = saleGoods.goods.marketPrice||0;
            //模板变量
            var data ={
                priceSetting:priceSetting,
                priceColor:priceColor,
                //四种价格是否显示
                hasPrePrice:hasPrePrice,
                hasOnlinePrice:hasOnlinePrice,
                hasGuidePrice:hasGuidePrice,
                hasMarketPrice:hasMarketPrice,
                //四个价格的文案
                prePriceValue:prePriceValue,
                onlinePriceValue:onlinePriceValue,
                guidePriceValue:guidePriceValue,
                marketPriceValue:marketPriceValue,
                //四个价格的值
                prePrice:prePrice,
                onlinePrice:onlinePrice,
                guidePrice:guidePrice,
                marketPrice:marketPrice
            };
            return e1._$get(seed_html,data,_);
        }
    }
},239,471,681);
I$(682,"{if isSoldOut}\n<span class=\"w-icon w-icon-13\">&nbsp;</span>\n{/if}");
I$(672,function (e1,_,html,p,o,f,r){
    var pro,
        seed_html = e1._$add(_.minifyHtml(html));
    return {
        g_soldout:function(saleGoods){
            //模块变量
            var isSoldOut = saleGoods.goods.actualStorageStatus==0;
            //模板变量
            var data ={
                isSoldOut:isSoldOut
            };
            return e1._$get(seed_html,data,_);
        }
    }
},239,471,682);
I$(683,"<ul class=\"tags clearfix\">\n  <!-- 是否显示组合标签 -->\n  {if cfg.showCompositeTag && memberCount>0 && saleGoods.goods.isShowDiscountCost}\n  <li class=\"tagItem\">每${saleGoods.goods.memberUnitName||'件'}${saleGoods.goods.memberPrice||0}元</li>\n  {/if}\n  <!-- 是否显示运营标签（之前的角标） -->\n  {if !showMaizengTag && !!cfg.cornerMark}\n  {var cornerMarkType = +(cfg.cornerMark.type||-1) }\n    {if cornerMarkType==0}\n    <li class=\"tagItem\">立省¥{if hasPrePrice && prePrice>0}${(marketPrice0-prePrice).Round(1)}{else}${(marketPrice0-onlinePrice).Round(1)}{/if}</li>\n    {elseif cornerMarkType==1}\n    <li class=\"tagItem\">{if hasPrePrice && prePrice>0}${Math.ceil(100*prePrice/marketPrice1)/10}{else}${Math.ceil(100*onlinePrice/marketPrice1)/10}{/if}折</li>\n    {elseif cornerMarkType==2}\n    <li class=\"tagItem\">${cfg.cornerMark.value||\"\"}</li>\n    {elseif cornerMarkType==3 && saleGoods.goods.isAppOnlyPrice==1 && (onlinePrice-appOnlinePrice)>0}\n    <li class=\"tagItem\">手机下单减${(onlinePrice-appOnlinePrice).Round(1)}元</li>\n    {/if}\n  {/if}\n  <!-- 是否显示包邮标签 -->\n  {if cfg.showFreePostageTag && saleGoods.goods.isPostageFree==1}\n  <li class=\"tagItem\">包邮</li>\n  {/if}\n  <!-- 是否显示买赠标签 -->\n  {if showMaizengTag}\n  <li class=\"tagItem\">买赠</li>\n  {/if}\n</ul>");
I$(673,function (e1,_,html,p,o,f,r){
    var pro,
        seed_html = e1._$add(_.minifyHtml(html));
    return {
        g_tags:function(zone,saleGoods){
            //模块变量
            var cfg = zone.zoneConfigMap || {},
                priceSetting = cfg.priceSetting || {},
                hasPrePrice = !!priceSetting.prePrice && priceSetting.prePrice.type==1,//是否有预告价
                prePrice = saleGoods.prePrice||0,//预告价
                onlinePrice = saleGoods.goods.actualCurrentPrice||0,//在线售价
                appOnlinePrice = saleGoods.goods.actualCurrentPriceForApp||0,//app在线售价
                marketPrice0 = saleGoods.goods.marketPrice||0,//市场价,默认0
                marketPrice1 = saleGoods.goods.marketPrice||1,//市场价,默认1
                showMaizengTag = !!cfg.showPremiumsTag && (saleGoods.goods.maizengPromotionTitleLink||'')!='',
                memberCount = saleGoods.goods.memberCount||0;//多件装个数
            //模板变量
            var data ={
                cfg:cfg,
                saleGoods:saleGoods,
                memberCount:memberCount,
                hasPrePrice:hasPrePrice,
                prePrice:prePrice,
                onlinePrice:onlinePrice,
                appOnlinePrice:appOnlinePrice,
                marketPrice0:marketPrice0,
                marketPrice1:marketPrice1,
                showMaizengTag:showMaizengTag
            };
            return e1._$get(seed_html,data,_);
        }
    }
},239,471,683);
I$(684,"{if type==\"lineOfOne\"}\n<h3 class=\"tit\">\n  <a target=\"_blank\" href=\"${goodsLink}\" data-param=\"${dataParam}\" data-actda=\"${actDaParam}\" title=\"{if hasMemberCount}${memberCount}${memberUnitName}&nbsp;|&nbsp;{/if}${shortTitle}\">{if hasMemberCount}<b>${memberCount}${memberUnitName}</b>&nbsp;|&nbsp;{/if}<strong>${shortTitle}</strong></a>\n</h3>\n<p class=\"desc\" title=\"${introduce} ${description}\"><b>${introduce}</b>${description}</p>\n{else}\n<h3 class=\"tit\">\n  <a class=\"titLink\" target=\"_blank\" href=\"${goodsLink}\" data-param=\"${dataParam}\" data-actda=\"${actDaParam}\" title=\"{if hasMemberCount}${memberCount}${memberUnitName}&nbsp;|&nbsp;{/if}${shortTitle}\">{if hasMemberCount}<b>${memberCount}${memberUnitName}</b>&nbsp;|&nbsp;{/if}${shortTitle}</a>\n  {if type!='maizeng-3' && type!='maizeng-4' && type!='maizeng-5'}\n  <a target=\"_blank\" href=\"${goodsLink}\" {if isAdvertShowRed}class=\"z-red\"{/if} data-param=\"${dataParam}\" data-actda=\"${actDaParam}\" title=\"${introduce}\">${introduce}</a>\n  {/if}\n</h3>\n{/if}");
I$(674,function (e1,_,html,p,o,f,r){
    var pro,
        seed_html = e1._$add(_.minifyHtml(html));
    return {
        g_titles:function(zone,zoneIndex,saleGoods,type,pIndex){
            //全局变量
            var domainUrl = window.domainUrl || '//www.kaola.com/',
                activityId = window.activityId || '';
            //模块变量
            var cfg = zone.zoneConfigMap || {},
                goodsConfigMap = saleGoods.goodsConfigMap || {},
                advertString = goodsConfigMap.advertString || '',//ms定制的十字描述
                memberCount = saleGoods.goods.memberCount || 0,
                hasMemberCount = memberCount>0,
                memberUnitName = (saleGoods.goods.memberUnitName||'件')+'装',
                shortTitle = saleGoods.goods.shortTitle||'',
                introduce = advertString!=''?advertString:(saleGoods.goods.introduce||''),
                description = saleGoods.goods.description||'',
                isAdvertShowRed = cfg.isAdvertShowRed||false,//十字描述 是否标红
                goodsLink = domainUrl + "product/"+saleGoods.goods.goodsId+".html",
                dataParam = _.jointTjQuery(goodsLink,activityId,'product',zone.locateId,pIndex,cfg.zoneName),
                actDaParam = _.jointDaLabel(cfg.zoneName,zoneIndex,pIndex,goodsLink);
            //模板变量
            var data ={
                type:type,
                memberCount:memberCount,
                hasMemberCount:hasMemberCount,
                memberUnitName:memberUnitName,
                shortTitle:shortTitle,
                introduce:introduce,
                description:description,
                isAdvertShowRed:isAdvertShowRed,
                goodsLink:goodsLink,
                dataParam:dataParam,
                actDaParam:actDaParam
            };
            return e1._$get(seed_html,data,_);
        }
    }
},239,471,684);
I$(685,"{if showUnionTag && actTag!=''}\n<span class=\"unionTag {if actTag=='换购'}z-hg{/if}\">${actTag}</span>\n{/if}");
I$(675,function (e1,_,html,p,o,f,r){
    var pro,
        seed_html = e1._$add(_.minifyHtml(html));
    return {
        g_unionTag:function(zone,saleGoods){
            //模块变量
            var cfg = zone.zoneConfigMap || {},
                showUnionTag = cfg.showUnionTag||false,
                actTag = (saleGoods.goods.unionPromptPriceInfo||'').replace(/(选|减)/g,'<br/>$1');
            //模板变量
            var data ={
                showUnionTag:showUnionTag,
                actTag:actTag
            };
            return e1._$get(seed_html,data,_);
        }
    }
},239,471,685);
I$(657,function (g0,g1,g2,g3,g4,g5,g6,g7,g8,g9,_,p,o,f,r){
    
	var data ={},i=0,l=arguments.length-5;
	for(;i<l;i++){
		_.merge(data,arguments[i]);
	}

	return data;
},666,667,668,669,670,671,672,673,674,675,471);
I$(658,"<div class=\"${goodsClass}\" goodsId=\"${saleGoods.goods.goodsId}\">\n    <a class=\"pic\" href=\"${goodsLink}\" data-param=\"${dataParam}\" data-actda=\"${actDaParam}\" target=\"_blank\" title=\"${saleGoods.goods.title||''}\">\n      <!-- 商品图片 -->\n      {if type==\"lineOfOne\"||type==\"lineOfTwo\"}\n        ${g_img(saleGoods,490,300)}\n      {else}\n        ${g_img(saleGoods,330,330)}\n      {/if}\n      <!-- 商品评论相关 -->\n      ${g_comment(zone,saleGoods,type)}\n      <!-- 商品售罄 -->\n      ${g_soldout(saleGoods)}\n      {if type!=\"lineOfOne\"}\n        <!-- 国旗 -->\n        ${g_flag(saleGoods)}\n        {if type!=\"lineOfTwo\"}\n        <!-- 整单类标签 -->\n        ${g_unionTag(zone,saleGoods)}\n        {/if}\n      {/if}\n    </a>\n    <div class=\"proinfo\">\n      {if type==\"lineOfOne\"}\n      <!-- 一排一国旗 -->\n      <div class=\"w-brand clearfix\">\n          ${g_flag(saleGoods)}\n          <span>${saleGoods.goods.originCountryBrev||''}<br/>${saleGoods.goods.goodsSource||''}</span>\n      </div>\n      {/if}\n        <!-- 标题区域 -->\n        ${g_titles(zone,zoneIndex,saleGoods,type,pIndex)}\n        <!-- 标签区域 -->\n        ${g_tags(zone,saleGoods)}\n        <!-- 价格区域 -->\n        ${g_prices(zone,saleGoods)}\n        <!-- 行动点区域 -->\n        ${g_actions(zone,zoneIndex,saleGoods,pIndex,kaolaSystemTime)}\n    </div>\n</div>");
I$(634,function (_e,e1,_,fragments,html,p,o,f,r){
    var pro,
        seed_html = e1._$add(_.minifyHtml(html));
    return {
        goods_common:function(zone,zoneIndex,saleGoods,type,pIndex,kaolaSystemTime){
            //全局变量
            var domainUrl = window.domainUrl || '//www.kaola.com/',
                activityId = window.activityId || '';

            function jointTjQuery2(){
                var recId = saleGoods.goodsConfigMap.recId||'',
                    isRecommen = _e._$attr(zone.locateId,'isRecommend'),
                    zn=(isRecommen=='1')?'recproduct':cfg.zoneName,
                    str;
                str = _.jointTjQuery(goodsLink,activityId,'product',zone.locateId,pIndex,zn);
                if(isRecommen=='1'){
                    str += '&recId='+recId;
                }
                return str;
            }
            //模块变量
            var cfg = zone.zoneConfigMap || {},
                isBigAction = cfg.buyButtonStyle==1,
                goodsClass = 'detailWrap'+(isBigAction?' bigActionWrap':'')+' clearfix',
                goodsLink = domainUrl + "product/"+saleGoods.goods.goodsId+".html",
                dataParam = jointTjQuery2(),
                actDaParam = _.jointDaLabel(cfg.zoneName,zoneIndex,pIndex,goodsLink);
            //模板变量
            var data ={
                zone:zone,
                zoneIndex:zoneIndex,
                kaolaSystemTime:kaolaSystemTime,
                saleGoods:saleGoods,
                type:type,
                pIndex:pIndex,
                goodsClass:goodsClass,
                goodsLink:goodsLink,
                dataParam:dataParam,
                actDaParam:actDaParam
            };
            _.merge(data,fragments);
            return e1._$get(seed_html,data,_);
        }
    }
},4,239,471,657,658);
I$(659,"<a href=\"${imageUrl|splitUrlHash}\" data-param=\"${dataParam}\" data-actda=\"${actDaParam}\" target=\"_blank\" class=\"${imgClass}\" style=\"background:url(${goodsImage}) no-repeat center;\"></a>");
I$(635,function (e1,_,fragments,html,p,o,f,r){
    var pro,
        seed_html = e1._$add(_.minifyHtml(html));
    return {
        goods_image:function(zone,zoneIndex,saleGoods,type,pIndex){
            //全局变量
            var activityId = window.activityId || '';
            //模块变量
            var cfg = zone.zoneConfigMap || {},
                isBigAction = cfg.buyButtonStyle==1,
                imgClass = 'detailWrap'+(isBigAction?' bigActionWrap':''),
                imageUrl = (saleGoods.imageUrl||'')==''?'javascript:;':saleGoods.imageUrl,
                goodsImage = saleGoods.goodsImage || '',
                dataParam = _.jointTjQuery(imageUrl,activityId,'product',zone.locateId,pIndex,cfg.zoneName),
                actDaParam = _.jointDaLabel(cfg.zoneName,zoneIndex,pIndex,imageUrl);
            //模板变量
            var data ={
                zone:zone,
                zoneIndex:zoneIndex,
                saleGoods:saleGoods,
                type:type,
                pIndex:pIndex,
                imgClass:imgClass,
                imageUrl:imageUrl,
                goodsImage:goodsImage,
                dataParam:dataParam,
                actDaParam:actDaParam
            };
            // _.merge(data,fragments);
            return e1._$get(seed_html,data,_);
        }
    }
},239,471,657,659);
I$(660,"{macro g_infoTop(goodsConfigMap,goodsLink,dataParam,actDaParam,textColor,memberCount,memberUnitName)}\n<div class=\"infoTop\" style=\"border-bottom-color:${textColor}\">\n    <p class=\"intro\"><a target=\"_blank\" href=\"${goodsLink}\" style=\"color:${textColor}\" data-param=\"${dataParam}\" data-actda=\"${actDaParam}\" title=\"${goodsConfigMap.introduce||''}\">${goodsConfigMap.introduce||''}</a></p>\n    <h3 class=\"shortTitle\">\n      <a target=\"_blank\" href=\"${goodsLink}\" style=\"color:${textColor}\" data-param=\"${dataParam}\" data-actda=\"${actDaParam}\" \n      title=\"{if memberCount>0}${memberCount}${memberUnitName}&nbsp;|&nbsp;{/if}${goodsConfigMap.shortTitle||''}\"\n      >{if memberCount>0}<b>${memberCount}${memberUnitName}</b>&nbsp;|&nbsp;{/if}${goodsConfigMap.shortTitle||''}</a>\n    </h3>\n</div>\n<h4 class=\"subTitle\"><a target=\"_blank\" href=\"${goodsLink}\" style=\"color:${textColor}\" data-param=\"${dataParam}\" data-actda=\"${actDaParam}\" title=\"${goodsConfigMap.subTitle||''}\">${goodsConfigMap.subTitle||''}</a></h4>\n{/macro}\n\n<div class=\"${goodsClass}\" goodsId=\"${saleGoods.goods.goodsId}\">\n    <a class=\"${picClass}\" href=\"${goodsLink}\" data-param=\"${dataParam}\" data-actda=\"${actDaParam}\" target=\"_blank\" title=\"${saleGoods.goods.title||''}\">\n      <!-- 商品图片 -->\n      {if type==\"newLineOfOne\"}\n        ${g_img(saleGoods,500,400)}\n      {else}\n        ${g_img(saleGoods,440,352)}\n      {/if}\n      <!-- 商品售罄 -->\n      ${g_soldout(saleGoods)}\n    </a>\n    <div class=\"${infoClass}\">\n        <!-- 十字描述、短标题 -->\n        ${g_infoTop(goodsConfigMap,goodsLink,dataParam,actDaParam,textColor,memberCount,memberUnitName)}\n        <!-- 标签区域 -->\n        ${g_tags(zone,saleGoods)}\n        <!-- 价格区域 -->\n        ${g_prices(zone,saleGoods)}\n        <!-- 行动点区域 -->\n        ${g_actions(zone,zoneIndex,saleGoods,pIndex,kaolaSystemTime)}\n    </div>\n</div>\n\n");
I$(636,function (e1,_,fragments,html,p,o,f,r){
    var pro,
        seed_html = e1._$add(_.minifyHtml(html));
    return {
        goods_newitem:function(zone,zoneIndex,saleGoods,type,pIndex,kaolaSystemTime){
            //全局变量
            var domainUrl = window.domainUrl || '//www.kaola.com/',
                activityId = window.activityId || '';
            //模块变量
            var cfg = zone.zoneConfigMap || {},
                goodsClass = 'detailWrap clearfix',
                picClass = 'pic',
                infoClass = 'proinfo',
                textColor = (cfg.textColor||'')==''?'#333':cfg.textColor,
                goodsConfigMap = saleGoods.goodsConfigMap || {},
                displayType = goodsConfigMap.displayType || 1,//展示形式 1:左图右文 2：左文右图
                memberCount = saleGoods.goods.memberCount || 0,
                memberUnitName = (saleGoods.goods.memberUnitName||'件')+'装',
                goodsLink = domainUrl + "product/"+saleGoods.goods.goodsId+".html",
                dataParam = _.jointTjQuery(goodsLink,activityId,'product',zone.locateId,pIndex,cfg.zoneName),
                actDaParam = _.jointDaLabel(cfg.zoneName,zoneIndex,pIndex,goodsLink);
            if(type=='newLineOfOne'){
                picClass += (displayType==2?' f-fr':' f-fl');
                infoClass += (displayType==2?' f-fr mr40':' f-fl ml40');
            }
            //模板变量
            var data ={
                zone:zone,
                zoneIndex:zoneIndex,
                kaolaSystemTime:kaolaSystemTime,
                saleGoods:saleGoods,
                type:type,
                pIndex:pIndex,
                goodsConfigMap:goodsConfigMap,
                goodsClass:goodsClass,
                picClass:picClass,
                infoClass:infoClass,
                textColor:textColor,
                displayType:displayType,
                memberCount:memberCount,
                memberUnitName:memberUnitName,
                goodsLink:goodsLink,
                dataParam:dataParam,
                actDaParam:actDaParam
            };
            _.merge(data,fragments);
            return e1._$get(seed_html,data,_);
        }
    }
},239,471,657,660);
I$(661,"<div class=\"${goodsClass}\" goodsId=\"${saleGoods.goods.goodsId}\">\n    <a class=\"pic\" href=\"${goodsLink}\" data-param=\"${dataParam}\" data-actda=\"${actDaParam}\" target=\"_blank\" title=\"${saleGoods.goods.title||''}\">\n      <!-- 商品图片 -->\n      ${g_img(saleGoods,330,330)}\n      <!-- 商品评论相关 -->\n      ${g_comment(zone,saleGoods,type)}\n      <!-- 商品售罄 -->\n      ${g_soldout(saleGoods)}\n      <!-- 国旗 -->\n      ${g_flag(saleGoods)}\n    </a>\n    <div class=\"line\"></div>\n    <div class=\"proinfo\">\n        <!-- 赠品区域 -->\n        ${g_gift(saleGoods,type)}\n        <!-- 标题区域 -->\n        ${g_titles(zone,zoneIndex,saleGoods,type,pIndex)}\n        <!-- 价格区域 -->\n        <p class=\"w-price\">¥<b>${saleGoods.goods.actualCurrentPrice||0}</b><i>¥</i><del>${saleGoods.goods.marketPrice||0}</del></p>\n        <!-- 行动点区域 -->\n        ${g_actions(zone,zoneIndex,saleGoods,pIndex,kaolaSystemTime)}\n    </div>\n</div>");
I$(637,function (e1,_,fragments,html,p,o,f,r){
    var pro,
        seed_html = e1._$add(_.minifyHtml(html));
    return {
        goods_maizeng:function(zone,zoneIndex,saleGoods,type,pIndex,kaolaSystemTime){
            //全局变量
            var domainUrl = window.domainUrl || '//www.kaola.com/',
                activityId = window.activityId || '';
            //模块变量
            var cfg = zone.zoneConfigMap || {},
                isBigAction = cfg.buyButtonStyle==1,
                goodsClass = 'detailWrap'+(isBigAction?' bigActionWrap':'')+' clearfix',
                goodsLink = domainUrl + "product/"+saleGoods.goods.goodsId+".html",
                dataParam = _.jointTjQuery(goodsLink,activityId,'product',zone.locateId,pIndex,cfg.zoneName),
                actDaParam = _.jointDaLabel(cfg.zoneName,zoneIndex,pIndex,goodsLink);
            //模板变量
            var data ={
                zone:zone,
                zoneIndex:zoneIndex,
                kaolaSystemTime:kaolaSystemTime,
                saleGoods:saleGoods,
                type:type,
                pIndex:pIndex,
                goodsClass:goodsClass,
                goodsLink:goodsLink,
                dataParam:dataParam,
                actDaParam:actDaParam
            };
            _.merge(data,fragments);
            return e1._$get(seed_html,data,_);
        }
    }
},239,471,657,661);
I$(597,function (g0,g1,g2,g3,_,p,o,f,r){
	var data ={},i=0,l=arguments.length-5;
	for(;i<l;i++){
		_.merge(data,arguments[i]);
	}

	return data;
},634,635,636,637,471);
I$(598,"<article id=\"${zone.locateId||''}\" class=\"m-goodsarea js-goodsarea\" style=\"${bgStyle}\">\n<section class=\"${type}\">\n<div class=\"goodsWrap clearfix\">\n{var showGoodsList = zone.showGoodsList||[]}\n{var pIndex = 0}<!-- 排序计数 -->\n{list showGoodsList as saleGoods}<!-- 商品循环 -->\n    {if saleGoods.type==0}<!-- 显示商品 -->\n        <!-- {if saleGoods.goods.isShow!=0 && saleGoods.goods.onlineStatus!=0} --><!-- 判断商品是否需要显示 -->\n        {var pIndex = pIndex+1}\n        {if type=='newLineOfOne'||type=='newLineOfTwo'}\n            <!-- 显示新版一排一，一排二 -->\n            ${goods_newitem(zone,zoneIndex,saleGoods,type,pIndex,kaolaSystemTime)}\n        {elseif type=='maizeng-3'||type=='maizeng-4'||type=='maizeng-5'}\n            <!-- 显示买赠一排三，一排四，一排五 -->\n            ${goods_maizeng(zone,zoneIndex,saleGoods,type,pIndex,kaolaSystemTime)}\n        {else}\n            <!-- 显示常规的商品一排1,2,3,4,5 -->\n            ${goods_common(zone,zoneIndex,saleGoods,type,pIndex,kaolaSystemTime)}\n        {/if}\n        <!-- {/if} -->\n    {elseif saleGoods.type==1}<!-- 显示图片 -->\n        {var pIndex = pIndex+1}\n        <!-- 显示商品区域中的图片 -->\n        ${goods_image(zone,zoneIndex,saleGoods,type,pIndex,kaolaSystemTime)}\n    {/if}\n{/list}\n</div>\n</section>\n</article>\n");
I$(475,function (k,_e,_u,_v,_,t0,kinds,_$$TplModule,html,GoodsArea,p,o,f,r){
    var pro,
    	seed_html = t0._$add(_.minifyHtml(html));
    
    p._$$JstGoods = k._$klass();
    pro = p._$$JstGoods._$extend(_$$TplModule);
    
    pro.__reset = function(options){
        this.__super(options);
        //整理数据
        var data = this.__initData(options);
        //渲染模板
        this.__render(data);
        //模板插入后的操作
        this.__afterRender(this._$getBody());
    };
    /**
     * 整理数据
     */
    pro.__initData = function(options){
        this.__super();
        var zoneIndex = options.zoneIndex,
            zone = options.zone||{},
            kaolaSystemTime = +(options.kaolaSystemTime || 0),
            cfg = zone.zoneConfigMap||{},
            displayForm = cfg.displayForm||0,//13买赠
            showType = +(cfg.showType||'-1'),
            bgStyle = _._get_background(zone.zoneImageUrl,zone.backgroundColor,zone.imgLocation,cfg.bgPaddingTop),
            type = '';
        if(displayForm==13){
            type = 'maizeng-'+(showType+1);
        }else{
            switch(showType){
                case 0:type = 'lineOfOne';break;
                case 1:type = 'lineOfTwo';break;
                case 2:type = 'lineOfThree';break;
                case 3:type = 'lineOfFour';break;
                case 4:type = 'lineOfFive';break;
                case 5:type = 'newLineOfOne';break;
                case 6:type = 'newLineOfTwo';break;
            }
        }
        var data = {
            zone:zone,
            type:type,
            zoneIndex:zoneIndex,
            kaolaSystemTime:kaolaSystemTime,
            bgStyle:bgStyle
        }
        //整合各种商品模块
        _.merge(data,kinds);
        return data;
    };
    /**
     * 渲染模板
     */
    pro.__render = function(data){
        this.__super();//super一定要放在前面，避免在IE8等浏览器中，缓存节点innerHTML的时候不识别html5标签
        t0._$render(this._$getBody(),seed_html,data);
    };
    /**
     * 模板插入后的操作
     */
    pro.__afterRender = function(body){
        this.__super();
        GoodsArea._$allocate({
            parent:body,
            cbloginOk:this._$dispatchEvent._$bind(this,'cbloginOk')
        });
        _v._$dispatchEvent(window, "scroll");
    };
    
    return p._$$JstGoods;
},1,4,2,3,471,239,597,472,598,34);
I$(662,"<div class=\"brandWrap clearfix\"{if isRowOf34} ani=\"need\"{/if}>\n    <a class=\"brandImgLink{if isRowOf12} f-fl{/if}\" href=\"${brandLink|splitUrlHash}\" data-param=\"${dataParam}\" data-actda=\"${actDaParam}\" target=\"_blank\">\n      {if type==\"rowOfOne\"}\n      <img class=\"brandImg\" src=\"${brandImg|imgThumbnailUrl:640,320}\" title=\"${brandName}\">\n      {elseif type==\"rowOfTwo\"}\n      <img class=\"brandImg\" src=\"${brandImg|imgThumbnailUrl:270,270}\" title=\"${brandName}\">\n      {elseif type==\"rowOfThree\"}\n      <img class=\"brandImg\" src=\"${brandImg|imgThumbnailUrl:328,328}\" title=\"${brandName}\">\n      {else}\n      <img class=\"brandImg\" src=\"${brandImg|imgThumbnailUrl:244,244}\" title=\"${brandName}\">\n      {/if}\n    </a>\n    <a class=\"brandDesc{if isRowOf12} f-fl{/if}\" href=\"${brandLink|splitUrlHash}\" data-param=\"${dataParam}\" data-actda=\"${actDaParam}\" target=\"_blank\">\n      <img class=\"brandLogo\" src=\"${(brandDetail.logoPic||'')|imgThumbnailUrl:120,120}\" title=\"${brandName}\">\n      <p class=\"brandName\" title=\"${brandName}\">${brandName}</p>\n      {if type==\"rowOfOne\"}\n      <!-- 仅一排一显示品牌描述 -->\n      <p class=\"brandIntro\" title=\"${brandDetail.detailShort||''}\">${brandDetail.detailShort||''}</p>\n      {/if}\n      <p class=\"brandBenefit\" title=\"${brandConfig.benefitDesc||''}\">${brandConfig.benefitDesc||''}</p>\n      {if hasButton && !isBrandCoupon}\n      <span class=\"brandBtn\" style=\"${acButtonColor}${acTextColor}\">${acButtonName}</span>\n      {/if}\n      {if isRowOf12}\n      {if startTime > kaolaSystemTime}\n      <p class=\"brandTime start\" time=\"${startTime}\"><b></b>距开始：<span class=\"timeArea\"></span></p>\n      {elseif endTime > kaolaSystemTime}\n      <p class=\"brandTime end\" time=\"${endTime}\"><b></b>距结束：<span class=\"timeArea\"></span></p>\n      {/if}\n      {/if}\n    </a>\n    {if isBrandCoupon}\n    <p class=\"coupon\">\n      <a class=\"text f-cb j-brandcoupon couponExchange\" href=\"javascript:;\" schemeId=\"${brandConfig.couponRedeemCode||''}\" data-type='brandcoupon'>\n        <b class='j-kind'>${isCombinedCoupon?'礼包':'券'}</b><b class=\"val\"><i>¥${shareTicket.couponAmount||0}</i>&nbsp;&gt;</b>\n      </a>\n      {if hasButton}\n      <a class=\"couponBtn\" href=\"${brandLink|splitUrlHash}\" data-param=\"${dataParam}\" data-actda=\"${actDaParam}\" target=\"_blank\" style=\"${acButtonColor}${acTextColor}\">${acButtonName}</a>\n      {/if}\n    </p>\n    {/if}\n</div>\n");
I$(638,function (e1,_,html,p,o,f,r){
    var pro,
        seed_html = e1._$add(_.minifyHtml(html));
    return {
        brand_common:function(zone,zoneIndex,brand,type,bIndex,kaolaSystemTime){
            //全局变量
            var domainUrl = window.domainUrl || '//www.kaola.com/',
                activityId = window.activityId || '';
            //模块变量
            var cfg = zone.zoneConfigMap || {},
                hasButton = !!cfg.actionButton,//是否有行动点按钮
                button = cfg.actionButton || {},
                acButtonColor = "background-color:"+(button.acButtonColor||'#d22147')+";",
                acTextColor = "color:"+(button.acTextColor||'#fff')+";",
                acButtonName = (button.acButtonName||'去购买'),
                isBrandCoupon = type=="rowOfThree-coupon"||type=="rowOfFour-coupon",//是否是品牌领券
                isRowOf12 = type=="rowOfOne"||type=="rowOfTwo",//是否是一排一、二的品牌
                isRowOf34 = type=="rowOfThree"||type=="rowOfFour",//是否是一排三、四的品牌
                brandDetail = brand.brand || {},
                brandConfig = brand.goodsConfigMap || {},
                shareTicket = brandConfig.shareTicket || {},
                startTime = brandConfig.startTime || 0,
                endTime = brandConfig.endTime || 0,
                isCombinedCoupon = (shareTicket.isIngredientCoupon||0)==1,//是否是组合券
                brandUrl = brandConfig.brandUrl||'',
                brandLink = brandUrl!=''?brandUrl:(domainUrl+'brand/'+(brandDetail.brandId||'')+'.html'),
                brandName = brandDetail.name || '',
                dataParam = _.jointTjQuery(brandLink,activityId,'brand',zone.locateId,bIndex,cfg.zoneName),
                actDaParam = _.jointDaLabel(cfg.zoneName,zoneIndex,bIndex,brandLink);
            if((brand.goodsImage||'')!=''){
                var brandImg = brand.goodsImage||'';
            }else if(type=="rowOfOne"){
                var brandImg = brandDetail.zoneStripImgUrl||'';
            }else{
                var brandImg = brandDetail.h5ImageUrl||'';
            }
            //模板变量
            var data ={
                type:type,
                bIndex:bIndex,
                kaolaSystemTime:kaolaSystemTime,
                brandDetail:brandDetail,
                brandConfig:brandConfig,
                isBrandCoupon:isBrandCoupon,
                isRowOf12:isRowOf12,
                isRowOf34:isRowOf34,
                hasButton:hasButton,
                button:button,
                acButtonColor:acButtonColor,
                acTextColor:acTextColor,
                acButtonName:acButtonName,
                startTime:startTime,
                endTime:endTime,
                shareTicket:shareTicket,
                isCombinedCoupon:isCombinedCoupon,
                brandName:brandName,
                brandLink:brandLink,
                brandImg:brandImg,
                dataParam:dataParam,
                actDaParam:actDaParam
            };
            return e1._$get(seed_html,data,_);
        }
    }
},239,471,662);
I$(663,"<a href=\"${imageUrl|splitUrlHash}\" data-param=\"${dataParam}\" data-actda=\"${actDaParam}\" target=\"_blank\" class=\"${imgClass}\" style=\"background:url(${goodsImage}) no-repeat center;\"></a>");
I$(639,function (e1,_,html,p,o,f,r){
    var pro,
        seed_html = e1._$add(_.minifyHtml(html));
    return {
        brand_image:function(zone,zoneIndex,brand,type,bIndex){
            //全局变量
            var activityId = window.activityId || '';
            //模块变量
            var cfg = zone.zoneConfigMap || {},
                isBigAction = cfg.buyButtonStyle==1,
                imgClass = 'brandWrap',
                imageUrl = (brand.imageUrl||'')==''?'javascript:;':brand.imageUrl,
                goodsImage = brand.goodsImage || '',
                dataParam = _.jointTjQuery(imageUrl,activityId,'brand',zone.locateId,bIndex,cfg.zoneName),
                actDaParam = _.jointDaLabel(cfg.zoneName,zoneIndex,bIndex,imageUrl);
            //模板变量
            var data ={
                zone:zone,
                brand:brand,
                type:type,
                imgClass:imgClass,
                imageUrl:imageUrl,
                goodsImage:goodsImage,
                dataParam:dataParam,
                actDaParam:actDaParam
            };
            return e1._$get(seed_html,data,_);
        }
    }
},239,471,663);
I$(664,"<div class=\"brandWrap clearfix\">\n    <a class=\"brandDesc\" href=\"${brandLink|splitUrlHash}\" data-param=\"${dataParam}\" data-actda=\"${actDaParam}\" target=\"_blank\" title=\"${brandName}\">\n        <img class=\"brandLogo\" src=\"${(brandDetail.logoPic||'')|imgThumbnailUrl:120,120}\">\n        {if hasButton}\n        <span class=\"brandBenefit\">${brandConfig.benefitDesc||''}</span>\n        <span class=\"brandBtn\" style=\"background-color:${button.acButtonColor||'#d22147'};color:${button.acTextColor||'#fff'}\">${button.acButtonName||'进入品牌'}</span>\n        {/if}\n        <span class=\"follow\" brandId=\"${brandDetail.brandId||''}\"></span>\n        <span class=\"toast\">已关注</span>\n    </a>\n</div>");
I$(640,function (e1,_,html,p,o,f,r){
    var pro,
        seed_html = e1._$add(_.minifyHtml(html));
    return {
        brand_wall:function(zone,zoneIndex,brand,type,bIndex){
            //全局变量
            var domainUrl = window.domainUrl || '//www.kaola.com/',
                activityId = window.activityId || '';
            //模块变量
            var cfg = zone.zoneConfigMap || {},
                hasButton = !!cfg.actionButton,//是否有行动点按钮
                button = cfg.actionButton || {},
                brandDetail = brand.brand || {},
                brandConfig = brand.goodsConfigMap || {},
                brandUrl = brandConfig.brandUrl||'',
                brandLink = brandUrl!=''?brandUrl:(domainUrl+'brand/'+(brandDetail.brandId||'')+'.html'),
                brandName = brandDetail.name || '',
                dataParam = _.jointTjQuery(brandLink,activityId,'brand',zone.locateId,bIndex,cfg.zoneName),
                actDaParam = _.jointDaLabel(cfg.zoneName,zoneIndex,bIndex,brandLink);
            //模板变量
            var data ={
                type:type,
                bIndex:bIndex,
                brandDetail:brandDetail,
                brandConfig:brandConfig,
                hasButton:hasButton,
                button:button,
                brandName:brandName,
                brandLink:brandLink,
                dataParam:dataParam,
                actDaParam:actDaParam
            };
            return e1._$get(seed_html,data,_);
        }
    }
},239,471,664);
I$(599,function (b0,b1,b2,_,p,o,f,r){
    
	var data ={},i=0,l=arguments.length-5;
	for(;i<l;i++){
		_.merge(data,arguments[i]);
	}

	return data;
},638,639,640,471);
I$(600,"<article id=\"${zone.locateId||''}\" class=\"m-brandarea\" imgLocation=\"${zone.imgLocation||'0'}\" style=\"${bgStyle}\">\n<section class=\"${type} brandSec\">\n<section class=\"brandBox clearfix\">\n{var showGoodsList = zone.showGoodsList||[]}\n{var bIndex = 0}<!-- 排序计数 -->\n{list showGoodsList as brand}<!-- 品牌循环 -->\n    {if brand.type==2}\n        <!-- 显示品牌 -->\n        {if !(!!brand.goodsConfigMap && !!brand.goodsConfigMap.endTime && brand.goodsConfigMap.endTime<kaolaSystemTime)}<!-- 判断品牌是否已结束 -->\n            {var bIndex = bIndex+1}\n            {if type==\"rowOfSix\"}\n                <!-- 品牌墙 -->\n                ${brand_wall(zone,zoneIndex,brand,type,bIndex)}\n            {else}\n                <!-- 品牌 一排1,2,3,4,领券 -->\n                ${brand_common(zone,zoneIndex,brand,type,bIndex,kaolaSystemTime)}\n            {/if}\n        {/if}\n    {elseif brand.type==1}\n        <!-- 显示图片 -->\n        {var bIndex = bIndex+1}\n        <!-- 显示品牌区域中的图片 -->\n        ${brand_image(zone,zoneIndex,brand,type,bIndex)}\n    {/if}\n{/list}\n</section>\n</section>\n</article>\n");
I$(476,function (k,_e,_u,_v,_,t0,kinds,_$$TplModule,html,BrandArea,p,o,f,r){
    var pro,
    	seed_html = t0._$add(_.minifyHtml(html));
    
    p._$$JstBrand = k._$klass();
    pro = p._$$JstBrand._$extend(_$$TplModule);
    
    pro.__reset = function(options){
        this.__super(options);
        //整理数据
        var data = this.__initData(options);
        //渲染模板
        this.__render(data);
        //模板插入后的操作
        this.__afterRender(this._$getBody(),data.kaolaSystemTime);
    };

    pro.__initData = function(options){
        this.__super();
        //模块变量
        var zone = options.zone||{},
            zoneIndex = options.zoneIndex,
            kaolaSystemTime = +(options.kaolaSystemTime || 0),
            cfg = zone.zoneConfigMap||{},
            displayStyle = +(cfg.displayStyle||0),//展示样式:0正常样式，1领券样式
            showType = +(cfg.showType||'-1'),
            bgStyle = _._get_background(zone.zoneImageUrl,zone.backgroundColor,zone.imgLocation,cfg.bgPaddingTop),
            type = '';
        if(displayStyle==0){
            switch(showType){
                case 1:type = 'rowOfOne';break;
                case 2:type = 'rowOfTwo';break;
                case 3:type = 'rowOfThree';break;
                case 4:type = 'rowOfFour';break;
                case 6:type = 'rowOfSix';break;
            }
        }else if(displayStyle==1){
            switch(showType){
                case 3:type = 'rowOfThree-coupon';break;
                case 4:type = 'rowOfFour-coupon';break;
            }
        }
        //模板变量
        var data = {
            zone:zone,
            type:type,
            kaolaSystemTime:kaolaSystemTime,
            zoneIndex:zoneIndex,
            bgStyle:bgStyle
        }
        //整合各种品牌模块
        _.merge(data,kinds);
        return data;
    };

    pro.__render = function(data){
        this.__super();
        t0._$render(this._$getBody(),seed_html,data);
    };

    pro.__afterRender = function(body,kaolaSystemTime){
        this.__super();
        BrandArea._$allocate({
            parent:body,
            kaolaSystemTime:kaolaSystemTime,
            cbloginOk:this._$dispatchEvent._$bind(this,'cbloginOk')
        });
        _v._$dispatchEvent(window, "scroll");
    };
    
    return p._$$JstBrand;
},1,4,2,3,471,239,599,472,600,32);
I$(601,"<article id=\"${locateId||''}\" class=\"m-brandarea m-brandarea-tj\" style=\"background-color: ${bgColor};\">\n<section class=\"${type} brandSec\">\n<section class=\"brandBox clearfix\">\n{var bIndex = 0}<!-- 排序计数 -->\n{list blist as brand}\n    {var bIndex = bIndex+1}\n    <!-- 品牌推荐 -->\n    <div class=\"brandWrap clearfix\" ani=\"need\">\n        {var brandLink = domainUrl+'brand/'+(brand.brandId||'')+'.html'}\n        <a class=\"brandImgLink\" href=\"${brandLink}\" data-param=\"${jointTjQuery2(brandLink,brand.brandName,bIndex,brand.recId)}\" target=\"_blank\">\n          <img class=\"brandImg\" src=\"${(brand.h5ImageUrl||'')|imgThumbnailUrl:244,244}\" title=\"${brand.brandName}\">\n        </a>\n        <a class=\"brandDesc\" href=\"${brandLink}\" data-param=\"${jointTjQuery2(brandLink,brand.brandName,bIndex,brand.recId)}\" target=\"_blank\">\n          <img class=\"brandLogo\" src=\"${(brand.logoPic||'')|imgThumbnailUrl:120,120}\" title=\"${brand.brandName}\">\n          <p class=\"brandName\" title=\"${brand.brandName}\">${brand.brandName}</p>\n          <p class=\"brandBenefit\" title=\"${brand.benefitPoint||''}\">${brand.benefitPoint||''}</p>\n        </a>\n    </div>\n{/list}\n</section>\n</section>\n</article>\n");
I$(477,function (k,_e,_u,_v,_,t0,kinds,_$$TplModule,html,BrandArea,p,o,f,r){
    var pro,
    	seed_html = t0._$add(_.minifyHtml(html));
    
    p._$$JstBrand = k._$klass();
    pro = p._$$JstBrand._$extend(_$$TplModule);
    
    pro.__reset = function(options){
        this.__super(options);
        //整理数据
        var data = this.__initData(options);
        //渲染模板
        this.__render(data);
    };

    pro.__initData = function(options){
        this.__super();
        //全局变量
        var domainUrl = window.domainUrl || '//www.kaola.com/',
            activityId = window.activityId || '';
        //模块变量
        var obj = options.data||{},
            id = options.id,
            zoneIndex = options.zoneIndex,
            type = 'rowOfFour';
        //模板变量
        var data = {
            blist:obj.brandList||[],
            locateId:id,
            type:type,
            activityId:activityId,
            domainUrl:domainUrl,
            zoneIndex:zoneIndex,
            bgColor:obj.bgColor
        }
        var jointTjQuery2 = function(url,name,zp,recId){
            var str = _.jointTjQuery(url,activityId,'',id,_.encode(name)+'-'+zp,'personalbrand');
            str += '&recId='+(recId||'');
            return str;
        }
        //模板中添加jointTjQuery2方法
        _.merge(data,{
            jointTjQuery2:jointTjQuery2
        });
        return data;
    };

    pro.__render = function(data){
        this.__super();
        t0._$render(this._$getBody(),seed_html,data,_);
    };

    return p._$$JstBrand;
},1,4,2,3,471,239,599,472,601,32);
I$(478,function (k,_e,_u,_v,_,_$$TplModule,SeckillModule,p,o,f,r){
    var pro;
    
    p._$$SeckillArea = k._$klass();
    pro = p._$$SeckillArea._$extend(_$$TplModule);
    
    pro.__reset = function(options){
        this.__super(options);
        var data = this.__initData(options);
        if(data){
            this.__renderSeckill(data);
        }
    };

    pro.__initData = function(options){
        var zone = options.zone || {},
            id = zone.locateId||('seckillArea'+options.zoneIndex);
        if(!!zone.seckillModuleJson){
            return {
                config:zone.zoneConfigMap||{},
                json:JSON.parse(zone.seckillModuleJson||'{}'),
                id:id,
                kaolaSystemTime:options.kaolaSystemTime
            }
        }else{
            var node = document.getElementById(id);
            node.parentNode.removeChild(node);
            return false;
        }
    };

    pro.__renderSeckill = function(seckill){
        //秒杀模板
        var module = new SeckillModule({
            data: {
                zone: seckill.json || {},
                kaolaSystemTime:seckill.kaolaSystemTime,
                days: seckill.json.groupList || [],
                config: seckill.config || {}
            }
        });
        //商品加载触发回调
        module.$on("inject", this.__triggerScroll._$bind(this));
        //商品切换触发回调
        module.$on("goodsChange", this.__triggerScroll._$bind(this));
        //登录成功后回调
        module.$on("cbloginOk", this._$dispatchEvent._$bind(this,'cbloginOk'));

        var area = document.getElementById(seckill.id);
        //清除模块loading效果
        area.innerHTML = "";
        //加载模块
        module.$inject(area);
    };

    pro.__triggerScroll = function(){
        //触发scroll，重新定位侧滑快速侧滑
        _v._$dispatchEvent(window, "scroll");
    };

    
    return p._$$SeckillArea;
},1,4,2,3,471,472,266);
I$(602,function (_k,_ut,_v,_t,_e,$,Bezier,_,_p,_o,_f,_r,_pro) {
        var pro;

        _p._$$Switch = _k._$klass();
        _pro = _p._$$Switch._$extend(_t._$$EventTarget);

        /**
         * 控件初始化
         * @param  {Object} 配置参数
         * @return {Void}
         * node:Node,			图片容器节点
           gap:Number           图片间距
           duration:Number      每次滚动持续时间
           timing:String        timingFunction name
           count:Number         每次滚动的图片张数
           autoPlay:Boolean     是否自动轮播
           delay:Number         自动轮播间隔时间
		   onstop:Function	    单次滚动停止时回调函数
         */
        _pro.__reset = function(_options){
            this.__super(_options);
            var node = _options.node;
            if(!node)
                return;
            this.__listBox = _e._$getByClassName(node,'j-list')[0];
            this.__list = _e._$getChildren(this.__listBox);
            this.__preBtn = _e._$getByClassName(node,'j-pre')[0];
            this.__nextBtn = _e._$getByClassName(node,'j-next')[0];
            this.__length = this.__list.length;
            this.gap = _options.gap || 0;
            this.duration = _options.duration||300;
            this.timing = _options.timing||'easeinout';
            this.count = _options.count || 4;//每次滚动的个数
            this.autoPlay = !!_options.autoPlay; //是否自动播放
            this.delay = _options.delay || 5000;    // 自动播放间隔时间
            this.stopCB = _options.onstop || null; //回调
            this.__init();
        };

        _pro.__init = function(){
            if(this.__listBox && this.__length){
                this.itemWidth = this.__list[0].offsetWidth + this.gap;
                $(this.__listBox)._$style({"width":(this.itemWidth * this.__length)+'px',"left":"0px"});
                if(this.__length>4){
                    this.__setNode('left');
                }
                $(this.__listBox)._$style({"visibility":"visible"}); //预先左移后再可见
                _v._$addEvent(this.__preBtn,'click', this.__clickBtn._$bind(this,'left'));
                _v._$addEvent(this.__nextBtn,'click', this.__clickBtn._$bind(this,'right'));
                if(this.autoPlay){
                    //自动播放
                    if(this.timer){
                        clearInterval(this.timer);
                    }
                    this.timer = setInterval(this.__doAnimation._$bind(this,'right'),this.delay);
                }
            }
        };

        _pro.__clickBtn = function(dir){
            var node = dir=='left'?this.__preBtn:this.__nextBtn;
            var param = _e._$dataset(node,'param');
            var params = param.split('@@');
            this.__doAnimation(dir);
            _.daEvent(params[0]||'个性化会场', params[1]||'点击',params[2]||dir);
        };

        _pro.__setNode = function(dir){
            var c = this.count,l = this.__length;
            if(dir=='right'){
                for(var i=0;i<c;i++){
                    var lstNode = $(this.__listBox);
                    var tmpnode = lstNode._$children('a:first-child');
                    $(tmpnode)._$clone(true)._$insert2(this.__listBox,'bottom');
                    $(tmpnode)._$remove();
                }
            }else{
                for(var i=l-1;i>=l-c;i--){
                    var lstNode = $(this.__listBox);
                    var tmpnode = lstNode._$children('a:last-child');
                    $(tmpnode)._$clone(true)._$insert2(this.__listBox,'top');
                    $(tmpnode)._$remove();
                }
            }
            $(this.__listBox)._$style({"left":-this.itemWidth*c+'px'});
        };

        // 滚动动画
        _pro.__doAnimation = function(dir){
            var node = this.__listBox,
                self=this,
                end = this.itemWidth * this.count,
                left = parseFloat(node.style.left);
            if(this.inAnimation)
                return;
            if(dir=='right'){
                end = - end;
            }
            Bezier._$$AnimBezier._$allocate({
                from: {offset: left},
                to: {offset: left + end},
                duration:this.duration,
                timing:this.timing,
                onupdate:function(_event){
                    node.style.left = _event.offset+'px';
                },
                onstop:function(){
                    self.inAnimation = false;
                    self.stopCB && self.stopCB();
                    setTimeout(function(){self.__setNode(dir);},0);
                    this._$recycle();
                }
            })._$play();
            this.inAnimation = true;
        };

        return _p._$$Switch;
    },1,2,3,23,4,79,96,15);
I$(603,"<!-- 会场推荐 -->\n<article id=\"${id}\" class=\"m-placeRec\" style=\"background-color: ${bgColor};height: ${height}px;\">\n  <section class=\"imgWrap clearfix\">\n    <div class=\"imgbox j-list\" style=\"visibility: hidden;\">\n      {list list as item}\n      <a class=\"imgLink\" href=\"${item.imageLink|splitUrlHash}\" data-index=\"${item_index}\" data-param=\"${jointTjQuery2(item.imageLink,item.showName, item_index+1,item.recId)}\" target=\"_blank\"><img src=\"${item.imageUrl|imgThumbnailUrl:244,0,85}\"></a>\n      {/list}\n      {if list.length < 12 && list.length > 4}\n      {list list as item}\n      <a class=\"imgLink\" href=\"${item.imageLink|splitUrlHash}\" data-index=\"${item_index}\" data-param=\"${jointTjQuery2(item.imageLink,item.showName, item_index+1,item.recId)}\" target=\"_blank\"><img src=\"${item.imageUrl|imgThumbnailUrl:244,0,85}\"></a>\n      {/list}\n      {if list.length < 8}\n      {list list as item}\n      <a class=\"imgLink\" href=\"${item.imageLink|splitUrlHash}\" data-index=\"${item_index}\" data-param=\"${jointTjQuery2(item.imageLink,item.showName, item_index+1,item.recId)}\" target=\"_blank\"><img src=\"${item.imageUrl|imgThumbnailUrl:244,0,85}\"></a>\n      {/list}\n      {/if}\n      {/if}\n    </div>\n    {if list.length > 4}\n    <div class=\"u-ctrl\">\n      <b class=\"dir prev j-pre\" data-param=\"个性化会场@@点击@@左切\"></b>\n      <b class=\"dir next j-next\" data-param=\"个性化会场@@点击@@右切\"></b>\n    </div>\n    {/if}\n  </section>\n</article>");
I$(479,function (k,_e,_u,_v,$,t0,_,_$$TplModule,Switch,html,p,o,f,r){
    var pro,
    	seed_html = t0._$add(_.minifyHtml(html));
    
    p._$$PlaceRecmd = k._$klass();
    pro = p._$$PlaceRecmd._$extend(_$$TplModule);
    
    pro.__reset = function(options){
        var data = options.data;
        this.__super(options);
        //整理数据
        data.id = options.id;
        data = this.__initData(data);
        //渲染模板
        this.__render(data);
        //模板插入后的操作
        this.__afterRender();
    };

    pro.__initData = function(data){
        this.__super();
        var locateId = data.id,
            activityId = window.activityId || '';
        //模板变量
        var obj = data || {};
        var jointTjQuery2 = function(url,name,zp,recId){
            var str = _.jointTjQuery(url,activityId,'',locateId,_.encode(name)+'-'+zp,'personalmall');
            str += '&recId='+(recId||'');
            return str;
        }
        //模板中添加jointDaLabel方法
        _.merge(obj,{
            jointDaLabel:_.jointDaLabel,
            jointTjQuery2:jointTjQuery2
        });
        obj.height = data.list[0].height || 244;
        return obj;
    };

    pro.__render = function(data){
        this.__super();
        t0._$render(this._$getBody(),seed_html,data,_);
    };

    pro.__afterRender = function(){
        this.__super();
        Switch._$allocate({
            node:this.__body,
            duration:300,
            gap:8
        });
    };

    return p._$$PlaceRecmd;
},1,4,2,3,79,239,471,472,602,603);
I$(604,"<article class=\"m-couponarea m-couponarea-${showType||3}\" style=\"${areaBgStyle}\">\n\t<section class=\"couponBox\" {if boxWidth!=1000}style=\"${boxStyle}\"{/if}>\n\t\t<div class=\"couponWrap f-cb\">\n\t\t\t{list list as coupon}\n\t\t\t<div class='coupon' style=\"${imgAreaBgStyle}\">\n\t\t\t\t<div class='detail f-cb'>\n\t\t\t\t\t<span class='price'>¥<b>${coupon.couponAmount||0}</b></span>\n\t\t\t\t\t<span class='condition'>\n\t\t\t\t\t\t<b title=\"${coupon.couponThreshold||''}\">${coupon.couponThreshold||''}</b>\n\t\t\t\t\t\t<b title=\"${replaceBr(coupon.couponTitle)}\">${replaceBr(coupon.couponTitle)}</b>\n\t\t\t\t\t</span>\n\t\t\t\t\t<i class='line'></i>\n\t\t\t\t</div>\n\t\t\t\t<a class='get couponExchange' schemeId=\"${coupon.redeemCode||''}\" href=\"javascript:;\">立即领取&gt;</a>\n\t\t\t\t{if coupon.expireTimeType==1}\n\t\t\t\t<p class='expires'>使用期限：领取后${coupon.expireDays||''}天内有效</p>\n\t\t\t\t{else}\n\t\t\t\t<p class='expires'>使用期限：${formatTime(coupon.couponActiveTime,'yyyy.MM.dd')}-${formatTime(coupon.couponExpireTime,'yyyy.MM.dd')}</p>\n\t\t\t\t{/if}\n\t\t\t\t<span class='gap gap-left' style=\"${areaBgStyle}\"></span>\n\t\t\t\t<span class='gap gap-right' style=\"${areaBgStyle}\"></span>\n\t\t\t</div>\n\t\t\t{/list}\n\t\t</div>\n\t</section>\n</article>");
I$(480,function (k,_e,_u,_v,t0,_,_$$TplModule,html,p,o,f,r){
    var pro,
    	seed_html = t0._$add(_.minifyHtml(html));
    
    p._$$Coupon = k._$klass();
    pro = p._$$Coupon._$extend(_$$TplModule);
    
    pro.__reset = function(options){
        var list = options.json.data||[];
        if(list.length==0){return;}
        this.__super(options);
        //整理数据
        var data = this.__initData(options);
        //渲染模板
        this.__render(data);
    };

    pro.__initData = function(options){
        this.__super(options);
        //模块变量
        var list = options.json.data||[],
            len = list.length,
            showType = len<4?3:4,//3.一排三 4.一排四
            areaBgColor = options.areaBgColor||'#fff',//优惠券模块背景色
            imgAreaBgColor = options.imgAreaBgColor||'#ffcd75',//优惠券图片背景色
            areaBgStyle = 'background:'+areaBgColor+';',
            imgAreaBgStyle = 'background:'+imgAreaBgColor+';',
            boxWidth = 1000;//当优惠券数量少于3个时，以一排三的样式居中展示
        switch(len){
            case 1:boxWidth=324;break;
            case 2:boxWidth=662;break;
        }
        var boxStyle = 'width:'+boxWidth+'px;';
        //模板变量
        var data = {
            list:list,
            showType:showType,
            areaBgStyle:areaBgStyle,
            imgAreaBgStyle:imgAreaBgStyle,
            boxWidth:boxWidth,
            boxStyle:boxStyle
        }
        //模板中添加jointDaLabel方法
        _.merge(data,{
            jointDaLabel:_.jointDaLabel,
            formatTime:_.formatTime,
            replaceBr:function(str){
                return (str||'').replace(/<br>|<br\/>/gmi,' ');
            }
        });
        return data;
    };

    pro.__render = function(data){
        this.__super();
        t0._$render(this._$getBody(),seed_html,data);
    };
    
    return p._$$Coupon;
},1,4,2,3,239,471,472,604);
I$(284,function (_k,_ut,_,_v,_t,_e,$,_$$JstGoods,_$$JstBrand,_$$JstBrandRecmd, _$$SeckillArea,_$$PlaceRecommend,_$$Coupon,_p,_o,_f,_r,_pro) {
        var _pro;

        var _$$ZoneMap = _k._$klass();
        _pro = _$$ZoneMap._$extend(_t._$$EventTarget);
        
        _pro.__reset = function(_options) {
            this.__supInit(_options);
            this.__initJstMap();
            this.__zoneMap(_options);
        };

        _pro.__zoneMap = function(_options){
					_options = this.__extendOptions(_options,['id','zoneKind','zoneIndex','isRecommend']);
          switch(+_options.zoneKind){
            case 1://异步化商品模块
            case 9:
              if(_options.zoneKind==9&&_options.isRecommend=='1'){//异步化品牌模块 or isRecommend==1推荐品牌模块
                this.__renderBrandRecmd(_options);
                break;
              }
            case 16:this.__renderJst(_options);break;//异步化秒杀模块
            case 21:this.__renderCoupon(_options);break;//优惠券模块
            case 22:this.__renderZoneRecmd(_options);break;//会场推荐模块
            default:;
          }
        };
        /**
         * 异步化商品、品牌、秒杀模块
         */
        _pro.__renderJst = function(_options){
          var id = _options.id,
              zoneIndex = _options.zoneIndex,
              zoneKind = _options.zoneKind,
              zoneList = _options.json.zone_data||[],
              kaolaSystemTime = _options.json.kaolaSystemTime||window.kaolaSystemTime;
          if(!id){return;}
          _ut._$forEach(zoneList,function(zone){
            var __$$JstModule = this.__jstMap[zoneKind];
            if(!!__$$JstModule){
              __$$JstModule._$allocate({
                id:id,
                zoneIndex:zoneIndex,
                kaolaSystemTime:kaolaSystemTime,
                zone:zone,
                cbloginOk:this._$dispatchEvent._$bind(this,'cbloginOk')
              });
            }
          },this);
        };
        /**
         * å¼‚æ­¥åŒ–å•†å“ã€å“ç‰Œã€ç§’æ€æ¨¡å—
         */
        _pro.__initJstMap = function(){
          this.__jstMap = {
            '1':_$$JstGoods,
            '9':_$$JstBrand,
            '16':_$$SeckillArea
          };
        };
        /**
         * ä¼˜æƒ åˆ¸æ¨¡å—
         */
        _pro.__renderCoupon = function(_options){
          _options = this.__extendOptions(_options,['imgAreaBgColor','areaBgColor']);
          _$$Coupon._$allocate(_options);
        };
        //ä¼šåœºæŽ¨èæ¨¡å—
        _pro.__renderZoneRecmd = function(_options){
          var id = _options.id,
              zoneIndex = _options.zoneIndex,
              zoneKind = _options.zoneKind,
              list = _options.json.data||[],
              bgColor = $('#'+id)._$attr('bgColor'),
              data = {list:list,bgColor:bgColor};
          _$$PlaceRecommend._$allocate({
            id:id,
            zoneIndex:zoneIndex,
            zoneKind:zoneKind,
            data:data
          });
        };
        //å“ç‰ŒæŽ¨èæ¨¡å—
        _pro.__renderBrandRecmd = function(_options){
          var id = _options.id,
              zoneIndex = _options.zoneIndex,
              zoneKind = _options.zoneKind,
              data = _options.json.data||{};
          _$$JstBrandRecmd._$allocate({
            id:id,
            zoneIndex:zoneIndex,
            zoneKind:zoneKind,
            data:data
          });
        };
		    /**
         * æ‰©å……options
         */
        _pro.__extendOptions = function(options,attrList){
          _.extend(options,this.__getNodeAttr(options.node,attrList),true);
          return options;
        };
        /**
         * ä»Žnodeä¸­èŽ·å–å±žæ€§
         */
        _pro.__getNodeAttr = function(node,attrList){
          var obj = {};
          _ut._$forEach(attrList||[],function(attr){
            obj[attr] = _e._$attr(node,attr)||'';
          });
          return obj;
        };

        return _$$ZoneMap;
    },1,2,15,3,23,4,79,475,476,477,478,479,480);
I$(72,function (_k,_ut,_v,_t,_e,_,$,Request,_$$ZoneMap,_p,_o,_f,_r,_pro) {
        var _pro;

        var _$$Scroll2getZone = _k._$klass();
        _pro = _$$Scroll2getZone._$extend(_t._$$EventTarget);
        
        _pro.__reset = function(_options) {
            this.__supInit(_options);
            this.__cfg(_options);
            this.__bindScroll();
        };
        /**
         * å¤„ç†é…ç½®
         */
        _pro.__cfg = function(_opt){
            this._detectClass = _opt.detectClass||'.j-async';//éœ€è¦æ£€æµ‹çš„èŠ‚ç‚¹æ ·å¼
            this._exploreDist = _opt.exploreDist||200;//æ£€æµ‹çš„å±å¹•å‘å¤–æ‰©å±•è·ç¦»
            this._inAjax = {};//å½“å‰æ¨¡å—æ˜¯å¦æ­£åœ¨è¯·æ±‚ä¸­
            this._ajaxCount = {};//å½“å‰æ¨¡å—å‘é€ajaxè¯·æ±‚çš„æ¬¡æ•°
        };
        /**
         * ç»‘å®šæ»šåŠ¨äº‹ä»¶
         */
        _pro.__bindScroll = function(){
            this.__onWinScrollThrottle = _.throttle(this.__onWinScroll._$bind(this),100);
            _v._$addEvent(window,'scroll',this.__onWinScrollThrottle);
            //é¦–æ¬¡ç»‘å®šæ‰‹åŠ¨è§¦å‘æ»šåŠ¨
            _v._$dispatchEvent(window,'scroll');
        };
        /**
         * æ»šåŠ¨æ—¶æ£€æµ‹ æ˜¯å¦éœ€è¦åŠ è½½æ•°æ®
         */
        _pro.__onWinScroll = function(){
            var asyncNode = $(this._detectClass);
            if(!asyncNode.length){
              // è§£ç»‘äº‹ä»¶
              _v._$delEvent(window,'scroll',this.__onWinScrollThrottle);
              return;
            }
            asyncNode._$forEach(function(node){
              //å¦‚æžœåœ¨è§†å£ä¸­ï¼Œè¯·æ±‚å…¨éƒ¨æ•°æ®
              this.__isInViewPort(node) && this.__getZoneData(node);
            }._$bind(this));
        };
        /**
         * æ˜¯å¦åœ¨è§†å£ä¸­
         */
        _pro.__isInViewPort = function(node){
            var rect = node.getBoundingClientRect(),
                top = rect.top || 0,
                bottom = rect.bottom || 0,
                exploreDist = this._exploreDist,
                viewportH = document.documentElement.clientHeight + exploreDist,
                isHidden = top==0 && bottom==0;//ffã€chromeçš„éšè—èŠ‚ç‚¹topã€bottomä¸º0
            return !isHidden && ((top > -exploreDist && top < viewportH) ||
                    (bottom > -exploreDist && bottom < viewportH) ||
                    (top < -exploreDist && bottom > viewportH));
        };
        /**
         * æ ¹æ®zonekindç¡®å®šè¯·æ±‚url
         */
        _pro.__getRequestUrl = function(node){
            var url = '',
                isPreview = window.syncData.isPreview,//æ˜¯å¦æ˜¯é¢„è§ˆ
                activityId = window.activityId,
                id = _e._$attr(node,'id'),
                isRecommend = _e._$attr(node,'isRecommend'),
                zoneKind = +_e._$attr(node,'zoneKind');
            switch(zoneKind){
                case 1://å•†å“æ¨¡å—
                    if(isRecommend=='1'){ // å•†å“æŽ¨è
                      url = '/activity/get/recommend_goods_list/'+activityId+'/'+id+'.html';
                      url += isPreview?'?isPreview=1':''
                      break;
                    }
                case 9://å“ç‰Œæ¨¡å—
                    if(isRecommend=='1' && zoneKind==9){ // å“ç‰ŒæŽ¨è
                      url = '/activity/get/recommend_brand_list/'+activityId+'/'+id+'.html';
                      url += isPreview?'?isPreview=1':''
                      break;
                    }
                case 16: //ç§’æ€æ¨¡å—
                    url=isPreview?'/activityshow/preview/getActivityShowZone/'+activityId+'/'+id+'.html':'/activity/detail/getActivityShowZone/'+activityId+'/'+id+'.shtml';
                    break;
                case 21: //ä¼˜æƒ åˆ¸æ¨¡å—
                    url=isPreview?'/activity/preview/coupon/getCouponShowZone/'+activityId+'/'+id+'.html':'/activity/coupon/getCouponShowZone/'+activityId+'/'+id+'.shtml';break;
                case 22: //ä¼šåœºæŽ¨èæ¨¡å—
                    url='/activity/get/recommend_show_list.html';break;
                default:;
            }
            return url;
        };
        /**
         * èŽ·å–zoneçš„å…¨éƒ¨æ•°æ®
         */
        _pro.__getZoneData = function(node){
            var id = _e._$attr(node,'id'),
                url = this.__getRequestUrl(node);
            // åˆ¤æ–­å½“å‰æ¨¡å—æ˜¯å¦åœ¨è¯·æ±‚ä¸­ ä»¥åŠ è¯·æ±‚æ¬¡æ•°æ˜¯å¦å¤§äºŽ3æ¬¡
            var inAjax = !!this._inAjax[id],
                ajaxCount = this._ajaxCount[id]||0;
            if(inAjax || ajaxCount>2){
                // è‹¥è¯·æ±‚æ¬¡æ•°å¤§äºŽ3ï¼Œåˆ é™¤å¼‚æ­¥åŠ è½½æ ‡è®°
                ajaxCount>2 && _e._$delClassName(node,'j-async');
                return;
            }
            this._inAjax[id] = true;
            this._ajaxCount[id] = ajaxCount+1;
            //æœ¬åœ°æµ‹è¯•å‡æ•°æ® startã€‚ã€‚ã€‚ã€‚ã€‚ã€‚
            //,'./fakeData.js' -> fakeData
            // _ut._$forEach(fakeData,function(data){
            //    var node = document.getElementById(data.locateId),
            //        zoneKind = +_e._$attr(node,'zoneKind'),
            //        json = {};
            //     switch(zoneKind){
            //         case 1:case 9:case 16:json={zone_data:[data],kaolaSystemTime:1300366850000};break;
            //         case 21:json=data;break;
            //         default:json=data;break;
            //     }
            //    data.locateId==id && _$$ZoneMap._$allocate({
            //        node:node,
            //        json:json,
            //        'cbloginOk':this._$dispatchEvent._$bind(this,'cbloginOk')
            //    }) && _e._$delClassName(node,'j-async') && (this._inAjax[id]=false);
            // }._$bind(this));
            // return;
            //æœ¬åœ°æµ‹è¯•å‡æ•°æ® endã€‚ã€‚ã€‚ã€‚ã€‚ã€‚
            Request(url,{
              method:'get',
              norest:true,
              onload:function(_json){
                var json = _json||{};
                if(json.success){
                  // æ’å…¥jstæ¨¡æ¿
                  _$$ZoneMap._$allocate({
                      node:node||{},
                      json:json,
                      cbloginOk:this._$dispatchEvent._$bind(this,'cbloginOk')
                  });
                  //åˆ é™¤å¼‚æ­¥åŠ è½½æ ‡è®°
                  _e._$delClassName(node,'j-async');
                }else{
                  //remove node
                  _e._$remove(id,false);
                }
                this._inAjax[id] = false;
              }._$bind(this),
              onerror:function(_json){
                  this._inAjax[id] = false;
              }._$bind(this)
            });
        };

        return _$$Scroll2getZone;
    },1,2,3,23,4,15,25,6,284);
I$(49,function (_k, _ut, _t, _v, _e,
            _p, _o, _f, _r, _pro) {

  	// æ ¹æ®æ¯«ç§’æ•°è®¡ç®—å‰©ä½™æ—¶é—´å¯¹è±¡
    var __getTimeObj = (function(){
        //è½¬åŒ–ä¸ºä¸¤ä½æ•°å­—
        var fillZ = function( N ){
            return (N < 10 ? "0" : "" )+N;
        };
        var onemin = 60000, onehour = 60*onemin, oneday = 24*onehour;
        return function(num){
            var time = +num > 0 ? +num : 0;
            var d = parseInt(time / oneday, 10),
                h = parseInt(time % oneday / onehour, 10),
                m = parseInt(time % oneday % onehour / onemin, 10),
                s = parseInt(time % oneday % onehour % onemin / 1000, 10),
                ms = parseInt(time % oneday % onehour % onemin % 1000, 10);
            //ä¼˜åŒ–ä¸´ç•Œç‚¹æ˜¾ç¤º
            if (d === 1 && h === 0) {
                d = 0;
                h = 24;
            }
            return {
                d : d, h : h, m: m, s : s, ms:ms,
                dd : fillZ(d), hh: fillZ(h), mm : fillZ(m), ss : fillZ(s)
            };
        };
    })();

    /**
     * å€’è®¡æ—¶æŽ§ä»¶å°è£…
     *
     * @extends module:util/event._$$EventTarget
     *
     * @param    {Object}  config   - å¯é€‰é…ç½®å‚æ•°
     * @property {Number}  dvalue 	- kaolasystemæ—¶é—´ å‡åŽ» æœ¬åœ°æ—¶é—´ çš„å·®å€¼ï¼Œç”¨æ¥è°ƒæ•´ç”±äºŽjsæ‰§è¡Œå…¶ä»–å‘½ä»¤å¯¼è‡´çš„settimeoutå»¶è¿Ÿ
     * @property {Number}  deadline    - æœ€ç»ˆçš„ç»“æŸæ—¶é—´
     * @property {String}  parentnode    - çˆ¶èŠ‚ç‚¹
     * @property {Boolean} nodeflag  - èŽ·å–åˆ†ç§’ç­‰èŠ‚ç‚¹çš„classnameæ ‡è¯†
     */
    
    _p._$$CountDown = _k._$klass();
    _pro = _p._$$CountDown._$extend(_t._$$EventTarget);

    _pro.__reset = function(_options) {
    	this.__super(_options);
    	this.__dvalue = Number(_options.dvalue);
    	this.__deadLine = Number(_options.deadline);
    	this.__parent = _options.parentnode;
    	this.__timeNodes = _e._$getByClassName(this.__parent, _options.nodeflag);

    	//åˆå§‹åŒ–
    	this.__update();
    };

    _pro.__update = function(){
    	//è®¡ç®—å‡ºæœåŠ¡å™¨æ—¶é—´å†è¿›è¡Œæ¯”è¾ƒ
    	var now = new Date().getTime(),
    		systime = now + this.__dvalue,
    		spareTime = this.__deadLine - systime;

    	if(spareTime <= 0){
    		var timeobj = __getTimeObj(0);
    	}else{
	    	//è®¡ç®—æ—¶é—´
	    	var timeobj = __getTimeObj(spareTime);
	    	window.setTimeout(function(){
	    		this.__update();
	    	}._$bind(this), 500);
    	}

	    this.__setTimeShow(timeobj);
    };

    _pro.__setTimeShow = function(timeobj){
    	var i=0, l=this.__timeNodes.length, node, key;
    	for(; i<l; i++){
    		node = this.__timeNodes[i];
    		key = _e._$attr(node,'data-timekey');
    		node.innerText = timeobj[key];
    	}
    };

    return _p._$$CountDown;

  },1,2,23,3,4);
I$(267,"{#if type == 0}\n<div class=\"operation\">\n{#if categoryId==-1 && categoryList.length > 0}\n<div class=\"m-classify clearfix\">\n\t<div class=\"name\">åˆ†ç±»ï¼š</div>\n\t<div class=\"hdbrands\" r-class='{{\"autoheight\": catListInfo.more == true || catListInfo.offsetHeight < 90, \"line2height\": catListInfo.more == false && catListInfo.offsetHeight > 90}}'>\n\t\t<div class=\"hdbrands2\">\n\t\t\t<div class=\"brands all\" ref=catlist>\n\t\t\t\t{#list categoryList as item}\n\t\t\t\t{#if category == item.categoryId}\n\t\t\t\t<a class=\"active\" href=\"javascript:void(0)\" on-click={this.changeCategory(item.categoryId)}>{item.categoryName}<b r-html={'&#xe61b;'}>x</b></a>\n\t\t\t\t{#else}\n\t\t\t\t<a href=\"javascript:void(0)\" on-click={this.changeCategory(item.categoryId)}>{item.categoryName}</a>\n\t\t\t\t{/if}\n\t\t\t\t{/list}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t{#if catListInfo.offsetHeight > 90}\n\t<div class=\"morewrap\">\n\t\t{#if catListInfo.more}\n\t\t<div class=\"more\" on-click={this.moreShow(catListInfo)}>收起<span class=\"packup\"></span></div>\n\t\t{#else}\n\t\t<div class=\"more\" on-click={this.moreShow(catListInfo)}>更多<span></span></div>\n\t\t{/if}\n\t</div>\n\t{/if}\n</div>\n{/if}\n\n{#if proList.length > 0}\n{#list proList as property}\n<div class=\"m-classify property clearfix\">\n\t<div class=\"name\">{property.proNameCn||''}：</div>\n\t<div class=\"hdbrands\">\n\t\t<div class=\"hdbrands2\">\n\t\t\t<div class=\"brands all\" ref={'pro'+property_index}>\n\t\t\t\t{#list property.proValues as item}\n\t\t\t\t{#if proSelectIds.indexOf(','+item.proNameValueId+',') != -1}\n\t\t\t\t<a class=\"active\" href=\"javascript:void(0)\" on-click={this.changePrototype(property.proNameId,item.proNameValueId)}>{item.proValueDesc}<b r-html={'&#xe61b;'}>x</b></a>\n\t\t\t\t{#else}\n\t\t\t\t<a href=\"javascript:void(0)\" on-click={this.changePrototype(property.proNameId,item.proNameValueId)}>{item.proValueDesc}</a>\n\t\t\t\t{/if}\n\t\t\t\t{/list}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t{#if property.prototypeInfo.offsetHeight > 90}\n\t<div class=\"morewrap\">\n\t\t{#if property.prototypeInfo.more}\n\t\t<div class=\"more\" on-click={this.moreShow(property.prototypeInfo)}>收起<span class=\"packup\"></span></div>\n\t\t{#else}\n\t\t<div class=\"more\" on-click={this.moreShow(property.prototypeInfo)}>更多<span></span></div>\n\t\t{/if}\n\t</div>\n\t{/if}\n</div>\n{/list}\n{/if}\n</div>\n{/if}\n\n<div class=\"operation\">\n<div class=\"m-filter clearfix\">\n\t<div class=\"hdorder clearfix\" id=\"order\">\n    <dl class=\"order\">\n        <dd class=\"jtag\" r-class='{{\"active\": sortfield==0}}' on-click={this.sortClick(0)}>\n          <span>人气{#if sortfield==0}{#if isDesc==true}<span class=\"arrow-down\"></span>{#else}<span class=\"arrow-up\"></span>{/if}{/if}</span>\n        </dd>\n\n        <dd class=\"jtag\" r-class='{{\"active\": sortfield==2}}' on-click={this.sortClick(2)}>\n          <span>销量{#if sortfield==2}{#if isDesc==true}<span class=\"arrow-down\"></span>{#else}<span class=\"arrow-up\"></span>{/if}{/if}</span>\n        </dd>\n\n        <dd class=\"jtag\" r-class='{{\"active\": sortfield==1}}' on-click={this.sortClick(1)}>\n          <span>价格{#if sortfield==1}{#if isDesc==true}<span class=\"arrow-down\"></span>{#else}<span class=\"arrow-up\"></span>{/if}{/if}</span>\n        </dd>\n    </dl>\n    <label class=\"m-checkbox jtag\" r-class='{{\"m-checked\": isStock==true}}' on-click={this.filterResultClick('isStock')}>\n        <span class=\"box\"><i r-html={'&#xe601;'}></i><em r-html={'&#xe60b;'}></em></span><span>只选有货商品</span>\n    </label>\n    <label class=\"m-checkbox jtag\" r-class='{{\"m-checked\": isPromote==true}}' on-click={this.filterResultClick('isPromote')}>\n        <span class=\"box\"><i r-html={'&#xe601;'}></i><em r-html={'&#xe60b;'}></em></span><span>仅显示促销</span>\n    </label>\n    {#if totalPage && totalPage != 0}\n    <div class=\"simplePage\">\n        <span class=\"num\"><i>{current}</i>/{totalPage}</span>\n        {#if current==1}\n        <span class=\"arrow-left def-left\"></span>\n        {#else}\n        <a href=\"javascript:void(0);\" class=\"arrow-left\" on-click={this.paging(-1)}></a>\n        {/if}\n        {#if current==totalPage}\n        <span class=\"arrow-right def-right\"></span>\n        {#else}\n        <a href=\"javascript:void(0);\" class=\"arrow-right\" on-click={this.paging(1)}></a>\n        {/if}\n    </div>\n    {/if}\n\n    </div>\n</div>\n</div>\n\n{#if total != 0}\n<div class=\"m-result\">\n\t<ul class=\"clearfix\" >\n\t\t{#list list as goods}\n\t\t<li class=\"goods\">\n\t\t\t<div class=\"goodswrap\" r-class='{{\"promotion\": !!goods.saleShow}}'>\n        \t<div class=\"img\">\n\t\t\t\t<a target=\"_blank\" href=\"/product/{goods.goodsId}.html\">\n\t\t\t\t<img alt=\"{goods.title}\" class=\"img-lazyload\" data-src=\"{goods.imageUrl|imgThumbnailUrl:262,262,90}\" >\n\t\t\t\t\t{#if !goods.storage}\n\t\t\t\t\t<span class=\"soldout\"></span>\n\t\t\t\t\t{#elseif !!goods.promoteUrl}\n\t\t\t\t\t<img class=\"promote\" src=\"{goods.promoteUrl|noProtocol}\" />\n\t\t\t\t\t{#else}\n\t\t\t\t\t<div class=\"activityflag\">\n\t\t\t\t\t\t{#if goods.bestselling && goods.bestselling== true}\n\t\t\t\t\t\t<span class=\"hot\">çƒ­é”€</span>\n\t\t\t\t\t\t{#elseif goods.isNewGoods && goods.isNewGoods== true}\n\t\t\t\t\t\t<span class=\"new\">æ–°å“</span>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n          \t\t</a>\n          \t\t{#if !goods.storage}\n          \t\t<a class=\"arrivenotice\" target=\"_blank\" href=\"/product/{goods.goodsId}.html\"><span class=\"icon\"></span><span class=\"text\">åˆ°è´§é€šçŸ¥</span></a>\n          \t\t{#else}\n            \t<span class=\"favbtn\"  r-class='{{\"favt\": goods.isFavorite==true}}' on-click={this.addFav(goods)}><span class=\"iconfont ic\" r-html={'&#xe62a;'}></span> æ”¶è—</span>\n          \t\t{/if}\n        \t</div>\n        \t<div class=\"desc clearfix\">\n\t\t\t\t<p class=\"price\">\n\t\t\t\t\t<span class=\"cur\"><i>Â¥</i>{#if goods.actualCurrentPrice}{goods.actualCurrentPrice}{#else}{goods.suggestPrice}{/if}</span>\n\t\t\t\t\t{#if goods.memberCount && goods.memberCount > 0}\n\t\t\t\t\t\t{#if !!goods.isShowDiscountCost}\n\t\t\t\t\t\t<b class=\"combinedLabel\">å•{goods.memberUnitName||'ä»¶'}Â¥<i>{goods.memberPrice}</i></b>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t{#else}\n\t\t\t\t\t\t<b class=\"combinedLabel\">{goods.discount}æŠ˜</b>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t{#if (goods.isPostageFree)==1}\n\t\t\t\t\t\t<b class=\"combinedLabel\">åŒ…é‚®</b>\n\t\t\t\t\t{/if}\n\t\t\t\t\t<span class=\"marketprice\">Â¥<del>{goods.marketPrice}</del></span>\n\t\t\t\t</p>\n\t\t\t\t<p class=\"titlewrap\">\n\t\t\t\t{#if goods.memberCount && goods.memberCount > 0}\n\t\t\t\t\t<a class=\"title\" href=\"/product/{goods.goodsId}.html\" target=\"_blank\"><i>{goods.memberCount}{goods.memberUnitName||'ä»¶'}è£…</i> | {goods.title}</a>\n\t\t\t\t{#else}\n\t\t\t\t\t<a class=\"title\" href=\"/product/{goods.goodsId}.html\" target=\"_blank\">{goods.title}</a>\n\t\t\t\t{/if}\n\t\t\t\t</p>\n\t\t\t\t{#if goods.saleShow}\n\t\t\t\t<p class=\"saelsinfo\">\n\t\t\t\t\t{#if !!goods.danpinPromotionTitleLink}\n\t\t\t\t\t<span class=\"activity danpin\">{goods.danpinPromotionTitleLink.split('-')[0]}</span>\n\t\t\t\t\t{/if}\n\t\t\t\t\t{#if !!goods.zhengdanPromotionTitleLink}\n\t\t\t\t\t<span class=\"activity zhengdan\" r-class='{{\"large\": (goods.zhengdanPromotionTitleLink.indexOf(\"Nå…ƒä»»é€‰\") != -1 || goods.zhengdanPromotionTitleLink.indexOf(\"ç¨Žè´¹è¡¥è´´\") != -1)}}' >{goods.zhengdanPromotionTitleLink.split('-')[0]}</span>{/if}&nbsp;{goods.saleShow}</p>\n\t\t\t\t{/if}\n\t\t\t\t<p class=\"goodsinfo clearfix\">\n\t\t\t\t\t<a target=\"_blank\" href=\"/product/{goods.goodsId}.html#mainBtmWrap\" class=\"comments\"><span class=\"icon\"></span>{goods.commentGoodCount}</a>\n\t\t\t\t\t<span class=\"proPlace ellipsis\">{goods.productionPlace||''}</span>\n\t\t\t\t</p>\n        \t</div>\n      \t\t</div>\n      \t</li>\n\t\t{/list}\n\t</ul>\n</div>\n{#else}\n<div class=\"m-empty\">\n    <div class=\"content\">\n\t\t<p style=\"font-size:18px;\">æŠ±æ­‰ï¼Œæ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å•†å“</p>\n\t\t<br>\n\t\t<p>å»ºè®®æ‚¨ï¼š</p>\n\t\t<p>1ã€é€‚å½“å‡å°‘ç­›é€‰æ¡ä»¶ï¼Œå¯ä»¥èŽ·å¾—æ›´å¤šç»“æžœ</p>\n\t\t<p>2ã€å°è¯•å…¶ä»–å…³é”®è¯</p>\n    </div>\n    <span class=\"errorimg\"></span>\n</div>\n{/if}\n\n<div id=\"pageNavWrap\">\n    <div id=\"pageNav\" class=\"m-centerpager clearfix center\">\n        <pager total={Math.ceil(total/limit)} current={current}></pager>\n    </div>\n</div>");
I$(50,function (_ut,tpl,ut,ListComponent,LoginWindow,PromptWin){
var BrandList = ListComponent.extend({
	url:'/activity/brand/getGoods.html',
	template: tpl,
	scrollToTop: true,
	hasInitPro:false,

	data:{
		list:[],
		type:0,
		categoryList:[],
		categoryId:'',
		catListInfo:{offsetHeight:0, more:false},
		proSelectIds:',',
		isSearch:true,    //æ ‡è®°æ˜¯å¦æ˜¯ç‚¹å‡»æœç´¢è§¦å‘è¯·æ±‚
		empty:false,
		category:'',
		brandId:'',
		sortfield:0,
		isDesc:true,
		isStock:false,
		isPromote:false,
		schemeId:''
	},
	
	config: function(data){
		ut.extend(data, {
			total: 1,
			current: 1,
			limit: 60,
			list: []
		});

		if(data.categoryId && data.categoryId != -1){
			data.category = data.categoryId;
		}

		this.$watch(this.watchedAttr, function(){
			if(this.shouldUpdateList()) this.__getList();
		});
	},

	search: function(_flag, _key){
		if(this.data.current != 1) {
			this.data.current = 1;
		} else {
			this.__getList();
		}
	},

	changeCategory: function(id){
		if(this.data.category == id){
			this.data.category = '';
		}else{
			this.data.category = id;
		}
		this.search();
	},

	changePrototype: function(proId, proValId){
		var proSelectIds = this.data.proSelectIds;
		if(proSelectIds.indexOf(','+proId+'_') != -1){	//å½“å‰å±žæ€§æ˜¯å¦å·²ç»è¢«é€‰ä¸­
			if(proSelectIds.indexOf(proValId) != -1){	//ç‚¹å‡»çš„æ˜¯é€‰ä¸­çš„å±žæ€§åç§°
				proSelectIds = proSelectIds.replace(','+proValId+',', ',');
			}else{
				var reg  = new RegExp(','+proId+'_\\d+,', 'ig');
				proSelectIds = proSelectIds.replace(reg, (','+proValId+','))
			}
		}else{
			proSelectIds += (proValId+',');
		}
		this.data.proSelectIds = proSelectIds;
		this.search();
	},

	sortClick: function(type){
		if(this.data.sortfield == type) {  //ç›¸åŒæŽ’åºç‚¹å‡»
			this.data.isDesc = !this.data.isDesc;
		}else {
			this.data.sortfield = type;
			this.data.isDesc = true;

			if(type == 1){  //ä»·æ ¼é¦–æ¬¡æŽ’åºä»Žä½Žåˆ°é«˜
			  this.data.isDesc = false;
			}
		}
		this.search();
	},

	filterResultClick: function(key){
		this.data[key] = !this.data[key];
		this.search();
	},

	paging: function(num){
		// this.scrollToTop = false;
		this.data.current += num;
	},

	moreShow: function(info){
		info.more = !info.more;
	},

	//è®¡ç®—åˆ†ç±»åˆ—è¡¨çš„æ˜¾ç¤ºæ–¹å¼
	calBrandsParam: function(){
		var data=this.data, l=data.proList.length, i=0, node;

		if(!!this.$refs.catlist) {
			var height = this.$refs.catlist.offsetHeight, type=0;
			data.catListInfo = {offsetHeight: height, more:false};
		}

		for(; i<l; i++){
			node = this.$refs['pro'+i];
			if(node){
				var height = node.offsetHeight;
				data.proList[i]['prototypeInfo'] = {offHeight: height, more:false}
			}
		}

		this.$update();
	},

	addFav: function(goods){
		var url = '/favoriteAjax/add.html', type=1;
        if(goods.isFavorite == true){
            url = '/favoriteAjax/delete.html';
            type = -1;
        }
        this.$request(url, {
            method: 'POST',
            data: {goodsId: goods.goodsId},
            type: 'json',
            norest: true,
            onload: function(json){
                if(json.retcode == 200){
                    //修改状态
                    this.changeFavStatus(goods);
                }else if(json.retcode == 461){
                    this.loginWin = LoginWindow._$allocate({logincallback: this.getLoginOK2._$bind(this, goods)})._$show();
                }else if(json.retcode == 491){
                    //已收藏,修改状态
                    this.changeFavStatus(goods);
                }else{
                    //错误提示
                    PromptWin._$allocate({message: json.retdesc})._$show();
                }
            }._$bind(this),
            onerror: function(json){
                PromptWin._$allocate({message: '内部错误！'})._$show();
            }
        })
	},

	changeFavStatus: function(goods){
		goods.isFavorite = !goods.isFavorite;
		this.$update();
	},

	//收藏登录回调
    getLoginOK2: function(goods, state){
        if(state==0){
            this.addFav(goods);
            // TODO 刷新顶部
            // this._$dispatchEvent('cbloginOk');
        }
    },

	getListParam: function(){
	    var data = this.data, brandIdAry = [],
	    	goodsTag=data.schemeId, c=data.category;

	    if(data.type == 0){
	    	goodsTag = '';
	    }else if(data.type == 1){
	    	c = '';
	    }

	    return {
			pageNo:data.current,
			pageSize:data.limit,
			sortfield:data.sortfield,
			isDesc:data.isDesc,
			isStock:data.isStock,
			b:data.brandId,
			c:c,
			source:1,
			proIds:data.proSelectIds.slice(1,-1),
			goodsTag:goodsTag
	    }
	},

	__getList: function(){
	    var data = this.data;
	    var option = {
			data: this.getListParam(),
			method: 'POST',
			type:'json',
			progress: true,
			// norest: true,
			onload: function(json){
				if(json.retcode==200){
			        var result = json.result,
			            list = result.goodsList||[];

				    this.data.empty = false;

				  	if(!this.hasInitPro){
					  	this.initProOnce(result);
				  	}

				    data.total = result.total;
				    data.totalPage = Math.ceil(result.total/data.limit)||1;
				    data.list = list;
				    data.result = result;
				    if(!!window.lazyImgTrigger) {
				    	window.setTimeout(window.lazyImgTrigger, 60);
				    }
				} else{  //未内容搜索到
					if(!!this.data.isSearch){ //只有在搜索框搜索时empty才会为true
						this.data.empty = true;
						data.brandNameList = [];
					} 
					data.list = [];   //其他情况通过设置list为[]来显示没有数据的视觉
					data.total = data.totalPage = 0;
				}

				this.data.isSearch = false;
			},
			onerror: function(json){
				//请求错误直接显示无内容页面
				this.data.empty = true;
				data.list = data.brandNameList = [];
				data.total = data.totalPage = 0;
			}
	    };

	    this.$request(this.url,option)
	},

	initProOnce: function(result){
		var data = this.data;
		data.categoryList = result.frontCategoryList||[];
		data.proList = result.propertyNameList||[];

		window.setTimeout(this.calBrandsParam._$bind(this), 50);
		this.hasInitPro = true;
	}
});

return BrandList;

},2,267,15,268,7,8);
I$(262,".#<uispace>{width:518px;text-align:center;}\n.#<uispace> .cntbox{padding:30px;font-size: 24px;} \n.#<uispace> .btnbox{padding:0 0 40px;}\n.#<uispace> .btnbox .u-btn{display:inline-block;*display:inline;zoom:1;min-width:70px;padding:0 10px;height:34px;margin:0 10px;border:1px solid #D22147;cursor: pointer;\n\ttext-decoration: none;text-align:center;line-height:34px;color:#fff;font-size:14px;background:#D22147;}\n.#<uispace> .btnbox .u-btn:hover{background-color: #F5345E;border-color: #F5345E;color:#fff;}\n.#<uispace> .btnbox .u-btn-cancel{color: #666;border-color: #ccc;background: #fff;}\n.#<uispace> .btnbox .u-btn-cancel:hover{background: #fff;color: #666;}");
I$(263,"<div class=\"cfmbox\">\n\t<div class=\"cntbox j-flag\"></div>\n\t<div class=\"btnbox\">\n\t\t<a href=\"javascript:void(0);\" class=\"u-btn j-flag\">确定</a>\n\t\t<a href=\"javascript:void(0);\" class=\"u-btn u-btn-cancel j-flag\">取消</a>\n\t</div>\n</div>\n");
I$(39,function (AWWindow, e,v,_css,_html,tpl,jst,_p, _o, _f, _r,_pro) {
	
    var _seed_css = e._$pushCSSText(_css),
        _seed_html = tpl._$addNodeTemplate(_html);

    _p._$$ConfirmWindow = NEJ.C();
    _pro = _p._$$ConfirmWindow._$extend(AWWindow);

    _pro.__initNode = function() {
        this.__super();
        var _list = e._$getByClassName(this.__body,'j-flag');
        this.__box = _list[0];
        this.__okBtn = _list[1];
        this.__cancelBtn = _list[2];
        v._$addEvent(this.__okBtn, 'click', this.__onOK._$bind(this));
        v._$addEvent(this.__cancelBtn, 'click', this.__onCancel._$bind(this));
    };

    _pro.__reset = function(options) {
    	options.title = options.title || '提示';
        options.clazz = options.clazz || 'm-confirm';
        options.noCancel = options.noCancel || false;
        this.__super(options);
        this.__box.innerHTML = options.msg || '';
        this.__okBtn.innerHTML = options.oktext || '确定';
        this.__cancelBtn.innerHTML = options.canceltext || '取消';
        if(options.noCancel){
            this.__cancelBtn.style.display = 'none';
        }
        if(!!options.okBtnText){
            this.__okBtn.innerText = options.okBtnText;
        }
    };

    _pro.__initXGui = function() {
        this.__seed_css = _seed_css;
        this.__seed_html = _seed_html;
    };

    /**
     * 点击"确定"按钮事件响应
     * */
    _pro.__onOK = function(_event) {
    	v._$stop(_event);
    	this._$dispatchEvent('onok');
		this._$hide();
    };
    /**
     * 点击"取消"按钮事件响应
     * */
    _pro.__onCancel = function(_event) {
        v._$stop(_event);
        this._$dispatchEvent('oncancel');
        this._$hide();
    };
    
    return _p._$$ConfirmWindow;
},229,4,3,262,263,233,239);
I$(180,function (NEJ,_k,_u,_t0,_p,_o,_f,_r){
    // variable declaration
    var _pro;
    /**
     * 先慢后快再慢动画
     * 
     * 结构举例
     * ```html
     * <div id='id-bounce1'></div>
     * ```
     * 
     * 脚本举例
     * ```javascript
     * NEJ.define([
     *     'util/animation/easeinout'
     * ],function(_t){
     *     // 创建动画实例
     *     var _easeinout  = _t._$$AnimEaseInOut._$allocate({
     *         from:{
     *             offset:100
     *         },
     *         to:{
     *             offset:200
     *         },
     *         duration:1000,
     *         onupdate:function(_event){
     *             _box.style.left = _event.offset + 'px';
     *         },
     *         onstop:function(){
     *             this._$recycle();
     *         }
     *     });
     *     // 开始动画
     *     _easeinout._$play();
     * });
     * ```
     * 
     * @class   module:util/animation/easeinout._$$AnimEaseInOut
     * @extends module:util/animation/bezier._$$AnimBezier
     * 
     * @param   {Object} config 可选配置参数
     */
    _p._$$AnimEaseInOut = _k._$klass();
    _pro = _p._$$AnimEaseInOut._$extend(_t0._$$AnimBezier);
    /**
     * 控件重置
     * 
     * @protected
     * @method module:util/animation/easeinout._$$AnimEaseInOut#__reset
     * @param  {Object} arg0 - 可选配置参数
     * @return {Void}
     */
    _pro.__reset = function(_options){
        _options = _u._$merge({},_options);
        _options.timing = 'easeinout';
        this.__super(_options);
    };

    if (CMPT){
        NEJ.copy(NEJ.P('nej.ut'),_p);
    }

    return _p;
},215,1,2,96);
I$(91,function (k,ut,v,e,pt,$,lazy,_,Module,Request,p,o,f,r,pro) {
        var pro;

        p._$$HelpModule = k._$klass();
        pro = p._$$HelpModule._$extend(Module);

        pro.__init = function(options) {
          if(window.useHelpModule){
            this.__supInit(options);
            this.__initLeftNav();
          }
        };
        pro.__initLeftNav = function(){
          if(!$('#helpLeftNav')){
            return;
          }
          $('#helpLeftNav .active')._$parent('.top',true)._$delClassName('collapsed')._$addClassName('expanded');
          $('#helpLeftNav .tit')._$on('click',function(){
            var titParent = $(this)._$parent();
            if(titParent._$hasClassName('collapsed')){
              titParent._$delClassName('collapsed')._$addClassName('expanded');
            }else{
              titParent._$delClassName('expanded')._$addClassName('collapsed');
            }
          });
        };

        p._$$HelpModule._$allocate();
    },1,2,3,4,78,79,51,15,5,6);
I$(287,"{#if list.length!=0}\n<h4 class=\"newRecomTitle clearFix\">大家都在买<b>全网最热门的商品推荐</b></h4>\n<div class=\"m-reclst clearFix\">\n\t{#list list as item}\n\t<div class=\"newRecomItemWrap\" on-click={this.clickRecommendTj(item_index)}>\n\t\t{#if item.memberCount && item.memberCount>0}\n\t\t<a class=\"itemImg\" target=\"_blank\" href=\"/product/{item.goodsId}.html?{condition.tongji.query}{item.reason|encode}&istext=0\">\n\t\t\t<img border=\"0\" title=\"{item.memberCount}{item.memberUnitName || '件'}装 | {item.title}\" alt=\"{item.memberCount}{item.memberUnitName || '件'}装 | {item.title}\" src=\"{(item.imageUrlFor430||item.imageUrl)|noProtocol}\" style=\"opacity: 1;\">\n\t\t</a>\n\t\t<p class=\"itemTitle\">\n\t\t\t<a href=\"/product/{item.goodsId}.html?{condition.tongji.query}{item.reason|encode}&istext=1\" title=\"{item.memberCount}{item.memberUnitName || '件'}装 | {item.title}\" target=\"_blank\"><b>{item.memberCount}{item.memberUnitName || '件'}装</b>&nbsp;|&nbsp;{item.title}</a>\n\t\t</p>\n\t\t{#else}\n\t\t<a class=\"itemImg\" target=\"_blank\" href=\"/product/{item.goodsId}.html?{condition.tongji.query}{item.reason|encode}&istext=0\">\n\t\t\t<img border=\"0\" title=\"{item.title}\" alt=\"{item.title}\" src=\"{(item.imageUrlFor430||item.imageUrl)|noProtocol}\" style=\"opacity: 1;\">\n\t\t</a>\n\t\t<p class=\"itemTitle\">\n\t\t\t<a href=\"/product/{item.goodsId}.html?{condition.tongji.query}{item.reason|encode}&istext=1\" title=\"{item.title}\" target=\"_blank\">{item.title}</a>\n\t\t</p>\n\t\t{/if}\n\t\t<div class=\"itemInfo clearfix\">\n\t\t\t<p class=\"price\">¥{item.actualCurrentPrice}<span class=\"marprice\">¥<del>{item.marketPrice}</del></span></p>\n\t\t\t<a href=\"/product/{item.goodsId}.html?{condition.tongji.query}{item.reason|encode}&istext=2#mainBtmWrap\" target=\"_blank\" class=\"comment\">{item.commentCount} 人已评价</a>\n\t\t</div>\n\t</div>\n\t{/list}\n</div>\n{/if}");
I$(288,function (_ut,_v,ut,ListComponent,_){
	
  var List = ListComponent.extend({
	printRecommendLog:'/recommend/printRecommendLog.html',
    init:function(){
    	this.supr();
    	_v._$addEvent(window,'scroll',_.throttle(this.onBodyScrollCheck._$bind(this),100));
    }
  });

  ListComponent.filter({
    'encode':function(str){
       return !!str?window.encodeURIComponent(str):'';
    }
  });
  
  return List;

},2,3,15,268,15);
I$(289,function (_k, _ut, _t, _v, _e, $, _p, _o, _f, _r, _pro) {

        /**
         * 若模块在视口停留超过一段时间，则进行打点（条件：1滚动到视口中(可通过设置参数缩小视口范围) 2持续一段时间(默认1000ms)）
         *   - 发送的打点请求会在page参数前增加 "停留打点^_^" 前缀，详见代码（用来区分于其它打点请求）
         *   - 引用：'pro/widget/dapush/scrollpush'
         *
         * @param id {String} 打点元素id 【必填】
         * @param elem {Node} 打点元素 【与id参数二选一】
         * @param page {String} 页面 【必填】
         * @param module {String} 页面的模块 【必填】
         * @param param {Object|Array|Function} 自定义参数（根据打点模块，可能为：商品id数组、品牌id数组等）【选填】
         * 											- 如果是Function，则参数为它执行结果的返回值
         * @param waitMills {Number} 模块在视口内等待多久会触发打点 【选填】
         * @param area {Object} 缩小触发打点的范围 {top:0;bottom:0;} 【选填】
         *
         * ````javascript
         * Scrollpush._$allocate({
         * 		id: "guess",
         * 		page: "首页",
         * 		module: "猜你喜欢",
         * 	    param: []
         * });
         *
         * ````
         */

        _p._$$ScrollTo = _k._$klass();
        _pro = _p._$$ScrollTo._$extend(_t._$$EventTarget);

        _pro.__init = function (_options) {
            this.__super(_options);
        };

        _pro.__reset = function (_options) {
            var self = this;
            self.__super(_options);

            //打点元素
            self._elem = _options.elem || _e._$get(_options.id || '');

            //发送的打点请求会在page参数前增加 "停留打点^_^" 前缀（用来区分于其它打点请求）
            self._page = "停留打点^_^" + (_options.page || '');
            self._module = _options.module || '';
            self._param = _options.param || (_ut._$isArray(_options.param) ? [] : {});

            //停留时间
            self._waitMills = _options.waitMills || 1000;

            //用来缩小视口区域，{top:xx, bottom:xx}
            self._area = _options.area || {};

            if(!self._elem || !_options.page || !_options.module) return;

            //是否已经打点成功
            self._hasCalled = false;
            //是否正在计时中（保证只有一个正在进行中的倒计时）
            self._blocking = false;
            //用来clearTimeout
            self._sto = undefined;

            //添加滚动事件
            _v._$addEvent(window, 'scroll', self.__cbFn._$bind(self));
            _v._$addEvent(window, 'resize', self.__cbFn._$bind(self));

            //页面初始化时触发一次事件
            self.__cbFn._$bind(self)();
            //$(window)._$trigger('resize');
        };

        //判断并发送打点请求
        _pro.__cbFn = function () {
            var self = this;
            var area = self._area,
                waitMills = self._waitMills;
            if(!self._elem.getBoundingClientRect || !!self._hasCalled) return;

            //获取元素相对视口位置
            var rect = self._elem.getBoundingClientRect(),//top,left
                top = rect.top || 0,
                bottom = rect.bottom || 0,
                viewportH = document.documentElement.clientHeight,
                minH = area.top || 0,
                maxH = viewportH - (area.bottom || 0);

            //判断元素是否在视口中
            if((top > minH && top < maxH) ||
                (bottom > minH && bottom < maxH) ||
                (top < minH && bottom > maxH)) {
                //同一时间只有一个setTimeout
                if(!!self._blocking) return;
                self._blocking = true;
                self._sto = setTimeout(function () {
                    self._blocking = false;
                    self.__sendDaPush();
                }, waitMills);
            } else {
                //元素离开视口区域
                self._blocking = false;
                if(!!self._sto) {
                    clearTimeout(self._sto);
                    self._sto = undefined;
                }
            }
        };

        //发送打点请求
        _pro.__sendDaPush = function () {
            var self = this, _param = self._param;

            //标示已发送过打点请求
            self._hasCalled = true;

            if(typeof _param == 'function') {
                _param = _param.apply(window);
            }

            //测试用
            //console.log(self._page, self._module, JSON.stringify(_param));

            //打点
            !!window._dapush &&
            window._dapush("_trackEvent",
                self._page,//事件类别(页面)
                self._module,//事件操作(页面模块)
                JSON.stringify(_param) || "",//事件标签(自定义参数)
                {'userAccount': window.account, 'userId': window.account});
        };

        return _p._$$ScrollTo;

    },1,2,23,3,4,25);
I$(81,function (_ut,_e,tpl,ListComponent,_,ScrollPush){
	
  var List = ListComponent.extend({
    template: tpl,
    data:{
    	list:[]
    },
    getListParam: function(){
        var param = _.extend({}, this.getExtraParam(this.data));
        delete param.tongji;//删除统计相关的参数
        return param;
    },
    url:'/recommend/getRecommendGoods.html',
    xdrOption:{
    	method:'POST',
    	norest:true,
    	type:'json'
    },
    onBodyScrollCheck:function(event){
    	var offset = _e._$offset(this.$root.parentNode,document.body);
    	var pageBox = _e._$getPageBox();
    	if(pageBox.scrollTop+pageBox.clientHeight>offset.y && !this.data.recommendSent){
        this.daPush();
    		this.data.recommendSent = true;
        var itemsArr = [];
        _ut._$forEach(this.data.list,function(item){
          itemsArr.push('{'+'"id":'+(item.goodsId||'')+',"recType":"'+(item.recType||'')+'","reason":"'+(item.reason||'')+'","weight":"'+(item.weight||'')+'"}');
        });
    		this.$request(this.printRecommendLog,{
    			data:{
    				userId:window.account||"",
    				date:+new Date,
    				position:this.data.condition.tongji.position||'大家都在买',
    				items:"["+itemsArr.join(",")+"]",
    				resource:'挖掘组'
    			},
    			onload:function(){
    				
    			},
    			onerror:function(){
    				
    			}
    		})
    	}
    },
    daPush:function(){
      _.daEvent(this.data.condition.tongji.category||'推荐区域展示',this.data.condition.tongji.action||"我的优惠券",this.data.condition.tongji.lable||"大家都在买");
    },
    // 推荐商品点击统计事件 hzmating 20150802
    clickRecommendTj:function(index){
      var item = this.data.list[index] || {};
      if(!!event.target.getAttribute("hasClick")){
        return;
      }
      event.target.setAttribute("hasClick",1);
      this.$request(this.printRecommendLog,{
        data:{
          userId:window.account||"",
          date:+new Date,
          position:this.data.condition.tongji.position||'大家都在买',
          clickItem:'{'+'"id":'+(item.goodsId||'')+',"recType":"'+(item.recType||'')+'","reason":"'+(item.reason||'')+'","weight":"'+(item.weight||'')+'"}',
          resource:'挖掘组'
        },
        onload:function(){
          
        },
        onerror:function(){
          
        }
      })
    },
    __getList: function(){
        var data = this.data;
        var option = {
          progress: true,
          data: this.getListParam(),
          onload: function(json){
        	if(json.retcode==200){
	            var result = json,
	              list = result.list||[];
	            _.mergeList(list, data.list,data.key||'id')
	
	            data.total = result.totalCount;
	            data.list = list;
              if(list.length == 0){
                this.__setParentHide();
              }
        	} else{
        		this.__setParentHide();
        	}
          },
          onerror: function(json){
            // @TODO: remove
            this.__setParentHide();
          }
        };
        if(this.xdrOption){
      	  _.extend(option, this.xdrOption);
        }
        if(option.norest&&!_ut._$isString(option.data)){
      	  option.data = _ut._$object2query(option.data);
        }
        if(option.method.toUpperCase()=='GET'){
      	  option.query = option.data ;
        }
        this.$request(this.data.url||this.url,option)
   },
   __setParentHide: function(){
    this.parentNode.style.display = 'none';
   },
      //绑定打点事件
      __bindDaPush: function () {
          var self = this, data = self.data, dapushParam = data.dapushParam;
          //无打点参数
          if(!dapushParam || !dapushParam.page) return;
          //准备参数
          var spec = {
              param: function () {
                  //获取商品id列表，作为打点请求参数
                  for(var i = 0, list = [], l = data.list.length; i < l; i++) {
                      list.push(data.list[i].goodsId);
                  }
                  return list;
              }
          };
          _.extend(spec, dapushParam);
          //绑定滚动打点事件
          ScrollPush._$allocate(spec);
      },
    config: function(data){
        _.extend(data, {
          total: 1,
          current: 1,
          limit: 20,
          list: []
        });

        if(!this.data.condition.tongji) {
          this.data.condition.tongji = {
            'category':'',
            'action':'',
            'lable':'',
            'position':'',
            'from':'',
            'query':''
          }
        }

        //绑定打点事件
        this.__bindDaPush();
        
        this.$watch(this.watchedAttr, function(){
          if(this.shouldUpdateList()) this.__getList();
        });
    }
  });
  
  return List;

},2,4,287,288,15,289);
I$(291,"{#if list.length!=0}\n\t<h4 class=\"newRecomTitle\">猜你喜欢<b>根据你的浏览记录推荐的商品</b>\n       {! <a href=\"javascript:;\" class=\"rec-refresh\" on-click={this.refresh($event)}>\n         <span class=\"refresh-icon\" r-html={refreshIcon}></span>\n         <span class=\"refresh-txt\">换一批</span>\n       </a> !}\n    </h4>\n\t<div class=\"m-reclst clearfix\">\n\t{#list list as item}\n\t<div class=\"newRecomItemWrap newRecomItemWrap-{item_index+1}\" on-click={this.clickRecommendTj(item_index,item.goodsId,condition.tongji.from)}>\n\t\t{#if item.memberCount && item.memberCount>0}\n\t\t<a class=\"itemImg\" target=\"_blank\" href=\"/product/{item.goodsId}.html?{condition.tongji.query}{item.reason|encode}&istext=0\">\n\t\t\t<img border=\"0\" title=\"{item.memberCount}{item.memberUnitName || '件'}装 | {item.title}\" alt=\"{item.memberCount}{item.memberUnitName || '件'}装 | {item.title}\" src=\"{(item.imageUrlFor430||item.imageUrl)|noProtocol}\" style=\"opacity: 1;\">\n\t\t</a>\n\t\t<p {#if !!item.saleShow}class=\"itemTitle hasPromotion\"{#else}class=\"itemTitle\"{/if}>\n\t\t\t<a class=\"protitle\" href=\"/product/{item.goodsId}.html?{condition.tongji.query}{item.reason|encode}&istext=1\" title=\"{item.memberCount}{item.memberUnitName || '件'}装 | {item.title}\" target=\"_blank\"><b>{item.memberCount}{item.memberUnitName || '件'}装</b>&nbsp;|&nbsp;{item.title}</a>\n\t\t</p>\n\t\t{#else}\n\t\t<a class=\"itemImg\" target=\"_blank\" href=\"/product/{item.goodsId}.html?{condition.tongji.query}{item.reason|encode}&istext=0\">\n\t\t\t<img border=\"0\" title=\"{item.title}\" alt=\"{item.title}\" src=\"{(item.imageUrlFor430||item.imageUrl)|noProtocol}\" style=\"opacity: 1;\">\n\t\t</a>\n\t\t<p {#if !!item.saleShow}class=\"itemTitle hasPromotion\"{#else}class=\"itemTitle\"{/if}>\n\t\t\t<a class=\"protitle\" href=\"/product/{item.goodsId}.html?{condition.tongji.query}{item.reason|encode}&istext=1\" title=\"{item.title}\" target=\"_blank\">{item.title}</a>\n\t\t</p>\n\t\t{/if}\n\t\t{#if !!item.saleShow}\n\t\t<p class=\"promotion\"><span title=\"{item.saleShow||''}\">{item.saleShow||''}</span></p>\n\t\t{/if}\n\t\t<div class=\"itemInfo clearfix\">\n\t\t\t<p class=\"price\"><span class=\"symbol\">¥</span>{item.actualCurrentPrice}<span class=\"marprice\">¥<del>{item.marketPrice}</del></span></p>\n\t\t\t<a href=\"/product/{item.goodsId}.html?{condition.tongji.query}{item.reason|encode}&istext=2#mainBtmWrap\" target=\"_blank\" class=\"comment\">{item.commentCount} 人已评价</a>\n\t\t</div>\n\t</div>\n\t{/list}\n\t</div>\n{/if}");
I$(82,function (_ut,_e,tpl,ListComponent,_,ScrollPush){
  var List = ListComponent.extend({
    template: tpl,
    data:{
    	list:[]
    },
    getListParam: function(){
        var param = _.extend({}, this.getExtraParam(this.data));
        delete param.tongji;//删除统计相关的参数
        return param;
    },
    url:'/recommend/getRecommendGoods.html',
    xdrOption:{
    	method:'POST',
    	norest:true,
    	type:'json'
    },
    onBodyScrollCheck:function(event){
    	var offset = _e._$offset(this.$root.parentNode,document.body);
    	var pageBox = _e._$getPageBox();
    	if(pageBox.scrollTop+pageBox.clientHeight>offset.y && !this.data.recommendSent){
        this.daPush();
    		this.data.recommendSent = true;
        var itemsArr = [];
        _ut._$forEach(this.data.list,function(item){
          itemsArr.push('{'+'"id":'+(item.goodsId||'')+',"recType":"'+(item.recType||'')+'","reason":"'+(item.reason||'')+'","weight":"'+(item.weight||'')+'"}');
        });
    		this.$request(this.printRecommendLog,{
    			data:{
    				userId:window.account||'',
    				date:+new Date,
    				position:this.data.condition.tongji.position||'我的优惠券：猜你喜欢',
            items:"["+itemsArr.join(",")+"]",
    				resource:'挖掘组'
    			},
    			onload:function(){
    				
    			},
    			onerror:function(){
    				
    			}
    		})
    	}
    },
    daPush:function(){
      _.daEvent(this.data.condition.tongji.category||'推荐区域展示',this.data.condition.tongji.action||"我的优惠券",this.data.condition.tongji.lable||"猜你喜欢");
    },
    // 推荐商品点击统计事件 hzmating 20150802
    clickRecommendTj:function(index,goodsId,from){
      if(from === "homecnxh")
    		window._dapush && window._dapush('_trackEvent', '首页', '猜你喜欢', index+1, {'userAccount':window.account||'','userId':window.account||'','customData':'/product/'+goodsId+'.html'});
    	
      var item = this.data.list[index] || {};
      if(!!event.target.getAttribute("hasClick")){
        return;
      }
      event.target.setAttribute("hasClick",1);
      this.$request(this.printRecommendLog,{
        data:{
          userId:window.account||"",
          date:+new Date,
          position:this.data.condition.tongji.position||'我的优惠券：猜你喜欢',
          clickItem:'{'+'"id":'+(item.goodsId||'')+',"recType":"'+(item.recType||'')+'","reason":"'+(item.reason||'')+'","weight":"'+(item.weight||'')+'"}',
          resource:'挖掘组'
        },
        onload:function(){
          
        },
        onerror:function(){
          
        }
      })
    },
    // refresh:function(){
    //   this.__getList();
    // },
    __getList: function(){
        var data = this.data;
        var option = {
//        progress: true,
          data: this.getListParam(),
          onload: function(json){
        	if(json.retcode==200){
	            var result = json,
	              list = result.list||[];
	            _.mergeList(list, data.list,data.key||'id')
	
	            data.total = result.totalCount;
	            data.list = list;
              data.refreshIcon = "&#xe61a;";
              if(list.length == 0){
                this.__setParentHide();
              }
        	} else{
        		this.__setParentHide();
        	}
          },
          onerror: function(json){
            // @TODO: remove
            this.__setParentHide();
          }
        };
        if(this.xdrOption){
      	  _.extend(option, this.xdrOption);
        }
        if(option.norest&&!_ut._$isString(option.data)){
      	  option.data = _ut._$object2query(option.data);
        }
        if(option.method.toUpperCase()=='GET'){
      	  option.query = option.data ;
        }
        this.$request(this.data.url||this.url,option)
   },
   __setParentHide: function(){
    this.parentNode.style.display = 'none';
   },
      //绑定打点事件
      __bindDaPush: function () {
          var self = this, data = self.data, dapushParam = data.dapushParam;
          //无打点参数
          if(!dapushParam || !dapushParam.page) return;
          //准备参数
          var spec = {
              param: function () {
                  //获取商品id列表，作为打点请求参数
                  for(var i = 0, list = [], l = data.list.length; i < l; i++) {
                      list.push(data.list[i].goodsId);
                  }
                  return list;
              }
          };
          _.extend(spec, dapushParam);
          //绑定滚动打点事件
          ScrollPush._$allocate(spec);
      },
    config: function(data){
        _.extend(data, {
          total: 1,
          current: 1,
          limit: 20,
          list: []
        });

        if(!this.data.condition.tongji) {
          this.data.condition.tongji = {
            'category':'',
            'action':'',
            'lable':'',
            'position':'',
            'from':'',
            'query':''
          }
        }

        //绑定打点事件
        this.__bindDaPush();
        
        this.$watch(this.watchedAttr, function(){
          if(this.shouldUpdateList()) this.__getList();
        });
    }
  });
  
  return List;

},2,4,291,288,15,289);
I$(503,"<div class=\"m-startbuymodal iDialogMain startBuyModal\">\n\t<div class=\"cnt\">\n\t    <div class=\"noticeText\">{noticeTxt || '请留下您的手机号码，该商品开抢前，考拉会第一时间通知您'}</div>\n\t    <div class=\"phoneInput\">\n\t        <input {#if phoneNum=='请输入接收通知的手机号'}class=\"c_ccc\"{/if} type=\"text\" ref=\"phoneNum\" placeholder=\"请输入接收通知的手机号\" data-holder=\"请输入接收通知的手机号\" autocomplete=\"off\" on-blur={this.onPhoneNumBlur()} on-focus={this.onPhoneNumFocus()} r-model={phoneNum|integer} maxlength=11 />\n\t    </div>\n\t    {#if errorMsg}\n\t    <div class=\"phoneErr\">{errorMsg}</div>\n\t    {/if}\n\t</div>\n\t<div class=\"btnbar f-tac\">\n\t  <a class=\"btn\" href=\"javascript:void(0)\" on-click={this.confirm()}>确定</a>\n\t</div>\n</div>");
I$(304,function (ut, e,v,ut1, Modal, tpl,_j,dialogModal){
	var reg = new RegExp('(^1[3|4|5|7|8|]\\d{9}$)|(^1[3|4|5|7|8|][0-9]{1}[*]{4}[0-9]{4}$)');;
	/**
	 * goodsId	商品id
	 * skuId	skuId
	 * from 调用的页面
	 */
	var NotifyModal = Modal.extend({
	    content:tpl,
	    data:{title:'开抢提醒',width:520},
	    onPhoneNumFocus:function(){
	    	this.data.errorMsg ='';
	    },
	    init:function(){
	    	this.supr();
	    },
	    config:function(data){
	    	data.phoneNum = data.phoneNum || _j._$cookie('STARTBUYTEL') || '请输入接收通知的手机号';
	    	data.url = data.url || '/short/message/onsale/seckillNotify.html';
	    },
	    onPhoneNumBlur:function(){
	    	if(!this.data.phoneNum){
	    		this.data.errorMsg ='不能为空';
	    	}
	    	if(!reg.test(this.data.phoneNum)){
	    		this.data.errorMsg ='请填写正确的手机号码！';
	    	} else{
	    		this.data.errorMsg ='';
	    	}
	    },
	    onPhoneNumFocus:function(){
	    	if(this.data.phoneNum=='请输入接收通知的手机号'){
	    		this.data.phoneNum='';
	    	}
	    	this.data.errorMsg ='';
	    },
	    confirm: function(){
	    	if(reg.test(this.data.phoneNum)){
	    		this.$request(this.data.url,{
	    			data:{"phoneNum":this.data.phoneNum,"goodsId":this.data.goodsId,"tabId":this.data.tabId},
	    			method:'POST',
	    			norest:true,
	    			onload:function(_json){
	    				if(_json.retcode==200){
	    					_j._$cookie('STARTBUYTEL',{value:_json.phoneNum||'',path:"/",expires:365*10})
	    					this.$emit('confirm',_json);
	    					this.resultDialog.call(this,'yes','设置成功','考拉将在开抢前通过免费短信通知您。');
	    				} else if(_json.retcode==402){
	    					this.resultDialog.call(this,'fail','设置失败','因为网络等原因，设置失败。请重试。');
	    				} else{
	    					this.resultDialog.call(this,'fail','设置失败',_json.retdesc||'');
	    				}
	    			}._$bind(this)
	    		})
	    	} else{
	    		if(!this.data.phoneNum){
		    		this.data.errorMsg ='不能为空';
		    	}
		    	if(!reg.test(this.data.phoneNum)){
		    		this.data.errorMsg ='请填写正确的手机号码！';
		    	}
	    	}
	    },
	    resultDialog : function(icon,text,detail){
	    	var data = {
	    		title:'提示',
	    		icon:icon,
	    		text:text,
	    		detail:detail,
	    		btnText:'确认',
	    		customClass:'startBuyResult'
	    	};
	    	this.destroy();
	    	new dialogModal({
	    		data:data
	    	})
	    }
	});

	// 绑定Modal
  	return NotifyModal;
},15,4,3,2,128,503,11,115);
I$(311,"<article class=\"m-goodslist lineOfFour\">\n<section class=\"goodsWrap f-cb\">\n{#if !!goodsList}\n{#list goodsList as goods}\n\t<div class=\"detailWrap f-cb\">\n\t\t<a class=\"pic\" href=\"{goods|goodsLink}\" target=\"_blank\" title=\"{goods|getTitle:true}\" data-param=\"{goods|dataParam:goods_index,curStatus}\">\n\t\t\t{! 商品图片 !}\n\t\t\t<img class=\"proImg img-lazyload\" src=\"{cdnBaseUrl}images/blank.gif\" data-src=\"{(goods.imageUrl||'')|imgThumbnailUrl:360,360}\" alt=\"{goods|getTitle:true}\" title=\"{goods|getTitle:true}\" >\n\t\t    {! 是否售罄 !}\n\t\t    {#if curStatus=='ing' && (goods|soldout)}\n\t\t\t  \t<span class=\"w-icon w-icon-13\">&nbsp;</span>\n\t\t\t{/if}\n\t\t\t{! 自定义角标 !}\n\t\t\t{#if !!goods.cornerLabel}\n\t\t\t\t{#if (goods.cornerLabel||'').length>4}\n\t\t\t\t<span class=\"custom-corner gt4\"><b>{goods.cornerLabel||''}</b></span>\n\t\t\t\t{#elseif (goods.cornerLabel||'').length==4}\n\t\t\t\t<span class=\"custom-corner\"><b>{goods.cornerLabel||''}</b></span>\n\t\t\t\t{#else}\n\t\t\t\t<span class=\"custom-corner lt4\"><b>{goods.cornerLabel||''}</b></span>\n\t\t\t\t{/if}\n\t\t\t{/if}\n\t\t\t{! 明日开抢提醒 !}\n\t\t\t{#if curStatus!='ing'}\n\t\t\t  \t<span class=\"start-hint\">{goods|startHint}</span>\n\t\t\t{/if}\n\t\t</a>\n\t\t<div class=\"proinfo\">\n\t\t\t{! 标题区域 !}\n\t\t\t<h3 class=\"tit\">\n\t\t\t\t<a class=\"titLink\" target=\"_blank\" href=\"{goods|goodsLink}\" title=\"{goods|getTitle:true}\" r-html=\"{goods|getTitle}\" data-param=\"{goods|dataParam:goods_index,curStatus}\"></a>\n\t\t\t\t<a class=\"titLink intro\" target=\"_blank\" href=\"{goods|goodsLink}\" title=\"{goods.introduce||''}\" data-param=\"{goods|dataParam:goods_index,curStatus}\">{goods.introduce||''}</a>\n\t\t\t</h3>\n\t\t\t{! 销售进度条 !}\n\t\t\t{#if curStatus=='ing'}\n\t\t\t\t{#if goods|soldout}\n\t\t\t\t\t<div class=\"dlprogress f-cb\">抢完也有优惠哦~</div>\n\t\t\t\t{#else}\n\t\t\t\t\t{#if (goods.activityGoodsSellCount||0)==0}\n\t\t\t\t\t<p class=\"limit f-cb\">限量<i>{goods.activityGoodsStore||0}</i>件</p>\n\t\t\t\t\t{#else}\n\t\t\t\t\t<dl class=\"dlprogress f-cb\">\n\t\t\t\t\t\t<dd class=\"barWrap\"><b class=\"bar\" style=\"width:{goods|remainPercent}%;\"></b></dd>\n\t\t\t\t\t\t<dd class=\"remain\">剩余<i>{goods|remainNum}</i>件</dd>\n\t\t\t\t\t</dl>\n\t\t\t\t\t{/if}\n\t\t\t\t{/if}\n\t\t\t{#else}\n\t\t\t{! 限量角标 !}\n\t\t\t<p class=\"limit f-cb\">限量<i>{goods.activityGoodsStore||0}</i>件</p>\n\t\t\t{/if}\n\t\t\t{! 开抢提醒 !}\n\t\t\t{#if curStatus=='tomorrow'||curStatus=='soon'}\n\t\t\t<a class=\"j-remind u-remind\" href=\"javascript:;\" on-click=\"{this.startBuyNotice(goods,$event)}\"><i class='iconfont' r-html={'&#xe643;'}></i>开抢通知我</a>\n\t\t\t{/if}\n\t\t</div>\n\t\t{! 价格&&行动点区域 !}\n\t\t<div class=\"proaction f-cb act\">\n\t\t{#if curStatus=='tomorrow' || curStatus=='soon' || curStatus=='ready'}\n\t\t\t<p class=\"u-price u-price-blue\">¥<b>{goods.pcMiaoshaPrice||0}{#if goods.showPriceOriginTip}<i class='tip'>起</i>{/if}</b>¥<del>{goods.marketPrice||0}</del></p>\n\t\t\t<a class=\"u-action u-action-blue\" href=\"{goods|goodsLink}\" target=\"_blank\" data-param=\"{goods|dataParam:goods_index,curStatus}\">即将开始</a>\n\t\t{#else}\n\t\t\t{#if goods|soldout}\n\t\t\t<p class=\"u-price u-price-gray\">¥<b>{goods.pcMiaoshaPrice||0}{#if goods.showPriceOriginTip}<i class='tip'>起</i>{/if}</b>¥<del>{goods.marketPrice||0}</del></p>\n\t\t\t<a class=\"u-action\" href=\"{goods|goodsLink}\" target=\"_blank\" data-param=\"{goods|dataParam:goods_index,curStatus}\">去看看</a>\n\t\t\t{#else}\n\t\t\t<p class=\"u-price\">¥<b>{goods.pcMiaoshaPrice||0}{#if goods.showPriceOriginTip}<i class='tip'>起</i>{/if}</b>¥<del>{goods.marketPrice||0}</del></p>\n\t\t\t<a class=\"u-action\" href=\"{goods|goodsLink}\" target=\"_blank\" data-param=\"{goods|dataParam:goods_index,curStatus}\">立即抢购</a>\n\t\t\t{/if}\n\t\t{/if}\n\t\t</div>\n\t</div>\n{/list}\n{#else}\n\t<img src=\"{cdnBaseUrl}images/loadingWhite.gif\" class=\"dl-loading\">\n{/if}\n</section>\n{#if !!goodsList && !!totalPage && !!pageNo}\n<pager total={totalPage} current={pageNo} on-nav={this.pageChange($event)}></pager>\n{/if}\n</article>");
I$(116,function (_, _e ,_v, BaseComponent,tpl,startBuyModal,Pager, p,o,f,r){
	/**
	 * 商品列表模板
	 * @param  goodsList  商品列表
	 * @param  curStatus  ing:抢购中,soon:即将开启,ready:距开抢只有15分钟,tomorrow:明日预告
	 * @param  cdnBaseUrl  默认'/'
	 * @param  kaolaSystemTime  考拉系统时间
	 * @param  query  商品链接中加统计参数
	 * 
	 */
	var goodsList = BaseComponent.extend({
	    template: tpl,
	    config:function(data){
	        data.cdnBaseUrl = data.cdnBaseUrl||'/';
	    },
	    init:function(){
	    	this.supr();
    	},
    	startBuyNotice:function(goods,e){
    		var goodsId = goods.goodsId||'';
            var tabId = goods.tabId||'';
            new startBuyModal({
                data:{
                    goodsId:goodsId,
                    tabId:tabId
                }
            }).$inject(document.body);
    	},
        pageChange:function(pageNo){
            this.$emit('pageChange',pageNo);
        }
	});

    var noop = function(){};

	function hasMemberCount(goods){
		return !!goods.memberCount && (goods.memberCount>0);
	}

	function addZero(num){
		return ("0"+num).slice(-2);
	}

	goodsList.filter({
		'goodsLink':function(goods){
			return "/product/"+(goods.goodsId||0)+".html" + (!!this.data.query?('?'+this.data.query):'');
		},
		'hasMemberCount':hasMemberCount,
		'getTitle':function(goods,isHover){
			var isMulti = hasMemberCount(goods);
			var memberCount = goods.memberCount||'';
			var memberUnitName = goods.memberUnitName||'件';
			var shortTitle = goods.shortTitle||'';
			if(!!isHover){
				return (isMulti?(memberCount+memberUnitName+'装 | '):'')+shortTitle;
			}else{
				return (isMulti?('<b>'+memberCount+memberUnitName+'装 | </b>'):'')+shortTitle;
			}
		},
		'remainPercent':function(goods){
            var remainPercent = 0;
            if((goods.activityGoodsStore||0)!=0){
                remainPercent = 100-(goods.activityGoodsSellCount||0)/(goods.activityGoodsStore||1)*100;
                remainPercent = Math.ceil(remainPercent);
            }
            return remainPercent;
        },
		'remainNum':function(goods){
			var remainNum = "0";
			if((goods.activityGoodsStore||0)!=0){
				remainNum = (goods.activityGoodsStore||0) - (goods.activityGoodsSellCount||0);
			}
			return remainNum;
		},
		'soldout':function(goods){
			return goods.showSoldOut;
		},
		'startHint':function(goods){
			var systemTime = new Date(+this.data.kaolaSystemTime),
				startTime = new Date(goods.startTimeMs||0),
				systemDate = systemTime.getDate(),
				startDate = startTime.getDate(),
				startHour = addZero(startTime.getHours()),
				startMinute = addZero(startTime.getMinutes());
			return '将于'+(systemDate==startDate?'今日 ':'明日 ')+startHour+':'+startMinute+'正式开抢';
		},
        'dataParam':noop
	});

  return goodsList;

},15,4,3,151,311,304,308);
I$(312,"{#list brandList as brand}\n<div class=\"brandWrap\">\n\t<a class='img' href=\"{brand.siteUrl||'javascript:;'}\" target=\"_blank\" data-param=\"{brand|dataParam:brand_index}\">\n\t\t<img class='img-lazyload' src=\"{cdnBaseUrl}images/blank.gif\" data-src=\"{brand|brandImg}\">\n\t</a>\n\t<p class='time {brand.status==0?\"time-notstart\":\"time-start\"}'><b class='iconfont' r-html={'&#xe64c;'}></b><span r-countdown='{brand}'>00:00:00</span></p>\n</div>\n{/list}");
I$(118,function (_, _e ,_v, BaseComponent,tpl,CountZero, p,o,f,r){

	  var brand = BaseComponent.extend({
	    template: tpl,
	    config:function(data){
	        var list = data.list||[],
	          len = list.length,
              index = data.index||0,
              quantity = data.quantity||0,
              brandList = [];
          if(quantity=='all'){
            brandList = list;
          }else{
            for(var i=index;i<index+quantity;i++){
              if(i>=len){
            	  break;
              }
              list[i] = list[i]||{};
              list[i].realIndex = i;
              brandList.push(list[i]);
            }
          }
          data.cdnBaseUrl = data.cdnBaseUrl||'//mm.bst.126.net/';
          data.brandList = brandList;
	    },
	    init:function(){
	    	this.supr();
    	}
    });
    
    var noop = function(){};
    var countZero = CountZero._$allocate();

    brand.directive('r-countdown',function(elem,value){
        var brandData = this.$get(value),
            status = brandData.status||0,//0-未开始 1-进行中
            leftTime = brandData.nowToEndMs||0;
        countZero._$addCount({
            parent:elem,
            leftMs:leftTime,
            format:(status==0?'距开始':'距结束')+"{hh}:{mm}:{ss}",
            onZero:function(){
                
            }
        });
    });

    brand.filter({
      'brandImg':function(brand){
        var img = brand.themeImgUrl||'';
        return _.imgThumbnailUrl(img,536,0,90);
      },
      'dataParam':noop
    });

    return brand;

},15,4,3,151,312,108);
I$(496,"<a href=\"/product/{(goods.goodsId)}.html\" data-param=\"{urlParam}\" title=\"{goods.title}\" target=\"_blank\" class=\"imgwrap\">\n  <img class=\"gimg\" src=\"{cdnBaseUrl}images/blank.gif\" data-src=\"{goods.imageUrl|imgThumbnailUrl:imgWidth||0,imgHeight||0,imgQulity||85}\" alt=\"{goods.title}\">\n  {#if isShowFlag}\n    {#if goods.originCountryRectFlag}\n    <img class=\"u-flag\" src=\"{goods.originCountryRectFlag|imgThumbnailUrl:35}\"/>\n    {#elseif goods.originCountryFlag}\n    <img class=\"u-flag\" src=\"{goods.originCountryFlag|imgThumbnailUrl:28}\"/>\n    {/if}\n  {/if}\n  {#if goods.actualStorageStatus==0}<span class=\"u-icn u-soldout\">已抢光</span>{/if}\n</a>");
I$(497,"  <a class=\"gtlt\" href=\"/product/{goods.goodsId}.html\" data-param=\"{urlParam}\" target=\"_blank\"\n  {#if (goods.memberCount ||0) >0} title=\"{goods.memberCount+(goods.memberUnitName||'件')+'装 | '+goods.title}\"\n  {#else} title=\"{goods.title}\"{/if}>\n    {#if (goods.memberCount ||0) >0}\n        <b>{goods.memberCount+(goods.memberUnitName||'件')+'装 | '}</b>{goods.title}\n    {#else}\n      {goods.title}\n    {/if}\n  </a>\n");
I$(498," <a class=\"gintro f-toe2\" href=\"/product/{(goods.goodsId)}.html\" data-param=\"{urlParam}\" title=\"{goods.introduce}\" target=\"_blank\">{goods.introduce}</a>");
I$(499,"<span class=\"u-gprice\">\n      <em class=\"crtprice\"><span class=\"symbol\">¥</span>{goods.actualCurrentPrice}</em>\n      <i class=\"mktprice\">¥<del>{goods.marketPrice}</del></i>\n  </span>");
I$(500,"{#if (goods.memberCount || 0) > 0 && goods.isShowDiscountCost !== false}\n  <span class=\"u-gtag\"><span class=\"f-fwb\">单{goods.memberUnitName || '件'}¥{goods.memberPrice}</span></span>\n{#else}\n  {#if (goods.discount > 0 && goods.discount < 10)}\n  <span class=\"u-gtag\"><b class=\"num\">{(goods.discount).toFixed(1)}</b>折</span>\n  {/if}\n{/if}\n{#if goods.isPostageFree === true}\n  <span class=\"u-gtag\">包邮</span>\n{/if}");
I$(501,"<a href=\"/product/{(goods.goodsId)}.html\" data-param=\"{urlParam}\" title=\"{btnText || '立即抢购'}\" target=\"_blank\" class=\"u-gbuy\">\n   {btnText || '立即抢购'}\n</a>");
I$(502,"\n<li class=\"m-goods\" ref=\"goodsItem\">\n  {#include tpl_gimg}\n  <div class=\"detail\">\n    <p class=\"tlt\">{#include tpl_gtlt}</p>\n    <p class=\"intro\">{#include tpl_gintro}</p>\n    <p class=\"price\">{#include tpl_gprice}{#include tpl_gtag}</p>\n    <p class=\"btnwrap\">{#include tpl_gbtn}</p>\n  </div>\n</li>");
I$(303,function (_, _e ,_v, request,BaseComponent,tpl_gimg,tpl_gtlt,tpl_gintro,tpl_gprice,tpl_gtag,tpl_gbtn,tpl, p,o,f,r){

	var goodsItem = BaseComponent.extend({
	    template: tpl,
      name: 'goodsItem',
	    config:function(data){
          _.extend(data, {
              tpl_gtlt: tpl_gtlt,
              tpl_gimg: tpl_gimg,
              tpl_gintro: tpl_gintro,
              tpl_gprice: tpl_gprice,
              tpl_gtag: tpl_gtag,
              tpl_gbtn: tpl_gbtn
          });
	    },
	    init:function(){
	    	this.supr();
    	}
	});


  return goodsItem;

},15,4,3,6,151,496,497,498,499,500,501,502);
I$(608,"<table class=\"m-modaltbl m-popmodal\">\n\t<tbody>\n\t\t<tr>\n\t\t  <td class={type==2?\"cell-rightbottom\":\"cell\"} {#if type==2}align=\"right\"{/if}>\n\t\t  <div class=\"modal iDialog {modalName||''} iDialogAniCore iDialogAnimate1\" ref=\"modal\" style=\"background:url({png}) 0 0 no-repeat;width:{width}px;{height}px;\">\n\t\t\t  {#include content ||this.content }\n\t\t\t</div>\n\t\t  </td>\n\t\t</tr>\n\t</tbody>\n</table>");
I$(505,function (_, _e ,_v, BaseComponent,tpl, p,o,f,r){

	var Modal = BaseComponent.extend({
	    template: tpl,
	    init:function(){
	    	this.supr();
	    	var destroy = this.destroy._$bind(this);
    	    _v._$addEvent(document,'keydown', function(event){
    	    	var event = event||window.event;
    	    	if(event.keyCode==27){
    	    		destroy();
    	    		_v._$delEvent(document,'keydown',destroy);
    	    	}
	    	})
	    	if(this.$root == this) this.$inject(document.body);
    	    setTimeout(function(){
    	    	_e._$delClassName(this.$refs['modal'],'iDialogAnimate1');
    	    }._$bind(this),10)
    	},
	    confirm: function(){
	      this.$emit("confirm", this.data);
	      this.destroy();
	    },
	    close: function(){
	      this.$emit("close", this.data);
	      this.destroy();
	    },
	    destroy:function(){
	    	_e._$addClassName(this.$refs['modal'],'iDialogAnimate1');
	    	var destroy = this.supr;
	    	setTimeout(function(){
	    		destroy.apply(this);
	    	}._$bind(this),300)
	    }
	    // 使用timeout模块
	  });

  return Modal;

},15,4,3,151,608);
I$(506,"<a href=\"{url}\" style=\"cursor:pointer;display:block;width:{width}px;height:{height}px;\" on-click={this.close()}></a>\n<a class=\"iDialogClose\" title=\"关闭\" href=\"javascript:void(0)\" on-click={this.close()}></a>\n");
I$(314,function (ut, e,v,ut1, Modal, tpl){
	/**
	 * png		图片
	 * width	宽度
	 * height	高度
	 */
	var PopModal = Modal.extend({
	    content:tpl,
	    data:{width:520},
	    onPhoneNumFocus:function(){
	    	this.data.errorMsg ='';
	    },
	    close:function(){
	    	this.$emit('close',this.data);
	    	this.destroy();
	    }
	});

	// 绑定Modal
  	return PopModal;
},15,4,3,2,505,506);
I$(507,"<div class=\"cntbox\">\n\t<div class=\"u-close\" on-click={this.close()} data-category=\"新人礼包\" data-event=\"引导弹框\" data-label=\"关闭\"></div>\n\t<div class=\"u-btn\" on-click={this.onTakeBtnClick()} id=\"getbag\" data-category=\"新人礼包\" data-event=\"引导弹框\" data-label=\"点击领取\"></div>\n</div>");
I$(315,function (ut, e,v,ut1, Modal, tpl){

	var NewUserModal = Modal.extend({
	    content:tpl,
	    data:{width:760,modalName:'m-onlyimgwin m-newerwin'},
	    init:function(){
	    	this.supr();
	    },
	    onTakeBtnClick: function(){
	    	var newuserUrl = location.protocol +  '//www.kaola.com/activity/detail/' + this.data.__newGiftId__ + '.shtml';
	    	if(!!window.isLogin){
	    		window.location.href = newuserUrl;
	    	}else{
	    		window.location.href = '/login.html?target=' + newuserUrl;
	    	}
	    }
	});

  	return NewUserModal;
},15,4,3,2,128,507);
I$(508,"{#if asideImg!='' && asideLink!='javascript:;' && onSaleGoodsList.length >= 4}\n<article id='{flashSaleId}' class='m-dailylimit'>\n    <h2 class=\"w-tit1 w-tit1-1 tit\"><span class=\"big\">{mainTilte}</span>{#if status==0}{subTitle}{#else}本场还剩<span id=\"j-dltimebox\" class=\"timebox\" leftms='{timeToEndMs}'><i>0</i><i>0</i>:<i>0</i><i>0</i>:<i>0</i><i>0</i></span>{/if}<a class='more' href='{dailyLimitUrl}' target='_blank' data-param=\"{'limitBuy-up-1'|dataParam}\">进入限时购频道&gt;</a></h2>\n    <section class=\"cnt f-cb\">\n        <ul class=\"goodslist\">\n            {#list onSaleGoodsList as goods}\n            <li class=\"goods f-cb\">\n                <a href=\"{goods|goodsLink}\" class=\"pic\" target='_blank' data-param=\"{('limitBuy-mid-'+(goods_index+1))|dataParam}\">\n                    <img class=\"img-lazyload\" src=\"{cdnBaseUrl}images/blank.gif\" data-src=\"{(goods.imageUrl||'')|imgThumbnailUrl:188}\" title=\"{goods|getGoodsTitle:true}\">\n                    {#if (goods|leftNum)==0}\n                    <span class=\"w-icon w-icon-13\">&nbsp;</span>\n                    {/if}\n                    {! 自定义角标 !}\n                    {#if (goods|cornerLabel) != ''}\n                        {#if (goods|cornerLabelLen) > 4}\n                        <span class=\"custom-corner gt4\"><b>{goods|cornerLabel}</b></span>\n                        {#elseif (goods|cornerLabelLen) == 4}\n                        <span class=\"custom-corner\"><b>{goods|cornerLabel}</b></span>\n                        {#else}\n                        <span class=\"custom-corner lt4\"><b>{goods|cornerLabel}</b></span>\n                        {/if}\n                    {/if}\n                </a>\n                <div class=\"detail\">\n                    <h3 class='intro'><a href=\"{goods|goodsLink}\" target='_blank' title=\"{goods.introduce||''}\" data-param=\"{('limitBuy-mid-'+(goods_index+1))|dataParam}\">{goods.introduce||''}</a></h3>\n                    <h3 class='shortTitle'><a href=\"{goods|goodsLink}\" target='_blank' title=\"{goods|getGoodsTitle:true}\" data-param=\"{('limitBuy-mid-'+(goods_index+1))|dataParam}\" r-html={goods|getGoodsTitle:false}></a></h3>\n                    <p class='price'><b>¥</b>{goods.pcMiaoshaPrice||0}<span>¥</span><del>{goods.marketPrice||0}</del></p>\n                    {! 进度条 !}\n                    {#if status==0}\n                    <div class='process process-limit'>限量{goods|goodsStore}件</div>\n                    {#elseif status==1}\n                        {#if (goods|leftNum)==0}\n                        <div class='process process-soldout'>抢完仍有优惠哦～</div>\n                        {#elseif (goods|goodsSellCount)==0}\n                        <div class='process process-limit'>限量{goods|goodsStore}件</div>\n                        {#else}\n                        <div class='process'><b style=\"width:{goods|leftPercent}%;\"></b><p class='text'>剩余{goods|leftNum}件</p></div>\n                        {/if}\n                    {/if}\n                    {! 行动点按钮 !}\n                    {#if status==0}\n                    <a class='btn f-hover btn-soon' href=\"{goods|goodsLink}\" target='_blank' data-param=\"{('limitBuy-mid-'+(goods_index+1))|dataParam}\">即将开始</a>\n                    {#elseif status==1}\n                        {#if (goods|leftNum)==0}\n                        <a class='btn f-hover btn-goto' href=\"{goods|goodsLink}\" target='_blank' data-param=\"{('limitBuy-mid-'+(goods_index+1))|dataParam}\">去看看</a>\n                        {#else}\n                        <a class='btn f-hover' href=\"{goods|goodsLink}\" target='_blank' data-param=\"{('limitBuy-mid-'+(goods_index+1))|dataParam}\">立即抢购</a>\n                        {/if}\n                    {/if}\n                </div>\n            </li>\n            {/list}\n        </ul>\n        <aside class='aside'>\n            <a href=\"{asideLink}\" class=\"pic\" target='_blank' data-param=\"{'limitBuy-right-1'|dataParam}\"><img class=\"img-lazyload\" src=\"{cdnBaseUrl}images/blank.gif\" data-src=\"{asideImg|imgThumbnailUrl:221,378,95}\"></a>\n        </aside>\n    </section>\n</article>\n{/if}");
I$(316,function (_ut,_v,_e,tpl,_,BaseComponent){

    var dlModule = BaseComponent.extend({
        template: tpl,
        config: function(data){
            var flashSaleFloor = data.flashSaleFloor || {};
            _.extend(data,{
                cdnBaseUrl : data.cdnBaseUrl||'//mm.bst.126.net/',
                mainTilte : flashSaleFloor.mainTilte||'',
                subTitle : flashSaleFloor.subTitle||'',
                status : flashSaleFloor.status||0,
                timeToEndMs : flashSaleFloor.timeToEndMs||0,
                asideImg : flashSaleFloor.imgUrl||'',
                asideLink : flashSaleFloor.linkUrl||'javascript:;',
                onSaleGoodsList : flashSaleFloor.onSaleGoodsList||[],
                dailyLimitUrl : '/activity/flashSaleIndex/show.html',
                flashSaleId : flashSaleFloor.floorId||''
            });
        },
        init: function(){
          this.supr();
        }
            
    });

    var goodsStore = function(goods){
        return goods.activityGoodsStore||0;
    }
    var goodsSellCount = function(goods){
        return goods.activityGoodsSellCount||0;
    }
    var cornerLabel = function(goods){
        return goods.cornerLabel||'';
    }
    var leftNum = function(goods){
        return goodsStore(goods) - goodsSellCount(goods);
    }

    dlModule.filter({
        goodsLink:function(goods){
            return "/product/"+(goods.goodsId||0)+".html";
        },
        goodsStore:goodsStore,
        goodsSellCount:goodsSellCount,
        leftNum:leftNum,
        leftPercent:function(goods){
            var store = goodsStore(goods);
            if(store==0){
                return '0.0';
            }else{
                return (100*leftNum(goods)/store).toFixed(1);
            }
        },
        cornerLabel:cornerLabel,
        cornerLabelLen:function(goods){
            return cornerLabel(goods).length;
        },
        dataParam:function(zp){
            return 'ri=home&zid='+this.data.flashSaleId+'&zp='+zp+'&zn=limitBuy';
        },
        // 获取商品标签，包含X件装的逻辑；isHover标示鼠标hover时显示的title，去掉了html代码
        getGoodsTitle:function(goods,isHover){
            var memberCount = goods.memberCount||0;
            var memberUnitName = goods.memberUnitName||'件';
            var shortTitle = goods.shortTitle||'';
            if(memberCount>0){
                if(isHover){
                    return memberCount+memberUnitName+'装 | '+shortTitle;
                }else{
                    return '<b>'+memberCount+memberUnitName+'装 | </b>'+shortTitle;
                }
            }else{
                return shortTitle;
            }
        }
    });
     
    return dlModule;

},2,3,4,508,15,151);
I$(509,"{#if !!appDownloadBanner}\n<article class=\"m-appbanner\" id=\"j-appbanner\" style=\"display:none;\">\n    <a href=\"{appDownloadBanner.siteUrl||''}\" target=\"_blank\">\n        <img src=\"{(appDownloadBanner.imageUrl||'')|noProtocol}\" />\n    </a>\n    <i class=\"close\"></i>\n</article>\n{/if}\n{#if !!appDownloadBanner2}\n<article class=\"m-appbanner2\" id=\"j-appbanner2\" style=\"display:none;\">\n    <div class=\"cont\">\n        <a href=\"{appDownloadBanner2.siteUrl||''}\" target=\"_blank\">\n            <img src=\"{(appDownloadBanner2.imageUrl||'')|noProtocol}\" />\n        </a>\n        <i class=\"close\"></i>\n    </div>\n</article>\n{/if}");
I$(317,function (_ut,_v,_e,tpl,_,BaseComponent){

    var appDownloadBanner = BaseComponent.extend({
        template: tpl,
        config: function(data){
            _.extend(data,{
                
            });
        },
        init: function(){
          this.supr();
        }
            
    });

    
     
    return appDownloadBanner;

},2,3,4,509,15,151);
I$(510,"<div class=\"cntbox\" style=\"background:url({mail.imgUrl}) 0 0 no-repeat;\">\n\t<a target=\"_blank\" class=\"hotzone\" href=\"{mail.url}\" style=\"width:{mail.width}px;height:{mail.height}px;top:{mail.top}px;left:{mail.left}px;\"></a>\n\t<div class=\"u-close close\" on-click={this.close()} data-category=\"邮箱\" data-event=\"引导弹框\" data-label=\"关闭\" r-html=\"{'&#xe605;'}\"></div>\n</div>");
I$(318,function (ut, e, v, ut1, Modal, tpl) {

    return Modal.extend({
        content: tpl,
        data: {width: 760, modalName: 'm-onlyimgwin m-mailtopwin'},
        init: function (data) {
            this.supr();
            var mail = data.mail;
            mail.url = mail.url || '';
            mail.width = mail.width || 0;
            mail.height = mail.height || 0;
            mail.top = mail.top || 0;
            mail.left = mail.left || 0;
        }
    });

},15,4,3,2,128,510);
I$(511,"{#if !!mailTabAdImageLink && !!mailTabAdImageUrl}\n<article class=\"m-appbanner2\" id=\"j-mailbanner\" style=\"display:none;\">\n    <div class=\"cont\">\n        <a href=\"{(mailTabAdImageLink||'')|noProtocol}\" target=\"_blank\">\n            <img src=\"{(mailTabAdImageUrl||'')|noProtocol}\" />\n        </a>\n        <i class=\"close\"></i>\n    </div>\n</article>\n{/if}");
I$(319,function (_ut,_v,_e,tpl,_,BaseComponent){

    var mailTabAd = BaseComponent.extend({
        template: tpl,
        config: function(data){
            _.extend(data,{
                
            });
        },
        init: function(){
          this.supr();
        }
            
    });

    
     
    return mailTabAd;

},2,3,4,511,15,151);
I$(320,function (_k, _ut, _t, _v, _e, Bezier, _p, _o, _f, _r, _pro) {

    /**
     * 倒计时控件封装
     *
     * @extends module:util/event._$$EventTarget
     *
     * @param    {Object}  config   - 可选配置参数
     * @property {Node}  wrap  - 公告list的wrap，默认list的parentNode
     * @property {Array}  list  - 公告list【必需】
     * @property {Number}  offset  - 公告list切换的幅度【必需】
     * @property {Number} duration  - 切换的时间间隔，默认5000ms
     * @property {Number} aniDuration  - 切换动画的执行时间，500ms
     * @property {Function} timing  - 切换的时间函数，默认'easeinout'
     * @property {Boolean} mouseEvent  - 是否有鼠标移入暂停滚动的事件，默认true
     * @property {Function} onChange  - 每次公告切换完成回调
     *
     */
    
    _p._$$Announce = _k._$klass();
    _pro = _p._$$Announce._$extend(_t._$$EventTarget);

    _pro.__reset = function(_options) {
        this.__super(_options);
        this._list = _options.list||[];
        this._offset = _options.offset||0;
        this._duration = _options.duration||5000;
        this._aniDuration = _options.aniDuration||500;
        this._timing = _options.timing||'easeinout';
        this._onChange = _options.onChange;
        this._mouseEvent = !!_options.mouseEvent||true;
        this._timer = null;
        //list没有，list小于2条，offset没有，这些情况不处理
        if(!this._list || this._list.length<=1 || this._offset==0){
            return;
        }
        this._wrap = _options.wrap || this._list[0].parentNode;
        //初始化
        this.__startAnnounce();
        //mouse事件
        if(this._mouseEvent){
            this.__bindMouseEvent();
        }
    };

    _pro.__startAnnounce = function(){
        this._timer = setInterval(this.__changeAnnounce._$bind(this),this._duration);
    };

    _pro.__changeAnnounce = function(){
        var self = this;
        var firstNode = this._list[0];
        Bezier._$$AnimBezier._$allocate({
            from: {
                offset: 0
            },
            to:{
                offset: this._offset
            },
            duration:this._aniDuration,
            timing:this._timing,
            onupdate:function(_event){
                firstNode.style.marginTop = -_event.offset+"px";
            },
            onstop:function(){
                firstNode.style.marginTop = 0;
                firstNode.parentNode.appendChild(firstNode);
                self.__callback();
                // 动画停止后回收控件
                this._$recycle();
            }
        })._$play();
    };

    _pro.__callback = function(){
        if(this._onChange && _ut._$isFunction(this._onChange)){
            this._onChange();
        }
    };

    _pro.__bindMouseEvent = function(){
        _v._$addEvent(this._wrap,'mouseenter',this.__onWrapMouseEnter._$bind(this))
        _v._$addEvent(this._wrap,'mouseleave',this.__onWrapMouseLeave._$bind(this))
    };

    _pro.__onWrapMouseEnter = function(){
        window.clearInterval(this._timer);
    };

    _pro.__onWrapMouseLeave = function(){
        this.__startAnnounce();
    };

    return _p._$$Announce;

  },1,2,23,3,4,96);
I$(512,"<li class=\"hide\">\n    <a class=\"itm\" target=\"_blank\" href=\"{banner|urlstr|removeHash}\" on-click={this.daEvent($event)} data-param=\"{banner|dataParam:index}\" >\n        <img class=\"showImg\" src=\"{(banner.imageUrl||'')|imgThumbnailUrl:1920,0,90}\" width=\"1920px\" height=\"400px\"/>\n        {#if banner.imageUrlSmall!=\"\"}\n        <img class=\"logoImg\" src=\"{(banner.imageUrlSmall||'')|noProtocol}\" />\n        {/if}\n    </a>\n</li>");
I$(321,function (_ut,_,tpl, BaseComponent){

  var origin = BaseComponent.extend({
    template: tpl,
    config:function(data){
      _.extend(data,{
        
      });
    },
    init: function(){
      
    },
    daEvent: function(){
      _.daEvent('é¦–é¡µ','banner',this.data.index+1,{customData:urlstr(this.data.banner)});
    }

  });

  var urlstr = function(banner){
    var banner = banner || {};
    return banner.siteUrl||'';
  }

  origin.filter({
    dataParam:function(banner,index){
      var banner = banner || {};
      var hash = urlstr(banner).split('#')[1];
      return 'ri=home&zp=banner-'+(index+1)+'&zn=banner'+(!!hash?'#'+hash:'');
    },
    removeHash:function(url){
      var url = url || '';
      return url.split('#')[0];
    },
    urlstr:urlstr
  });
  
  return origin;

},2,15,512,151);
I$(513,"<table class=\"img_pagebox\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" style=\"z-index: 11;\">\n    <tbody>\n    <tr class=\"img_page\">\n        <td id=\"icon_num\" class=\"pageBox\">\n            <span class=\"w-slbtn\">\n              <span class=\"partr\">\n                {#list 1..len as num}\n                    <a class=\"idxicon\"\n                       r-class=\"{{'first active':num==1, 'last':num==len}}\"\n                      href=\"javascript:void(0)\"><i class=\"iconfont\" r-html=\"{'&#xe603;'}\"></i><span class=\"num\">{num}</span>\n                    </a>\n                {/list}\n                </span>\n            </span>\n        </td>\n    </tr>\n    </tbody>\n</table>\n<div class=\"control\" style=\"z-index: 11;\">\n    <div>\n        <a href=\"javascript:void(0)\" class=\"cons prev ani\"></a>\n        <a href=\"javascript:void(0)\" class=\"cons next ani\"></a>\n    </div>\n</div>");
I$(322,function (_ut,_,tpl, BaseComponent){

  return BaseComponent.extend({
    template: tpl,
    config: function(data){
    },
    init: function(){
    }
  });

},2,15,513,151);
I$(123,function (_k,_ut,_v,_t,_e,_pt,LazyImg,request,gtm,POPModal, NewUserModal,ListGuess,DlModule,AppDownloadBanner,MailTopModal,MailTabAd,
             _j,Slider,Announce,CountZero,ScrollTo,_v1,_q,followBrand,Origin,Iconnum,_p,_o,_f,_r,_pro) {
        var _pro;

        _p._$$Index = _k._$klass();
        _pro = _p._$$Index._$extend(_t._$$EventTarget);
        
        /**
         * é¦–é¡µé€»è¾‘æ¨¡å—åˆå§‹åŒ–
         * @param  {Object} é…ç½®å‚æ•°
         * @return {Void}
         */
        _pro.__reset = function(_options){
            this.__super(_options);
            //æ˜¯å¦æ˜¯é‚®ç®±å†…æ‰“å¼€
            this.__isMail = !!_options.isMail;
            // lazy loading
            LazyImg._$allocate({exploreDist:1000});
            //ç§»åŠ¨ç«¯æµè§ˆå™¨æ‰“å¼€è¯¦æƒ…é¡µï¼Œtargetè®¾ä¸ºå½“å‰é¡µ jira#5786
            this.__initLinkTarget(); 
            // é¦–é¡µæµ®å±‚ã€å°éƒ¨ä»¶æ˜¾ç¤ºé¡ºåºæŽ§åˆ¶ï¼Œé™æ€åŒ–å¤„ç†ï¼ŒKJDS-14600
            this.__staticizeDisplayCtrl();
            // slider
            this.__initSlide();
            // è€ƒæ‹‰å…¬å‘Š
            this.__announce();
            // bannerä¸‹é¢ä¸€æŽ’xèµ„æºä½
            this.__rowofx();
            //é™æ—¶è´­æ¨¡å—å¼‚æ­¥åŒ–
            this.__dailyLimit();
            //å·¦ä¾§å¯¼èˆªç‚¹å‡»äº‹ä»¶
            this.__leftNavEvent();
            // æ¥¼å±‚å„ä¸ªæ¨¡å—slider
            this.__initSlideFloor();
            // å¤„ç†äºŒçº§ç±»ç›®
            this.__processSecondList();
            // çŒœä½ å–œæ¬¢
            this.__recommendlist();
            // å“ç‰Œæ”¶è—åŠŸèƒ½
            this.__followBrand();
            // GTM æ•°æ®æ”¶é›†
            this.__gtmCollect();
        };
        _pro.__followBrand = function(){
        	var followlist = _q('.w-logolist .follow');
            if(followlist.length){
            	followlist._$on('click', function(event){
            		_v._$stop(event);
            		
            		var target = _v._$getElement(event),
            			bid = _e._$attr(target,'data-bid');
            		followBrand.addFav(event, bid, target, this);
	            }._$bind(this));
            }
        };
        _pro.__processSecondList = function(){
        	var _banner = _e._$get('j-profloorlist'),
	    		_bannerlist = _e._$getByClassName(_banner,'w-secondlist');
	    	if(_bannerlist && _bannerlist.length>0){
	    		_ut._$forEach(_bannerlist,function(_item,_index,_list){
	    			//èµ„æºä½_ç±»ç›®n&åç§°
	    			var _keylist = _e._$getByClassName(_item,'txt');
	    			if(_keylist && _keylist.length>0){
	    				_ut._$forEach(_keylist,function(_item,_index,_list){
		    				var _txt = _item.innerHTML || '';
		    				var _len = _txt.replace(/[^\x00-\xff]/g, "r").length;
		    	            if (_len >4) {
		    	            	_e._$addClassName(_item,'txt-1');
		    	            }
	    				}._$bind(this));
	    			}
	    		}._$bind(this));
	    	}
        };
        _pro.__initLinkTarget = function(){
    		if(/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase())){
    			console.log('mobile');
    			var links = document.getElementsByTagName('a'), href = '';
    			
    			for(var i=0,l=links.length;i<l;i++){
    				href = links[i].href;
    				if(href.indexOf('/product/')> -1){
    					links[i].removeAttribute('target');
    				}
    			}
    		}
    	};
        /**
         * é¦–é¡µæµ®å±‚ã€å°éƒ¨ä»¶æ˜¾ç¤ºé¡ºåºæŽ§åˆ¶ï¼Œé™æ€åŒ–å¤„ç†ï¼ŒKJDS-14600
         *  ä¸€ã€æ¶‰åŠåˆ°çš„å†…å®¹ï¼š
                1.æ–°äººç¤¼æµ®å±‚ï¼ˆæ–°è€ç”¨æˆ·ï¼‰
                3.appä¸‹è½½æµ®å±‚ï¼ˆï¼‰
                4.åˆä¼™äººå¼¹çª—ï¼ˆç”¨æˆ·ç›¸å…³ï¼‰
                5.é‚®ç®±é‡Œçš„å¸åº•æµ®å±‚
                6.é‚®ç®±å¼¹çª—
                7.å‰ç«¯æ ¹æ®userAccountæ‰“ç‚¹
            äºŒã€æ˜¾ç¤ºè§„åˆ™ï¼š
                1.è‹¥åŒ…å«blockå‚æ•°ï¼Œä¸å±•ç¤ºæ–°äººç¤¼åŒ…ã€appä¸‹è½½æµ®å±‚ï¼›å¦‚æžœæœ‰å¤§ä¿ƒæµ®å±‚ï¼Œåˆ™å±•ç¤ºã€‚
                2.ä¸åŒ…å«blockå‚æ•°ï¼Œ
                ----2.1ä¼˜å…ˆå±•ç¤ºå¤§ä¿ƒåº•éƒ¨æµ®å±‚ï¼Œä¸å±•ç¤ºappä¸‹è½½æµ®å±‚ã€‚
                ----2.2æœ‰å¤§ä¿ƒæµ®å±‚ã€æ–°äººç¤¼æµ®å±‚ï¼Œéƒ½å±•ç¤ºï¼Œä¸å±•ç¤ºappä¸‹è½½æµ®å±‚ï¼›
                ----2.3æœ‰æ–°äººç¤¼æµ®å±‚ï¼Œä¸å±•ç¤ºappä¸‹è½½æµ®å±‚
                3.é‚®ç®±é‡Œä¸å±•ç¤ºæ–°äººç¤¼åŒ…æµ®å±‚ã€appä¸‹è½½æµ®å±‚ï¼›è‹¥æœ‰å¤§ä¿ƒæµ®å±‚ï¼Œåˆ™å±•ç¤ºå¤§ä¿ƒï¼›è‹¥æ²¡æœ‰å¤§ä¿ƒæµ®å±‚ï¼Œæœ‰é‚®ç®±åº•éƒ¨å¹¿å‘Šä½ï¼Œåˆ™å±•ç¤ºåº•éƒ¨å¹¿å‘Šä½
         * hzmating 20160603
         */
        _pro.__staticizeDisplayCtrl = function(){
            if(this.__isMail){
                this.__getMailPopupDivs();
            }else{
                this.__getPopupDivs();
            }
        };
        /**
         * éžé‚®ç®±ä¸­ é¦–é¡µæµ®å±‚ã€å°éƒ¨ä»¶æ˜¾ç¤ºé¡ºåºæŽ§åˆ¶
         */
        _pro.__getPopupDivs = function(){
            var hasBlock = 'block' in _ut._$query2object(location.search.replace(/^\?/,''));//æ˜¯å¦æœ‰æŽ¨å¹¿å‚æ•°
            request('/index/ajax/getPopupDivs.html',{
              data:{
            	  block:hasBlock?1:0,
            	  hasNav:!!_e._$get('js_bottomnav')?1:0
              },
              norest:true,
              method:"post",
              onload:function(_json){
                var json = _json || {},
                    retcode = json.retcode || -1,
                    body = json.body || {},
                    newPartnerNotice = _e._$get('j-newPartnerNotice');//合伙人提示
                if(retcode==200){
                  //是否出现合伙人提示
                  if(body.indexInternalStaffIsShow==1){
                    _e._$delClassName(newPartnerNotice,'f-dn');
                  }else{
                    _e._$remove(newPartnerNotice);
                  }
                  //appDownloadBanner & appDownloadBanner2
                  if(body.appDownloadBanner || body.appDownloadBanner2){
                    new AppDownloadBanner({
                        data:{
                            appDownloadBanner:body.appDownloadBanner,
                            appDownloadBanner2:body.appDownloadBanner2
                        }
                    }).$inject('#index-netease-com');
                  }
                  //是否新人礼弹窗
                  this.__IsShowWin__ = body.newUserGiftPopup||0;
                  //新人礼礼包id
                  this.__newGiftId__ = body.newUserGiftActivityId||'';
                }else{
                   _e._$remove(newPartnerNotice);
                }
                // 首页浮层显示顺序控制
                this.__showWin();
                // 移动端下载app banner
                this.__initMobileAppBanner();
              }._$bind(this)
            })
        };
        /**
         * 邮箱中 首页浮层、小部件显示顺序控制
         */
        _pro.__getMailPopupDivs = function(){
            var hasBlock = 'block' in _ut._$query2object(location.search.replace(/^\?/,''));//是否有推广参数
            request('/index/ajax/getMailPopupDivs.html',{
              data:{block:hasBlock?1:0},
              norest:true,
              method:"post",
              onload:function(_json){
                var json = _json || {},
                    retcode = json.retcode || -1,
                    body = json.body || {},
                    newPartnerNotice = _e._$get('j-newPartnerNotice');//合伙人提示
                if(retcode==200){
                    // 邮箱首页弹窗 hztianyanan KJDS-6363
                    if(body.mailTopPop){
                        new MailTopModal({data: {mail: body.mailTopPop || {}}});
                    }
                    // 邮箱嵌入版新加ini可配置拉新入口 add by lzf; jira#3032
                    if(body.mailTabAdImageLink && body.mailTabAdImageUrl){
                        new MailTabAd({
                            data: {
                                mailTabAdImageLink: body.mailTabAdImageLink,
                                mailTabAdImageUrl: body.mailTabAdImageUrl
                            }
                        }).$inject('#index-netease-com');
                        // 邮箱嵌入ini可配置拉新入口
                        this.__initMailFootBanner();
                    }
                }
                //合伙人提示 邮箱中删除
                _e._$remove(newPartnerNotice);
                // 首页浮层显示顺序控制
                this.__showWin();
              }._$bind(this)
            })
        };
        /**
         * 手机访问www的app下载浮层控制
         */
    	_pro.__initMobileAppBanner = function(){
    		// appDownloadBanner
    		var appbanner = _e._$get('j-appbanner');
    		if(!!appbanner){
    			var indexappbanner = _j._$cookie("NTES_KAOLA_INDEXAPPBANNER");
        		if(!!indexappbanner && indexappbanner=='-1'){
        			//return;
        		}else{
        			appbanner.style.display ='block';
        		}
        		var list = _e._$getByClassName(appbanner,'close');
            	if(list.length){
    	        	_v._$addEvent(list[0],'click',function(){
    	        		appbanner.style.display ='none';
    	        		_j._$cookie('NTES_KAOLA_INDEXAPPBANNER',{value: '-1',
							   path : '/', domain: 'kaola.com', expires:365});
    	    		}._$bind(this));
            	}
    		}
    	};
        // 新人大礼包 > 首页app下载banner > 首页广告弹窗
        _pro.__showWin = function(){
            // 新人大礼包弹窗
            this.__checkIsNewer();
			if(!this.__hasShowWin) {
            	var _appbanner2 = _e._$get('j-appbanner2');
                var _indexappbanner2 = _j._$cookie("NTES_KAOLA_INDEXAPPBANNER2");
    			if(!!_indexappbanner2 ){
    				var now = new Date(),
    					date=now.getDate(),
    					month=now.getMonth(),
    					preCloseDay = new Date(parseInt(_indexappbanner2)),
    					preCloseDate = preCloseDay.getDate(),
    					preCloseMonth = preCloseDay.getMonth();
    				if(preCloseDate!=date||(preCloseMonth!=month&&preCloseDate==date)){	// 不在同一天，要跳“app下载”这个提示
    					if(!!_appbanner2){
    						// appDownloadBanner2
    						_appbanner2.style.display ='block';
    					}else{
    						// 后台配置弹层（ajax）
    		                this.__checkPageAd();
    					}
    				} else{
    					this.__checkPageAd();
    				}
    			}else{
    				if(!!_appbanner2){
    					_appbanner2.style.display ='block';
    				}else{
    					this.__checkPageAd();
    				}
    			}
    			
    			if(!!_appbanner2){
	    			var list = _e._$getByClassName(_appbanner2,'close');
	            	if(list.length){
	    	        	_v._$addEvent(list[0],'click',function(){
	    	        		_appbanner2.style.display ='none';
	    	        		_j._$cookie('NTES_KAOLA_INDEXAPPBANNER2',{value: +new Date(),
								   path : '/', domain: 'kaola.com', expires:1});
	    	    		}._$bind(this));
	            	}
    			}
            }
        };
        /**
         * 新人大礼包弹窗
         */
        _pro.__checkIsNewer = function(){
			if(!!this.__IsShowWin__ && !this.__hasShowWin) {
                new NewUserModal({
                    data:{
                        __newGiftId__:this.__newGiftId__
                    }
                });
				this.__hasShowWin = 1;
            }
        };
        // 邮箱嵌入ini可配置拉新入口 add by lzf jira#3032
        _pro.__initMailFootBanner = function(){
          // mailfootBanner
          var mailbanner = _e._$get('j-mailbanner');
          if(!!mailbanner){
            var indexmailbanner = _j._$cookie("NTES_KAOLA_INDEXMAILBANNER");
            if(!!indexmailbanner && indexmailbanner=='-1'){
              //return;
            }else{
              mailbanner.style.display ='block';
            }
            var list = _e._$getByClassName(mailbanner,'close');
            if(list.length){
              _v._$addEvent(list[0],'click',function(){
                mailbanner.style.display ='none';
                _j._$cookie('NTES_KAOLA_INDEXMAILBANNER',{value: '-1',
                   path : '/', domain: 'kaola.com', expires:365});
              }._$bind(this));
            }
          }
        };
        /**
         * 楼层各个模块slider
         */
        _pro.__initSlideFloor = function(){
        	var slideBox = _q('.m-prolist');
        	if(!!slideBox.length) {
            	_ut._$forEach(slideBox,function(_item,_index,_list){
                	var list = _e._$getByClassName(_list[_index],'itemgroup');
                	if(list.length<2){
                		return;
                	}
                	var indexIcons = _e._$getByClassName(_list[_index],'idxicon');
                	
                	Slider._$allocate({
                		list:list,
                		icons:indexIcons
                	});
            	});
            }
        };        
        // banner下面一排x资源位
        _pro.__rowofx = function(){
            var rowOfXWrap = _e._$get('rowOfXResource'),
                newuserWrap = _e._$getByClassName(rowOfXWrap,'j-newuser-row')[0],
                olduserWrap = _e._$getByClassName(rowOfXWrap,'j-olduser-row')[0],
                top = +_e._$attr(rowOfXWrap,'top');
            this.__rowofxHasBg = _e._$attr(rowOfXWrap,'hasBg')=='true';
            //移除占位节点
            _e._$remove('j-rowofx');
            if(!newuserWrap && !olduserWrap){
                _e._$remove(rowOfXWrap);
                return;
            }
            if(_j._$cookie('KAOLA_NEW_USER_COOKIE')=='no'){//老用户
                if(!olduserWrap){//老用户资源位没有
                    _e._$remove(rowOfXWrap);
                    return;
                }else{
                    _e._$remove(newuserWrap);
                    _e._$delClassName(rowOfXWrap,'f-dn');
                }
            }else{//新用户
                _j._$cookie('KAOLA_NEW_USER_COOKIE',{value:'no',path : '/', expires:365,domain:'.kaola.com'});
                if(!newuserWrap){//新用户资源位没有
                    _e._$remove(rowOfXWrap);
                    return;
                }else{
                    _e._$remove(olduserWrap);
                    _e._$delClassName(rowOfXWrap,'f-dn');
                }
            }
            //调整侧滑参数
            //IE低版本不处理
            if(this.__isIEOldVer()){
                return;
            }
            var mainWrap = _e._$getByClassName(document.body,'mainBgWrap')[0];
            var mainWrapReat = mainWrap.getBoundingClientRect();
            var scrollTop = document.body.scrollTop||document.documentElement.scrollTop;
            if(this.__rowofxHasBg){
                this._$dispatchEvent('refreshRightBar',{
                    __offsetABTop : scrollTop + mainWrapReat.top + mainWrap.clientHeight
                });
            }else{
                var rowOfXRect = rowOfXWrap.getBoundingClientRect();
                var __top = scrollTop + rowOfXRect.top + top;//开始滚动的位置
                this._$dispatchEvent('refreshRightBar',{
                    __offsetABTop:scrollTop + rowOfXRect.top + top + __top,
                    __abTop:-(mainWrapReat.top - rowOfXRect.top - top),//侧滑静止时距离mainWrap顶部距离
                    __top:__top//开始滚动的位置
                });
            }
        };
        //限时购请求后（可能有限时购，可能没有，如果没有则侧滑距顶加37-20px），对齐两侧侧滑
        _pro.__alignSlideSlip = function(){
            //IE低版本不处理
            if(this.__isIEOldVer()){
                return;
            }
            var indexleft = _e._$get('indexleft'),
                rowOfXWrap = _e._$get('rowOfXResource');
            if(!this.__rowofxHasBg && !this.__isMail && rowOfXWrap){
                var top = +_e._$attr(rowOfXWrap,'top'),
                    rowOfXRect = rowOfXWrap.getBoundingClientRect(),
                    mainWrap = _e._$getByClassName(document.body,'mainBgWrap')[0],
                    mainWrapReat = mainWrap.getBoundingClientRect();
                this._$dispatchEvent('refreshRightBar',{
                    __abTop:-(mainWrapReat.top - rowOfXRect.top - top)//侧滑静止时距离mainWrap顶部距离
                });
            }
        };
		// 猜你喜欢
        _pro.__recommendlist = function() {
    		var recommondData = {
    			'strategy':'fav',
    			'limit':4,
    			'account':window.account || '',
                'ver':2,
                'from':'pc',
                'tongji':{
                    'category':'推荐区域展示',
                    'action':'首页',
                    'lable':'猜你喜欢',
                    'position':'首页：猜你喜欢',
                    'from':'homecnxh',
                    'query':'rp=home&zp=cnxh&zn=rec&recId='
                }
    		};
			new ListGuess({
				data: {
					url: '/recommend/getRecommendGoods.html', condition: recommondData,
					dapushParam: {id: "guess", page: "首页", module: "猜你喜欢"}//停留打点参数
				}
			}).$inject(_e._$get('guess'));
    	};
        /**
         * 检查是否有广告
         */
        _pro.__checkPageAd = function(){
        	request('/surprise/get.html',{
        		query:{url:encodeURIComponent(document.URL)},
        		norest:true,
        		onload:function(_json){
        			var list = _json.adList;
        			for(var i=0,l=list.length;i<l;i++){
        				var opt = {};
        				opt.id = list[i].adId;
        				opt.png = list[i].adImg;
        				opt.url = list[i].adUrl;
        				opt.mode = list[i].closeType;
    					//暂时处理这两个位置
        				opt.type = {
    						"center" : 1,
    						"right-bottom" : 2
    					}[list[i].location||"center"];
        				opt.txt = list[i].adContent;
        				opt.layout = !!list[i].coverScreen;
        				this.__showPOPWin(opt);
        			}
        		}._$bind(this)
        		
        	})
        };
        /**
         * 首页弹窗逻辑
         */
        _pro.__showPOPWin= function(opt){
        	var key ='mmAd' + opt.id;
        	var cookie = _j._$cookie(key);
        	if(cookie){
        		return;
        	}
        	var img = new Image();
        	img.onload = function(){
        		opt.width = this.width;
        		opt.height = this.height;
        		var modal = new POPModal({data:opt});
        		modal.$on('close',function(_item){
        			var key= 'mmAd' + _item.id;
        			_j._$cookie( key,{value:'-1',path : '/', domain: 'kaola.com', expires:365});
        		})
        	}
        	img.src = opt.png;
        };
        /**
         * 首页渐现渐隐功能
         */
        _pro.__initSlide= function(){
        	request('/getPCBannerList.html',{
                norest:true,
                onload:function(_json){
                    var json = _json || {},
                        code = json.code || -1,
                        body = json.body || {},
                        bannerList = body.bannerList || [];
                    if(code==200 && bannerList.length>1){
                        this.__createSlideNode(bannerList);
                    }
                }._$bind(this)
            })
        };
        /**
         * 插入轮播节点(大图，缩略图)
         */
        _pro.__createSlideNode = function(bannerList){
            //插入大图
            _ut._$forEach(bannerList,function(banner,i){
                if(i!=0){
                    new Origin({
                        data:{
                            banner:banner,
                            index:i
                        }
                    }).$inject('#show_pic','bottom');
                }
            }._$bind(this));
            //缩略图
            new Iconnum({
                data:{len:bannerList.length || 0}
            }).$inject('#show_pic','after');
            //绑定首页轮播相关事件
            this.__bindSlide();
        };
        /**
         * 绑定首页轮播相关事件
         */
        _pro.__bindSlide = function(){
            var slideBox = _e._$get('picBox');
            var list = _e._$getChildren(_e._$get('show_pic'))||[];
            if(!list || list.length<2){
                return;
            }
            //var thumbnailBox = _e._$get('j-thumbnailbox');
            //var itemGroups = _e._$getByClassName(thumbnailBox,'itmBox');
            //var items = _e._$getByClassName(thumbnailBox,'itm');
            //var arrows = _e._$getByClassName(thumbnailBox,'arrow');

            var indexIcons = _e._$getByClassName(slideBox,'idxicon');
            var btns = _e._$getByClassName(slideBox,'cons');

            _v1._$hover(slideBox,'j-sliderBoxhover');//ie 6下hover
            var slider = Slider._$allocate({
              box:slideBox,
              list:list,
              icons:indexIcons,//
              preBtn:btns[0],//
              nextBtn:btns[1]//
              //,
              //thumbnailAni:{
              //    wrap : thumbnailBox,
              //    itemGroups : itemGroups,
              //    items : items,
              //    preArrow:arrows[0],
              //    nextArrow:arrows[1]
              //}
            });
        };
        /**
         * 考拉公告
         */
        _pro.__announce = function(){
            var announce = _e._$get('j-announce');
            if(!announce){
                return;
            }
            Announce._$allocate({
                list : announce.getElementsByTagName('li'),
                offset : 18
            });
        };
        /**
         * 限时购倒计时
         */
        _pro.__dltimebox = function(){
            var dltimebox = _e._$get('j-dltimebox');
            var leftMs = +_e._$attr(dltimebox,'leftms');
            if(!dltimebox || leftMs<=0){
                return;
            }
            CountZero._$allocate({
                parent:dltimebox,
                leftMs:leftMs,
                format:'<i>{hh:1}</i><i>{hh:2}</i>:<i>{mm:1}</i><i>{mm:2}</i>:<i>{ss:1}</i><i>{ss:2}</i>',
                onZero:function(){
                    window.location.reload();
                }
            });
        };
        /**
         * 左侧栏插入限时购栏
         */
        _pro.__inject2Leftbar = function(flashSaleFloor){
            var indexleft = _e._$get('indexleft');
            if(!indexleft){
                return;
            }
            var channel = _e._$getByClassName(indexleft,'channel')[0],
                floorId = flashSaleFloor.floorId||'',
                mainTilte = flashSaleFloor.mainTilte||'';
            if(!!channel){
                var node = _q('<li><a href="javascript:;" class="j-floor" data-id="'+floorId+'">'+mainTilte+'</a></li>')[0];
                channel.insertBefore(node,_e._$getChildren(channel)[0]);
            }
        };
        /**
         * 限时购模块异步化
         */
        _pro.__dailyLimit = function(){
            var dailyLimitNode = _e._$get('j-dailyLimit');
            if(!dailyLimitNode) return;
            request('/index/ajax/getFlashSaleFloor.html',{
                norest:true,
                onload:function(_json){
                    var json = _json||{},
                        retcode = json.retcode||-1,
                        body = json.body||{},
                        flashSaleFloor = body.flashSaleFloor;
                    if(retcode==200 && !!flashSaleFloor){
                        new DlModule({
                            data:{
                                flashSaleFloor:flashSaleFloor,
                                cdnBaseUrl:window.cdnBaseUrl||''
                            }
                        }).$inject(dailyLimitNode,'after');
                        // 今日限时购倒计时
                        this.__dltimebox();
                        if(!this.__isMail){
                        	// 左侧栏插入限时购栏
                            this.__inject2Leftbar(flashSaleFloor);
                        }
                    }
                    //删除占位元素
                    _e._$remove(dailyLimitNode);
                    //对齐侧滑
                    this.__alignSlideSlip();
                    //触发lazyloading
                    _v._$dispatchEvent(window,'scroll');
                }._$bind(this),
                onerror:function(){
                    //删除占位元素
                    _e._$remove(dailyLimitNode);
                    //对齐侧滑
                    this.__alignSlideSlip();
                }._$bind(this)
            });
        };
        /**
         * 左侧导航点击事件
         */
        _pro.__leftNavEvent = function(){
            _q('body')._$on('click #indexleft .j-floor',function(e){
                    var target = _v._$getElement(e),
                        moduleId = _e._$attr(target,'data-id'),
                        module = _e._$get(moduleId);
                    if(!!module){
                        ScrollTo._$allocate({
                            scrollTo:module,
                            offset:-58,
                            duration:500,
                            timing:'easeinout'
                        });
                    }
                });
        };
        /**
         * 替换onclick da打点中的userAccountPH字段为真正的账号
         * 静态化处理
         * hzmating 20160606
         */
        _pro._$replaceUserAccountPH = function(){
            _q('a[onclick]')._$forEach(function(_node){
                var onclick = _node.getAttribute('onclick');
                if(typeof onclick==='string'){
                    _node.setAttribute('onclick',onclick.replace(/(\'userAccount\'\:\')\'/g,'$1'+window.account+"'").replace(/(\'userId\'\:\')\'/g,'$1'+window.account+"'"));
                }
            });
        };
        /**
         * GTM 数据收集
         */
        _pro.__gtmCollect = function(){
            gtm.gtmReadyAsync({
                com_data:{
                    page_type:'home'
                }
            });
        };
        /**
         * 是否IE低版本（IE6,7）
         */
        _pro.__isIEOldVer = (function(){
            var isIEOrderVer = _pt._$KERNEL.browser=='ie'&&_pt._$KERNEL.release<='3.0'
            return function(){
                return isIEOrderVer;
            }
        })();

        return _p._$$Index;
    },1,2,3,23,4,78,24,6,44,314,315,82,316,317,318,319,11,106,320,108,95,107,25,257,321,322);
I$(492,"<div id=\"brandboxwrap\">\n    <div class=\"name\"  r-class=\"{{'letter':isShow}}\">品牌：</div>\n    {#if isShow}\n    <ul class=\"letterBox clearfix\">\n        <li on-mouseover=\"{this.letterChange(0)}\" r-class=\"{{'active':selected==0}}\" style=\"margin-left:15px;\">全部</li>\n        {#list letterList as letter}\n        <li on-mouseover=\"{this.letterChange(letter)}\" r-class=\"{{'active':selected==letter}}\" >{letter}</li>\n        {/list}\n        <li on-mouseover=\"{this.letterChange(-1)}\" r-class=\"{{'active':selected==-1}}\">其它</li>\n    </ul>\n    {/if}\n    <div class=\"hdbrands j-tagwrap\" r-class='{{\"autoheight\": isShow, \"line2height\": !isShow}}'>\n        <div class=\"hdbrands2 ctag\">\n            <div class=\"brands  brands-cate all ctag\">{#list brandList as brand}<a title=\"{brand.brandName}\" data-brid=\"{brand.brandId}\" href=\"{brand.url}\">{brand.brandName}</a>{/list}\n            </div>\n        </div>\n    </div>\n    <div class=\"morewrap\">\n\n        <div class=\"more ctag\" on-click=\"{this.changeList()}\">{#if !isShow}展开<span></span>{#else}收起<span class=\"packup\"></span>{/if}\n        </div>\n    </div>\n</div>");
I$(493,function (){

        var Pinyin = function (ops){
                this.initialize(ops);
            },

            options = {
                checkPolyphone: false,
                charcase: 'default'
            };


        Pinyin.fn = Pinyin.prototype = {
            init: function (ops){
                this.options = extend(options, ops);
            },

            initialize: function(ops){
                this.init(ops);
                this.char_dict = "YDYQSXMWZSSXJBYMGCCZQPSSQBYCDSCDQLDYLYBSSJGYZZJJFKCCLZDHWDWZJLJPFYYNWJJTMYHZWZHFLZPPQHGSCYYYNJQYXXGJHHSDSJNKKTMOMLCRXYPSNQSECCQZGGLLYJLMYZZSECYKYYHQWJSSGGYXYZYJWWKDJHYCHMYXJTLXJYQBYXZLDWRDJRWYSRLDZJPCBZJJBRCFTLECZSTZFXXZHTRQHYBDLYCZSSYMMRFMYQZPWWJJYFCRWFDFZQPYDDWYXKYJAWJFFXYPSFTZYHHYZYSWCJYXSCLCXXWZZXNBGNNXBXLZSZSBSGPYSYZDHMDZBQBZCWDZZYYTZHBTSYYBZGNTNXQYWQSKBPHHLXGYBFMJEBJHHGQTJCYSXSTKZHLYCKGLYSMZXYALMELDCCXGZYRJXSDLTYZCQKCNNJWHJTZZCQLJSTSTBNXBTYXCEQXGKWJYFLZQLYHYXSPSFXLMPBYSXXXYDJCZYLLLSJXFHJXPJBTFFYABYXBHZZBJYZLWLCZGGBTSSMDTJZXPTHYQTGLJSCQFZKJZJQNLZWLSLHDZBWJNCJZYZSQQYCQYRZCJJWYBRTWPYFTWEXCSKDZCTBZHYZZYYJXZCFFZZMJYXXSDZZOTTBZLQWFCKSZSXFYRLNYJMBDTHJXSQQCCSBXYYTSYFBXDZTGBCNSLCYZZPSAZYZZSCJCSHZQYDXLBPJLLMQXTYDZXSQJTZPXLCGLQTZWJBHCTSYJSFXYEJJTLBGXSXJMYJQQPFZASYJNTYDJXKJCDJSZCBARTDCLYJQMWNQNCLLLKBYBZZSYHQQLTWLCCXTXLLZNTYLNEWYZYXCZXXGRKRMTCNDNJTSYYSSDQDGHSDBJGHRWRQLYBGLXHLGTGXBQJDZPYJSJYJCTMRNYMGRZJCZGJMZMGXMPRYXKJNYMSGMZJYMKMFXMLDTGFBHCJHKYLPFMDXLQJJSMTQGZSJLQDLDGJYCALCMZCSDJLLNXDJFFFFJCZFMZFFPFKHKGDPSXKTACJDHHZDDCRRCFQYJKQCCWJDXHWJLYLLZGCFCQDSMLZPBJJPLSBCJGGDCKKDEZSQCCKJGCGKDJTJDLZYCXKLQSCGJCLTFPCQCZGWPJDQYZJJBYJHSJDZWGFSJGZKQCCZLLPSPKJGQJHZZLJPLGJGJJTHJJYJZCZMLZLYQBGJWMLJKXZDZNJQSYZMLJLLJKYWXMKJLHSKJGBMCLYYMKXJQLBMLLKMDXXKWYXYSLMLPSJQQJQXYXFJTJDXMXXLLCXQBSYJBGWYMBGGBCYXPJYGPEPFGDJGBHBNSQJYZJKJKHXQFGQZKFHYGKHDKLLSDJQXPQYKYBNQSXQNSZSWHBSXWHXWBZZXDMNSJBSBKBBZKLYLXGWXDRWYQZMYWSJQLCJXXJXKJEQXSCYETLZHLYYYSDZPAQYZCMTLSHTZCFYZYXYLJSDCJQAGYSLCQLYYYSHMRQQKLDXZSCSSSYDYCJYSFSJBFRSSZQSBXXPXJYSDRCKGJLGDKZJZBDKTCSYQPYHSTCLDJDHMXMCGXYZHJDDTMHLTXZXYLYMOHYJCLTYFBQQXPFBDFHHTKSQHZYYWCNXXCRWHOWGYJLEGWDQCWGFJYCSNTMYTOLBYGWQWESJPWNMLRYDZSZTXYQPZGCWXHNGPYXSHMYQJXZTDPPBFYHZHTJYFDZWKGKZBLDNTSXHQEEGZZYLZMMZYJZGXZXKHKSTXNXXWYLYAPSTHXDWHZYMPXAGKYDXBHNHXKDPJNMYHYLPMGOCSLNZHKXXLPZZLBMLSFBHHGYGYYGGBHSCYAQTYWLXTZQCEZYDQDQMMHTKLLSZHLSJZWFYHQSWSCWLQAZYNYTLSXTHAZNKZZSZZLAXXZWWCTGQQTDDYZTCCHYQZFLXPSLZYGPZSZNGLNDQTBDLXGTCTAJDKYWNSYZLJHHZZCWNYYZYWMHYCHHYXHJKZWSXHZYXLYSKQYSPSLYZWMYPPKBYGLKZHTYXAXQSYSHXASMCHKDSCRSWJPWXSGZJLWWSCHSJHSQNHCSEGNDAQTBAALZZMSSTDQJCJKTSCJAXPLGGXHHGXXZCXPDMMHLDGTYBYSJMXHMRCPXXJZCKZXSHMLQXXTTHXWZFKHCCZDYTCJYXQHLXDHYPJQXYLSYYDZOZJNYXQEZYSQYAYXWYPDGXDDXSPPYZNDLTWRHXYDXZZJHTCXMCZLHPYYYYMHZLLHNXMYLLLMDCPPXHMXDKYCYRDLTXJCHHZZXZLCCLYLNZSHZJZZLNNRLWHYQSNJHXYNTTTKYJPYCHHYEGKCTTWLGQRLGGTGTYGYHPYHYLQYQGCWYQKPYYYTTTTLHYHLLTYTTSPLKYZXGZWGPYDSSZZDQXSKCQNMJJZZBXYQMJRTFFBTKHZKBXLJJKDXJTLBWFZPPTKQTZTGPDGNTPJYFALQMKGXBDCLZFHZCLLLLADPMXDJHLCCLGYHDZFGYDDGCYYFGYDXKSSEBDHYKDKDKHNAXXYBPBYYHXZQGAFFQYJXDMLJCSQZLLPCHBSXGJYNDYBYQSPZWJLZKSDDTACTBXZDYZYPJZQSJNKKTKNJDJGYYPGTLFYQKASDNTCYHBLWDZHBBYDWJRYGKZYHEYYFJMSDTYFZJJHGCXPLXHLDWXXJKYTCYKSSSMTWCTTQZLPBSZDZWZXGZAGYKTYWXLHLSPBCLLOQMMZSSLCMBJCSZZKYDCZJGQQDSMCYTZQQLWZQZXSSFPTTFQMDDZDSHDTDWFHTDYZJYQJQKYPBDJYYXTLJHDRQXXXHAYDHRJLKLYTWHLLRLLRCXYLBWSRSZZSYMKZZHHKYHXKSMDSYDYCJPBZBSQLFCXXXNXKXWYWSDZYQOGGQMMYHCDZTTFJYYBGSTTTYBYKJDHKYXBELHTYPJQNFXFDYKZHQKZBYJTZBXHFDXKDASWTAWAJLDYJSFHBLDNNTNQJTJNCHXFJSRFWHZFMDRYJYJWZPDJKZYJYMPCYZNYNXFBYTFYFWYGDBNZZZDNYTXZEMMQBSQEHXFZMBMFLZZSRXYMJGSXWZJSPRYDJSJGXHJJGLJJYNZZJXHGXKYMLPYYYCXYTWQZSWHWLYRJLPXSLSXMFSWWKLCTNXNYNPSJSZHDZEPTXMYYWXYYSYWLXJQZQXZDCLEEELMCPJPCLWBXSQHFWWTFFJTNQJHJQDXHWLBYZNFJLALKYYJLDXHHYCSTYYWNRJYXYWTRMDRQHWQCMFJDYZMHMYYXJWMYZQZXTLMRSPWWCHAQBXYGZYPXYYRRCLMPYMGKSJSZYSRMYJSNXTPLNBAPPYPYLXYYZKYNLDZYJZCZNNLMZHHARQMPGWQTZMXXMLLHGDZXYHXKYXYCJMFFYYHJFSBSSQLXXNDYCANNMTCJCYPRRNYTYQNYYMBMSXNDLYLYSLJRLXYSXQMLLYZLZJJJKYZZCSFBZXXMSTBJGNXYZHLXNMCWSCYZYFZLXBRNNNYLBNRTGZQYSATSWRYHYJZMZDHZGZDWYBSSCSKXSYHYTXXGCQGXZZSHYXJSCRHMKKBXCZJYJYMKQHZJFNBHMQHYSNJNZYBKNQMCLGQHWLZNZSWXKHLJHYYBQLBFCDSXDLDSPFZPSKJYZWZXZDDXJSMMEGJSCSSMGCLXXKYYYLNYPWWWGYDKZJGGGZGGSYCKNJWNJPCXBJJTQTJWDSSPJXZXNZXUMELPXFSXTLLXCLJXJJLJZXCTPSWXLYDHLYQRWHSYCSQYYBYAYWJJJQFWQCQQCJQGXALDBZZYJGKGXPLTZYFXJLTPADKYQHPMATLCPDCKBMTXYBHKLENXDLEEGQDYMSAWHZMLJTWYGXLYQZLJEEYYBQQFFNLYXRDSCTGJGXYYNKLLYQKCCTLHJLQMKKZGCYYGLLLJDZGYDHZWXPYSJBZKDZGYZZHYWYFQYTYZSZYEZZLYMHJJHTSMQWYZLKYYWZCSRKQYTLTDXWCTYJKLWSQZWBDCQYNCJSRSZJLKCDCDTLZZZACQQZZDDXYPLXZBQJYLZLLLQDDZQJYJYJZYXNYYYNYJXKXDAZWYRDLJYYYRJLXLLDYXJCYWYWNQCCLDDNYYYNYCKCZHXXCCLGZQJGKWPPCQQJYSBZZXYJSQPXJPZBSBDSFNSFPZXHDWZTDWPPTFLZZBZDMYYPQJRSDZSQZSQXBDGCPZSWDWCSQZGMDHZXMWWFYBPDGPHTMJTHZSMMBGZMBZJCFZWFZBBZMQCFMBDMCJXLGPNJBBXGYHYYJGPTZGZMQBQTCGYXJXLWZKYDPDYMGCFTPFXYZTZXDZXTGKMTYBBCLBJASKYTSSQYYMSZXFJEWLXLLSZBQJJJAKLYLXLYCCTSXMCWFKKKBSXLLLLJYXTYLTJYYTDPJHNHNNKBYQNFQYYZBYYESSESSGDYHFHWTCJBSDZZTFDMXHCNJZYMQWSRYJDZJQPDQBBSTJGGFBKJBXTGQHNGWJXJGDLLTHZHHYYYYYYSXWTYYYCCBDBPYPZYCCZYJPZYWCBDLFWZCWJDXXHYHLHWZZXJTCZLCDPXUJCZZZLYXJJTXPHFXWPYWXZPTDZZBDZCYHJHMLXBQXSBYLRDTGJRRCTTTHYTCZWMXFYTWWZCWJWXJYWCSKYBZSCCTZQNHXNWXXKHKFHTSWOCCJYBCMPZZYKBNNZPBZHHZDLSYDDYTYFJPXYNGFXBYQXCBHXCPSXTYZDMKYSNXSXLHKMZXLYHDHKWHXXSSKQYHHCJYXGLHZXCSNHEKDTGZXQYPKDHEXTYKCNYMYYYPKQYYYKXZLTHJQTBYQHXBMYHSQCKWWYLLHCYYLNNEQXQWMCFBDCCMLJGGXDQKTLXKGNQCDGZJWYJJLYHHQTTTNWCHMXCXWHWSZJYDJCCDBQCDGDNYXZTHCQRXCBHZTQCBXWGQWYYBXHMBYMYQTYEXMQKYAQYRGYZSLFYKKQHYSSQYSHJGJCNXKZYCXSBXYXHYYLSTYCXQTHYSMGSCPMMGCCCCCMTZTASMGQZJHKLOSQYLSWTMXSYQKDZLJQQYPLSYCZTCQQPBBQJZCLPKHQZYYXXDTDDTSJCXFFLLCHQXMJLWCJCXTSPYCXNDTJSHJWXDQQJSKXYAMYLSJHMLALYKXCYYDMNMDQMXMCZNNCYBZKKYFLMCHCMLHXRCJJHSYLNMTJZGZGYWJXSRXCWJGJQHQZDQJDCJJZKJKGDZQGJJYJYLXZXXCDQHHHEYTMHLFSBDJSYYSHFYSTCZQLPBDRFRZTZYKYWHSZYQKWDQZRKMSYNBCRXQBJYFAZPZZEDZCJYWBCJWHYJBQSZYWRYSZPTDKZPFPBNZTKLQYHBBZPNPPTYZZYBQNYDCPJMMCYCQMCYFZZDCMNLFPBPLNGQJTBTTNJZPZBBZNJKLJQYLNBZQHKSJZNGGQSZZKYXSHPZSNBCGZKDDZQANZHJKDRTLZLSWJLJZLYWTJNDJZJHXYAYNCBGTZCSSQMNJPJYTYSWXZFKWJQTKHTZPLBHSNJZSYZBWZZZZLSYLSBJHDWWQPSLMMFBJDWAQYZTCJTBNNWZXQXCDSLQGDSDPDZHJTQQPSWLYYJZLGYXYZLCTCBJTKTYCZJTQKBSJLGMGZDMCSGPYNJZYQYYKNXRPWSZXMTNCSZZYXYBYHYZAXYWQCJTLLCKJJTJHGDXDXYQYZZBYWDLWQCGLZGJGQRQZCZSSBCRPCSKYDZNXJSQGXSSJMYDNSTZTPBDLTKZWXQWQTZEXNQCZGWEZKSSBYBRTSSSLCCGBPSZQSZLCCGLLLZXHZQTHCZMQGYZQZNMCOCSZJMMZSQPJYGQLJYJPPLDXRGZYXCCSXHSHGTZNLZWZKJCXTCFCJXLBMQBCZZWPQDNHXLJCTHYZLGYLNLSZZPCXDSCQQHJQKSXZPBAJYEMSMJTZDXLCJYRYYNWJBNGZZTMJXLTBSLYRZPYLSSCNXPHLLHYLLQQZQLXYMRSYCXZLMMCZLTZSDWTJJLLNZGGQXPFSKYGYGHBFZPDKMWGHCXMSGDXJMCJZDYCABXJDLNBCDQYGSKYDQTXDJJYXMSZQAZDZFSLQXYJSJZYLBTXXWXQQZBJZUFBBLYLWDSLJHXJYZJWTDJCZFQZQZZDZSXZZQLZCDZFJHYSPYMPQZMLPPLFFXJJNZZYLSJEYQZFPFZKSYWJJJHRDJZZXTXXGLGHYDXCSKYSWMMZCWYBAZBJKSHFHJCXMHFQHYXXYZFTSJYZFXYXPZLCHMZMBXHZZSXYFYMNCWDABAZLXKTCSHHXKXJJZJSTHYGXSXYYHHHJWXKZXSSBZZWHHHCWTZZZPJXSNXQQJGZYZYWLLCWXZFXXYXYHXMKYYSWSQMNLNAYCYSPMJKHWCQHYLAJJMZXHMMCNZHBHXCLXTJPLTXYJHDYYLTTXFSZHYXXSJBJYAYRSMXYPLCKDUYHLXRLNLLSTYZYYQYGYHHSCCSMZCTZQXKYQFPYYRPFFLKQUNTSZLLZMWWTCQQYZWTLLMLMPWMBZSSTZRBPDDTLQJJBXZCSRZQQYGWCSXFWZLXCCRSZDZMCYGGDZQSGTJSWLJMYMMZYHFBJDGYXCCPSHXNZCSBSJYJGJMPPWAFFYFNXHYZXZYLREMZGZCYZSSZDLLJCSQFNXZKPTXZGXJJGFMYYYSNBTYLBNLHPFZDCYFBMGQRRSSSZXYSGTZRNYDZZCDGPJAFJFZKNZBLCZSZPSGCYCJSZLMLRSZBZZLDLSLLYSXSQZQLYXZLSKKBRXBRBZCYCXZZZEEYFGKLZLYYHGZSGZLFJHGTGWKRAAJYZKZQTSSHJJXDCYZUYJLZYRZDQQHGJZXSSZBYKJPBFRTJXLLFQWJHYLQTYMBLPZDXTZYGBDHZZRBGXHWNJTJXLKSCFSMWLSDQYSJTXKZSCFWJLBXFTZLLJZLLQBLSQMQQCGCZFPBPHZCZJLPYYGGDTGWDCFCZQYYYQYSSCLXZSKLZZZGFFCQNWGLHQYZJJCZLQZZYJPJZZBPDCCMHJGXDQDGDLZQMFGPSYTSDYFWWDJZJYSXYYCZCYHZWPBYKXRYLYBHKJKSFXTZJMMCKHLLTNYYMSYXYZPYJQYCSYCWMTJJKQYRHLLQXPSGTLYYCLJSCPXJYZFNMLRGJJTYZBXYZMSJYJHHFZQMSYXRSZCWTLRTQZSSTKXGQKGSPTGCZNJSJCQCXHMXGGZTQYDJKZDLBZSXJLHYQGGGTHQSZPYHJHHGYYGKGGCWJZZYLCZLXQSFTGZSLLLMLJSKCTBLLZZSZMMNYTPZSXQHJCJYQXYZXZQZCPSHKZZYSXCDFGMWQRLLQXRFZTLYSTCTMJCXJJXHJNXTNRZTZFQYHQGLLGCXSZSJDJLJCYDSJTLNYXHSZXCGJZYQPYLFHDJSBPCCZHJJJQZJQDYBSSLLCMYTTMQTBHJQNNYGKYRQYQMZGCJKPDCGMYZHQLLSLLCLMHOLZGDYYFZSLJCQZLYLZQJESHNYLLJXGJXLYSYYYXNBZLJSSZCQQCJYLLZLTJYLLZLLBNYLGQCHXYYXOXCXQKYJXXXYKLXSXXYQXCYKQXQCSGYXXYQXYGYTQOHXHXPYXXXULCYEYCHZZCBWQBBWJQZSCSZSSLZYLKDESJZWMYMCYTSDSXXSCJPQQSQYLYYZYCMDJDZYWCBTJSYDJKCYDDJLBDJJSODZYSYXQQYXDHHGQQYQHDYXWGMMMAJDYBBBPPBCMUUPLJZSMTXERXJMHQNUTPJDCBSSMSSSTKJTSSMMTRCPLZSZMLQDSDMJMQPNQDXCFYNBFSDQXYXHYAYKQYDDLQYYYSSZBYDSLNTFQTZQPZMCHDHCZCWFDXTMYQSPHQYYXSRGJCWTJTZZQMGWJJTJHTQJBBHWZPXXHYQFXXQYWYYHYSCDYDHHQMNMTMWCPBSZPPZZGLMZFOLLCFWHMMSJZTTDHZZYFFYTZZGZYSKYJXQYJZQBHMBZZLYGHGFMSHPZFZSNCLPBQSNJXZSLXXFPMTYJYGBXLLDLXPZJYZJYHHZCYWHJYLSJEXFSZZYWXKZJLUYDTMLYMQJPWXYHXSKTQJEZRPXXZHHMHWQPWQLYJJQJJZSZCPHJLCHHNXJLQWZJHBMZYXBDHHYPZLHLHLGFWLCHYYTLHJXCJMSCPXSTKPNHQXSRTYXXTESYJCTLSSLSTDLLLWWYHDHRJZSFGXTSYCZYNYHTDHWJSLHTZDQDJZXXQHGYLTZPHCSQFCLNJTCLZPFSTPDYNYLGMJLLYCQHYSSHCHYLHQYQTMZYPBYWRFQYKQSYSLZDQJMPXYYSSRHZJNYWTQDFZBWWTWWRXCWHGYHXMKMYYYQMSMZHNGCEPMLQQMTCWCTMMPXJPJJHFXYYZSXZHTYBMSTSYJTTQQQYYLHYNPYQZLCYZHZWSMYLKFJXLWGXYPJYTYSYXYMZCKTTWLKSMZSYLMPWLZWXWQZSSAQSYXYRHSSNTSRAPXCPWCMGDXHXZDZYFJHGZTTSBJHGYZSZYSMYCLLLXBTYXHBBZJKSSDMALXHYCFYGMQYPJYCQXJLLLJGSLZGQLYCJCCZOTYXMTMTTLLWTGPXYMZMKLPSZZZXHKQYSXCTYJZYHXSHYXZKXLZWPSQPYHJWPJPWXQQYLXSDHMRSLZZYZWTTCYXYSZZSHBSCCSTPLWSSCJCHNLCGCHSSPHYLHFHHXJSXYLLNYLSZDHZXYLSXLWZYKCLDYAXZCMDDYSPJTQJZLNWQPSSSWCTSTSZLBLNXSMNYYMJQBQHRZWTYYDCHQLXKPZWBGQYBKFCMZWPZLLYYLSZYDWHXPSBCMLJBSCGBHXLQHYRLJXYSWXWXZSLDFHLSLYNJLZYFLYJYCDRJLFSYZFSLLCQYQFGJYHYXZLYLMSTDJCYHBZLLNWLXXYGYYHSMGDHXXHHLZZJZXCZZZCYQZFNGWPYLCPKPYYPMCLQKDGXZGGWQBDXZZKZFBXXLZXJTPJPTTBYTSZZDWSLCHZHSLTYXHQLHYXXXYYZYSWTXZKHLXZXZPYHGCHKCFSYHUTJRLXFJXPTZTWHPLYXFCRHXSHXKYXXYHZQDXQWULHYHMJTBFLKHTXCWHJFWJCFPQRYQXCYYYQYGRPYWSGSUNGWCHKZDXYFLXXHJJBYZWTSXXNCYJJYMSWZJQRMHXZWFQSYLZJZGBHYNSLBGTTCSYBYXXWXYHXYYXNSQYXMQYWRGYQLXBBZLJSYLPSYTJZYHYZAWLRORJMKSCZJXXXYXCHDYXRYXXJDTSQFXLYLTSFFYXLMTYJMJUYYYXLTZCSXQZQHZXLYYXZHDNBRXXXJCTYHLBRLMBRLLAXKYLLLJLYXXLYCRYLCJTGJCMTLZLLCYZZPZPCYAWHJJFYBDYYZSMPCKZDQYQPBPCJPDCYZMDPBCYYDYCNNPLMTMLRMFMMGWYZBSJGYGSMZQQQZTXMKQWGXLLPJGZBQCDJJJFPKJKCXBLJMSWMDTQJXLDLPPBXCWRCQFBFQJCZAHZGMYKPHYYHZYKNDKZMBPJYXPXYHLFPNYYGXJDBKXNXHJMZJXSTRSTLDXSKZYSYBZXJLXYSLBZYSLHXJPFXPQNBYLLJQKYGZMCYZZYMCCSLCLHZFWFWYXZMWSXTYNXJHPYYMCYSPMHYSMYDYSHQYZCHMJJMZCAAGCFJBBHPLYZYLXXSDJGXDHKXXTXXNBHRMLYJSLTXMRHNLXQJXYZLLYSWQGDLBJHDCGJYQYCMHWFMJYBMBYJYJWYMDPWHXQLDYGPDFXXBCGJSPCKRSSYZJMSLBZZJFLJJJLGXZGYXYXLSZQYXBEXYXHGCXBPLDYHWETTWWCJMBTXCHXYQXLLXFLYXLLJLSSFWDPZSMYJCLMWYTCZPCHQEKCQBWLCQYDPLQPPQZQFJQDJHYMMCXTXDRMJWRHXCJZYLQXDYYNHYYHRSLSRSYWWZJYMTLTLLGTQCJZYABTCKZCJYCCQLJZQXALMZYHYWLWDXZXQDLLQSHGPJFJLJHJABCQZDJGTKHSSTCYJLPSWZLXZXRWGLDLZRLZXTGSLLLLZLYXXWGDZYGBDPHZPBRLWSXQBPFDWOFMWHLYPCBJCCLDMBZPBZZLCYQXLDOMZBLZWPDWYYGDSTTHCSQSCCRSSSYSLFYBFNTYJSZDFNDPDHDZZMBBLSLCMYFFGTJJQWFTMTPJWFNLBZCMMJTGBDZLQLPYFHYYMJYLSDCHDZJWJCCTLJCLDTLJJCPDDSQDSSZYBNDBJLGGJZXSXNLYCYBJXQYCBYLZCFZPPGKCXZDZFZTJJFJSJXZBNZYJQTTYJYHTYCZHYMDJXTTMPXSPLZCDWSLSHXYPZGTFMLCJTYCBPMGDKWYCYZCDSZZYHFLYCTYGWHKJYYLSJCXGYWJCBLLCSNDDBTZBSCLYZCZZSSQDLLMQYYHFSLQLLXFTYHABXGWNYWYYPLLSDLDLLBJCYXJZMLHLJDXYYQYTDLLLBUGBFDFBBQJZZMDPJHGCLGMJJPGAEHHBWCQXAXHHHZCHXYPHJAXHLPHJPGPZJQCQZGJJZZUZDMQYYBZZPHYHYBWHAZYJHYKFGDPFQSDLZMLJXKXGALXZDAGLMDGXMWZQYXXDXXPFDMMSSYMPFMDMMKXKSYZYSHDZKXSYSMMZZZMSYDNZZCZXFPLSTMZDNMXCKJMZTYYMZMZZMSXHHDCZJEMXXKLJSTLWLSQLYJZLLZJSSDPPMHNLZJCZYHMXXHGZCJMDHXTKGRMXFWMCGMWKDTKSXQMMMFZZYDKMSCLCMPCGMHSPXQPZDSSLCXKYXTWLWJYAHZJGZQMCSNXYYMMPMLKJXMHLMLQMXCTKZMJQYSZJSYSZHSYJZJCDAJZYBSDQJZGWZQQXFKDMSDJLFWEHKZQKJPEYPZYSZCDWYJFFMZZYLTTDZZEFMZLBNPPLPLPEPSZALLTYLKCKQZKGENQLWAGYXYDPXLHSXQQWQCQXQCLHYXXMLYCCWLYMQYSKGCHLCJNSZKPYZKCQZQLJPDMDZHLASXLBYDWQLWDNBQCRYDDZTJYBKBWSZDXDTNPJDTCTQDFXQQMGNXECLTTBKPWSLCTYQLPWYZZKLPYGZCQQPLLKCCYLPQMZCZQCLJSLQZDJXLDDHPZQDLJJXZQDXYZQKZLJCYQDYJPPYPQYKJYRMPCBYMCXKLLZLLFQPYLLLMBSGLCYSSLRSYSQTMXYXZQZFDZUYSYZTFFMZZSMZQHZSSCCMLYXWTPZGXZJGZGSJSGKDDHTQGGZLLBJDZLCBCHYXYZHZFYWXYZYMSDBZZYJGTSMTFXQYXQSTDGSLNXDLRYZZLRYYLXQHTXSRTZNGZXBNQQZFMYKMZJBZYMKBPNLYZPBLMCNQYZZZSJZHJCTZKHYZZJRDYZHNPXGLFZTLKGJTCTSSYLLGZRZBBQZZKLPKLCZYSSUYXBJFPNJZZXCDWXZYJXZZDJJKGGRSRJKMSMZJLSJYWQSKYHQJSXPJZZZLSNSHRNYPZTWCHKLPSRZLZXYJQXQKYSJYCZTLQZYBBYBWZPQDWWYZCYTJCJXCKCWDKKZXSGKDZXWWYYJQYYTCYTDLLXWKCZKKLCCLZCQQDZLQLCSFQCHQHSFSMQZZLNBJJZBSJHTSZDYSJQJPDLZCDCWJKJZZLPYCGMZWDJJBSJQZSYZYHHXJPBJYDSSXDZNCGLQMBTSFSBPDZDLZNFGFJGFSMPXJQLMBLGQCYYXBQKDJJQYRFKZTJDHCZKLBSDZCFJTPLLJGXHYXZCSSZZXSTJYGKGCKGYOQXJPLZPBPGTGYJZGHZQZZLBJLSQFZGKQQJZGYCZBZQTLDXRJXBSXXPZXHYZYCLWDXJJHXMFDZPFZHQHQMQGKSLYHTYCGFRZGNQXCLPDLBZCSCZQLLJBLHBZCYPZZPPDYMZZSGYHCKCPZJGSLJLNSCDSLDLXBMSTLDDFJMKDJDHZLZXLSZQPQPGJLLYBDSZGQLBZLSLKYYHZTTNTJYQTZZPSZQZTLLJTYYLLQLLQYZQLBDZLSLYYZYMDFSZSNHLXZNCZQZPBWSKRFBSYZMTHBLGJPMCZZLSTLXSHTCSYZLZBLFEQHLXFLCJLYLJQCBZLZJHHSSTBRMHXZHJZCLXFNBGXGTQJCZTMSFZKJMSSNXLJKBHSJXNTNLZDNTLMSJXGZJYJCZXYJYJWRWWQNZTNFJSZPZSHZJFYRDJSFSZJZBJFZQZZHZLXFYSBZQLZSGYFTZDCSZXZJBQMSZKJRHYJZCKMJKHCHGTXKXQGLXPXFXTRTYLXJXHDTSJXHJZJXZWZLCQSBTXWXGXTXXHXFTSDKFJHZYJFJXRZSDLLLTQSQQZQWZXSYQTWGWBZCGZLLYZBCLMQQTZHZXZXLJFRMYZFLXYSQXXJKXRMQDZDMMYYBSQBHGZMWFWXGMXLZPYYTGZYCCDXYZXYWGSYJYZNBHPZJSQSYXSXRTFYZGRHZTXSZZTHCBFCLSYXZLZQMZLMPLMXZJXSFLBYZMYQHXJSXRXSQZZZSSLYFRCZJRCRXHHZXQYDYHXSJJHZCXZBTYNSYSXJBQLPXZQPYMLXZKYXLXCJLCYSXXZZLXDLLLJJYHZXGYJWKJRWYHCPSGNRZLFZWFZZNSXGXFLZSXZZZBFCSYJDBRJKRDHHGXJLJJTGXJXXSTJTJXLYXQFCSGSWMSBCTLQZZWLZZKXJMLTMJYHSDDBXGZHDLBMYJFRZFSGCLYJBPMLYSMSXLSZJQQHJZFXGFQFQBPXZGYYQXGZTCQWYLTLGWSGWHRLFSFGZJMGMGBGTJFSYZZGZYZAFLSSPMLPFLCWBJZCLJJMZLPJJLYMQDMYYYFBGYGYZMLYZDXQYXRQQQHSYYYQXYLJTYXFSFSLLGNQCYHYCWFHCCCFXPYLYPLLZYXXXXXKQHHXSHJZCFZSCZJXCPZWHHHHHAPYLQALPQAFYHXDYLUKMZQGGGDDESRNNZLTZGCHYPPYSQJJHCLLJTOLNJPZLJLHYMHEYDYDSQYCDDHGZUNDZCLZYZLLZNTNYZGSLHSLPJJBDGWXPCDUTJCKLKCLWKLLCASSTKZZDNQNTTLYYZSSYSSZZRYLJQKCQDHHCRXRZYDGRGCWCGZQFFFPPJFZYNAKRGYWYQPQXXFKJTSZZXSWZDDFBBXTBGTZKZNPZZPZXZPJSZBMQHKCYXYLDKLJNYPKYGHGDZJXXEAHPNZKZTZCMXCXMMJXNKSZQNMNLWBWWXJKYHCPSTMCSQTZJYXTPCTPDTNNPGLLLZSJLSPBLPLQHDTNJNLYYRSZFFJFQWDPHZDWMRZCCLODAXNSSNYZRESTYJWJYJDBCFXNMWTTBYLWSTSZGYBLJPXGLBOCLHPCBJLTMXZLJYLZXCLTPNCLCKXTPZJSWCYXSFYSZDKNTLBYJCYJLLSTGQCBXRYZXBXKLYLHZLQZLNZCXWJZLJZJNCJHXMNZZGJZZXTZJXYCYYCXXJYYXJJXSSSJSTSSTTPPGQTCSXWZDCSYFPTFBFHFBBLZJCLZZDBXGCXLQPXKFZFLSYLTUWBMQJHSZBMDDBCYSCCLDXYCDDQLYJJWMQLLCSGLJJSYFPYYCCYLTJANTJJPWYCMMGQYYSXDXQMZHSZXPFTWWZQSWQRFKJLZJQQYFBRXJHHFWJJZYQAZMYFRHCYYBYQWLPEXCCZSTYRLTTDMQLYKMBBGMYYJPRKZNPBSXYXBHYZDJDNGHPMFSGMWFZMFQMMBCMZZCJJLCNUXYQLMLRYGQZCYXZLWJGCJCGGMCJNFYZZJHYCPRRCMTZQZXHFQGTJXCCJEAQCRJYHPLQLSZDJRBCQHQDYRHYLYXJSYMHZYDWLDFRYHBPYDTSSCNWBXGLPZMLZZTQSSCPJMXXYCSJYTYCGHYCJWYRXXLFEMWJNMKLLSWTXHYYYNCMMCWJDQDJZGLLJWJRKHPZGGFLCCSCZMCBLTBHBQJXQDSPDJZZGKGLFQYWBZYZJLTSTDHQHCTCBCHFLQMPWDSHYYTQWCNZZJTLBYMBPDYYYXSQKXWYYFLXXNCWCXYPMAELYKKJMZZZBRXYYQJFLJPFHHHYTZZXSGQQMHSPGDZQWBWPJHZJDYSCQWZKTXXSQLZYYMYSDZGRXCKKUJLWPYSYSCSYZLRMLQSYLJXBCXTLWDQZPCYCYKPPPNSXFYZJJRCEMHSZMSXLXGLRWGCSTLRSXBZGBZGZTCPLUJLSLYLYMTXMTZPALZXPXJTJWTCYYZLBLXBZLQMYLXPGHDSLSSDMXMBDZZSXWHAMLCZCPJMCNHJYSNSYGCHSKQMZZQDLLKABLWJXSFMOCDXJRRLYQZKJMYBYQLYHETFJZFRFKSRYXFJTWDSXXSYSQJYSLYXWJHSNLXYYXHBHAWHHJZXWMYLJCSSLKYDZTXBZSYFDXGXZJKHSXXYBSSXDPYNZWRPTQZCZENYGCXQFJYKJBZMLJCMQQXUOXSLYXXLYLLJDZBTYMHPFSTTQQWLHOKYBLZZALZXQLHZWRRQHLSTMYPYXJJXMQSJFNBXYXYJXXYQYLTHYLQYFMLKLJTMLLHSZWKZHLJMLHLJKLJSTLQXYLMBHHLNLZXQJHXCFXXLHYHJJGBYZZKBXSCQDJQDSUJZYYHZHHMGSXCSYMXFEBCQWWRBPYYJQTYZCYQYQQZYHMWFFHGZFRJFCDPXNTQYZPDYKHJLFRZXPPXZDBBGZQSTLGDGYLCQMLCHHMFYWLZYXKJLYPQHSYWMQQGQZMLZJNSQXJQSYJYCBEHSXFSZPXZWFLLBCYYJDYTDTHWZSFJMQQYJLMQXXLLDTTKHHYBFPWTYYSQQWNQWLGWDEBZWCMYGCULKJXTMXMYJSXHYBRWFYMWFRXYQMXYSZTZZTFYKMLDHQDXWYYNLCRYJBLPSXCXYWLSPRRJWXHQYPHTYDNXHHMMYWYTZCSQMTSSCCDALWZTCPQPYJLLQZYJSWXMZZMMYLMXCLMXCZMXMZSQTZPPQQBLPGXQZHFLJJHYTJSRXWZXSCCDLXTYJDCQJXSLQYCLZXLZZXMXQRJMHRHZJBHMFLJLMLCLQNLDXZLLLPYPSYJYSXCQQDCMQJZZXHNPNXZMEKMXHYKYQLXSXTXJYYHWDCWDZHQYYBGYBCYSCFGPSJNZDYZZJZXRZRQJJYMCANYRJTLDPPYZBSTJKXXZYPFDWFGZZRPYMTNGXZQBYXNBUFNQKRJQZMJEGRZGYCLKXZDSKKNSXKCLJSPJYYZLQQJYBZSSQLLLKJXTBKTYLCCDDBLSPPFYLGYDTZJYQGGKQTTFZXBDKTYYHYBBFYTYYBCLPDYTGDHRYRNJSPTCSNYJQHKLLLZSLYDXXWBCJQSPXBPJZJCJDZFFXXBRMLAZHCSNDLBJDSZBLPRZTSWSBXBCLLXXLZDJZSJPYLYXXYFTFFFBHJJXGBYXJPMMMPSSJZJMTLYZJXSWXTYLEDQPJMYGQZJGDJLQJWJQLLSJGJGYGMSCLJJXDTYGJQJQJCJZCJGDZZSXQGSJGGCXHQXSNQLZZBXHSGZXCXYLJXYXYYDFQQJHJFXDHCTXJYRXYSQTJXYEFYYSSYYJXNCYZXFXMSYSZXYYSCHSHXZZZGZZZGFJDLTYLNPZGYJYZYYQZPBXQBDZTZCZYXXYHHSQXSHDHGQHJHGYWSZTMZMLHYXGEBTYLZKQWYTJZRCLEKYSTDBCYKQQSAYXCJXWWGSBHJYZYDHCSJKQCXSWXFLTYNYZPZCCZJQTZWJQDZZZQZLJJXLSBHPYXXPSXSHHEZTXFPTLQYZZXHYTXNCFZYYHXGNXMYWXTZSJPTHHGYMXMXQZXTSBCZYJYXXTYYZYPCQLMMSZMJZZLLZXGXZAAJZYXJMZXWDXZSXZDZXLEYJJZQBHZWZZZQTZPSXZTDSXJJJZNYAZPHXYYSRNQDTHZHYYKYJHDZXZLSWCLYBZYECWCYCRYLCXNHZYDZYDYJDFRJJHTRSQTXYXJRJHOJYNXELXSFSFJZGHPZSXZSZDZCQZBYYKLSGSJHCZSHDGQGXYZGXCHXZJWYQWGYHKSSEQZZNDZFKWYSSTCLZSTSYMCDHJXXYWEYXCZAYDMPXMDSXYBSQMJMZJMTZQLPJYQZCGQHXJHHLXXHLHDLDJQCLDWBSXFZZYYSCHTYTYYBHECXHYKGJPXHHYZJFXHWHBDZFYZBCAPNPGNYDMSXHMMMMAMYNBYJTMPXYYMCTHJBZYFCGTYHWPHFTWZZEZSBZEGPFMTSKFTYCMHFLLHGPZJXZJGZJYXZSBBQSCZZLZCCSTPGXMJSFTCCZJZDJXCYBZLFCJSYZFGSZLYBCWZZBYZDZYPSWYJZXZBDSYUXLZZBZFYGCZXBZHZFTPBGZGEJBSTGKDMFHYZZJHZLLZZGJQZLSFDJSSCBZGPDLFZFZSZYZYZSYGCXSNXXCHCZXTZZLJFZGQSQYXZJQDCCZTQCDXZJYQJQCHXZTDLGSCXZSYQJQTZWLQDQZTQCHQQJZYEZZZPBWKDJFCJPZTYPQYQTTYNLMBDKTJZPQZQZZFPZSBNJLGYJDXJDZZKZGQKXDLPZJTCJDQBXDJQJSTCKNXBXZMSLYJCQMTJQWWCJQNJNLLLHJCWQTBZQYDZCZPZZDZYDDCYZZZCCJTTJFZDPRRTZTJDCQTQZDTJNPLZBCLLCTZSXKJZQZPZLBZRBTJDCXFCZDBCCJJLTQQPLDCGZDBBZJCQDCJWYNLLZYZCCDWLLXWZLXRXNTQQCZXKQLSGDFQTDDGLRLAJJTKUYMKQLLTZYTDYYCZGJWYXDXFRSKSTQTENQMRKQZHHQKDLDAZFKYPBGGPZREBZZYKZZSPEGJXGYKQZZZSLYSYYYZWFQZYLZZLZHWCHKYPQGNPGBLPLRRJYXCCSYYHSFZFYBZYYTGZXYLXCZWXXZJZBLFFLGSKHYJZEYJHLPLLLLCZGXDRZELRHGKLZZYHZLYQSZZJZQLJZFLNBHGWLCZCFJYSPYXZLZLXGCCPZBLLCYBBBBUBBCBPCRNNZCZYRBFSRLDCGQYYQXYGMQZWTZYTYJXYFWTEHZZJYWLCCNTZYJJZDEDPZDZTSYQJHDYMBJNYJZLXTSSTPHNDJXXBYXQTZQDDTJTDYYTGWSCSZQFLSHLGLBCZPHDLYZJYCKWTYTYLBNYTSDSYCCTYSZYYEBHEXHQDTWNYGYCLXTSZYSTQMYGZAZCCSZZDSLZCLZRQXYYELJSBYMXSXZTEMBBLLYYLLYTDQYSHYMRQWKFKBFXNXSBYCHXBWJYHTQBPBSBWDZYLKGZSKYHXQZJXHXJXGNLJKZLYYCDXLFYFGHLJGJYBXQLYBXQPQGZTZPLNCYPXDJYQYDYMRBESJYYHKXXSTMXRCZZYWXYQYBMCLLYZHQYZWQXDBXBZWZMSLPDMYSKFMZKLZCYQYCZLQXFZZYDQZPZYGYJYZMZXDZFYFYTTQTZHGSPCZMLCCYTZXJCYTJMKSLPZHYSNZLLYTPZCTZZCKTXDHXXTQCYFKSMQCCYYAZHTJPCYLZLYJBJXTPNYLJYYNRXSYLMMNXJSMYBCSYSYLZYLXJJQYLDZLPQBFZZBLFNDXQKCZFYWHGQMRDSXYCYTXNQQJZYYPFZXDYZFPRXEJDGYQBXRCNFYYQPGHYJDYZXGRHTKYLNWDZNTSMPKLBTHBPYSZBZTJZSZZJTYYXZPHSSZZBZCZPTQFZMYFLYPYBBJQXZMXXDJMTSYSKKBJZXHJCKLPSMKYJZCXTMLJYXRZZQSLXXQPYZXMKYXXXJCLJPRMYYGADYSKQLSNDHYZKQXZYZTCGHZTLMLWZYBWSYCTBHJHJFCWZTXWYTKZLXQSHLYJZJXTMPLPYCGLTBZZTLZJCYJGDTCLKLPLLQPJMZPAPXYZLKKTKDZCZZBNZDYDYQZJYJGMCTXLTGXSZLMLHBGLKFWNWZHDXUHLFMKYSLGXDTWWFRJEJZTZHYDXYKSHWFZCQSHKTMQQHTZHYMJDJSKHXZJZBZZXYMPAGQMSTPXLSKLZYNWRTSQLSZBPSPSGZWYHTLKSSSWHZZLYYTNXJGMJSZSUFWNLSOZTXGXLSAMMLBWLDSZYLAKQCQCTMYCFJBSLXCLZZCLXXKSBZQCLHJPSQPLSXXCKSLNHPSFQQYTXYJZLQLDXZQJZDYYDJNZPTUZDSKJFSLJHYLZSQZLBTXYDGTQFDBYAZXDZHZJNHHQBYKNXJJQCZMLLJZKSPLDYCLBBLXKLELXJLBQYCXJXGCNLCQPLZLZYJTZLJGYZDZPLTQCSXFDMNYCXGBTJDCZNBGBQYQJWGKFHTNPYQZQGBKPBBYZMTJDYTBLSQMPSXTBNPDXKLEMYYCJYNZCTLDYKZZXDDXHQSHDGMZSJYCCTAYRZLPYLTLKXSLZCGGEXCLFXLKJRTLQJAQZNCMBYDKKCXGLCZJZXJHPTDJJMZQYKQSECQZDSHHADMLZFMMZBGNTJNNLGBYJBRBTMLBYJDZXLCJLPLDLPCQDHLXZLYCBLCXZZJADJLNZMMSSSMYBHBSQKBHRSXXJMXSDZNZPXLGBRHWGGFCXGMSKLLTSJYYCQLTSKYWYYHYWXBXQYWPYWYKQLSQPTNTKHQCWDQKTWPXXHCPTHTWUMSSYHBWCRWXHJMKMZNGWTMLKFGHKJYLSYYCXWHYECLQHKQHTTQKHFZLDXQWYZYYDESBPKYRZPJFYYZJCEQDZZDLATZBBFJLLCXDLMJSSXEGYGSJQXCWBXSSZPDYZCXDNYXPPZYDLYJCZPLTXLSXYZYRXCYYYDYLWWNZSAHJSYQYHGYWWAXTJZDAXYSRLTDPSSYYFNEJDXYZHLXLLLZQZSJNYQYQQXYJGHZGZCYJCHZLYCDSHWSHJZYJXCLLNXZJJYYXNFXMWFPYLCYLLABWDDHWDXJMCXZTZPMLQZHSFHZYNZTLLDYWLSLXHYMMYLMBWWKYXYADTXYLLDJPYBPWUXJMWMLLSAFDLLYFLBHHHBQQLTZJCQJLDJTFFKMMMBYTHYGDCQRDDWRQJXNBYSNWZDBYYTBJHPYBYTTJXAAHGQDQTMYSTQXKBTZPKJLZRBEQQSSMJJBDJOTGTBXPGBKTLHQXJJJCTHXQDWJLWRFWQGWSHCKRYSWGFTGYGBXSDWDWRFHWYTJJXXXJYZYSLPYYYPAYXHYDQKXSHXYXGSKQHYWFDDDPPLCJLQQEEWXKSYYKDYPLTJTHKJLTCYYHHJTTPLTZZCDLTHQKZXQYSTEEYWYYZYXXYYSTTJKLLPZMCYHQGXYHSRMBXPLLNQYDQHXSXXWGDQBSHYLLPJJJTHYJKYPPTHYYKTYEZYENMDSHLCRPQFDGFXZPSFTLJXXJBSWYYSKSFLXLPPLBBBLBSFXFYZBSJSSYLPBBFFFFSSCJDSTZSXZRYYSYFFSYZYZBJTBCTSBSDHRTJJBYTCXYJEYLXCBNEBJDSYXYKGSJZBXBYTFZWGENYHHTHZHHXFWGCSTBGXKLSXYWMTMBYXJSTZSCDYQRCYTWXZFHMYMCXLZNSDJTTTXRYCFYJSBSDYERXJLJXBBDEYNJGHXGCKGSCYMBLXJMSZNSKGXFBNBPTHFJAAFXYXFPXMYPQDTZCXZZPXRSYWZDLYBBKTYQPQJPZYPZJZNJPZJLZZFYSBTTSLMPTZRTDXQSJEHBZYLZDHLJSQMLHTXTJECXSLZZSPKTLZKQQYFSYGYWPCPQFHQHYTQXZKRSGTTSQCZLPTXCDYYZXSQZSLXLZMYCPCQBZYXHBSXLZDLTCDXTYLZJYYZPZYZLTXJSJXHLPMYTXCQRBLZSSFJZZTNJYTXMYJHLHPPLCYXQJQQKZZSCPZKSWALQSBLCCZJSXGWWWYGYKTJBBZTDKHXHKGTGPBKQYSLPXPJCKBMLLXDZSTBKLGGQKQLSBKKTFXRMDKBFTPZFRTBBRFERQGXYJPZSSTLBZTPSZQZSJDHLJQLZBPMSMMSXLQQNHKNBLRDDNXXDHDDJCYYGYLXGZLXSYGMQQGKHBPMXYXLYTQWLWGCPBMQXCYZYDRJBHTDJYHQSHTMJSBYPLWHLZFFNYPMHXXHPLTBQPFBJWQDBYGPNZTPFZJGSDDTQSHZEAWZZYLLTYYBWJKXXGHLFKXDJTMSZSQYNZGGSWQSPHTLSSKMCLZXYSZQZXNCJDQGZDLFNYKLJCJLLZLMZZNHYDSSHTHZZLZZBBHQZWWYCRZHLYQQJBEYFXXXWHSRXWQHWPSLMSSKZTTYGYQQWRSLALHMJTQJSMXQBJJZJXZYZKXBYQXBJXSHZTSFJLXMXZXFGHKZSZGGYLCLSARJYHSLLLMZXELGLXYDJYTLFBHBPNLYZFBBHPTGJKWETZHKJJXZXXGLLJLSTGSHJJYQLQZFKCGNNDJSSZFDBCTWWSEQFHQJBSAQTGYPQLBXBMMYWXGSLZHGLZGQYFLZBYFZJFRYSFMBYZHQGFWZSYFYJJPHZBYYZFFWODGRLMFTWLBZGYCQXCDJYGZYYYYTYTYDWEGAZYHXJLZYYHLRMGRXXZCLHNELJJTJTPWJYBJJBXJJTJTEEKHWSLJPLPSFYZPQQBDLQJJTYYQLYZKDKSQJYYQZLDQTGJQYZJSUCMRYQTHTEJMFCTYHYPKMHYZWJDQFHYYXWSHCTXRLJHQXHCCYYYJLTKTTYTMXGTCJTZAYYOCZLYLBSZYWJYTSJYHBYSHFJLYGJXXTMZYYLTXXYPZLXYJZYZYYPNHMYMDYYLBLHLSYYQQLLNJJYMSOYQBZGDLYXYLCQYXTSZEGXHZGLHWBLJHEYXTWQMAKBPQCGYSHHEGQCMWYYWLJYJHYYZLLJJYLHZYHMGSLJLJXCJJYCLYCJPCPZJZJMMYLCQLNQLJQJSXYJMLSZLJQLYCMMHCFMMFPQQMFYLQMCFFQMMMMHMZNFHHJGTTHHKHSLNCHHYQDXTMMQDCYZYXYQMYQYLTDCYYYZAZZCYMZYDLZFFFMMYCQZWZZMABTBYZTDMNZZGGDFTYPCGQYTTSSFFWFDTZQSSYSTWXJHXYTSXXYLBYQHWWKXHZXWZNNZZJZJJQJCCCHYYXBZXZCYZTLLCQXYNJYCYYCYNZZQYYYEWYCZDCJYCCHYJLBTZYYCQWMPWPYMLGKDLDLGKQQBGYCHJXY"
                this.full_dict = {"a":"\u554a\u963f\u9515","ai":"\u57c3\u6328\u54ce\u5509\u54c0\u7691\u764c\u853c\u77ee\u827e\u788d\u7231\u9698\u8bf6\u6371\u55f3\u55cc\u5ad2\u7477\u66a7\u7839\u953f\u972d","an":"\u978d\u6c28\u5b89\u4ffa\u6309\u6697\u5cb8\u80fa\u6848\u8c19\u57ef\u63de\u72b4\u5eb5\u6849\u94f5\u9e4c\u9878\u9eef","ang":"\u80ae\u6602\u76ce","ao":"\u51f9\u6556\u71ac\u7ff1\u8884\u50b2\u5965\u61ca\u6fb3\u5773\u62d7\u55f7\u5662\u5c99\u5ed2\u9068\u5aaa\u9a9c\u8071\u87af\u93ca\u9ccc\u93d6","ba":"\u82ad\u634c\u6252\u53ed\u5427\u7b06\u516b\u75a4\u5df4\u62d4\u8dcb\u9776\u628a\u8019\u575d\u9738\u7f62\u7238\u8307\u83dd\u8406\u636d\u5c9c\u705e\u6777\u94af\u7c91\u9c85\u9b43","bai":"\u767d\u67cf\u767e\u6446\u4f70\u8d25\u62dc\u7a17\u859c\u63b0\u97b4","ban":"\u6591\u73ed\u642c\u6273\u822c\u9881\u677f\u7248\u626e\u62cc\u4f34\u74e3\u534a\u529e\u7eca\u962a\u5742\u8c73\u94a3\u7622\u764d\u8228","bang":"\u90a6\u5e2e\u6886\u699c\u8180\u7ed1\u68d2\u78c5\u868c\u9551\u508d\u8c24\u84a1\u8783","bao":"\u82de\u80de\u5305\u8912\u96f9\u4fdd\u5821\u9971\u5b9d\u62b1\u62a5\u66b4\u8c79\u9c8d\u7206\u52f9\u8446\u5b80\u5b62\u7172\u9e28\u8913\u8db5\u9f85","bo":"\u5265\u8584\u73bb\u83e0\u64ad\u62e8\u94b5\u6ce2\u535a\u52c3\u640f\u94c2\u7b94\u4f2f\u5e1b\u8236\u8116\u818a\u6e24\u6cca\u9a73\u4eb3\u8543\u5575\u997d\u6a97\u64d8\u7934\u94b9\u9e41\u7c38\u8ddb","bei":"\u676f\u7891\u60b2\u5351\u5317\u8f88\u80cc\u8d1d\u94a1\u500d\u72c8\u5907\u60eb\u7119\u88ab\u5b5b\u9642\u90b6\u57e4\u84d3\u5457\u602b\u6096\u789a\u9e4e\u8919\u943e","ben":"\u5954\u82ef\u672c\u7b28\u755a\u574c\u951b","beng":"\u5d29\u7ef7\u752d\u6cf5\u8e66\u8ff8\u552a\u5623\u750f","bi":"\u903c\u9f3b\u6bd4\u9119\u7b14\u5f7c\u78a7\u84d6\u853d\u6bd5\u6bd9\u6bd6\u5e01\u5e87\u75f9\u95ed\u655d\u5f0a\u5fc5\u8f9f\u58c1\u81c2\u907f\u965b\u5315\u4ef3\u4ffe\u8298\u835c\u8378\u5421\u54d4\u72f4\u5eb3\u610e\u6ed7\u6fde\u5f3c\u59a3\u5a62\u5b16\u74a7\u8d32\u7540\u94cb\u79d5\u88e8\u7b5a\u7b85\u7be6\u822d\u895e\u8df8\u9ac0","bian":"\u97ad\u8fb9\u7f16\u8d2c\u6241\u4fbf\u53d8\u535e\u8fa8\u8fa9\u8fab\u904d\u533e\u5f01\u82c4\u5fed\u6c74\u7f0f\u7178\u782d\u78a5\u7a39\u7a86\u8759\u7b3e\u9cca","biao":"\u6807\u5f6a\u8198\u8868\u5a4a\u9aa0\u98d1\u98d9\u98da\u706c\u9556\u9573\u762d\u88f1\u9cd4","bie":"\u9cd6\u618b\u522b\u762a\u8e69\u9cd8","bin":"\u5f6c\u658c\u6fd2\u6ee8\u5bbe\u6448\u50a7\u6d5c\u7f24\u73a2\u6ba1\u8191\u9554\u9acc\u9b13","bing":"\u5175\u51b0\u67c4\u4e19\u79c9\u997c\u70b3\u75c5\u5e76\u7980\u90b4\u6452\u7ee0\u678b\u69df\u71f9","bu":"\u6355\u535c\u54fa\u8865\u57e0\u4e0d\u5e03\u6b65\u7c3f\u90e8\u6016\u62ca\u535f\u900b\u74ff\u6661\u949a\u91ad","ca":"\u64e6\u5693\u7924","cai":"\u731c\u88c1\u6750\u624d\u8d22\u776c\u8e29\u91c7\u5f69\u83dc\u8521","can":"\u9910\u53c2\u8695\u6b8b\u60ed\u60e8\u707f\u9a96\u74a8\u7cb2\u9eea","cang":"\u82cd\u8231\u4ed3\u6ca7\u85cf\u4f27","cao":"\u64cd\u7cd9\u69fd\u66f9\u8349\u8279\u5608\u6f15\u87ac\u825a","ce":"\u5395\u7b56\u4fa7\u518c\u6d4b\u5202\u5e3b\u607b","ceng":"\u5c42\u8e6d\u564c","cha":"\u63d2\u53c9\u832c\u8336\u67e5\u78b4\u643d\u5bdf\u5c94\u5dee\u8be7\u7339\u9987\u6c4a\u59f9\u6748\u6942\u69ce\u6aab\u9497\u9538\u9572\u8869","chai":"\u62c6\u67f4\u8c7a\u4faa\u8308\u7625\u867f\u9f87","chan":"\u6400\u63ba\u8749\u998b\u8c17\u7f20\u94f2\u4ea7\u9610\u98a4\u5181\u8c04\u8c36\u8487\u5edb\u5fcf\u6f7a\u6fb6\u5b71\u7fbc\u5a75\u5b17\u9aa3\u89c7\u7985\u9561\u88e3\u87fe\u8e94","chang":"\u660c\u7316\u573a\u5c1d\u5e38\u957f\u507f\u80a0\u5382\u655e\u7545\u5531\u5021\u4f25\u9b2f\u82cc\u83d6\u5f9c\u6005\u60dd\u960a\u5a3c\u5ae6\u6636\u6c05\u9cb3","chao":"\u8d85\u6284\u949e\u671d\u5632\u6f6e\u5de2\u5435\u7092\u600a\u7ec9\u6641\u8016","che":"\u8f66\u626f\u64a4\u63a3\u5f7b\u6f88\u577c\u5c6e\u7817","chen":"\u90f4\u81e3\u8fb0\u5c18\u6668\u5ff1\u6c89\u9648\u8d81\u886c\u79f0\u8c0c\u62bb\u55d4\u5bb8\u741b\u6987\u809c\u80c2\u789c\u9f80","cheng":"\u6491\u57ce\u6a59\u6210\u5448\u4e58\u7a0b\u60e9\u6f84\u8bda\u627f\u901e\u9a8b\u79e4\u57d5\u5d4a\u5fb5\u6d48\u67a8\u67fd\u6a18\u665f\u584d\u77a0\u94d6\u88ce\u86cf\u9172","chi":"\u5403\u75f4\u6301\u5319\u6c60\u8fdf\u5f1b\u9a70\u803b\u9f7f\u4f88\u5c3a\u8d64\u7fc5\u65a5\u70bd\u50ba\u5880\u82aa\u830c\u640b\u53f1\u54e7\u557b\u55e4\u5f73\u996c\u6cb2\u5ab8\u6555\u80dd\u7719\u7735\u9e31\u761b\u892b\u86a9\u87ad\u7b1e\u7bea\u8c49\u8e05\u8e1f\u9b51","chong":"\u5145\u51b2\u866b\u5d07\u5ba0\u833a\u5fe1\u61a7\u94f3\u825f","chou":"\u62bd\u916c\u7574\u8e0c\u7a20\u6101\u7b79\u4ec7\u7ef8\u7785\u4e11\u4fe6\u5733\u5e31\u60c6\u6eb4\u59af\u7633\u96e0\u9c8b","chu":"\u81ed\u521d\u51fa\u6a71\u53a8\u8e87\u9504\u96cf\u6ec1\u9664\u695a\u7840\u50a8\u77d7\u6410\u89e6\u5904\u4e8d\u520d\u61b7\u7ecc\u6775\u696e\u6a17\u870d\u8e70\u9edc","chuan":"\u63e3\u5ddd\u7a7f\u693d\u4f20\u8239\u5598\u4e32\u63be\u821b\u60f4\u9044\u5ddb\u6c1a\u948f\u9569\u8221","chuang":"\u75ae\u7a97\u5e62\u5e8a\u95ef\u521b\u6006","chui":"\u5439\u708a\u6376\u9524\u5782\u9672\u68f0\u69cc","chun":"\u6625\u693f\u9187\u5507\u6df3\u7eaf\u8822\u4fc3\u83bc\u6c8c\u80ab\u6710\u9e51\u877d","chuo":"\u6233\u7ef0\u851f\u8fb6\u8f8d\u955e\u8e14\u9f8a","ci":"\u75b5\u8328\u78c1\u96cc\u8f9e\u6148\u74f7\u8bcd\u6b64\u523a\u8d50\u6b21\u8360\u5472\u5d6f\u9e5a\u8785\u7ccd\u8d91","cong":"\u806a\u8471\u56f1\u5306\u4ece\u4e1b\u506c\u82c1\u6dd9\u9aa2\u742e\u7481\u679e","cu":"\u51d1\u7c97\u918b\u7c07\u731d\u6b82\u8e59","cuan":"\u8e7f\u7be1\u7a9c\u6c46\u64ba\u6615\u7228","cui":"\u6467\u5d14\u50ac\u8106\u7601\u7cb9\u6dec\u7fe0\u8403\u60b4\u7480\u69b1\u96b9","cun":"\u6751\u5b58\u5bf8\u78cb\u5fd6\u76b4","cuo":"\u64ae\u6413\u63aa\u632b\u9519\u539d\u811e\u9509\u77ec\u75e4\u9e7e\u8e49\u8e9c","da":"\u642d\u8fbe\u7b54\u7629\u6253\u5927\u8037\u54d2\u55d2\u601b\u59b2\u75b8\u8921\u7b2a\u977c\u9791","dai":"\u5446\u6b79\u50a3\u6234\u5e26\u6b86\u4ee3\u8d37\u888b\u5f85\u902e\u6020\u57ed\u7519\u5454\u5cb1\u8fe8\u902f\u9a80\u7ed0\u73b3\u9edb","dan":"\u803d\u62c5\u4e39\u5355\u90f8\u63b8\u80c6\u65e6\u6c2e\u4f46\u60ee\u6de1\u8bde\u5f39\u86cb\u4ebb\u510b\u5369\u840f\u5556\u6fb9\u6a90\u6b9a\u8d55\u7708\u7605\u8043\u7baa","dang":"\u5f53\u6321\u515a\u8361\u6863\u8c20\u51fc\u83ea\u5b95\u7800\u94db\u88c6","dao":"\u5200\u6363\u8e48\u5012\u5c9b\u7977\u5bfc\u5230\u7a3b\u60bc\u9053\u76d7\u53e8\u5541\u5fc9\u6d2e\u6c18\u7118\u5fd1\u7e9b","de":"\u5fb7\u5f97\u7684\u951d","deng":"\u8e6c\u706f\u767b\u7b49\u77aa\u51f3\u9093\u5654\u5d9d\u6225\u78f4\u956b\u7c26","di":"\u5824\u4f4e\u6ef4\u8fea\u654c\u7b1b\u72c4\u6da4\u7fdf\u5ae1\u62b5\u5e95\u5730\u8482\u7b2c\u5e1d\u5f1f\u9012\u7f14\u6c10\u7c74\u8bcb\u8c1b\u90b8\u577b\u839c\u837b\u5600\u5a23\u67e2\u68e3\u89cc\u7825\u78b2\u7747\u955d\u7f9d\u9ab6","dian":"\u98a0\u6382\u6ec7\u7898\u70b9\u5178\u975b\u57ab\u7535\u4f43\u7538\u5e97\u60e6\u5960\u6dc0\u6bbf\u4e36\u963d\u576b\u57dd\u5dc5\u73b7\u765c\u766b\u7c1f\u8e2e","diao":"\u7889\u53fc\u96d5\u51cb\u5201\u6389\u540a\u9493\u8c03\u8f7a\u94de\u8729\u7c9c\u8c82","die":"\u8dcc\u7239\u789f\u8776\u8fed\u8c0d\u53e0\u4f5a\u57a4\u581e\u63f2\u558b\u6e2b\u8f76\u7252\u74de\u8936\u800b\u8e40\u9cbd\u9cce","ding":"\u4e01\u76ef\u53ee\u9489\u9876\u9f0e\u952d\u5b9a\u8ba2\u4e22\u4ec3\u5576\u738e\u815a\u7887\u753a\u94e4\u7594\u8035\u914a","dong":"\u4e1c\u51ac\u8463\u61c2\u52a8\u680b\u4f97\u606b\u51bb\u6d1e\u578c\u549a\u5cbd\u5cd2\u5902\u6c21\u80e8\u80f4\u7850\u9e2b","dou":"\u515c\u6296\u6597\u9661\u8c46\u9017\u75d8\u8538\u94ad\u7aa6\u7aac\u86aa\u7bfc\u9161","du":"\u90fd\u7763\u6bd2\u728a\u72ec\u8bfb\u5835\u7779\u8d4c\u675c\u9540\u809a\u5ea6\u6e21\u5992\u828f\u561f\u6e0e\u691f\u6a50\u724d\u8839\u7b03\u9ad1\u9ee9","duan":"\u7aef\u77ed\u953b\u6bb5\u65ad\u7f0e\u5f56\u6934\u7145\u7c16","dui":"\u5806\u5151\u961f\u5bf9\u603c\u619d\u7893","dun":"\u58a9\u5428\u8e72\u6566\u987f\u56e4\u949d\u76fe\u9041\u7096\u7818\u7905\u76f9\u9566\u8db8","duo":"\u6387\u54c6\u591a\u593a\u579b\u8eb2\u6735\u8dfa\u8235\u5241\u60f0\u5815\u5484\u54da\u7f0d\u67c1\u94ce\u88f0\u8e31","e":"\u86fe\u5ce8\u9e45\u4fc4\u989d\u8bb9\u5a25\u6076\u5384\u627c\u904f\u9102\u997f\u5669\u8c14\u57a9\u57ad\u82ca\u83aa\u843c\u5443\u6115\u5c59\u5a40\u8f6d\u66f7\u816d\u786a\u9507\u9537\u9e57\u989a\u9cc4","en":"\u6069\u84bd\u6441\u5514\u55ef","er":"\u800c\u513f\u8033\u5c14\u9975\u6d31\u4e8c\u8d30\u8fe9\u73e5\u94d2\u9e38\u9c95","fa":"\u53d1\u7f5a\u7b4f\u4f10\u4e4f\u9600\u6cd5\u73d0\u57a1\u781d","fan":"\u85e9\u5e06\u756a\u7ffb\u6a0a\u77fe\u9492\u7e41\u51e1\u70e6\u53cd\u8fd4\u8303\u8d29\u72af\u996d\u6cdb\u8629\u5e61\u72ad\u68b5\u6535\u71d4\u7548\u8e6f","fang":"\u574a\u82b3\u65b9\u80aa\u623f\u9632\u59a8\u4eff\u8bbf\u7eba\u653e\u531a\u90a1\u5f77\u94ab\u822b\u9c82","fei":"\u83f2\u975e\u5561\u98de\u80a5\u532a\u8bfd\u5420\u80ba\u5e9f\u6cb8\u8d39\u82be\u72d2\u60b1\u6ddd\u5983\u7ecb\u7eef\u69a7\u8153\u6590\u6249\u7953\u7829\u9544\u75f1\u871a\u7bda\u7fe1\u970f\u9cb1","fen":"\u82ac\u915a\u5429\u6c1b\u5206\u7eb7\u575f\u711a\u6c7e\u7c89\u594b\u4efd\u5fff\u6124\u7caa\u507e\u7035\u68fc\u610d\u9cbc\u9f22","feng":"\u4e30\u5c01\u67ab\u8702\u5cf0\u950b\u98ce\u75af\u70fd\u9022\u51af\u7f1d\u8bbd\u5949\u51e4\u4ff8\u9146\u8451\u6ca3\u781c","fu":"\u4f5b\u5426\u592b\u6577\u80a4\u5b75\u6276\u62c2\u8f90\u5e45\u6c1f\u7b26\u4f0f\u4fd8\u670d\u6d6e\u6daa\u798f\u88b1\u5f17\u752b\u629a\u8f85\u4fef\u91dc\u65a7\u812f\u8151\u5e9c\u8150\u8d74\u526f\u8986\u8d4b\u590d\u5085\u4ed8\u961c\u7236\u8179\u8d1f\u5bcc\u8ba3\u9644\u5987\u7f1a\u5490\u5310\u51eb\u90db\u8299\u82fb\u832f\u83a9\u83d4\u544b\u5e5e\u6ecf\u8274\u5b5a\u9a78\u7ec2\u6874\u8d59\u9efb\u9efc\u7f58\u7a03\u99a5\u864d\u86a8\u8709\u8760\u876e\u9eb8\u8dba\u8dd7\u9cc6","ga":"\u5676\u560e\u86e4\u5c2c\u5477\u5c15\u5c1c\u65ee\u9486","gai":"\u8be5\u6539\u6982\u9499\u76d6\u6e89\u4e10\u9654\u5793\u6224\u8d45\u80f2","gan":"\u5e72\u7518\u6746\u67d1\u7aff\u809d\u8d76\u611f\u79c6\u6562\u8d63\u5769\u82f7\u5c34\u64c0\u6cd4\u6de6\u6f89\u7ec0\u6a44\u65f0\u77f8\u75b3\u9150","gang":"\u5188\u521a\u94a2\u7f38\u809b\u7eb2\u5c97\u6e2f\u6206\u7f61\u9883\u7b7b","gong":"\u6760\u5de5\u653b\u529f\u606d\u9f9a\u4f9b\u8eac\u516c\u5bab\u5f13\u5de9\u6c5e\u62f1\u8d21\u5171\u857b\u5efe\u54a3\u73d9\u80b1\u86a3\u86e9\u89e5","gao":"\u7bd9\u768b\u9ad8\u818f\u7f94\u7cd5\u641e\u9550\u7a3f\u544a\u777e\u8bf0\u90dc\u84bf\u85c1\u7f1f\u69d4\u69c1\u6772\u9506","ge":"\u54e5\u6b4c\u6401\u6208\u9e3d\u80f3\u7599\u5272\u9769\u845b\u683c\u9601\u9694\u94ec\u4e2a\u5404\u9b32\u4ee1\u54ff\u5865\u55dd\u7ea5\u643f\u8188\u784c\u94ea\u9549\u88bc\u988c\u867c\u8238\u9abc\u9ac2","gei":"\u7ed9","gen":"\u6839\u8ddf\u4e98\u831b\u54cf\u826e","geng":"\u8015\u66f4\u5e9a\u7fb9\u57c2\u803f\u6897\u54fd\u8d53\u9ca0","gou":"\u94a9\u52fe\u6c9f\u82df\u72d7\u57a2\u6784\u8d2d\u591f\u4f5d\u8bdf\u5ca3\u9058\u5abe\u7f11\u89cf\u5f40\u9e32\u7b31\u7bdd\u97b2","gu":"\u8f9c\u83c7\u5495\u7b8d\u4f30\u6cbd\u5b64\u59d1\u9f13\u53e4\u86ca\u9aa8\u8c37\u80a1\u6545\u987e\u56fa\u96c7\u560f\u8bc2\u83f0\u54cc\u5d2e\u6c69\u688f\u8f71\u726f\u727f\u80cd\u81cc\u6bc2\u77bd\u7f5f\u94b4\u9522\u74e0\u9e2a\u9e44\u75fc\u86c4\u9164\u89da\u9cb4\u9ab0\u9e58","gua":"\u522e\u74dc\u5250\u5be1\u6302\u8902\u5366\u8bd6\u5471\u681d\u9e39","guai":"\u4e56\u62d0\u602a\u54d9","guan":"\u68fa\u5173\u5b98\u51a0\u89c2\u7ba1\u9986\u7f50\u60ef\u704c\u8d2f\u500c\u839e\u63bc\u6dab\u76e5\u9e73\u9ccf","guang":"\u5149\u5e7f\u901b\u72b7\u6844\u80f1\u7592","gui":"\u7470\u89c4\u572d\u7845\u5f52\u9f9f\u95fa\u8f68\u9b3c\u8be1\u7678\u6842\u67dc\u8dea\u8d35\u523d\u5326\u523f\u5e8b\u5b84\u59ab\u6867\u7085\u6677\u7688\u7c0b\u9c91\u9cdc","gun":"\u8f8a\u6eda\u68cd\u4e28\u886e\u7ef2\u78d9\u9ca7","guo":"\u9505\u90ed\u56fd\u679c\u88f9\u8fc7\u9998\u8803\u57da\u63b4\u5459\u56d7\u5e3c\u5d1e\u7313\u6901\u8662\u951e\u8052\u872e\u873e\u8748","ha":"\u54c8","hai":"\u9ab8\u5b69\u6d77\u6c26\u4ea5\u5bb3\u9a87\u54b4\u55e8\u988f\u91a2","han":"\u9163\u61a8\u90af\u97e9\u542b\u6db5\u5bd2\u51fd\u558a\u7f55\u7ff0\u64bc\u634d\u65f1\u61be\u608d\u710a\u6c57\u6c49\u9097\u83e1\u6496\u961a\u701a\u6657\u7113\u9894\u86b6\u9f3e","hen":"\u592f\u75d5\u5f88\u72e0\u6068","hang":"\u676d\u822a\u6c86\u7ed7\u73e9\u6841","hao":"\u58d5\u568e\u8c6a\u6beb\u90dd\u597d\u8017\u53f7\u6d69\u8585\u55e5\u5686\u6fe0\u704f\u660a\u7693\u98a2\u869d","he":"\u5475\u559d\u8377\u83cf\u6838\u79be\u548c\u4f55\u5408\u76d2\u8c89\u9602\u6cb3\u6db8\u8d6b\u8910\u9e64\u8d3a\u8bc3\u52be\u58d1\u85ff\u55d1\u55ec\u9616\u76cd\u86b5\u7fee","hei":"\u563f\u9ed1","heng":"\u54fc\u4ea8\u6a2a\u8861\u6052\u8a07\u8605","hong":"\u8f70\u54c4\u70d8\u8679\u9e3f\u6d2a\u5b8f\u5f18\u7ea2\u9ec9\u8ba7\u836d\u85a8\u95f3\u6cd3","hou":"\u5589\u4faf\u7334\u543c\u539a\u5019\u540e\u5820\u5f8c\u9005\u760a\u7bcc\u7cc7\u9c8e\u9aba","hu":"\u547c\u4e4e\u5ffd\u745a\u58f6\u846b\u80e1\u8774\u72d0\u7cca\u6e56\u5f27\u864e\u552c\u62a4\u4e92\u6caa\u6237\u51b1\u553f\u56eb\u5cb5\u7322\u6019\u60da\u6d52\u6ef9\u7425\u69f2\u8f77\u89f3\u70c0\u7173\u623d\u6248\u795c\u9e55\u9e71\u7b0f\u9190\u659b","hua":"\u82b1\u54d7\u534e\u733e\u6ed1\u753b\u5212\u5316\u8bdd\u5290\u6d4d\u9a85\u6866\u94e7\u7a1e","huai":"\u69d0\u5f8a\u6000\u6dee\u574f\u8fd8\u8e1d","huan":"\u6b22\u73af\u6853\u7f13\u6362\u60a3\u5524\u75ea\u8c62\u7115\u6da3\u5ba6\u5e7b\u90c7\u5942\u57b8\u64d0\u571c\u6d39\u6d63\u6f36\u5bf0\u902d\u7f33\u953e\u9ca9\u9b1f","huang":"\u8352\u614c\u9ec4\u78fa\u8757\u7c27\u7687\u51f0\u60f6\u714c\u6643\u5e4c\u604d\u8c0e\u968d\u5fa8\u6e5f\u6f62\u9051\u749c\u8093\u7640\u87e5\u7bc1\u9cc7","hui":"\u7070\u6325\u8f89\u5fbd\u6062\u86d4\u56de\u6bc1\u6094\u6167\u5349\u60e0\u6666\u8d3f\u79fd\u4f1a\u70e9\u6c47\u8bb3\u8bf2\u7ed8\u8bd9\u8334\u835f\u8559\u54d5\u5599\u96b3\u6d04\u5f57\u7f0b\u73f2\u6656\u605a\u867a\u87ea\u9ebe","hun":"\u8364\u660f\u5a5a\u9b42\u6d51\u6df7\u8be8\u9984\u960d\u6eb7\u7f17","huo":"\u8c41\u6d3b\u4f19\u706b\u83b7\u6216\u60d1\u970d\u8d27\u7978\u6509\u56af\u5925\u94ac\u952a\u956c\u8020\u8816","ji":"\u51fb\u573e\u57fa\u673a\u7578\u7a3d\u79ef\u7b95\u808c\u9965\u8ff9\u6fc0\u8ba5\u9e21\u59ec\u7ee9\u7f09\u5409\u6781\u68d8\u8f91\u7c4d\u96c6\u53ca\u6025\u75be\u6c72\u5373\u5ac9\u7ea7\u6324\u51e0\u810a\u5df1\u84df\u6280\u5180\u5b63\u4f0e\u796d\u5242\u60b8\u6d4e\u5bc4\u5bc2\u8ba1\u8bb0\u65e2\u5fcc\u9645\u5993\u7ee7\u7eaa\u5c45\u4e0c\u4e69\u525e\u4f76\u4f74\u8114\u58bc\u82a8\u82b0\u8401\u84ba\u857a\u638e\u53fd\u54ad\u54dc\u5527\u5c8c\u5d74\u6d0e\u5f50\u5c50\u9aa5\u757f\u7391\u696b\u6b9b\u621f\u6222\u8d4d\u89ca\u7284\u9f51\u77f6\u7f81\u5d47\u7a37\u7620\u7635\u866e\u7b08\u7b04\u66a8\u8dfb\u8dfd\u9701\u9c9a\u9cab\u9afb\u9e82","jia":"\u5609\u67b7\u5939\u4f73\u5bb6\u52a0\u835a\u988a\u8d3e\u7532\u94be\u5047\u7a3c\u4ef7\u67b6\u9a7e\u5ac1\u4f3d\u90cf\u62ee\u5cac\u6d43\u8fe6\u73c8\u621b\u80db\u605d\u94d7\u9553\u75c2\u86f1\u7b33\u8888\u8dcf","jian":"\u6b7c\u76d1\u575a\u5c16\u7b3a\u95f4\u714e\u517c\u80a9\u8270\u5978\u7f04\u8327\u68c0\u67ec\u78b1\u7877\u62e3\u6361\u7b80\u4fed\u526a\u51cf\u8350\u69db\u9274\u8df5\u8d31\u89c1\u952e\u7bad\u4ef6\u5065\u8230\u5251\u996f\u6e10\u6e85\u6da7\u5efa\u50ed\u8c0f\u8c2b\u83c5\u84b9\u641b\u56dd\u6e54\u8e47\u8b07\u7f23\u67a7\u67d9\u6957\u620b\u622c\u726e\u728d\u6bfd\u8171\u7751\u950f\u9e63\u88e5\u7b15\u7bb4\u7fe6\u8dbc\u8e3a\u9ca3\u97af","jiang":"\u50f5\u59dc\u5c06\u6d46\u6c5f\u7586\u848b\u6868\u5956\u8bb2\u5320\u9171\u964d\u8333\u6d1a\u7edb\u7f30\u729f\u7913\u8029\u7ce8\u8c47","jiao":"\u8549\u6912\u7901\u7126\u80f6\u4ea4\u90ca\u6d47\u9a84\u5a07\u56bc\u6405\u94f0\u77eb\u4fa5\u811a\u72e1\u89d2\u997a\u7f34\u7ede\u527f\u6559\u9175\u8f7f\u8f83\u53eb\u4f7c\u50ec\u832d\u6322\u564d\u5ce4\u5fbc\u59e3\u7e9f\u656b\u768e\u9e6a\u86df\u91ae\u8de4\u9c9b","jie":"\u7a96\u63ed\u63a5\u7686\u79f8\u8857\u9636\u622a\u52ab\u8282\u6854\u6770\u6377\u776b\u7aed\u6d01\u7ed3\u89e3\u59d0\u6212\u85c9\u82a5\u754c\u501f\u4ecb\u75a5\u8beb\u5c4a\u5048\u8ba6\u8bd8\u5588\u55df\u736c\u5a55\u5b51\u6840\u7352\u78a3\u9534\u7596\u88b7\u9889\u86a7\u7faf\u9c92\u9ab1\u9aeb","jin":"\u5dfe\u7b4b\u65a4\u91d1\u4eca\u6d25\u895f\u7d27\u9526\u4ec5\u8c28\u8fdb\u9773\u664b\u7981\u8fd1\u70ec\u6d78\u5c3d\u537a\u8369\u5807\u5664\u9991\u5ed1\u5997\u7f19\u747e\u69ff\u8d46\u89d0\u9485\u9513\u887f\u77dc","jing":"\u52b2\u8346\u5162\u830e\u775b\u6676\u9cb8\u4eac\u60ca\u7cbe\u7cb3\u7ecf\u4e95\u8b66\u666f\u9888\u9759\u5883\u656c\u955c\u5f84\u75c9\u9756\u7adf\u7ade\u51c0\u522d\u5106\u9631\u83c1\u734d\u61ac\u6cfe\u8ff3\u5f2a\u5a67\u80bc\u80eb\u8148\u65cc","jiong":"\u70af\u7a98\u5182\u8fe5\u6243","jiu":"\u63ea\u7a76\u7ea0\u7396\u97ed\u4e45\u7078\u4e5d\u9152\u53a9\u6551\u65e7\u81fc\u8205\u548e\u5c31\u759a\u50e6\u557e\u9604\u67e9\u6855\u9e6b\u8d73\u9b0f","ju":"\u97a0\u62d8\u72d9\u75bd\u9a79\u83ca\u5c40\u5480\u77e9\u4e3e\u6cae\u805a\u62d2\u636e\u5de8\u5177\u8ddd\u8e1e\u952f\u4ff1\u53e5\u60e7\u70ac\u5267\u5028\u8bb5\u82e3\u82f4\u8392\u63ac\u907d\u5c66\u741a\u67b8\u6910\u6998\u6989\u6a58\u728b\u98d3\u949c\u9514\u7aad\u88fe\u8d84\u91b5\u8e3d\u9f83\u96ce\u97ab","juan":"\u6350\u9e43\u5a1f\u5026\u7737\u5377\u7ee2\u9104\u72f7\u6d93\u684a\u8832\u9529\u954c\u96bd","jue":"\u6485\u652b\u6289\u6398\u5014\u7235\u89c9\u51b3\u8bc0\u7edd\u53a5\u5282\u8c32\u77cd\u8568\u5658\u5d1b\u7357\u5b53\u73cf\u6877\u6a5b\u721d\u9562\u8e76\u89d6","jun":"\u5747\u83cc\u94a7\u519b\u541b\u5cfb\u4fca\u7ae3\u6d5a\u90e1\u9a8f\u6343\u72fb\u76b2\u7b60\u9e87","ka":"\u5580\u5496\u5361\u4f67\u5494\u80e9","ke":"\u54af\u5777\u82db\u67ef\u68f5\u78d5\u9897\u79d1\u58f3\u54b3\u53ef\u6e34\u514b\u523b\u5ba2\u8bfe\u5ca2\u606a\u6e98\u9a92\u7f02\u73c2\u8f72\u6c2a\u778c\u94b6\u75b4\u7aa0\u874c\u9ac1","kai":"\u5f00\u63e9\u6977\u51ef\u6168\u5240\u57b2\u8488\u5ffe\u607a\u94e0\u950e","kan":"\u520a\u582a\u52d8\u574e\u780d\u770b\u4f83\u51f5\u83b0\u83b6\u6221\u9f9b\u77b0","kang":"\u5eb7\u6177\u7ce0\u625b\u6297\u4ea2\u7095\u5751\u4f09\u95f6\u94aa","kao":"\u8003\u62f7\u70e4\u9760\u5c3b\u6832\u7292\u94d0","ken":"\u80af\u5543\u57a6\u6073\u57a0\u88c9\u9880","keng":"\u542d\u5fd0\u94ff","kong":"\u7a7a\u6050\u5b54\u63a7\u5025\u5d06\u7b9c","kou":"\u62a0\u53e3\u6263\u5bc7\u82a4\u853b\u53e9\u770d\u7b58","ku":"\u67af\u54ed\u7a9f\u82e6\u9177\u5e93\u88e4\u5233\u5800\u55be\u7ed4\u9ab7","kua":"\u5938\u57ae\u630e\u8de8\u80ef\u4f89","kuai":"\u5757\u7b77\u4fa9\u5feb\u84af\u90d0\u8489\u72ef\u810d","kuan":"\u5bbd\u6b3e\u9acb","kuang":"\u5321\u7b50\u72c2\u6846\u77ff\u7736\u65f7\u51b5\u8bd3\u8bf3\u909d\u5739\u593c\u54d0\u7ea9\u8d36","kui":"\u4e8f\u76d4\u5cbf\u7aa5\u8475\u594e\u9b41\u5080\u9988\u6127\u6e83\u9997\u532e\u5914\u9697\u63c6\u55b9\u559f\u609d\u6126\u9615\u9035\u668c\u777d\u8069\u8770\u7bd1\u81fe\u8dec","kun":"\u5764\u6606\u6346\u56f0\u6083\u9603\u7428\u951f\u918c\u9cb2\u9ae1","kuo":"\u62ec\u6269\u5ed3\u9614\u86de","la":"\u5783\u62c9\u5587\u8721\u814a\u8fa3\u5566\u524c\u647a\u908b\u65ef\u782c\u760c","lai":"\u83b1\u6765\u8d56\u5d03\u5f95\u6d9e\u6fd1\u8d49\u7750\u94fc\u765e\u7c41","lan":"\u84dd\u5a6a\u680f\u62e6\u7bee\u9611\u5170\u6f9c\u8c30\u63fd\u89c8\u61d2\u7f06\u70c2\u6ee5\u5549\u5c9a\u61d4\u6f24\u6984\u6593\u7f71\u9567\u8934","lang":"\u7405\u6994\u72fc\u5eca\u90ce\u6717\u6d6a\u83a8\u8497\u5577\u9606\u9512\u7a02\u8782","lao":"\u635e\u52b3\u7262\u8001\u4f6c\u59e5\u916a\u70d9\u6d9d\u5520\u5d02\u6833\u94d1\u94f9\u75e8\u91aa","le":"\u52d2\u4e50\u808b\u4ec2\u53fb\u561e\u6cd0\u9cd3","lei":"\u96f7\u956d\u857e\u78ca\u7d2f\u5121\u5792\u64c2\u7c7b\u6cea\u7fb8\u8bd4\u837d\u54a7\u6f2f\u5ad8\u7f27\u6a91\u8012\u9179","ling":"\u68f1\u51b7\u62ce\u73b2\u83f1\u96f6\u9f84\u94c3\u4f36\u7f9a\u51cc\u7075\u9675\u5cad\u9886\u53e6\u4ee4\u9143\u5844\u82d3\u5464\u56f9\u6ce0\u7eeb\u67c3\u68c2\u74f4\u8046\u86c9\u7fce\u9cae","leng":"\u695e\u6123","li":"\u5398\u68a8\u7281\u9ece\u7bf1\u72f8\u79bb\u6f13\u7406\u674e\u91cc\u9ca4\u793c\u8389\u8354\u540f\u6817\u4e3d\u5389\u52b1\u783e\u5386\u5229\u5088\u4f8b\u4fd0\u75e2\u7acb\u7c92\u6ca5\u96b6\u529b\u7483\u54e9\u4fea\u4fda\u90e6\u575c\u82c8\u8385\u84e0\u85dc\u6369\u5456\u5533\u55b1\u7301\u6ea7\u6fa7\u9026\u5a0c\u5ae0\u9a8a\u7f21\u73de\u67a5\u680e\u8f79\u623e\u783a\u8a48\u7f79\u9502\u9e42\u75a0\u75ac\u86ce\u870a\u8821\u7b20\u7be5\u7c9d\u91b4\u8dde\u96f3\u9ca1\u9ce2\u9ee7","lian":"\u4fe9\u8054\u83b2\u8fde\u9570\u5ec9\u601c\u6d9f\u5e18\u655b\u8138\u94fe\u604b\u70bc\u7ec3\u631b\u8539\u5941\u6f4b\u6fc2\u5a08\u740f\u695d\u6b93\u81c1\u81a6\u88e2\u880a\u9ca2","liang":"\u7cae\u51c9\u6881\u7cb1\u826f\u4e24\u8f86\u91cf\u667e\u4eae\u8c05\u589a\u690b\u8e09\u9753\u9b49","liao":"\u64a9\u804a\u50da\u7597\u71ce\u5be5\u8fbd\u6f66\u4e86\u6482\u9563\u5ed6\u6599\u84fc\u5c25\u5639\u7360\u5bee\u7f2d\u948c\u9e69\u8022","lie":"\u5217\u88c2\u70c8\u52a3\u730e\u51bd\u57d2\u6d0c\u8d94\u8e90\u9b23","lin":"\u7433\u6797\u78f7\u9716\u4e34\u90bb\u9cde\u6dcb\u51db\u8d41\u541d\u853a\u5d99\u5eea\u9074\u6aa9\u8f9a\u77b5\u7cbc\u8e8f\u9e9f","liu":"\u6e9c\u7409\u69b4\u786b\u998f\u7559\u5218\u7624\u6d41\u67f3\u516d\u62a1\u507b\u848c\u6cd6\u6d4f\u905b\u9a9d\u7efa\u65d2\u7198\u950d\u954f\u9e68\u938f","long":"\u9f99\u804b\u5499\u7b3c\u7abf\u9686\u5784\u62e2\u9647\u5f04\u5785\u830f\u6cf7\u73d1\u680a\u80e7\u783b\u7643","lou":"\u697c\u5a04\u6402\u7bd3\u6f0f\u964b\u55bd\u5d5d\u9542\u7618\u8027\u877c\u9ac5","lu":"\u82a6\u5362\u9885\u5e90\u7089\u63b3\u5364\u864f\u9c81\u9e93\u788c\u9732\u8def\u8d42\u9e7f\u6f5e\u7984\u5f55\u9646\u622e\u5786\u6445\u64b8\u565c\u6cf8\u6e0c\u6f09\u7490\u680c\u6a79\u8f73\u8f82\u8f98\u6c07\u80ea\u9565\u9e2c\u9e6d\u7c0f\u823b\u9c88","lv":"\u9a74\u5415\u94dd\u4fa3\u65c5\u5c65\u5c61\u7f15\u8651\u6c2f\u5f8b\u7387\u6ee4\u7eff\u634b\u95fe\u6988\u8182\u7a06\u891b","luan":"\u5ce6\u5b6a\u6ee6\u5375\u4e71\u683e\u9e3e\u92ae","lue":"\u63a0\u7565\u950a","lun":"\u8f6e\u4f26\u4ed1\u6ca6\u7eb6\u8bba\u56f5","luo":"\u841d\u87ba\u7f57\u903b\u9523\u7ba9\u9aa1\u88f8\u843d\u6d1b\u9a86\u7edc\u502e\u8366\u645e\u7321\u6cfa\u6924\u8136\u9559\u7630\u96d2","ma":"\u5988\u9ebb\u739b\u7801\u8682\u9a6c\u9a82\u561b\u5417\u551b\u72b8\u5b37\u6769\u9ebd","mai":"\u57cb\u4e70\u9ea6\u5356\u8fc8\u8109\u52a2\u836c\u54aa\u973e","man":"\u7792\u9992\u86ee\u6ee1\u8513\u66fc\u6162\u6f2b\u8c29\u5881\u5e54\u7f26\u71b3\u9558\u989f\u87a8\u9cd7\u9794","mang":"\u8292\u832b\u76f2\u5fd9\u83bd\u9099\u6f2d\u6726\u786d\u87d2","meng":"\u6c13\u840c\u8499\u6aac\u76df\u9530\u731b\u68a6\u5b5f\u52d0\u750d\u77a2\u61f5\u791e\u867b\u8722\u8813\u824b\u8268\u9efe","miao":"\u732b\u82d7\u63cf\u7784\u85d0\u79d2\u6e3a\u5e99\u5999\u55b5\u9088\u7f08\u7f2a\u676a\u6dfc\u7707\u9e4b\u8731","mao":"\u8305\u951a\u6bdb\u77db\u94c6\u536f\u8302\u5192\u5e3d\u8c8c\u8d38\u4f94\u88a4\u52d6\u8306\u5cc1\u7441\u6634\u7266\u8004\u65c4\u61cb\u7780\u86d1\u8765\u87ca\u9ae6","me":"\u4e48","mei":"\u73ab\u679a\u6885\u9176\u9709\u7164\u6ca1\u7709\u5a92\u9541\u6bcf\u7f8e\u6627\u5bd0\u59b9\u5a9a\u5776\u8393\u5d4b\u7338\u6d7c\u6e44\u6963\u9545\u9e5b\u8882\u9b45","men":"\u95e8\u95f7\u4eec\u626a\u739f\u7116\u61d1\u9494","mi":"\u772f\u919a\u9761\u7cdc\u8ff7\u8c1c\u5f25\u7c73\u79d8\u89c5\u6ccc\u871c\u5bc6\u5e42\u8288\u5196\u8c27\u863c\u5627\u7315\u736f\u6c68\u5b93\u5f2d\u8112\u6549\u7cf8\u7e3b\u9e8b","mian":"\u68c9\u7720\u7ef5\u5195\u514d\u52c9\u5a29\u7f05\u9762\u6c94\u6e4e\u817c\u7704","mie":"\u8511\u706d\u54a9\u881b\u7bfe","min":"\u6c11\u62bf\u76bf\u654f\u60af\u95fd\u82e0\u5cb7\u95f5\u6cef\u73c9","ming":"\u660e\u879f\u9e23\u94ed\u540d\u547d\u51a5\u8317\u6e9f\u669d\u7791\u9169","miu":"\u8c2c","mo":"\u6478\u6479\u8611\u6a21\u819c\u78e8\u6469\u9b54\u62b9\u672b\u83ab\u58a8\u9ed8\u6cab\u6f20\u5bde\u964c\u8c1f\u8309\u84e6\u998d\u5aeb\u9546\u79e3\u763c\u8031\u87c6\u8c8a\u8c98","mou":"\u8c0b\u725f\u67d0\u53b6\u54de\u5a7a\u7738\u936a","mu":"\u62c7\u7261\u4ea9\u59c6\u6bcd\u5893\u66ae\u5e55\u52df\u6155\u6728\u76ee\u7766\u7267\u7a46\u4eeb\u82dc\u5452\u6c90\u6bea\u94bc","na":"\u62ff\u54ea\u5450\u94a0\u90a3\u5a1c\u7eb3\u5185\u637a\u80ad\u954e\u8872\u7bac","nai":"\u6c16\u4e43\u5976\u8010\u5948\u9f10\u827f\u8418\u67f0","nan":"\u5357\u7537\u96be\u56ca\u5583\u56e1\u6960\u8169\u877b\u8d67","nao":"\u6320\u8111\u607c\u95f9\u5b6c\u57b4\u7331\u7459\u7847\u94d9\u86f2","ne":"\u6dd6\u5462\u8bb7","nei":"\u9981","nen":"\u5ae9\u80fd\u6798\u6041","ni":"\u59ae\u9713\u502a\u6ce5\u5c3c\u62df\u4f60\u533f\u817b\u9006\u6eba\u4f32\u576d\u730a\u6029\u6ee0\u6635\u65ce\u7962\u615d\u7768\u94cc\u9cb5","nian":"\u852b\u62c8\u5e74\u78be\u64b5\u637b\u5ff5\u5eff\u8f87\u9ecf\u9c87\u9cb6","niang":"\u5a18\u917f","niao":"\u9e1f\u5c3f\u8311\u5b32\u8132\u8885","nie":"\u634f\u8042\u5b7d\u556e\u954a\u954d\u6d85\u4e5c\u9667\u8616\u55eb\u8080\u989e\u81ec\u8e51","nin":"\u60a8\u67e0","ning":"\u72de\u51dd\u5b81\u62e7\u6cde\u4f5e\u84e5\u549b\u752f\u804d","niu":"\u725b\u626d\u94ae\u7ebd\u72c3\u5ff8\u599e\u86b4","nong":"\u8113\u6d53\u519c\u4fac","nu":"\u5974\u52aa\u6012\u5476\u5e11\u5f29\u80ec\u5b65\u9a7d","nv":"\u5973\u6067\u9495\u8844","nuan":"\u6696","nuenue":"\u8650","nue":"\u759f\u8c11","nuo":"\u632a\u61e6\u7cef\u8bfa\u50a9\u6426\u558f\u9518","ou":"\u54e6\u6b27\u9e25\u6bb4\u85d5\u5455\u5076\u6ca4\u6004\u74ef\u8026","pa":"\u556a\u8db4\u722c\u5e15\u6015\u7436\u8469\u7b62","pai":"\u62cd\u6392\u724c\u5f98\u6e43\u6d3e\u4ff3\u848e","pan":"\u6500\u6f58\u76d8\u78d0\u76fc\u7554\u5224\u53db\u723f\u6cee\u88a2\u897b\u87e0\u8e52","pang":"\u4e53\u5e9e\u65c1\u802a\u80d6\u6ec2\u9004","pao":"\u629b\u5486\u5228\u70ae\u888d\u8dd1\u6ce1\u530f\u72cd\u5e96\u812c\u75b1","pei":"\u5478\u80da\u57f9\u88f4\u8d54\u966a\u914d\u4f69\u6c9b\u638a\u8f94\u5e14\u6de0\u65c6\u952b\u9185\u9708","pen":"\u55b7\u76c6\u6e53","peng":"\u7830\u62a8\u70f9\u6f8e\u5f6d\u84ec\u68da\u787c\u7bf7\u81a8\u670b\u9e4f\u6367\u78b0\u576f\u580b\u562d\u6026\u87db","pi":"\u7812\u9739\u6279\u62ab\u5288\u7435\u6bd7\u5564\u813e\u75b2\u76ae\u5339\u75de\u50fb\u5c41\u8b6c\u4e15\u9674\u90b3\u90eb\u572e\u9f19\u64d7\u567c\u5e80\u5ab2\u7eb0\u6787\u7513\u7765\u7f74\u94cd\u75e6\u7656\u758b\u868d\u8c94","pian":"\u7bc7\u504f\u7247\u9a97\u8c1d\u9a88\u728f\u80fc\u890a\u7fe9\u8e41","piao":"\u98d8\u6f02\u74e2\u7968\u527d\u560c\u5ad6\u7f25\u6b8d\u779f\u87b5","pie":"\u6487\u77a5\u4e3f\u82e4\u6c15","pin":"\u62fc\u9891\u8d2b\u54c1\u8058\u62da\u59d8\u5ad4\u6980\u725d\u98a6","ping":"\u4e52\u576a\u82f9\u840d\u5e73\u51ed\u74f6\u8bc4\u5c4f\u4fdc\u5a09\u67b0\u9c86","po":"\u5761\u6cfc\u9887\u5a46\u7834\u9b44\u8feb\u7c95\u53f5\u9131\u6ea5\u73c0\u948b\u94b7\u76a4\u7b38","pou":"\u5256\u88d2\u8e23","pu":"\u6251\u94fa\u4ec6\u8386\u8461\u83e9\u84b2\u57d4\u6734\u5703\u666e\u6d66\u8c31\u66dd\u7011\u530d\u5657\u6fee\u749e\u6c06\u9564\u9568\u8e7c","qi":"\u671f\u6b3a\u6816\u621a\u59bb\u4e03\u51c4\u6f06\u67d2\u6c8f\u5176\u68cb\u5947\u6b67\u7566\u5d0e\u8110\u9f50\u65d7\u7948\u7941\u9a91\u8d77\u5c82\u4e5e\u4f01\u542f\u5951\u780c\u5668\u6c14\u8fc4\u5f03\u6c7d\u6ce3\u8bab\u4e9f\u4e93\u573b\u8291\u840b\u847a\u5601\u5c7a\u5c90\u6c54\u6dc7\u9a90\u7eee\u742a\u7426\u675e\u6864\u69ed\u6b39\u797a\u61a9\u789b\u86f4\u871e\u7da6\u7dae\u8dbf\u8e4a\u9ccd\u9e92","qia":"\u6390\u6070\u6d3d\u845c","qian":"\u7275\u6266\u948e\u94c5\u5343\u8fc1\u7b7e\u4edf\u8c26\u4e7e\u9ed4\u94b1\u94b3\u524d\u6f5c\u9063\u6d45\u8c34\u5811\u5d4c\u6b20\u6b49\u4f65\u9621\u828a\u82a1\u8368\u63ae\u5c8d\u60ad\u614a\u9a9e\u6434\u8930\u7f31\u6920\u80b7\u6106\u94a4\u8654\u7b9d","qiang":"\u67aa\u545b\u8154\u7f8c\u5899\u8537\u5f3a\u62a2\u5af1\u6a2f\u6217\u709d\u9516\u9535\u956a\u8941\u8723\u7f9f\u8deb\u8dc4","qiao":"\u6a47\u9539\u6572\u6084\u6865\u77a7\u4e54\u4fa8\u5de7\u9798\u64ac\u7fd8\u5ced\u4fcf\u7a8d\u5281\u8bee\u8c2f\u835e\u6100\u6194\u7f32\u6a35\u6bf3\u7857\u8df7\u9792","qie":"\u5207\u8304\u4e14\u602f\u7a83\u90c4\u553c\u60ec\u59be\u6308\u9532\u7ba7","qin":"\u94a6\u4fb5\u4eb2\u79e6\u7434\u52e4\u82b9\u64d2\u79bd\u5bdd\u6c81\u82a9\u84c1\u8572\u63ff\u5423\u55ea\u5659\u6eb1\u6a8e\u8793\u887e","qing":"\u9752\u8f7b\u6c22\u503e\u537f\u6e05\u64ce\u6674\u6c30\u60c5\u9877\u8bf7\u5e86\u5029\u82d8\u570a\u6aa0\u78ec\u873b\u7f44\u7b90\u8b26\u9cad\u9ee5","qiong":"\u743c\u7a77\u909b\u8315\u7a79\u7b47\u928e","qiu":"\u79cb\u4e18\u90b1\u7403\u6c42\u56da\u914b\u6cc5\u4fc5\u6c3d\u5def\u827d\u72b0\u6e6b\u9011\u9052\u6978\u8d47\u9e20\u866c\u86af\u8764\u88d8\u7cd7\u9cc5\u9f3d","qu":"\u8d8b\u533a\u86c6\u66f2\u8eaf\u5c48\u9a71\u6e20\u53d6\u5a36\u9f8b\u8da3\u53bb\u8bce\u52ac\u8556\u8627\u5c96\u8862\u9612\u74a9\u89d1\u6c0d\u795b\u78f2\u766f\u86d0\u883c\u9eb4\u77bf\u9ee2","quan":"\u5708\u98a7\u6743\u919b\u6cc9\u5168\u75ca\u62f3\u72ac\u5238\u529d\u8be0\u8343\u737e\u609b\u7efb\u8f81\u754e\u94e8\u8737\u7b4c\u9b08","que":"\u7f3a\u7094\u7638\u5374\u9e4a\u69b7\u786e\u96c0\u9619\u60ab","qun":"\u88d9\u7fa4\u9021","ran":"\u7136\u71c3\u5189\u67d3\u82d2\u9aef","rang":"\u74e4\u58e4\u6518\u56b7\u8ba9\u79b3\u7a70","rao":"\u9976\u6270\u7ed5\u835b\u5a06\u6861","ruo":"\u60f9\u82e5\u5f31","re":"\u70ed\u504c","ren":"\u58ec\u4ec1\u4eba\u5fcd\u97e7\u4efb\u8ba4\u5203\u598a\u7eab\u4ede\u834f\u845a\u996a\u8f6b\u7a14\u887d","reng":"\u6254\u4ecd","ri":"\u65e5","rong":"\u620e\u8338\u84c9\u8363\u878d\u7194\u6eb6\u5bb9\u7ed2\u5197\u5d58\u72e8\u7f1b\u6995\u877e","rou":"\u63c9\u67d4\u8089\u7cc5\u8e42\u97a3","ru":"\u8339\u8815\u5112\u5b7a\u5982\u8fb1\u4e73\u6c5d\u5165\u8925\u84d0\u85b7\u5685\u6d33\u6ebd\u6fe1\u94f7\u8966\u98a5","ruan":"\u8f6f\u962e\u670a","rui":"\u854a\u745e\u9510\u82ae\u8564\u777f\u868b","run":"\u95f0\u6da6","sa":"\u6492\u6d12\u8428\u5345\u4ee8\u6332\u98d2","sai":"\u816e\u9cc3\u585e\u8d5b\u567b","san":"\u4e09\u53c1\u4f1e\u6563\u5f61\u9993\u6c35\u6bf5\u7cc1\u9730","sang":"\u6851\u55d3\u4e27\u6421\u78c9\u98a1","sao":"\u6414\u9a9a\u626b\u5ac2\u57fd\u81ca\u7619\u9ccb","se":"\u745f\u8272\u6da9\u556c\u94e9\u94ef\u7a51","sen":"\u68ee","seng":"\u50e7","sha":"\u838e\u7802\u6740\u5239\u6c99\u7eb1\u50bb\u5565\u715e\u810e\u6b43\u75e7\u88df\u970e\u9ca8","shai":"\u7b5b\u6652\u917e","shan":"\u73ca\u82eb\u6749\u5c71\u5220\u717d\u886b\u95ea\u9655\u64c5\u8d61\u81b3\u5584\u6c55\u6247\u7f2e\u5261\u8baa\u912f\u57cf\u829f\u6f78\u59d7\u9a9f\u81bb\u9490\u759d\u87ee\u8222\u8dda\u9cdd","shang":"\u5892\u4f24\u5546\u8d4f\u664c\u4e0a\u5c1a\u88f3\u57a7\u7ef1\u6b87\u71b5\u89de","shao":"\u68a2\u634e\u7a0d\u70e7\u828d\u52fa\u97f6\u5c11\u54e8\u90b5\u7ecd\u52ad\u82d5\u6f72\u86f8\u7b24\u7b72\u8244","she":"\u5962\u8d4a\u86c7\u820c\u820d\u8d66\u6444\u5c04\u6151\u6d89\u793e\u8bbe\u538d\u4f58\u731e\u7572\u9e9d","shen":"\u7837\u7533\u547b\u4f38\u8eab\u6df1\u5a20\u7ec5\u795e\u6c88\u5ba1\u5a76\u751a\u80be\u614e\u6e17\u8bdc\u8c02\u5432\u54c2\u6e16\u6939\u77e7\u8703","sheng":"\u58f0\u751f\u7525\u7272\u5347\u7ef3\u7701\u76db\u5269\u80dc\u5723\u4e1e\u6e11\u5ab5\u771a\u7b19","shi":"\u5e08\u5931\u72ee\u65bd\u6e7f\u8bd7\u5c38\u8671\u5341\u77f3\u62fe\u65f6\u4ec0\u98df\u8680\u5b9e\u8bc6\u53f2\u77e2\u4f7f\u5c4e\u9a76\u59cb\u5f0f\u793a\u58eb\u4e16\u67ff\u4e8b\u62ed\u8a93\u901d\u52bf\u662f\u55dc\u566c\u9002\u4ed5\u4f8d\u91ca\u9970\u6c0f\u5e02\u6043\u5ba4\u89c6\u8bd5\u8c25\u57d8\u83b3\u84cd\u5f11\u5511\u9963\u8f7c\u8006\u8d33\u70bb\u793b\u94c8\u94ca\u87ab\u8210\u7b6e\u8c55\u9ca5\u9cba","shou":"\u6536\u624b\u9996\u5b88\u5bff\u6388\u552e\u53d7\u7626\u517d\u624c\u72e9\u7ef6\u824f","shu":"\u852c\u67a2\u68b3\u6b8a\u6292\u8f93\u53d4\u8212\u6dd1\u758f\u4e66\u8d4e\u5b70\u719f\u85af\u6691\u66d9\u7f72\u8700\u9ecd\u9f20\u5c5e\u672f\u8ff0\u6811\u675f\u620d\u7ad6\u5885\u5eb6\u6570\u6f31\u6055\u500f\u587e\u83fd\u5fc4\u6cad\u6d91\u6f8d\u59dd\u7ebe\u6bf9\u8167\u6bb3\u956f\u79eb\u9e6c","shua":"\u5237\u800d\u5530\u6dae","shuai":"\u6454\u8870\u7529\u5e05\u87c0","shuan":"\u6813\u62f4\u95e9","shuang":"\u971c\u53cc\u723d\u5b40","shui":"\u8c01\u6c34\u7761\u7a0e","shun":"\u542e\u77ac\u987a\u821c\u6042","shuo":"\u8bf4\u7855\u6714\u70c1\u84b4\u6420\u55cd\u6fef\u5981\u69ca\u94c4","si":"\u65af\u6495\u5636\u601d\u79c1\u53f8\u4e1d\u6b7b\u8086\u5bfa\u55e3\u56db\u4f3a\u4f3c\u9972\u5df3\u53ae\u4fdf\u5155\u83e5\u549d\u6c5c\u6cd7\u6f8c\u59d2\u9a77\u7f0c\u7940\u7960\u9536\u9e36\u801c\u86f3\u7b25","song":"\u677e\u8038\u6002\u9882\u9001\u5b8b\u8bbc\u8bf5\u51c7\u83d8\u5d27\u5d69\u5fea\u609a\u6dde\u7ae6","sou":"\u641c\u8258\u64de\u55fd\u53df\u55d6\u55fe\u998a\u6eb2\u98d5\u778d\u953c\u878b","su":"\u82cf\u9165\u4fd7\u7d20\u901f\u7c9f\u50f3\u5851\u6eaf\u5bbf\u8bc9\u8083\u5919\u8c21\u850c\u55c9\u612b\u7c0c\u89eb\u7a23","suan":"\u9178\u849c\u7b97","sui":"\u867d\u968b\u968f\u7ee5\u9ad3\u788e\u5c81\u7a57\u9042\u96a7\u795f\u84d1\u51ab\u8c07\u6fc9\u9083\u71e7\u772d\u7762","sun":"\u5b59\u635f\u7b0b\u836a\u72f2\u98e7\u69ab\u8de3\u96bc","suo":"\u68ad\u5506\u7f29\u7410\u7d22\u9501\u6240\u5522\u55e6\u5a11\u686b\u7743\u7fa7","ta":"\u584c\u4ed6\u5b83\u5979\u5854\u736d\u631e\u8e4b\u8e0f\u95fc\u6ebb\u9062\u69bb\u6c93","tai":"\u80ce\u82d4\u62ac\u53f0\u6cf0\u915e\u592a\u6001\u6c70\u90b0\u85b9\u80bd\u70b1\u949b\u8dc6\u9c90","tan":"\u574d\u644a\u8d2a\u762b\u6ee9\u575b\u6a80\u75f0\u6f6d\u8c2d\u8c08\u5766\u6bef\u8892\u78b3\u63a2\u53f9\u70ad\u90ef\u8548\u6619\u94bd\u952c\u8983","tang":"\u6c64\u5858\u642a\u5802\u68e0\u819b\u5510\u7cd6\u50a5\u9967\u6e8f\u746d\u94f4\u9557\u8025\u8797\u87b3\u7fb0\u91a3","thang":"\u5018\u8eba\u6dcc","theng":"\u8d9f\u70eb","tao":"\u638f\u6d9b\u6ed4\u7ee6\u8404\u6843\u9003\u6dd8\u9676\u8ba8\u5957\u6311\u9f17\u5555\u97ec\u9955","te":"\u7279","teng":"\u85e4\u817e\u75bc\u8a8a\u6ed5","ti":"\u68af\u5254\u8e22\u9511\u63d0\u9898\u8e44\u557c\u4f53\u66ff\u568f\u60d5\u6d95\u5243\u5c49\u8351\u608c\u9016\u7ee8\u7f07\u9e48\u88fc\u918d","tian":"\u5929\u6dfb\u586b\u7530\u751c\u606c\u8214\u8146\u63ad\u5fdd\u9617\u6b84\u754b\u94bf\u86ba","tiao":"\u6761\u8fe2\u773a\u8df3\u4f7b\u7967\u94eb\u7a95\u9f86\u9ca6","tie":"\u8d34\u94c1\u5e16\u841c\u992e","ting":"\u5385\u542c\u70c3\u6c40\u5ef7\u505c\u4ead\u5ead\u633a\u8247\u839b\u8476\u5a77\u6883\u8713\u9706","tong":"\u901a\u6850\u916e\u77b3\u540c\u94dc\u5f64\u7ae5\u6876\u6345\u7b52\u7edf\u75db\u4f5f\u50ee\u4edd\u833c\u55f5\u6078\u6f7c\u783c","tou":"\u5077\u6295\u5934\u900f\u4ea0","tu":"\u51f8\u79c3\u7a81\u56fe\u5f92\u9014\u6d82\u5c60\u571f\u5410\u5154\u580d\u837c\u83df\u948d\u9174","tuan":"\u6e4d\u56e2\u7583","tui":"\u63a8\u9893\u817f\u8715\u892a\u9000\u5fd2\u717a","tun":"\u541e\u5c6f\u81c0\u9968\u66be\u8c5a\u7a80","tuo":"\u62d6\u6258\u8131\u9e35\u9640\u9a6e\u9a7c\u692d\u59a5\u62d3\u553e\u4e47\u4f57\u5768\u5eb9\u6cb1\u67dd\u7823\u7ba8\u8204\u8dce\u9f0d","wa":"\u6316\u54c7\u86d9\u6d3c\u5a03\u74e6\u889c\u4f64\u5a32\u817d","wai":"\u6b6a\u5916","wan":"\u8c4c\u5f2f\u6e7e\u73a9\u987d\u4e38\u70f7\u5b8c\u7897\u633d\u665a\u7696\u60cb\u5b9b\u5a49\u4e07\u8155\u525c\u8284\u82cb\u83c0\u7ea8\u7efe\u742c\u8118\u7579\u873f\u7ba2","wang":"\u6c6a\u738b\u4ea1\u6789\u7f51\u5f80\u65fa\u671b\u5fd8\u5984\u7f54\u5c22\u60d8\u8f8b\u9b4d","wei":"\u5a01\u5dcd\u5fae\u5371\u97e6\u8fdd\u6845\u56f4\u552f\u60df\u4e3a\u6f4d\u7ef4\u82c7\u840e\u59d4\u4f1f\u4f2a\u5c3e\u7eac\u672a\u851a\u5473\u754f\u80c3\u5582\u9b4f\u4f4d\u6e2d\u8c13\u5c09\u6170\u536b\u502d\u504e\u8bff\u9688\u8473\u8587\u5e0f\u5e37\u5d34\u5d6c\u7325\u732c\u95f1\u6ca9\u6d27\u6da0\u9036\u5a13\u73ae\u97ea\u8ece\u709c\u7168\u71a8\u75ff\u8249\u9c94","wen":"\u761f\u6e29\u868a\u6587\u95fb\u7eb9\u543b\u7a33\u7d0a\u95ee\u520e\u6120\u960c\u6c76\u74ba\u97eb\u6b81\u96ef","weng":"\u55e1\u7fc1\u74ee\u84ca\u8579","wo":"\u631d\u8717\u6da1\u7a9d\u6211\u65a1\u5367\u63e1\u6c83\u83b4\u5e44\u6e25\u674c\u809f\u9f8c","wu":"\u5deb\u545c\u94a8\u4e4c\u6c61\u8bec\u5c4b\u65e0\u829c\u68a7\u543e\u5434\u6bcb\u6b66\u4e94\u6342\u5348\u821e\u4f0d\u4fae\u575e\u620a\u96fe\u6664\u7269\u52ff\u52a1\u609f\u8bef\u5140\u4ef5\u9622\u90ac\u572c\u82b4\u5e91\u6003\u5fe4\u6d6f\u5be4\u8fd5\u59a9\u9a9b\u727e\u7110\u9e49\u9e5c\u8708\u92c8\u9f2f","xi":"\u6614\u7199\u6790\u897f\u7852\u77fd\u6670\u563b\u5438\u9521\u727a\u7a00\u606f\u5e0c\u6089\u819d\u5915\u60dc\u7184\u70ef\u6eaa\u6c50\u7280\u6a84\u88ad\u5e2d\u4e60\u5ab3\u559c\u94e3\u6d17\u7cfb\u9699\u620f\u7ec6\u50d6\u516e\u96b0\u90d7\u831c\u8478\u84f0\u595a\u550f\u5f99\u9969\u960b\u6d60\u6dc5\u5c63\u5b09\u73ba\u6a28\u66e6\u89cb\u6b37\u71b9\u798a\u79a7\u94b8\u7699\u7a78\u8725\u87cb\u823e\u7fb2\u7c9e\u7fd5\u91af\u9f37","xia":"\u778e\u867e\u5323\u971e\u8f96\u6687\u5ce1\u4fa0\u72ed\u4e0b\u53a6\u590f\u5413\u6380\u846d\u55c4\u72ce\u9050\u7455\u7856\u7615\u7f45\u9ee0","xian":"\u9528\u5148\u4ed9\u9c9c\u7ea4\u54b8\u8d24\u8854\u8237\u95f2\u6d8e\u5f26\u5acc\u663e\u9669\u73b0\u732e\u53bf\u817a\u9985\u7fa1\u5baa\u9677\u9650\u7ebf\u51bc\u85d3\u5c98\u7303\u66b9\u5a34\u6c19\u7946\u9e47\u75eb\u86ac\u7b45\u7c7c\u9170\u8df9","xiang":"\u76f8\u53a2\u9576\u9999\u7bb1\u8944\u6e58\u4e61\u7fd4\u7965\u8be6\u60f3\u54cd\u4eab\u9879\u5df7\u6a61\u50cf\u5411\u8c61\u8297\u8459\u9977\u5ea0\u9aa7\u7f03\u87d3\u9c9e\u98e8","xiao":"\u8427\u785d\u9704\u524a\u54ee\u56a3\u9500\u6d88\u5bb5\u6dc6\u6653\u5c0f\u5b5d\u6821\u8096\u5578\u7b11\u6548\u54d3\u54bb\u5d24\u6f47\u900d\u9a81\u7ee1\u67ad\u67b5\u7b71\u7bab\u9b48","xie":"\u6954\u4e9b\u6b47\u874e\u978b\u534f\u631f\u643a\u90aa\u659c\u80c1\u8c10\u5199\u68b0\u5378\u87f9\u61c8\u6cc4\u6cfb\u8c22\u5c51\u5055\u4eb5\u52f0\u71ee\u85a4\u64b7\u5ee8\u7023\u9082\u7ec1\u7f2c\u69ad\u698d\u6b59\u8e9e","xin":"\u85aa\u82af\u950c\u6b23\u8f9b\u65b0\u5ffb\u5fc3\u4fe1\u8845\u56df\u99a8\u8398\u6b46\u94fd\u946b","xing":"\u661f\u8165\u7329\u60fa\u5174\u5211\u578b\u5f62\u90a2\u884c\u9192\u5e78\u674f\u6027\u59d3\u9649\u8347\u8365\u64e4\u60bb\u784e","xiong":"\u5144\u51f6\u80f8\u5308\u6c79\u96c4\u718a\u828e","xiu":"\u4f11\u4fee\u7f9e\u673d\u55c5\u9508\u79c0\u8896\u7ee3\u83a0\u5cab\u9990\u5ea5\u9e3a\u8c85\u9af9","xu":"\u589f\u620c\u9700\u865a\u5618\u987b\u5f90\u8bb8\u84c4\u9157\u53d9\u65ed\u5e8f\u755c\u6064\u7d6e\u5a7f\u7eea\u7eed\u8bb4\u8be9\u5729\u84ff\u6035\u6d2b\u6e86\u987c\u6829\u7166\u7809\u76f1\u80e5\u7cc8\u9191","xuan":"\u8f69\u55a7\u5ba3\u60ac\u65cb\u7384\u9009\u7663\u7729\u7eda\u5107\u8c16\u8431\u63ce\u9994\u6ceb\u6d35\u6e32\u6f29\u7487\u6966\u6684\u70ab\u714a\u78b9\u94c9\u955f\u75c3","xue":"\u9774\u859b\u5b66\u7a74\u96ea\u8840\u5671\u6cf6\u9cd5","xun":"\u52cb\u718f\u5faa\u65ec\u8be2\u5bfb\u9a6f\u5de1\u6b89\u6c5b\u8bad\u8baf\u900a\u8fc5\u5dfd\u57d9\u8340\u85b0\u5ccb\u5f87\u6d54\u66db\u7aa8\u91ba\u9c9f","ya":"\u538b\u62bc\u9e26\u9e2d\u5440\u4e2b\u82bd\u7259\u869c\u5d16\u8859\u6daf\u96c5\u54d1\u4e9a\u8bb6\u4f22\u63e0\u5416\u5c88\u8fd3\u5a05\u740a\u6860\u6c29\u7811\u775a\u75d6","yan":"\u7109\u54bd\u9609\u70df\u6df9\u76d0\u4e25\u7814\u8712\u5ca9\u5ef6\u8a00\u989c\u960e\u708e\u6cbf\u5944\u63a9\u773c\u884d\u6f14\u8273\u5830\u71d5\u538c\u781a\u96c1\u5501\u5f66\u7130\u5bb4\u8c1a\u9a8c\u53a3\u9765\u8d5d\u4fe8\u5043\u5156\u8ba0\u8c33\u90fe\u9122\u82ab\u83f8\u5d26\u6079\u95eb\u960f\u6d07\u6e6e\u6edf\u598d\u5ae3\u7430\u664f\u80ed\u814c\u7131\u7f68\u7b75\u917d\u9b47\u990d\u9f39","yang":"\u6b83\u592e\u9e2f\u79e7\u6768\u626c\u4f6f\u75a1\u7f8a\u6d0b\u9633\u6c27\u4ef0\u75d2\u517b\u6837\u6f3e\u5f89\u600f\u6cf1\u7080\u70ca\u6059\u86d8\u9785","yao":"\u9080\u8170\u5996\u7476\u6447\u5c27\u9065\u7a91\u8c23\u59da\u54ac\u8200\u836f\u8981\u8000\u592d\u723b\u5406\u5d3e\u5fad\u7039\u5e7a\u73e7\u6773\u66dc\u80b4\u9e5e\u7a88\u7e47\u9cd0","ye":"\u6930\u564e\u8036\u7237\u91ce\u51b6\u4e5f\u9875\u6396\u4e1a\u53f6\u66f3\u814b\u591c\u6db2\u8c12\u90ba\u63f6\u9980\u6654\u70e8\u94d8","yi":"\u4e00\u58f9\u533b\u63d6\u94f1\u4f9d\u4f0a\u8863\u9890\u5937\u9057\u79fb\u4eea\u80f0\u7591\u6c82\u5b9c\u59e8\u5f5d\u6905\u8681\u501a\u5df2\u4e59\u77e3\u4ee5\u827a\u6291\u6613\u9091\u5c79\u4ebf\u5f79\u81c6\u9038\u8084\u75ab\u4ea6\u88d4\u610f\u6bc5\u5fc6\u4e49\u76ca\u6ea2\u8be3\u8bae\u8c0a\u8bd1\u5f02\u7ffc\u7fcc\u7ece\u5208\u5293\u4f7e\u8bd2\u572a\u572f\u57f8\u61ff\u82e1\u858f\u5f08\u5955\u6339\u5f0b\u5453\u54a6\u54bf\u566b\u5cc4\u5db7\u7317\u9974\u603f\u6021\u6092\u6f2a\u8fe4\u9a7f\u7f22\u6baa\u8d3b\u65d6\u71a0\u9487\u9552\u9571\u75cd\u7617\u7654\u7fca\u8864\u8734\u8223\u7fbf\u7ff3\u914f\u9edf","yin":"\u8335\u836b\u56e0\u6bb7\u97f3\u9634\u59fb\u541f\u94f6\u6deb\u5bc5\u996e\u5c39\u5f15\u9690\u5370\u80e4\u911e\u5819\u831a\u5591\u72fa\u5924\u6c24\u94df\u763e\u8693\u972a\u9f88","ying":"\u82f1\u6a31\u5a74\u9e70\u5e94\u7f28\u83b9\u8424\u8425\u8367\u8747\u8fce\u8d62\u76c8\u5f71\u9896\u786c\u6620\u5b34\u90e2\u8314\u83ba\u8426\u6484\u5624\u81ba\u6ee2\u6f46\u701b\u745b\u748e\u6979\u9e66\u763f\u988d\u7f42","yo":"\u54df\u5537","yong":"\u62e5\u4f63\u81c3\u75c8\u5eb8\u96cd\u8e0a\u86f9\u548f\u6cf3\u6d8c\u6c38\u607f\u52c7\u7528\u4fd1\u58c5\u5889\u6175\u9095\u955b\u752c\u9cd9\u9954","you":"\u5e7d\u4f18\u60a0\u5fe7\u5c24\u7531\u90ae\u94c0\u72b9\u6cb9\u6e38\u9149\u6709\u53cb\u53f3\u4f51\u91c9\u8bf1\u53c8\u5e7c\u5363\u6538\u4f91\u83b8\u5466\u56ff\u5ba5\u67da\u7337\u7256\u94d5\u75a3\u8763\u9c7f\u9edd\u9f2c","yu":"\u8fc2\u6de4\u4e8e\u76c2\u6986\u865e\u611a\u8206\u4f59\u4fde\u903e\u9c7c\u6109\u6e1d\u6e14\u9685\u4e88\u5a31\u96e8\u4e0e\u5c7f\u79b9\u5b87\u8bed\u7fbd\u7389\u57df\u828b\u90c1\u5401\u9047\u55bb\u5cea\u5fa1\u6108\u6b32\u72f1\u80b2\u8a89\u6d74\u5bd3\u88d5\u9884\u8c6b\u9a6d\u79ba\u6bd3\u4f1b\u4fe3\u8c00\u8c15\u8438\u84e3\u63c4\u5581\u5704\u5709\u5d5b\u72f3\u996b\u5ebe\u9608\u59aa\u59a4\u7ea1\u745c\u6631\u89ce\u8174\u6b24\u65bc\u715c\u71e0\u807f\u94b0\u9e46\u7610\u7600\u7ab3\u8753\u7afd\u8201\u96e9\u9f89","yuan":"\u9e33\u6e0a\u51a4\u5143\u57a3\u8881\u539f\u63f4\u8f95\u56ed\u5458\u5706\u733f\u6e90\u7f18\u8fdc\u82d1\u613f\u6028\u9662\u586c\u6c85\u5a9b\u7457\u6a7c\u7230\u7722\u9e22\u8788\u9f0b","yue":"\u66f0\u7ea6\u8d8a\u8dc3\u94a5\u5cb3\u7ca4\u6708\u60a6\u9605\u9fa0\u6a3e\u5216\u94ba","yun":"\u8018\u4e91\u90e7\u5300\u9668\u5141\u8fd0\u8574\u915d\u6655\u97f5\u5b55\u90d3\u82b8\u72c1\u607d\u7ead\u6b92\u6600\u6c32","za":"\u531d\u7838\u6742\u62f6\u5482","zai":"\u683d\u54c9\u707e\u5bb0\u8f7d\u518d\u5728\u54b1\u5d3d\u753e","zan":"\u6512\u6682\u8d5e\u74d2\u661d\u7c2a\u7ccc\u8db1\u933e","zang":"\u8d43\u810f\u846c\u5958\u6215\u81e7","zao":"\u906d\u7cdf\u51ff\u85fb\u67a3\u65e9\u6fa1\u86a4\u8e81\u566a\u9020\u7682\u7076\u71e5\u5523\u7f2b","ze":"\u8d23\u62e9\u5219\u6cfd\u4ec4\u8d5c\u5567\u8fee\u6603\u7b2e\u7ba6\u8234","zei":"\u8d3c","zen":"\u600e\u8c2e","zeng":"\u589e\u618e\u66fe\u8d60\u7f2f\u7511\u7f7e\u9503","zha":"\u624e\u55b3\u6e23\u672d\u8f67\u94e1\u95f8\u7728\u6805\u69a8\u548b\u4e4d\u70b8\u8bc8\u63f8\u5412\u54a4\u54f3\u600d\u781f\u75c4\u86b1\u9f44","zhai":"\u6458\u658b\u5b85\u7a84\u503a\u5be8\u7826","zhan":"\u77bb\u6be1\u8a79\u7c98\u6cbe\u76cf\u65a9\u8f97\u5d2d\u5c55\u8638\u6808\u5360\u6218\u7ad9\u6e5b\u7efd\u8c35\u640c\u65c3","zhang":"\u6a1f\u7ae0\u5f70\u6f33\u5f20\u638c\u6da8\u6756\u4e08\u5e10\u8d26\u4ed7\u80c0\u7634\u969c\u4ec9\u9123\u5e5b\u5d82\u7350\u5adc\u748b\u87d1","zhao":"\u62db\u662d\u627e\u6cbc\u8d75\u7167\u7f69\u5146\u8087\u53ec\u722a\u8bcf\u68f9\u948a\u7b0a","zhe":"\u906e\u6298\u54f2\u86f0\u8f99\u8005\u9517\u8517\u8fd9\u6d59\u8c2a\u966c\u67d8\u8f84\u78d4\u9e67\u891a\u8707\u8d6d","zhen":"\u73cd\u659f\u771f\u7504\u7827\u81fb\u8d1e\u9488\u4fa6\u6795\u75b9\u8bca\u9707\u632f\u9547\u9635\u7f1c\u6862\u699b\u8f78\u8d48\u80d7\u6715\u796f\u755b\u9e29","zheng":"\u84b8\u6323\u7741\u5f81\u72f0\u4e89\u6014\u6574\u62ef\u6b63\u653f\u5e27\u75c7\u90d1\u8bc1\u8be4\u5ce5\u94b2\u94ee\u7b5d","zhi":"\u829d\u679d\u652f\u5431\u8718\u77e5\u80a2\u8102\u6c41\u4e4b\u7ec7\u804c\u76f4\u690d\u6b96\u6267\u503c\u4f84\u5740\u6307\u6b62\u8dbe\u53ea\u65e8\u7eb8\u5fd7\u631a\u63b7\u81f3\u81f4\u7f6e\u5e1c\u5cd9\u5236\u667a\u79e9\u7a1a\u8d28\u7099\u75d4\u6ede\u6cbb\u7a92\u536e\u965f\u90c5\u57f4\u82b7\u646d\u5e19\u5fee\u5f58\u54ab\u9a98\u6809\u67b3\u6800\u684e\u8f75\u8f7e\u6534\u8d3d\u81a3\u7949\u7957\u9ef9\u96c9\u9e37\u75e3\u86ed\u7d77\u916f\u8dd6\u8e2c\u8e2f\u8c78\u89ef","zhong":"\u4e2d\u76c5\u5fe0\u949f\u8877\u7ec8\u79cd\u80bf\u91cd\u4ef2\u4f17\u51a2\u953a\u87bd\u8202\u822f\u8e35","zhou":"\u821f\u5468\u5dde\u6d32\u8bcc\u7ca5\u8f74\u8098\u5e1a\u5492\u76b1\u5b99\u663c\u9aa4\u5544\u7740\u501c\u8bf9\u836e\u9b3b\u7ea3\u80c4\u78a1\u7c40\u8233\u914e\u9cb7","zhu":"\u73e0\u682a\u86db\u6731\u732a\u8bf8\u8bdb\u9010\u7af9\u70db\u716e\u62c4\u77a9\u5631\u4e3b\u8457\u67f1\u52a9\u86c0\u8d2e\u94f8\u7b51\u4f4f\u6ce8\u795d\u9a7b\u4f2b\u4f8f\u90be\u82ce\u8331\u6d19\u6e1a\u6f74\u9a7a\u677c\u69e0\u6a65\u70b7\u94e2\u75b0\u7603\u86b0\u7afa\u7bb8\u7fe5\u8e85\u9e88","zhua":"\u6293","zhuai":"\u62fd","zhuan":"\u4e13\u7816\u8f6c\u64b0\u8d5a\u7bc6\u629f\u556d\u989b","zhuang":"\u6869\u5e84\u88c5\u5986\u649e\u58ee\u72b6\u4e2c","zhui":"\u690e\u9525\u8ffd\u8d58\u5760\u7f00\u8411\u9a93\u7f12","zhun":"\u8c06\u51c6","zhuo":"\u6349\u62d9\u5353\u684c\u7422\u8301\u914c\u707c\u6d4a\u502c\u8bfc\u5ef4\u855e\u64e2\u555c\u6d5e\u6dbf\u6753\u712f\u799a\u65ab","zi":"\u5179\u54a8\u8d44\u59ff\u6ecb\u6dc4\u5b5c\u7d2b\u4ed4\u7c7d\u6ed3\u5b50\u81ea\u6e0d\u5b57\u8c18\u5d6b\u59ca\u5b73\u7f01\u6893\u8f8e\u8d40\u6063\u7726\u9531\u79ed\u8014\u7b2b\u7ca2\u89dc\u8a3e\u9cbb\u9aed","zong":"\u9b03\u68d5\u8e2a\u5b97\u7efc\u603b\u7eb5\u8159\u7cbd","zou":"\u90b9\u8d70\u594f\u63cd\u9139\u9cb0","zu":"\u79df\u8db3\u5352\u65cf\u7956\u8bc5\u963b\u7ec4\u4fce\u83f9\u5550\u5f82\u9a75\u8e74","zuan":"\u94bb\u7e82\u6525\u7f35","zui":"\u5634\u9189\u6700\u7f6a","zun":"\u5c0a\u9075\u6499\u6a3d\u9cdf","zuo":"\u6628\u5de6\u4f50\u67de\u505a\u4f5c\u5750\u5ea7\u961d\u963c\u80d9\u795a\u9162","cou":"\u85ae\u6971\u8f8f\u8160","nang":"\u652e\u54dd\u56d4\u9995\u66e9","o":"\u5594","dia":"\u55f2","chuai":"\u562c\u81aa\u8e39","cen":"\u5c91\u6d94","diu":"\u94e5","nou":"\u8028","fou":"\u7f36","bia":"\u9adf"};
                this.polyphone = {"19969":"DZ","19975":"WM","19988":"QJ","20048":"YL","20056":"SC","20060":"NM","20094":"QG","20127":"QJ","20167":"QC","20193":"YG","20250":"KH","20256":"ZC","20282":"SC","20285":"QJG","20291":"TD","20314":"YD","20340":"NE","20375":"TD","20389":"YJ","20391":"CZ","20415":"PB","20446":"YS","20447":"SQ","20504":"TC","20608":"KG","20854":"QJ","20857":"ZC","20911":"PF","20504":"TC","20608":"KG","20854":"QJ","20857":"ZC","20911":"PF","20985":"AW","21032":"PB","21048":"XQ","21049":"SC","21089":"YS","21119":"JC","21242":"SB","21273":"SC","21305":"YP","21306":"QO","21330":"ZC","21333":"SDC","21345":"QK","21378":"CA","21397":"SC","21414":"XS","21442":"SC","21477":"JG","21480":"TD","21484":"ZS","21494":"YX","21505":"YX","21512":"HG","21523":"XH","21537":"PB","21542":"PF","21549":"KH","21571":"E","21574":"DA","21588":"TD","21589":"O","21618":"ZC","21621":"KHA","21632":"ZJ","21654":"KG","21679":"LKG","21683":"KH","21710":"A","21719":"YH","21734":"WOE","21769":"A","21780":"WN","21804":"XH","21834":"A","21899":"ZD","21903":"RN","21908":"WO","21939":"ZC","21956":"SA","21964":"YA","21970":"TD","22003":"A","22031":"JG","22040":"XS","22060":"ZC","22066":"ZC","22079":"MH","22129":"XJ","22179":"XA","22237":"NJ","22244":"TD","22280":"JQ","22300":"YH","22313":"XW","22331":"YQ","22343":"YJ","22351":"PH","22395":"DC","22412":"TD","22484":"PB","22500":"PB","22534":"ZD","22549":"DH","22561":"PB","22612":"TD","22771":"KQ","22831":"HB","22841":"JG","22855":"QJ","22865":"XQ","23013":"ML","23081":"WM","23487":"SX","23558":"QJ","23561":"YW","23586":"YW","23614":"YW","23615":"SN","23631":"PB","23646":"ZS","23663":"ZT","23673":"YG","23762":"TD","23769":"ZS","23780":"QJ","23884":"QK","24055":"XH","24113":"DC","24162":"ZC","24191":"GA","24273":"QJ","24324":"NL","24377":"TD","24378":"QJ","24439":"PF","24554":"ZS","24683":"TD","24694":"WE","24733":"LK","24925":"TN","25094":"ZG","25100":"XQ","25103":"XH","25153":"PB","25170":"PB","25179":"KG","25203":"PB","25240":"ZS","25282":"FB","25303":"NA","25324":"KG","25341":"ZY","25373":"WZ","25375":"XJ","25384":"A","25457":"A","25528":"SD","25530":"SC","25552":"TD","25774":"ZC","25874":"ZC","26044":"YW","26080":"WM","26292":"PB","26333":"PB","26355":"ZY","26366":"CZ","26397":"ZC","26399":"QJ","26415":"ZS","26451":"SB","26526":"ZC","26552":"JG","26561":"TD","26588":"JG","26597":"CZ","26629":"ZS","26638":"YL","26646":"XQ","26653":"KG","26657":"XJ","26727":"HG","26894":"ZC","26937":"ZS","26946":"ZC","26999":"KJ","27099":"KJ","27449":"YQ","27481":"XS","27542":"ZS","27663":"ZS","27748":"TS","27784":"SC","27788":"ZD","27795":"TD","27812":"O","27850":"PB","27852":"MB","27895":"SL","27898":"PL","27973":"QJ","27981":"KH","27986":"HX","27994":"XJ","28044":"YC","28065":"WG","28177":"SM","28267":"QJ","28291":"KH","28337":"ZQ","28463":"TL","28548":"DC","28601":"TD","28689":"PB","28805":"JG","28820":"QG","28846":"PB","28952":"TD","28975":"ZC","29100":"A","29325":"QJ","29575":"SL","29602":"FB","30010":"TD","30044":"CX","30058":"PF","30091":"YSP","30111":"YN","30229":"XJ","30427":"SC","30465":"SX","30631":"YQ","30655":"QJ","30684":"QJG","30707":"SD","30729":"XH","30796":"LG","30917":"PB","31074":"NM","31085":"JZ","31109":"SC","31181":"ZC","31192":"MLB","31293":"JQ","31400":"YX","31584":"YJ","31896":"ZN","31909":"ZY","31995":"XJ","32321":"PF","32327":"ZY","32418":"HG","32420":"XQ","32421":"HG","32438":"LG","32473":"GJ","32488":"TD","32521":"QJ","32527":"PB","32562":"ZSQ","32564":"JZ","32735":"ZD","32793":"PB","33071":"PF","33098":"XL","33100":"YA","33152":"PB","33261":"CX","33324":"BP","33333":"TD","33406":"YA","33426":"WM","33432":"PB","33445":"JG","33486":"ZN","33493":"TS","33507":"QJ","33540":"QJ","33544":"ZC","33564":"XQ","33617":"YT","33632":"QJ","33636":"XH","33637":"YX","33694":"WG","33705":"PF","33728":"YW","33882":"SR","34067":"WM","34074":"YW","34121":"QJ","34255":"ZC","34259":"XL","34425":"JH","34430":"XH","34485":"KH","34503":"YS","34532":"HG","34552":"XS","34558":"YE","34593":"ZL","34660":"YQ","34892":"XH","34928":"SC","34999":"QJ","35048":"PB","35059":"SC","35098":"ZC","35203":"TQ","35265":"JX","35299":"JX","35782":"SZ","35828":"YS","35830":"E","35843":"TD","35895":"YG","35977":"MH","36158":"JG","36228":"QJ","36426":"XQ","36466":"DC","36710":"JC","36711":"ZYG","36767":"PB","36866":"SK","36951":"YW","37034":"YX","37063":"XH","37218":"ZC","37325":"ZC","38063":"PB","38079":"TD","38085":"QY","38107":"DC","38116":"TD","38123":"YD","38224":"HG","38241":"XTC","38271":"ZC","38415":"YE","38426":"KH","38461":"YD","38463":"AE","38466":"PB","38477":"XJ","38518":"YT","38551":"WK","38585":"ZC","38704":"XS","38739":"LJ","38761":"GJ","38808":"SQ","39048":"JG","39049":"XJ","39052":"HG","39076":"CZ","39271":"XT","39534":"TD","39552":"TD","39584":"PB","39647":"SB","39730":"LG","39748":"TPB","40109":"ZQ","40479":"ND","40516":"HG","40536":"HG","40583":"QJ","40765":"YQ","40784":"QJ","40840":"YK","40863":"QJG"};
            },

            // 提取拼音, 返回首字母大写形式
            getFullChars: function(str){
                var result = '', name;
                var reg = new RegExp('[a-zA-Z0-9\- ]');
                for (var i=0, len = str.length; i < len; i++){
                    var ch = str.substr(i,1), unicode = ch.charCodeAt(0);
                    if(unicode > 40869 || unicode < 19968){
                        result += ch;
                    }else{
                        name = this._getFullChar(ch);
                        if(name !== false){
                            result += name;
                        }
                    }
                }
                return result;
            },

            // 提取首字母，返回大写形式
            getCamelChars: function(str){
                if(typeof(str) !== 'string')
                    throw new Error(-1, "函数getFisrt需要字符串类型参数!");
                var chars = []; //保存中间结果的数组
                for(var i=0,len=str.length; i < len; i++){
                    //获得unicode码
                    var ch = str.charAt(i);
                    //检查该unicode码是否在处理范围之内,在则返回该码对映汉字的拼音首字母,不在则调用其它函数处理
                    chars.push(this._getChar(ch));
                }
                //处理arrResult,返回所有可能的拼音首字母串数组
                return this._getResult(chars);
            },


            // 提取拼音
            _getFullChar: function(str){
                for (var key in this.full_dict){
                    if(-1 !== this.full_dict[key].indexOf(str)){
                        return this._capitalize(key); break;
                    }
                }
                return false;
            },

            // 首字母大写
            _capitalize: function(str){
                if(str.length>0){
                    var first = str.substr(0,1).toUpperCase();
                    var spare = str.substr(1,str.length);
                    return first + spare;
                }
            },

            _getChar: function(ch){
                var unicode = ch.charCodeAt(0);
                //如果不在汉字处理范围之内,返回原字符,也可以调用自己的处理函数
                if(unicode > 40869 || unicode < 19968)
                    return ch; //dealWithOthers(ch);
                //检查是否是多音字,是按多音字处理,不是就直接在strChineseFirstPY字符串中找对应的首字母
                if(!this.options.checkPolyphone)
                    return this.char_dict.charAt(unicode-19968);
                return this.polyphone[unicode] ? this.polyphone[unicode] : this.char_dict.charAt(unicode-19968);
            },

            _getResult: function(chars){
                if(!this.options.checkPolyphone)
                    return chars.join('');
                var result = [''];
                for(var i=0,len=chars.length;i<len;i++){
                    var str = chars[i], strlen = str.length;
                    if(strlen == 1){
                        for(var j=0; j < result.length; j++){
                            result[k] += str;
                        }
                    }else{
                        var swap1 = result.slice(0);
                        result = [];
                        for(var j=0; j < strlen; j++){
                            //复制一个相同的arrRslt
                            var swap2 = swap1.slice(0);
                            //把当前字符str[k]添加到每个元素末尾
                            for(var k=0; k < swap2.length; k++){
                                swap2[k] += str.charAt(j);
                            }
                            //把复制并修改后的数组连接到arrRslt上
                            result = result.concat(swap2);
                        }
                    }
                }
                return result;
            }

        };

        var extend = function(dst, src){
            for(var property in src){
                dst[property] = src[property];
            }
            return dst;
        };

        return new Pinyin(arguments);

});
I$(300,function (_ut,tpl,_,BaseComponent,pinyin){
    var brandByLetter = BaseComponent.extend({
        template:tpl.replace(/[\n]/g,''),
        config: function(data){
            var list=data.brandList;
            for(var i=list.length;i--;){
                var item=list[i];
                var pattern=new RegExp( "&"+data.brandText+"=[^&]*", "gi");
                item.url=data.baseUrl.replace(pattern,'&'+data.brandText+'='+item.brandId)
            }
            data.isShow=true;
            data.selected=0;
            data.brandNameKey='brandName';//为了兼容不同接口返回的brand中name的key值不同的情况
            this.supr(data);
        },
        init:function(){
            var data=this.data;
            this.initLetter(data);
            this.supr();
        },
        initLetter:function(data){
            data.allBrand= _.clone(data.brandList);
            data.letterList=[];
            var obj={'A':0,'B':0,'C':0,'D':0,'E':0,'F':0,'G':0,'H':0,'I':0,'J':0,'K':0,'L':0,'M':0,'N':0,'O':0,'P':0,'Q':0,'R':0,'S':0,'T':0,'U':0,'V':0,'W':0,'X':0,'Y':0,'Z':0};
            _ut._$forEach(data.allBrand,function(item){
                var name=item[data.brandNameKey];
                var firstLetter=this.getFirstEnglishLetter(name);
                var firstLetter_c=this.getFirstChineseLetter(name);
                if(/^[a-zA-Z]$/.test(firstLetter)){
                    obj[firstLetter]++;
                }
                if(/^[a-zA-Z]$/.test(firstLetter_c)){
                    obj[firstLetter_c]++;
                }
            }._$bind(this));
            for(var i in obj){
                if(obj[i]>0){
                    data.letterList.push(i);
                }
            }
            this.$update();
        },
        letterChange:function(letter){
            var data=this.data;
            var list = data.allBrand||[];
            data.selected=letter;
            if(letter==0) {
                data.brandList= data.allBrand;
                return;
            }
            var arr=[];
            if(letter==-1){
                _ut._$forEach(list,function(item){
                    var name=item[data.brandNameKey];
                    if(!/[a-zA-Z]/.test(this.getFirstEnglishLetter(name))&&!/[a-zA-Z]/.test(this.getFirstChineseLetter(name)) ){
                        arr.push(item);
                    }
                }._$bind(this));
            }else{
                _ut._$forEach(list,function(item){
                    var name=item[data.brandNameKey];
                    if(this.getFirstEnglishLetter(name)==letter.toUpperCase()||this.getFirstChineseLetter(name)==letter.toUpperCase()){
                        arr.push(item);
                    }
                }._$bind(this));
            }
            data.brandList=arr;
        },
        getFirstChineseLetter:function(str){
            for (var i = 0; i < str.length; i++) {
                var s = str.charAt(i);
                if(/^[\u4E00-\u9FA5]$/.test(s)){
                    return pinyin._getChar(s).toUpperCase();
                }
            }
                return '';
        },
        getFirstEnglishLetter:function(str){
            for (var i = 0; i < str.length; i++) {
                var s = str.charAt(i);
                if(/[a-zA-Z]$/.test(s)){
                    return s.toUpperCase();
                }
            }
                return '';
        },
        changeList:function(){
            var data=this.data;
            if(data.isShow){
               data.brandList= data.allBrand;
            }
            data.isShow=!data.isShow;
        }
    });

    return brandByLetter;
},2,492,15,151,493);
I$(331,"<div class=\"m-modal-message\">\n\t{#include msg}\n</div>\n<div class=\"m-modal-footer\">\n\t{#if hideOkBtn != true}\n\t\t<a href=\"javascript:;\" class=\"btn u-btn u-btn-ok u-btn-medium\" on-click=\"{this.onok()}\"  r-html=\"{txtOk || '确认'}\"></a>\n\t{/if}\n\t{#if hideCCBtn != true}\n\t\t<a href=\"javascript:;\" class=\"btn u-btn u-btn-cancel u-btn-medium\" on-click=\"{this.cancel()}\" r-html=\"{txtCC || '取消'}\"></a>\n\t{/if}\n</div>");
I$(144,function (_, Modal,content){
	'use strict';
	return Modal.extend({
		config: function(){
			var data = this.data;
			_.extend(data,{
			});
			data.content = content;
			this.supr();
		}
	});

},15,128,331);
I$(142,function (_req,_j, LoginWindow, PromptWin) {
	var util = {
		parseJSON: function(data) {
			/*
			 * 字符串转化为json对象，适用小数据量转化
			 * 此处不对字符串进行安全检查，也不处理前后空格
			 * 将\/Date(...)\/格式的外层斜线去掉以供js使用
			 * $.parseJSON 也可进行json格式化，但是对输入检验比较严格，可以根据实际情况选择使用
			 */
			data = data.replace(/("|')\\?\/Date\((-?[0-9+]+)\)\\?\/\1/g, "new Date($2)");
			return (new Function("return " + data))();
		},
		isLogin: function(callback) {
			var _url = '/getUserName.html',
				_opts = {
					method: 'get',
					norest: true,
					type: 'json',
					onload: function(_json) {
						if (!(_json && _json.retcode == 461)) {
							// 已登陆
							callback(1);
						} else {
							callback(0);
						}
					}._$bind(this),
					onerror: function() {
						callback(0);
					}._$bind(this)
				};
			_req._$request(_url, _opts);
		},
		afterLogin: function(callback) {
			this.isLogin(function(islogin) {
				if (!islogin) {
					LoginWindow._$allocate({
						logincallback: callback
					})._$show();
				} else {
					callback();
				}
			});
		},
		scrollTo: function(to, callback, duration) {
			// requestAnimationFrame for Smart Animating http://goo.gl/sx5sts
			var requestAnimFrame = (function() {
				return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function(callback) {
					window.setTimeout(callback, 1000 / 60);
				};
			})();

			function easeInCubic(t, b, c, d) {
				var tc = (t /= d) * t * t;
				return b + c * (tc);
			}

			function easeInOutQuad(t, b, c, d) {
				t /= d / 2;
				if (t < 1) {
					return c / 2 * t * t + b;
				}
				t--;
				return -c / 2 * (t * (t - 2) - 1) + b;
			}

			function __scrollTo(to, callback, duration) {
				// because it's so fucking difficult to detect the scrolling element, just move them all
				function move(amount) {
					document.documentElement.scrollTop = amount;
					document.body.parentNode.scrollTop = amount;
					document.body.scrollTop = amount;
				}

				function position() {
					return document.documentElement.scrollTop || document.body.parentNode.scrollTop || document.body.scrollTop;
				}
				var start = position(),
					change = to - start,
					currentTime = 0,
					increment = 20;
				duration = (typeof(duration) === 'undefined') ? 500 : duration;
				var animateScroll = function() {
					// increment the time
					currentTime += increment;
					// find the value with the quadratic in-out easing function
					var val = easeInOutQuad(currentTime, start, change, duration);
					// move the document.body
					move(val);
					// do the animation unless its over
					if (currentTime < duration) {
						requestAnimFrame(animateScroll);
					} else {
						if (callback && typeof(callback) === 'function') {
							// the animation is done so lets callback
							callback();
						}
					}
				};
				animateScroll();
			}
			__scrollTo(to, callback, duration);
		},
		showErrorTip:function(_msg) {
	    	var msg = _msg || 'oh，服务器和考拉私奔了，请重试';
	    	// this.cancelorderdialog.destroy();
			var _win = PromptWin._$allocate({
				title:'提示',
				clazz:'m-window-3',
                message: '<div class="dialogStyle"><i class="alert">&#xe609;</i>' + msg + '</div>',
                btntext: '确定'
			})._$show();
			setTimeout(function() {
				_win._$hide();
			}, 3000);
	    },
	    showMsgTip:function(_msg, _callback) {
	    	var msg = _msg || '';
	    	// this.cancelorderdialog.destroy();
			var _win = PromptWin._$allocate({
				title:'提示',
				clazz:'m-window-3',
                message: '<div class="m-dialog-result"><i class="succ">&#xe612;</i>' + msg + '</div>',
                btntext: '确定',
                onok:function() {
                	_callback();
                },
                onclose:function() {
                	_callback();
                }
			})._$show();
			setTimeout(function() {
				_callback();
				_win._$hide();
			}, 3000);
	    },
	    getUserInfoFromCookie:function(site, _returnName) {
	    	var name = site === "163" || _j._$cookie("S_INFO") || !_j._$cookie("S_OINFO") ? "P_INFO" : "P_OINFO";
            if (_returnName) {
                return name;
            }
            var info = (_j._$cookie(name) || "").replace(/\"|\'/g, ""),
                arr  = info.split("|");
	        if (arr.length > 1 && /^.+@.+$/.test(arr[0])) {
	            var alias = arr[arr.length - 1];
                return {
                    base: arr[0],
                    alias: /^1\d{10}@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(alias) ? alias : arr[0]
                };
            }
	    }
	};
	return util;
},14,11,7,8);
I$(332,"{label}{#if label}：{/if}<span class=\"h-status\" on-click=\"{this.stopPropagation($event)}\">\n\t<span class=\"nselect-wrap {disabled?'nselect-wrap-dis':''}\" style=\"width:120px;\">\n\t\t<div class=\"nselector\">\n\t\t\t<div class=\"result-wrap\" style=\"font-size:12px; padding-left:16px; padding-right:16px; height:28px; line-height:28px; border-color:rgb(221, 221, 221)\" {#if !disabled} on-click=\"{this.data.active = !this.data.active}\" {/if}>\n\t\t\t\t<div class=\"result ellipsis\" style=\"width:100%; \">{current.value || '全部'}</div>\n\t\t\t\t<div r-class=\"{{'cp-arrow':true, 'cp-arrow-down':!active,'cp-arrow-up':active}}\" style=\"top:12.5px;\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"options-wrap\" style=\"top:30px;\">\n\t\t\t\t<div class=\"options\" r-hide=\"{!active}\">\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t{#list kv as itm}\n\t\t\t\t\t\t<li on-click=\"{this.onselect(itm)}\">\n\t\t\t\t\t\t\t<a hidefocus=\"true\" href=\"javascript:;\" class=\"option ellipsis\" title=\"{itm.value}\" value=\"{itm.key}\" style=\"font-size:12px; padding-left:16px; padding-right:16px; height:28px; line-height:28px;display:block;\">{itm.value}</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t{/list}\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</span>\n</span>");
I$(145,function (BaseComponent,_ut,_tpl,_v) {
	/**
	 * <iselect kv="{orderstates}" label="订单状态" name="orderState" value="{orderState}"></iselect>
	 */
	var iSelect = BaseComponent.extend({
		name:'iselect',
		template:_tpl,
		config:function(data) {
			_ut.extend(data, {
				active:false,
				current:data.kv[0] || {},
				value:data.kv[0].key || ''
			});
			this.supr(data);
		},
		init:function() {
			_v._$addEvent(document.body, 'click', function() {
				this.data.active = false;
				this.$update();
			}._$bind(this));
		},
		onselect:function(itm) {
			this.data.current = itm; 
			this.data.active = false;
			this.update();
		},
		stopPropagation:function(e) {
			e.stopPropagation && e.stopPropagation();
			e.cancelBubble && e.cancelBubble();
		},
		update:function() {
			this.data.value = this.data.current.key;
			this.$emit('update', this.data.value);
		}
	});


	return iSelect;
},151,15,332,3);
I$(333,function (BaseComponent,_ut, _e) {
	var Dialog = BaseComponent.extend({
		config:function(data) {
			_ut.extend(data, {
				active:true
			});
			this.supr(data);
		},
		onok:function() {
			this.data.active = false;
			setTimeout(function() {
				this.destroy();
			}._$bind(this), 350);
		},
		onclose:function() {
			this.data.active = false;
			setTimeout(function() {
				this.destroy();
			}._$bind(this), 350);
		}
	});
	Dialog.directive('animate', function(ele) {
		_e._$addClassName(ele, 'iDialogAnimate5');
		_e._$addClassName(ele, 'iDialogAniCore');

		this.$watch('active', function(val) {
			if ( !val ) {
				_e._$addClassName(ele, 'iDialogAnimate5');
			} else {
				setTimeout(function() {
					_e._$delClassName(ele, 'iDialogAnimate5');
				}, 100);
			}
		});
	});
	return Dialog;
},151,15,4);
I$(334,"<div class=\"iDialog commTipsPop m-window-2\" animate style=\"z-index:10001;width:{width}px; height:{height}px;margin-left:-{width/2}px; left:50%; margin-top:-{height/2}px; top:50%; \">\n\t<table class=\"iDialogWrapTable\">\n\t\t<tbody>\n\t\t\t<tr>\n\t\t\t\t<td class=\"itd-mid-left\"></td>\n\t\t\t\t<td class=\"itd-mid-center\">\n\t\t\t\t\t<div class=\"iDialogContent\">\n\t\t\t\t\t\t<div class=\"iDialogHead\">\n\t\t\t\t\t\t\t<h1>提示</h1>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<a class=\"iDialogClose\" hidefocus=\"true\" href=\"javascript:;\" on-click=\"{this.onclose()}\"></a>\n\t\t\t\t\t\t<div class=\"iDialogBody\">\n\t\t\t\t\t\t\t<div class=\"iDialogMain\" style=\"height:123px;\">\n\t\t\t\t\t\t\t\t<div class=\"cancelOrderStyle\">\n\t\t\t\t\t\t\t\t\t<div class=\"tipText\">您确定要取消订单吗？取消订单后，不能恢复</div>\n\t\t\t\t\t\t\t\t\t<span class=\"cancelOrderBtnOk btn-red30\" on-click=\"{this.onok()}\">确认</span>\n\t\t\t\t\t\t\t\t\t<span class=\"reasonSelect\" style=\"font-size:12px;\">\n\t\t\t\t\t\t\t\t\t\t<iselect kv=\"{cancelOrderReasonList}\" label=\"请选择取消订单的理由\" name=\"cancelOrderReason\" value=\"{cancelOrderReason}\"></iselect>\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t\t<td class=\"itd-mid-right\"></td>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n</div>\n<div class=\"iDialogLayout\" style=\"z-index:10000;\"></div>");
I$(146,function (AnimateDialog,_ut,_tpl) {
	var Dialog = AnimateDialog.extend({
		template:_tpl,
		config:function(data) {
			_ut.extend(data, {
				width: 520,
				height: 250,
				cancelOrderReasonList:[{
					value:'请选择关闭理由',
					key:'其他原因'
				},{
					value:'收货人信息有误',
					key:'收货人信息有误'
				},{
					value:'商品数量或款式需调整',
					key:'商品数量或款式需调整'
				},{
					value:'有更优惠的购买方案',
					key:"有更优惠的购买方案"
				},{
					value:'商品缺货',
					key:'商品缺货'
				},{
					value:'我不想买了',
					key:'我不想买了'
				},{
					value:'其他原因',
					key:'其他原因'
				}],
				cancelOrderReason:'其他原因'
			});
			this.supr(data);
		},
		onok:function() {
			this.data.onok && this.data.onok(this.data.cancelOrderReason);
		},
		onclose:function() {
			this.supr();
		}
	});
	return Dialog;
},333,15,334);
I$(342,"{#if list.length!=0}\n<h4 class=\"newRecomTitle clearFix\">最近浏览<b>你最近一段时间浏览的商品</b>\n{#if Math.ceil(total/limit)>1}\n\t<div class=\"fright m-recommentPager\">\n\t    <a href=\"javascript:void(0);\" class=\"rec-forward\" on-click={this.onNextPageClick()}>&gt;</a>\n\t    <span class=\"rec-page\">{current}/{Math.ceil(total/limit)}</span>\n\t\t<a href=\"javascript:void(0);\" class=\"rec-backward\"  on-click={this.onPrevPageClick()}>&lt;</a>\n    </div>\n{/if}\n</h4>\n<div class=\"m-reclst clearFix\">\n\t{#list list as item}\n\t\t{#if item_index<limit*current&&item_index>=limit*(current-1)}\n\t\t<div class=\"newRecomItemWrap\" on-click={this.clickRecommendTj(item_index)}>\n\t\t\t{#if item.memberCount && item.memberCount>0}\n\t\t\t<a class=\"itemImg\" target=\"_blank\" href=\"/product/{item.goodsId}.html?{condition.query}{item.reason|encode}&istext=0\">\n\t\t\t\t<img border=\"0\" title=\"{item.memberCount}{item.memberUnitName || '件'}装 | {item.title}\" alt=\"{item.memberCount}{item.memberUnitName || '件'}装 | {item.title}\" src=\"{(item.imageUrlFor430||item.imageUrl)|noProtocol}\" style=\"opacity: 1;\">\n\t\t\t</a>\n\t\t\t<p class=\"itemTitle\">\n\t\t\t\t<a href=\"/product/{item.goodsId}.html?{condition.query}{item.reason|encode}&istext=1\" title=\"{item.memberCount}{item.memberUnitName || '件'}装 | {item.title}\" target=\"_blank\"><b>{item.memberCount}{item.memberUnitName || '件'}装</b>&nbsp;|&nbsp;{item.title}</a>\n\t\t\t</p>\n\t\t\t{#else}\n\t\t\t<a class=\"itemImg\" target=\"_blank\" href=\"/product/{item.goodsId}.html?{condition.query}{item.reason|encode}&istext=0\">\n\t\t\t\t<img border=\"0\" title=\"{item.title}\" alt=\"{item.title}\" src=\"{(item.imageUrlFor430||item.imageUrl)|noProtocol}\" style=\"opacity: 1;\">\n\t\t\t</a>\n\t\t\t<p class=\"itemTitle\">\n\t\t\t\t<a href=\"/product/{item.goodsId}.html?{condition.query}{item.reason|encode}&istext=1\" title=\"{item.title}\" target=\"_blank\">{item.title}</a>\n\t\t\t</p>\n\t\t\t{/if}\n\t\t\t<div class=\"itemInfo clearfix\">\n\t\t\t\t<p class=\"price\">¥{item.actualCurrentPrice}<span class=\"marprice\">¥<del>{item.marketPrice}</del></span></p>\n\t\t\t\t<a href=\"/product/{item.goodsId}.html?{condition.query}{item.reason|encode}&istext=2#mainBtmWrap\" target=\"_blank\" class=\"comment\">{item.commentCount} 人已评价</a>\n\t\t\t</div>\n\t\t</div>\n\t\t{/if}\n\t{/list}\n</div>\n{/if}");
I$(159,function (_ut,_e,tpl,ListComponent,_j,_,ScrollPush){
	
  var List = ListComponent.extend({
    template: tpl,
    data:{
    	list:[],
    	condition:{},
      shouldUpdate:true
    },
    shouldUpdateList:function(data){
      return this.data.shouldUpdate;
    },
    getListParam: function(){
        var data = this.data;
        // return _.extend({}, this.getExtraParam(data));
        return {"id":this.getExtraParam(data).goods_ids,"v":1};
    },
    url:'/recommend/getRecommendGoods.html',
    xdrOption:{
    	method:'POST',
    	norest:true,
    	type:'json'
    },
	onBodyScrollCheck:function(event){
    	var offset = _e._$offset(this.$root.parentNode,document.body);
    	var pageBox = _e._$getPageBox();
    	if(pageBox.scrollTop+pageBox.clientHeight>offset.y && !this.data.recommendSent){
        this.daPush();
    		this.data.recommendSent = true;
        var itemsArr = [];
        _ut._$forEach(this.data.list,function(item){
          itemsArr.push('{'+'"id":'+(item.goodsId||'')+',"recType":"'+(item.recType||'')+'","reason":"'+(item.reason||'')+'","weight":"'+(item.weight||'')+'"}');
        });
    		this.$request(this.printRecommendLog,{
    			data:{
    				userId:window.account||"",
    				date:+new Date,
    				position:this.data.condition.tongji.position||'我的优惠券：最近浏览',
    				items:"["+itemsArr.join(",")+"]",
    				resource:'考拉产品组'
    			},
    			onload:function(){
    				
    			},
    			onerror:function(){
    				
    			}
    		})
    	}
    },
    // 推荐商品点击统计事件 hzmating 20150802
    clickRecommendTj:function(index){
      var item = this.data.list[index] || {};
      if(!!event.target.getAttribute("hasClick")){
        return;
      }
      event.target.setAttribute("hasClick",1);
      this.$request(this.printRecommendLog,{
        data:{
          userId:window.account||"",
          date:+new Date,
          position:this.data.condition.tongji.position||'我的优惠券：最近浏览',
          clickItem:'{'+'"id":'+(item.goodsId||'')+',"recType":"'+(item.recType||'')+'","reason":"'+(item.reason||'')+'","weight":"'+(item.weight||'')+'"}',
          resource:'考拉产品组'
        },
        onload:function(){
          
        },
        onerror:function(){
          
        }
      })
    },
    __getList: function(){
        var data = this.data;
        var option = {
          //progress: true,
          data: this.getListParam(),
          onload: function(json){
        	if(json.retcode==200){
	            var result = json,
	              list = result.list||[];
	            _.mergeList(list, data.list,data.key||'id')
	
	            data.total = result.totalCount;
	            data.list = list;
        	}
          },
          onerror: function(json){
            // @TODO: remove
            this.__setParentHide();
          }
        };
        if(this.xdrOption){
      	  _.extend(option, this.xdrOption);
        }
        if(option.norest&&!_ut._$isString(option.data)){
      	  option.data = _ut._$object2query(option.data);
        }
        if(option.method.toUpperCase()=='GET'){
      	  option.query = option.data ;
        }
        this.$request(this.data.url||this.url,option)
   },
   __setParentHide: function(){
    this.parentNode.style.display = 'none';
   },
   onPrevPageClick:function(){
	   if(this.data.current-1>0){
		   this.data.current -=1;
       this.daPush();
	   }
   },
   onNextPageClick:function(){
	   if(this.data.current+1<=Math.ceil(this.data.total/this.data.limit)){
		   this.data.current +=1;
       this.daPush();
	   }
   },
   daPush:function(){
      _.daEvent(this.data.condition.tongji.category||'æŽ¨èåŒºåŸŸå±•ç¤º',this.data.condition.tongji.action||"æˆ‘çš„ä¼˜æƒ åˆ¸",this.data.condition.tongji.lable||"æœ€è¿‘æµè§ˆ");
   },
  //ç»‘å®šæ‰“ç‚¹äº‹ä»¶
  __bindDaPush: function () {
      var self = this, data = self.data,
          dapushParam = data.dapushParam, limit = data.limit || 5;
      //æ— æ‰“ç‚¹å‚æ•°
      if(!dapushParam || !dapushParam.page) return;
      //å‡†å¤‡å‚æ•°
      var spec = {
          param: function () {
              //èŽ·å–å•†å“idåˆ—è¡¨ï¼Œä½œä¸ºæ‰“ç‚¹è¯·æ±‚å‚æ•°
              for(var i = 0, list = [], l = Math.min(data.list.length, limit); i < l; i++) {
                  list.push(data.list[i].goodsId);
              }
              return list;
          }
      };
      _.extend(spec, dapushParam);
      //ç»‘å®šæ»šåŠ¨æ‰“ç‚¹äº‹ä»¶
      ScrollPush._$allocate(spec);
  },
   config: function(data){
	    var koalRV = _j._$cookie('NTES_KAOLA_RV');
	   	var list = koalRV.split('|'), goods=[];
	   	for(var i=0,l=list.length;i<l;i++){
	   		var itm = list[i].split('_');
	   		goods.push(itm[0]);
	   	}
	   	//5896_1432868679291_0|5895_1432868393866_0|5893_1432868387121_0|6674_1432868379068_0|6997_1432868370570_0|5476_1432868290310_0
	   	this.data.condition.goods_ids = goods.join(',');
	   	this.data.condition.version = 1; //ä»ŽNTES_KAOLA_RVå–å‡ºæœ€è¿‘æµè§ˆçš„å£å•†å“ 
	   	this.data.total = goods.length*2;
	    _.extend(data, {
	      total: 1,
	      current: 1,
	      limit: data.condition.limit,
	      list: []
	    });

      if(!this.data.condition.tongji) {
        this.data.condition.tongji = {
          'category':'',
          'action':'',
          'lable':'',
          'position':'',
          'from':''
        }
      }

       //ç»‘å®šæ‰“ç‚¹äº‹ä»¶
       this.__bindDaPush();
	    
	    this.$watch(this.watchedAttr, function(){
	      if(this.shouldUpdateList()){
          this.data.shouldUpdate = false;
          this.__getList();
        } 
	    });
	}
  });
  
  return List;

},2,4,342,288,11,15,289);
I$(201,function(_h,_m,_p,_o,_f,_r){if (_m._$KERNEL.engine==='trident'&&_m._$KERNEL.release<='4.0'){I$(397,function (){
        var _pro = Array.prototype;
        /*
         * åˆ¤æ–­æ˜¯å¦å‡½æ•°
         * @return {Boolean} æ˜¯å¦å‡½æ•°
         */
        var _isFunction = function(_arg){
            return '[object function]' == _o.toString.call(_arg).toLowerCase();
        };
        /**
         * åˆ¤æ–­å‚æ•°æ˜¯å¦æ•°ç»„
         * @see http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.3.2
         * @param  {Variable} æ•°æ®
         * @return {Boolean}  æ˜¯å¦æ•°ç»„
         */
        Array.isArray = function(_arg){
            return "[object array]" === _o.toString.call(_arg).toLowerCase();
        };
        /**
         * æŸ¥æ‰¾ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å…ƒç´ çš„ç´¢å¼•å€¼ï¼ŒåŒ¹é…è§„åˆ™ä¸ºå…¨ç­‰åŒ¹é…
         * @see http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.4.14
         * @param  {Variable} è¦æœç´¢çš„å…ƒç´ 
         * @param  {Number}   èµ·å§‹ç´¢å¼•ï¼Œé»˜è®¤ä»Ž0å¼€å§‹ï¼Œè´Ÿæ•°è¡¨ç¤ºä»Žlength-beginçš„ä½ç½®å¼€å§‹æœç´¢
         * @return {Number}   ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ç´¢å¼•ï¼Œæ²¡æœ‰æ‰¾åˆ°è¿”å›ž-1
         */
        _pro.indexOf = function(_match,_beg){
            var _index = parseInt(_beg)||0;
            if (_index<0){
                _index = Math.max(0,this.length+_index);
            }
            for(var l=this.length;_index<l;_index++){
                if ((_index in this)&&_match===this[_index])
                    return _index;
            }
            return -1;
        };
        /**
         * æŸ¥æ‰¾æœ€åŽä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å…ƒç´ çš„ç´¢å¼•å€¼ï¼ŒåŒ¹é…è§„åˆ™ä¸ºå…¨ç­‰åŒ¹é…
         * @see http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.4.15
         * @param  {Variable} è¦æœç´¢çš„å…ƒç´ 
         * @param  {Number}   æœç´¢ç»“æŸä½ç½®ï¼Œé»˜è®¤ä¸ºæ•°ç»„å°¾éƒ¨ï¼Œè´Ÿæ•°è¡¨ç¤ºåœ¨length-endçš„ä½ç½®ç»“æŸ
         * @return {Number}   ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ç´¢å¼•ï¼Œæ²¡æœ‰æ‰¾åˆ°è¿”å›ž-1
         */
        _pro.lastIndexOf = function(_match,_end){
            var _index = this.length-1;
            _end = parseInt(_end);
            if (!isNaN(_end)){
                _index = _end;
                if (_index<0){
                    _index = this.length+_index;
                }
            }
            for(;_index>=0;_index--){
                if ((_index in this)&&_match===this[_index])
                    return _index;
            }
            return -1;
        };
        /**
         * æ£€æŸ¥æ•°ç»„æ‰€æœ‰å…ƒç´ æ˜¯å¦æ»¡è¶³æŒ‡å®šæ¡ä»¶
         * @see http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.4.16
         * @param  {Function} éªŒè¯å‡½æ•°
         * @param  {Object}   éªŒè¯å‡½æ•°éœ€è¦ä¿æŒä¸€è‡´çš„å¯¹è±¡ï¼Œnullè¡¨ç¤ºwindowå¯¹è±¡
         * @return {Boolean}  æ˜¯å¦æ‰€æœ‰å…ƒç´ éƒ½æ»¡è¶³æ¡ä»¶
         */
        _pro.every = function(_callback,_this){
            if (!_isFunction(_callback)){
                throw new Error(_callback+' is not a function');
            }
            for(var i=0,l=this.length;i<l;i++){
                if ((i in this)&&!_callback.call(_this,this[i],i,this))
                    return !1;
            }
            return !0;
        };
        /**
         * æ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦æœ‰å…ƒç´ æ»¡è¶³æŒ‡å®šæ¡ä»¶
         * @see http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.4.17
         * @param  {Function} éªŒè¯å‡½æ•°
         * @param  {Object}   éªŒè¯å‡½æ•°éœ€è¦ä¿æŒä¸€è‡´çš„å¯¹è±¡ï¼Œnullè¡¨ç¤ºwindowå¯¹è±¡
         * @return {Boolean}  æ˜¯å¦æœ‰å…ƒç´ æ»¡è¶³æŒ‡å®šæ¡ä»¶
         */
        _pro.some = function(_callback,_this){
            if (!_isFunction(_callback)){
                throw new Error(_callback+' is not a function');
            }
            for(var i=0,l=this.length;i<l;i++){
                if ((i in this)&&_callback.call(_this,this[i],i,this))
                    return !0;
            }
            return !1;
        };
        /**
         * éåŽ†æ•°ç»„æ‰€æœ‰å…ƒç´ ï¼Œå¹¶æ‰§è¡Œåˆ¶å®šå‡½æ•°
         * @see http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.4.18
         * @param  {Function} æ‰§è¡Œå‡½æ•°
         * @param  {Object}   æ‰§è¡Œå‡½æ•°éœ€è¦ä¿æŒä¸€è‡´çš„å¯¹è±¡ï¼Œnullè¡¨ç¤ºwindowå¯¹è±¡
         * @return {Void}
         */
        _pro.forEach = function(_callback,_this){
            if (!_isFunction(_callback)){
                throw new Error(_callback+' is not a function');
            }
            for(var i=0,l=this.length;i<l;i++){
                if (i in this){
                    _callback.call(_this,this[i],i,this);
                }
            }
        };
        /**
         * å¯¹æ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ ä½¿ç”¨å¤„ç†å‡½æ•°ç”Ÿæˆæ–°å…ƒç´ å½¢æˆçš„æ–°æ•°ç»„
         * @see http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.4.19
         * @param  {Function} å¤„ç†å‡½æ•°
         * @param  {Object}   å¤„ç†å‡½æ•°éœ€è¦ä¿æŒä¸€è‡´çš„å¯¹è±¡ï¼Œnullè¡¨ç¤ºwindowå¯¹è±¡
         * @return {Array}    æ ¹æ®å¤„ç†å‡½æ•°ç”Ÿæˆçš„æ–°çš„æ•°ç»„
         */
        _pro.map = function(_callback,_this){
            if (!_isFunction(_callback)){
                throw new Error(_callback+' is not a function');
            }
            var _result = new Array(this.length);
            for(var i=0,l=this.length;i<l;i++){
                if (i in this){
                    _result[i] = _callback.call(_this,this[i],i,this);
                }
            }
            return _result;
        };
        /**
         * è¿‡æ»¤ä¸ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œè¿”å›žç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰å…ƒç´ å½¢æˆçš„æ–°æ•°ç»„
         * @see http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.4.20
         * @param  {Function} 验证函数
         * @param  {Object}   验证函数需要保持一致的对象，null表示window对象
         * @return {Array}    符合验证规则的元素形成的新数组
         */
        _pro.filter = function(_callback,_this){
            if (!_isFunction(_callback)){
                throw new Error(_callback+' is not a function');
            }
            var _result = [];
            for(var i=0,l=this.length;i<l;i++){
                if ((i in this)&&_callback.call(_this,this[i],i,this)){
                    _result.push(this[i]);
                }
            }
            return _result;
        };
        /**
         * 从左到右根据处理函数计算数组中各元素的值
         * @see http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.4.21
         * @param  {Function} 处理函数
         * @param  {Variable} 初始值
         * @return {Variable} 计算结果
         */
        _pro.reduce = function(_callback,_value){
            if (!_isFunction(_callback)){
                throw new Error(_callback+' is not a function');
            }
            var _isset = arguments.length>1;
            for(var i=0,l=this.length;i<l;i++){
                if (!(i in this)) continue;
                if (_isset){
                    _value = _callback(_value,this[i],i,this);
                }else{
                    _isset = !0;
                    _value = this[i];
                }
            }
            if (!_isset){
              throw new Error('Reduce of empty array with no initial value');
            }
            return _value;
        };
        /**
         * 从右到左根据处理函数计算数组中各元素的值
         * @see http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.4.22
         * @param  {Function} 处理函数
         * @param  {Variable} 初始值
         * @return {Variable} 计算结果
         */
        _pro.reduceRight = function(_callback,_value){
            if (!_isFunction(_callback)){
                throw new Error(_callback+' is not a function');
            }
            var _isset = arguments.length>1;
            for(var i=this.length-1;i>=0;i--){
                if (!(i in this)) continue;
                if (_isset){
                    _value = _callback(_value,this[i],i,this);
                }else{
                    _isset = !0;
                    _value = this[i];
                }
            }
            if (!_isset){
              throw new Error('Reduce of empty array with no initial value');
            }
            return _value;
        };
    });}return _h;},398,78);
I$(150,function (_k, _ut, _t, _v, _e, _, User, Dialog,
            _p, _o, _f, _r, pro) {
	/**
   * 【1】单按钮确认弹窗 confirmDialog
   *    @param text（弹窗文案） [默认]无
   *    @param btnText（按钮文案） [默认]确认
   *    @param icon（图标）：success，alert，forbid，fail 4种样式 [默认]success
   *    @param onok（确认事件） [默认]无
   *    @param onclose（X关闭事件） [默认]无
   * 【2】快捷错误弹窗 errorDialog
   *    @param text（弹窗文案） [默认]网络或系统错误
   *    @param btnText（按钮文案） [默认]确认
   *    @param onclose（确认或X关闭事件） [默认]无
   * 【3】3秒自动关闭弹窗 autoCloseDialog
   *    @param text（弹窗文案） [默认]无
   *    @param icon（按钮文案） [默认]success
   *    @param onclose（自动关闭或X关闭事件） [默认]无
   * 【4】双按钮确认弹窗 promptDialog 
	 * 		@param options {Object}
	 *    	@property text（弹窗文案） [默认]无
	 *    	@property okBtnText（确定按钮文案） [默认]确认
	 *    	@property ccBtnText（取消按钮文案） [默认]取消
	 *    	@property icon（图标）：success，alert，forbid，fail 4种样式 [默认]success
	 *    	@property onok（确认事件） [默认]无
	 *    	@property onclose（X关闭事件） [默认]无
   * 【5】双行文案弹窗 twoLineDialog
	 * 		@param options {Object}
	 *    	@property text1（弹窗文案 第一行大字） [默认]无
	 *    	@property text2（弹窗文案 第二行小字） [默认]无
	 * 			@property marginLeft（文案距离左边距离） [默认]0
	 *    	@property okBtnText（确定按钮文案） [默认]确认
	 *    	@property ccBtnText（取消按钮文案） [默认]取消
	 *    	@property icon（图标）：success，alert，forbid，fail 4种样式 [默认]success
	 *    	@property onok（确认事件） [默认]无
	 *    	@property onclose（X关闭事件） [默认]无
   * 
   */
	var d = {};
  d.icons = {
    "alert" : "&#xe609;",
    "forbid" : "&#xe606;",
    "success" : "&#xe612;",
    "fail":"&#xe604;"
  };
  d.clazz = {
    "green" : "succ",
    "red" : "fail"
  };
  d.createIconNode = function(type){
    return type=='noIcon'?'':"<i class='"+this.clazz[type=='success'?'green':'red']+"' r-html={'"+this.icons[type]+"'}></i>";
  };
  d.iconDefault =function(icon){
    return icon||"success";
  };
  d.errorDefault = function(str){
    return str||"网络或系统错误";
  };
  d.okBtnDefault = function(str){
    return str||"确认";
  };
  d.ccBtnDefault = function(str){
    return str||"取消";
  };
	/**
	 * 单按钮确认弹窗
	 */
	d.confirmDialog = function(text,btnText,icon,onok,onclose){
		new Dialog({
			data:{
				width:520,
				title:'提示',
				msg:"<p class='m-dialog-result'>"+
              d.createIconNode(d.iconDefault(icon))+text+
            "</p>",
				txtOk:d.okBtnDefault(btnText),
				hideCCBtn:true,
        onok:function(){
          !!onok && onok();
        },
        onclose:function(){
          !!onclose && onclose();
        }
			}
		}).$inject(document.body);
	};
  /**
	 * 快捷错误弹窗
	 */
	d.errorDialog = function(text,btnText,onclose){
		d.confirmDialog(
      d.errorDefault(text),
      btnText,
      "fail",
      onclose,
      onclose
    );
	};
	/**
	 * 3秒自动关闭弹窗
	 */
	d.autoCloseDialog = function(text,icon,onclose){
    new Dialog({
      data:{
        width:520,
        title:'提示',
        hideOkBtn:true,
        hideCCBtn:true,
        msg:"<p class='m-dialog-result'>"+
            d.createIconNode(d.iconDefault(icon))+text+
          "</p>"+
          "<p style='display:none;' countdown='3'></p>",
        onclose:function() {
          !!onclose && onclose();
        }._$bind(this)
      }
    }).$inject(document.body);
  };
  /**
	 * 双按钮确认弹窗
	 */
	d.promptDialog = function(options){
    var options = options || {};
		new Dialog({
			data:{
				width:520,
				title:'提示',
				msg:"<p class='m-dialog-result'>"+
              d.createIconNode(d.iconDefault(options.icon))+options.text+
            "</p>",
				txtOk:d.okBtnDefault(options.okBtnText),
        txtCC:d.ccBtnDefault(options.ccBtnText),
        onok:function(){
          !!options.onok && options.onok();
        },
        onclose:function(){
          !!options.onclose && options.onclose();
        }
			}
		}).$inject(document.body);
	};
	/**
	 * 双按钮确认弹窗
	 */
	d.twoLineDialog = function(options){
    var options = options || {};
		new Dialog({
			data:{
				width:520,
				title:'提示',
				msg:"<div class='m-dialog-result f-tal' style='margin-left:"+(options.marginLeft||0)+"px;'>"+
              d.createIconNode(d.iconDefault(options.icon))+options.text1+
							"<p class='line2'>"+options.text2+"</p>"+
            "</div>",
				txtOk:d.okBtnDefault(options.okBtnText),
        txtCC:d.ccBtnDefault(options.ccBtnText),
				hideOkBtn:!!options.hideOkBtn,
				hideCCBtn:!!options.hideCCBtn,
        onok:function(){
          !!options.onok && options.onok();
        },
        onclose:function(){
          !!options.onclose && options.onclose();
        }
			}
		}).$inject(document.body);
	};

	return d;

},1,2,23,3,4,15,26,187);
I$(518,"<div class=\"iDialog commTipsPop {clazz} m-dialogVerify m-photoVerify\" animate style=\"z-index:109;width:{width}px; height:{height}px;margin-left:-{width/2}px; left:50%; margin-top:-{height/2}px; top:50%; \">\n\t<table class=\"iDialogWrapTable\">\n\t\t<tbody>\n\t\t\t<tr>\n\t\t\t\t<td class=\"itd-mid-left\"></td>\n\t\t\t\t<td class=\"itd-mid-center\">\n\t\t\t\t\t<div class=\"iDialogContent\">\n\t\t\t\t\t\t<div class=\"iDialogHead\">\n\t\t\t\t\t\t\t<h1>实名认证</h1>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<a class=\"iDialogClose\" hidefocus=\"true\" href=\"javascript:;\" on-click=\"{this.onclose()}\"></a>\n\t\t\t\t\t\t<div class=\"iDialogBody\">\n\t\t\t\t\t\t\t<div class=\"iDialogMain\" style=\"padding-bottom:30px;\">\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t{#if status==3}\n\t\t\t\t\t\t\t\t\t<p class=\"notice-2\"><b class=\"iconfont\" r-html={\"&#xe609;\"}></b>应海关要求，请上传身份证照片，补充实名认证信息</p>\n\t\t\t\t\t\t\t\t\t{#elseif status==4}\n\t\t\t\t\t\t\t\t\t<p class=\"notice-3\">根据海关要求，购买跨境商品需要对订购人进行实名认证</p>\n\t\t\t\t\t\t\t\t\t{#else}\n\t\t\t\t\t\t\t\t\t<p class=\"notice-1\">网易考拉海购承诺所传身份证明只用于办理跨境商品的清关手续，不作他途使用，其他任何人均无法查看。</p>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t<div class=\"m_myaddress m_myaddress_photo\">\n\t\t\t\t\t\t\t\t\t\t{#if status==4}\n\t\t\t\t\t\t\t\t\t\t<ul class=\"input-text\">\n\t\t\t\t\t\t\t\t\t\t\t<li class=\"input-name\"><b>*</b>收货人姓名<input type=\"text\" r-placeholder=\"请确保填写的是真实姓名\" on-focus={this.onInputFocus('name')} r-model='{authData.name}'></li>\n\t\t\t\t\t\t\t\t\t\t\t<li class=\"input-err\" r-hide=\"{!authError.name}\"><i r-html={\"&#xe606;\"}></i>{authError.name}</li>\n\t\t\t\t\t\t\t\t\t\t\t<li class=\"input-idNum\">\n\t\t\t\t\t\t\t\t\t\t\t\t<b>*</b>身份证号码<input type=\"text\" r-placeholder=\"请填写姓名对应的身份证号码\" on-focus={this.onInputFocus('idNum')} r-model={authData.idNum}>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"m-idcardtip m-idcardtip-photo\" on-mouseenter={showidcardtip=true} on-mouseleave={showidcardtip=false}>\n\t\t\t\t\t\t\t\t                   <i class=\"iconfont w-icon-ask\" r-html={\"&#xe613;\"}></i>\n\t\t\t\t\t\t\t\t                   <div class=\"m-notice m-notice-idcard\" style=\"display:none;\" r-hide={!showidcardtip}>\n\t\t\t\t\t\t\t\t\t                   <p class=\"para1\">根据海关要求，购买部分跨境商品需对收货人进行实名认证，并提供身份证影印件，错误信息可能导致无法正常清关。</p>\n\t\t\t\t\t\t\t\t\t                   <p class=\"para2\">你的身份证信息将加密保管，考拉保证信息安全，绝不对外泄露！</p>\n\t\t\t\t\t\t\t\t\t                   <p class=\"para3\">有任何身份认证的问题请咨询我们<br/>400-088-8188<br/>09:00-24:00</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"arrow\">\n\t\t\t\t\t\t\t\t\t\t                    <span class=\"arr\"></span>\n\t\t\t\t\t\t\t\t\t\t                    <span class=\"arr1\"></span>\n\t\t\t\t\t\t\t\t\t                   </span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t </div>\n\t\t\t\t\t\t\t\t        </div>\n\t\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t\t<li class=\"input-err\" r-hide=\"{!authError.idNum}\"><i r-html={\"&#xe606;\"}></i>{authError.idNum}</li>\n\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t{#else}\n\t\t\t\t\t\t\t\t\t\t<p class=\"name\">实名者：<b>{authData.name||''}</b></p>\n\t\t\t\t\t\t\t\t\t\t<p class=\"idNum\">身份证：<b>{authData.idNum||''}</b></p>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t<section {#if status==4}class=\"photoArea\"{/if}>\n\t\t\t\t\t\t\t\t\t\t<div ref=\"photoWrap\" class=\"photoWrap clearfix\">\n\t\t\t\t\t\t\t\t\t\t\t{#if status==4}<p class='tit'><b>*</b>上传照片</p>{/if}\n\t\t\t\t\t\t\t\t\t\t\t<label class=\"photo front uploadLabel\" r-hide=\"{!!authData.frontUrl}\" on-click={this.onLabelClick('front')}>+ 添加正面</label>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"display frontDisplay\" r-hide=\"{!authData.frontUrl}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"{authData.frontUrl|noProtocol}\" width=\"100%\" on-load={this.photoLoad($event)}>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"photoOpe\" r-hide={status==1}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label class=\"uploadLabel front\" on-click={this.onLabelClick('front')}>重新上传</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label on-click=\"{authData.frontUrl=''}\">删除</label>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<label class=\"photo back uploadLabel\" r-hide=\"{!!authData.backUrl}\" on-click={this.onLabelClick('back')}>+ 添加反面</label>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"display backDisplay\" r-hide=\"{!authData.backUrl}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"{authData.backUrl|noProtocol}\" width=\"100%\" on-load={this.photoLoad($event)}>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"photoOpe\" r-hide={status==1}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label class=\"uploadLabel\" on-click={this.onLabelClick('back')}>重新上传</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label on-click=\"{authData.backUrl=''}\">删除</label>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<ul class=\"err f-cb\">\n\t\t\t\t\t\t\t\t\t\t\t<li class=\"err-front\">\n\t\t\t\t\t\t\t\t\t\t\t\t<p r-hide=\"{!authError.frontUrl}\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i r-html={\"&#xe606;\"}></i>{authError.frontUrl}\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t\t<li class=\"err-back\">\n\t\t\t\t\t\t\t\t\t\t\t\t<p r-hide=\"{!authError.backUrl}\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i r-html={\"&#xe606;\"}></i>{authError.backUrl}\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t{#if status==1}\n\t\t\t\t\t\t\t\t\t\t<p class=\"hint-hidephoto\">为保护您的个人隐私，历史已上传的照片已做加密处理，无法再次查看</p>\n\t\t\t\t\t\t\t\t\t\t{#else}\n\t\t\t\t\t\t\t\t\t\t<p class=\"weak-hint\" r-hide={weakHint==''}><b class=\"iconfont\" r-html={\"&#xe614;\"}></b>{weakHint}</p>\n\t\t\t\t\t\t\t\t\t\t<ul class=\"example f-cb\" r-hide={weakHint!=''}>\n\t\t\t\t\t\t\t\t\t\t\t<li class=\"example-front\"><p>示例</p><div class=\"img\"></div></li>\n\t\t\t\t\t\t\t\t\t\t\t<li class=\"example-back\"><p>示例</p><div class=\"img\"></div></li>\n\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t<p class=\"hint hint1\">注：1.需上传清晰的身份证正面、反面共2张照片</p>\n\t\t\t\t\t\t\t\t\t\t<p class=\"hint hint2\">2.照片不超过5MB，支持格式jpg，jpeg，png</p>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t</section>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"iDialogFoot\">{#if status==1}<a href=\"javascript:;\" rel=\"1\" class=\"iDialogBtn focusBtn\" on-click=\"{this.onmodify()}\"><span>修改</span></a>{#else}<a href=\"javascript:;\" rel=\"1\" class=\"iDialogBtn focusBtn\" on-click=\"{this.onok()}\"><span>认证</span></a><a href=\"javascript:;\" rel=\"0\" class=\"iDialogBtn\" on-click=\"{this.onclose()}\"><span>取消</span></a>{/if}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t\t<td class=\"itd-mid-right\"></td>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n</div>\n<div class=\"iDialogLayout\" style=\"z-index:108;\"></div>");
I$(338,function (AnimateDialog,_e,_v,_ut,_,_s,_j,_tpl,Util) {
	var Dialog = AnimateDialog.extend({
		template:_tpl,
		config:function(data) {
			this.supr(data);
			_.extend(data, {
				width:520,
				height:400,
				authData : {
					name : '',
					idNum : '',
					frontUrl : '',
					backUrl : ''
				},
				authError:{
					name:'',
					idNum:'',
					frontUrl:'',
					backUrl:''
				},
                weakHint:'',//OCR多媒体检测弱提示
                frontImgExample:'//haitao.nos.netease.com/3e6d92a5615a4c22a7b8913fdb70c85f.jpg?imageView&thumbnail=132x0&quality=95&crop=0_0_132_88',
                backImgExample:'//haitao.nos.netease.com/3e6d92a5615a4c22a7b8913fdb70c85f.jpg?imageView&thumbnail=132x0&quality=95&crop=0_90_132_88',
				imgOpt : "imageView&thumbnail=272x0&quality=95",
				status:1//1:查看实名信息（个人中心），2：修改实名信息（个人中心），3：上传实名照片（个人中心），4：编辑实名信息（订单流程）
			});
			this.$watch('status',function(status){
				switch(status||1){
					case 1:
						data.height = 414;
						data.authData.frontUrl = data.frontImgExample;
						data.authData.backUrl = data.backImgExample;
						break;
					case 2:
						data.height = 496;
						break;
					case 3:
						data.height = 481;
						break;
					case 4:
						data.height = 507;
						break;
				}
			});
            //有改动就重新OCR多媒体验证
            this.$watch(['authData.name','authData.idNum','authData.frontPhoto','authData.backPhoto'],function(){
                data.weakHint = '';
            });
		},
		init:function() {
			//初始化上传事件
			this.initUpload();
            //打点
            if(this.data.status==4){//4：编辑实名信息（订单流程）
                _.daEvent('支付后实名认证','收货人实名认证浮层','出现');
            }
		},
        onInputFocus:function(type){
            var isName = type=='name';
            var data = this.data;
            data.authError[isName?'name':'idNum']='';
            if(data.status==4){
                _.daEvent('支付后实名认证','收货人实名认证浮层',isName?'姓名':'身份证');
            }
        },
        onLabelClick:function(type){
            var isFront = type=='front';
            var status = this.data.status;
            if(status==2 || status==3){//2：修改实名信息（个人中心），3：上传实名照片（个人中心）
                _.daEvent('个人中心实名认证','列表非空',isFront?'添加正面':'添加反面');
            }else if(status==4){//4：编辑实名信息（订单流程）
                _.daEvent('支付后实名认证','收货人实名认证浮层',isFront?'添加正面':'添加反面');
            }
        },
		photoLoad:function(e){
			var img = e.target,
				h = img.offsetHeight;
			img.style.marginTop = -h/2+"px";
		},
		initUpload:function(){
			var self = this;
			_ut._$forEach(_e._$getByClassName(this.$refs.photoWrap,"uploadLabel"),function(btn){
		        _s._$bind(btn,{
		        	parent:btn.parentNode,
		        	accept:"image/jpg,image/jpeg,image/png",
		        	onchange:function(_event){
		        		var isFront = _e._$hasClassName(_event.target,'front');
		        	    var form = _event.form;
		        	    form.action='/uploadImageForNej.html?module=authOcr';
		        	    form.method ='POST';
		        	    _j._$upload(form,{
		        	      cookie:true,
		        	      name:'fileData',
		        	      accept:'image/jpg,image/jpeg,image/png',
		        	      onload:self.uploadSucCb._$bind(self,isFront,form),
		        	      onerror:self.uploadFailCb._$bind(self,isFront,form)
		        	    });
		        	}
		        });
	        });
		},
		uploadSucCb:function(isFront,form,json){
			var data = json || {imageUrl:['']},imageUrl;
		    form.reset();
			if(data.retcode==200){
				imageUrl = data.imageUrl[0]||'';
				this.data.authData[isFront?'frontUrl':'backUrl'] = imageUrl + (imageUrl.indexOf('?')>0?'&':'?') + this.data.imgOpt;
				this.showError(isFront?'frontUrl':'backUrl');
			}else if(data.retcode==403){
				this.showError('frontUrl','图片格式不正确');
			}else if(data.retcode==404){
				this.showError('frontUrl','图片大小不能超过5MB');
			}else if(data.retcode==461){
				Util.afterLogin(function() {
					location.reload();
				}._$bind(this));
			}else{
				this.showError('frontUrl',data.retdesc||'照片上传失败');
			}
		},
		uploadFailCb:function(isFront,form){
			form.reset();
			this.showError('frontUrl','照片上传失败');
		},
		onok:function() {
			var data = this.data,
				errNum = 0,
                status = data.status,
				param = {
                    'authId':data.authId||'',
					'realName':(data.authData.name||'').trim(),
					'idCardNum':(data.authData.idNum||'').trim(),
					'idCardFrontUrl':(data.authData.frontUrl || '').trim().replace(new RegExp('[?&]{1}'+this.data.imgOpt,'g'),""),
					'idCardOppositeUrl':(data.authData.backUrl || '').trim().replace(new RegExp('[?&]{1}'+this.data.imgOpt,'g'),""),
					'gorderId':data.gorderId||'',
					'authType':0,
                    'forceSubmitPhoto':!!data.weakHint
				},
                idNumReg = /(^[0-9A-Za-z*]{15}$)|(^[0-9A-Za-z*]{18}$)/;
            // 打点
            if(status==2 || status==3){//2：修改实名信息（个人中心），3：上传实名照片（个人中心）
                _.daEvent('个人中心实名认证','列表非空','提交认证');
            }else if(status==4){//4：编辑实名信息（订单流程）
                _.daEvent('支付后实名认证','收货人实名认证浮层','提交认证');
            }
            //reset error
            _ut._$forEach(['name','idNum','frontUrl','backUrl'],function(errField){
                this.showError(errField);
            }._$bind(this));
            /**
             * 验证相关信息
             */
            //验证身份证照片
            if ( !param.idCardFrontUrl || param.idCardFrontUrl==data.frontImgExample) { 
                this.showError('frontUrl','请上传正面照片'); 
                errNum++;
            }
            if ( !param.idCardOppositeUrl || param.idCardOppositeUrl==data.backImgExample) { 
                this.showError('backUrl','请上传反面照片'); 
                errNum++;
            }
            if(status==4){//4：编辑实名信息（订单流程——订单列表）
                // 收货人实名authType = 2
                param.authType = 2;
                //验证姓名
                if(param.realName==''){
                    this.showError('name','请输入您的真实姓名');
                    errNum++;
                }
                //验证身份证号码
                if(param.idCardNum==''){
                    this.showError('idNum','请输入身份证号码');
                    errNum++;
                }else if(!idNumReg.test(param.idCardNum)){
                    this.showError('idNum','身份证号码有误，请重试');
                    errNum++;
                }
            }
            // 有错误拦截
            if(errNum>0){
                return;
            }
			Util.afterLogin(function() {
				this.authreq(param);
			}._$bind(this));
		},
		showError:function(field,msg){
			this.data.authError[field] = msg||'';
			this.$update();
		},
		requesting:false,
		authreq:function(_param) {
			if ( this.requesting ) { return; }
			this.requesting = true;
			var _url = '/personal/authenticate/doAuth.html',
				_opts= {
                    method:'post',
					data:_param,
                    norest:true,
					onload:this.onauthreqload._$bind(this),
					onerror:function() {
						this.requesting = false;
					}._$bind(this)
				};
			this.$request(_url, _opts);
		},
        onauthreqload:function(_json){
            var json = _json||{},
                code = json.retcode||0,
                desc = json.retdesc||'系统错误',
                data = this.data,
                status = data.status;
            // 打点
            if(code == 200){
                if(status==4){
                    _.daEvent('支付后实名认证','收货人实名认证浮层','认证通过');
                }else{
                    _.daEvent('个人中心实名认证','列表非空','认证通过');
                }
            }else{
                if(status==4){
                    _.daEvent('支付后实名认证','收货人实名认证浮层','错误',{errorType:desc});
                }else{
                    _.daEvent('个人中心实名认证','列表非空','错误',{errorType:desc});
                }
            }
            if ( code == 200 ) {
                this.onclose();
                Util.showMsgTip('恭喜您已提交成功', function() {
                    location.reload();
                }._$bind(this));
                //统计打点
                !!window._dapush && window._dapush("_trackEvent","郑州保税仓实名认证","上传成功弹窗弹出","弹窗出现",{'userAccount':window.account,'userId':window.account});
            }else if(code==-202||code==-203){//姓名错误
                this.showError('name',desc);
            }else if(code==-204||code==-205||code==-301||code==-305||code==-306){//身份证错误
                this.showError('idNum',desc);
            }else if(code==-302||code==-303||code==-304){//OCR多媒体检测问题，提供弱提示
                data.weakHint = desc;
            }else{
                this.showError('frontUrl',desc);
            }
            this.requesting = false;
        },
		onclose:function() {
			this.supr();
		},
		onmodify:function(){
			this.data.status = 2;
		}
	});

	var directive = {
        'r-placeholder':function(ele, _val) {
            var val = _val;
            if(_val.type=="expression"){
              val = this.$get(_val);
            }
            //初始化placeholder
            setTimeout(function(){
                if(ele.value.trim() == ''){
                    ele.value = val;
                    _e._$addClassName(ele, 'c_999');
                }
            });
            _v._$addEvent(ele, 'focus', function() {
              if ( ele.value.trim() == val ) {
                ele.value = '';
                _e._$delClassName(ele, 'c_999');
              }
            });
            _v._$addEvent(ele, 'blur', function() {
              if ( ele.value.trim() == '' ) {
                ele.value = val;
                _e._$addClassName(ele, 'c_999');
              }
            });
        }
    }
    // 扩展插件
    Dialog.directive(directive);

	return Dialog;
},333,4,3,2,15,516,14,518,142);
I$(343,"{#if !error}\n    {#if !empty}\n    <div class=\"resultwrap\">\n    {#if loading}\n      <div class=\"m-loading\">\n        <img src=\"{__cdnBaseUrl}images/loading.gif\">\n      </div>\n    {#else}\n      {#if list.length > 0}\n      <dl class=\"result\">\n        {#list list as line}\n        <dd class=\"g-brand  {(total<=limit && line_index+1===list.length)?'g-brand-onepage-last':''}\">\n            <div class=\"brand\">\n                <a href=\"/brand/{line.brand.id}.html\" target=\"_blank\">\n                <img class=\"logo\" src=\"{line.brand.logoUrl|noProtocol}\"/></a><br/>\n                <a href=\"#\" class=\"action {line._notfollowed?'action-notfollowed':'action-followed'}\" on-click={this.__brandFollow(line, $event)}>{#if line._notfollowed}<i class=\"iconfont\" r-html={\"&#xe631;\"}></i>关注{#else}<span class=\"def\">已关注</span><span class=\"hov\">取消</span>{/if}</a>\n            </div>\n            <div class=\"cont {(!line.goodsList || line.goodsList.length===0)?'nogoods':''}\">\n                <div class=\"bar\">\n                    <a class=\"more\" href=\"/brand/{line.brand.id}.html\" target=\"_blank\">查看全部<i class=\"iconfont\" r-html={\"&#xe629;\"}></i></a>\n                    <a class=\"name\" href=\"/brand/{line.brand.id}.html\" target=\"_blank\">{line.brand.name}</a>\n                </div>\n                <!-- 商品区块 -->\n                {#if line.goodsList && line.goodsList.length>0}\n                <ul class=\"itemlist clearfix\">\n                  {#list line.goodsList as sku}\n                  {#if sku}\n                    <li class=\"good\" >\n                      <div class=\"img\">\n                        <a target=\"_blank\" href=\"/product/{sku.goodsId}.html?from=page{current}&position={sku_index}\">\n                        <img class=\"img-lazyload\"\n                         title=\"{sku.title}\"\n                         src =\"/images/blank.gif\"\n                         data-src=\"{sku.imageUrl|imgThumbnailUrl:192}\" >\n                        {#if !sku.actualStorageStatus && sku.onlineStatus}\n                          <span class=\"soldout\"></span>\n                        {#elseif sku.onlineStatus}\n                          <div class=\"activityflag\">\n                            {#if !!sku.danpinPromotionTitle }\n                            <span class=\"danpin\">{sku.danpinPromotionTitle.split('-')[0]}</span>\n                            {#elseif !!sku.isNewGoods}\n                            <span class=\"new\">新品</span>\n                            {/if}\n                            {#if !!sku.zhengdanPromotionTitle }\n                            <span class=\"zhengdan large\">{sku.zhengdanPromotionTitle.split('-')[0]}</span>\n                            {/if}\n                          </div>\n                        {/if}\n                        </a>\n                      </div>\n                      <div class=\"desc\">\n                        <p class=\"title\">\n                        {#if !!sku.memberCount && sku.memberCount > 0}\n                          <a href=\"/product/{sku.goodsId}.html?from=page{current}&position={sku_index}&istext=1\" target=\"_blank\" title=\"{sku.title}\"><i>{sku.memberCount}件装</i> | {sku.title}</a>\n                        {#else}\n                          <a href=\"/product/{sku.goodsId}.html?from=page{current}&position={sku_index}&istext=1\" target=\"_blank\" title=\"{sku.title}\">{sku.title}</a>\n                        {/if}\n                        </p>\n                        {#if sku.onlineStatus!==0}\n                            <p class=\"price\">\n                            {#if !!sku.memberCount && sku.memberCount > 0 && sku.isShowDiscountCost!==false}\n                              <span class=\"cur\"><i>¥</i>{sku.actualCurrentPrice}</span><b class=\"combinedLabel\">折合单件¥<i>{sku.memberPrice}</i></b>\n                            {#else}\n                              <span class=\"cur\"><i>¥</i>{sku.actualCurrentPrice}</span>{#if sku.actualCurrentPrice>0 && sku.actualCurrentPrice/sku.marketPrice<=0.99}<b class=\"combinedLabel\">{(sku.actualCurrentPrice/sku.marketPrice)|toDiscount}折</b>\n                              {/if}\n                            {/if}\n                            </p>\n                            <p class=\"clearfix\">\n                              <del>¥{sku.marketPrice}</del>\n                              <a target=\"_blank\" href=\"/product/{sku.goodsId}.html?from=comment#mainBtmWrap\" class=\"comments\">{sku.commentCount}人已评价</a>\n                            </p>\n                        {#else}\n                            <p class=\"not-online\">商品已下架</p>\n                        {/if}\n                      </div>\n                    </li>\n                  {/if}\n                  {/list}\n                </ul>\n                {#else}\n                    暂无在售商品\n                {/if}\n            </div>\n        </dd>\n        {/list}\n        <div id=\"pageNavWrap\">\n            <div id=\"pageNav\" class=\"m-centerpager clearfix center\">\n                <pager total={Math.ceil(total/limit)} current={current} on-nav={this.pagerNav($event)}></pager>\n            </div>\n        </div>\n      </dl>\n      {#else}\n      <div class=\"tbl-nodata clearfix\">\n          <span class=\"img\"></span>\n          <span class=\"info\">当前无关注的品牌， &thinsp;<a href=\"/\" class=\"color-red\">去逛逛&gt;</a></span>\n      </div>\n      {/if}\n    {/if}\n    </div>\n    {#else}\n    <div class=\"tbl-nodata clearfix\">\n        <span class=\"img\"></span>\n        <span class=\"info\">当前无关注的品牌，&thinsp;<a href=\"/\" class=\"color-red\">去逛逛&gt;</a></span>\n    </div>\n    {/if}\n{#else}\n<div class=\"tbl-loaderror clearfix\">\n    <span class=\"img\"></span>\n    <span class=\"info\">获取关注品牌失败，&thinsp;<a href=\"\" class=\"color-red\" onclick=\"location.reload();return false;\">点击刷新页面&gt;</a></span>\n</div>\n{/if}\n");
I$(519,".#<uispace> .succ{width:auto}\n");
I$(520,"<div class=\"iDialogBody\">\n    <div class=\"iDialogMain\">\n        <div class=\"m-brandwin-bdy m-dlgcont m-dlgcont-c\">\n            <p class=\"j-cont title\">确定取消关注该品牌？</p>\n        </div>\n    </div>\n</div>\n<div class=\"iDialogFoot\">\n    <a href=\"javascript:;\" rel=\"1\" class=\"iDialogBtn focusBtn j-ok\"><span>确定</span></a>\n    <a href=\"javascript:;\" rel=\"0\" class=\"iDialogBtn j-cc\"><span>取消</span></a>\n</div>\n");
I$(344,function (Window, _e,_v,_css, _html,_e1,_t, $,_p, _o, _f, _r,_pro) {

	var _seed_css = _e._$pushCSSText(_css),
	    _seed_html = _e1._$addNodeTemplate(_html);

    _p._$$BrandWindow = NEJ.C();
    _pro = _p._$$BrandWindow._$extend(Window);

    _pro.__reset = function(_options) {
    	_options.title='提示';
        this.__super(_options);

        var type = _options.type||'confirm',
            msg = _options.msg|| '',
            btns = _options.btns||['确定','取消'];
        this.__diatype= type;
        switch (type) {
            case 'ask':
                $(this._okbtn)._$style('display', 'inline-block')._$children('span', true)._$text(btns[0]);
                $(this._ccbtn)._$style('display', 'inline-block')._$children('span', true)._$text(btns[1]);
                $(this._conts)._$html(msg);
                break;
            case 'confirm':
                $(this._okbtn)._$style('display', 'inline-block')._$children('span', true)._$text(btns[0]);
                $(this._ccbtn)._$style('display', 'none')._$children('span', true)._$text(btns[1]);
                $(this._conts)._$html(msg);
                break;
            default:
        }
        $(this._okbtn)._$on('click', this.__onOK._$bind(this));
        $(this._ccbtn)._$on('click', this.__onCC._$bind(this));
    };
    _pro.__destroy = function(_options) {
        this.__super(_options);
        $(this._okbtn)._$off('click');
        $(this._ccbtn)._$off('click');
        this._conts = null;
        this._okbtn = null;
        this._ccbtn = null;
    };

    _pro.__initXGui = function() {
        this.__seed_css = _seed_css;
        this.__seed_html = _seed_html;
    };

    _pro.__initNode = function() {
        this.__super();
        var _list = _e._$getByClassName(this.__body,'j-flag');
        this._conts = _e._$getByClassName(this.__body,'j-cont')[0];
        this._okbtn = _e._$getByClassName(this.__body,'j-ok')[0];
        this._ccbtn = _e._$getByClassName(this.__body,'j-cc')[0];
    };
    _pro.__onOK = function(_event) {
    	_v._$stop(_event);
    	this._$dispatchEvent('onok');
		this._$hide();
    };
    _pro.__onCC = function(_event) {
    	_v._$stop(_event);
    	this._$dispatchEvent('oncancel');
		this._$hide();
    };


    return _p._$$BrandWindow;
},229,4,3,519,520,233,238,25);
I$(160,function (_ut,tpl, BWin,ListComponent,request,_){
  var List = ListComponent.extend({
    template: tpl,
    config: function(data){
        _.extend(data, {
          total: 0,
          current: 1,
          limit: 10,
          list: []
        });

        data.error = false;
        data.__cdnBaseUrl = window.__cdnBaseUrl || '/';

        this.$watch(this.watchedAttr, function(){
          if(this.shouldUpdateList()) this.__getList();
        });
        this.$watch('total', this.emitLoad._$bind(this));         
    },
    init: function(){
    	this.supr();    	
    },
    emitLoad: function(){    	
        this.$emit('load', {total: this.data.total||0,list: this.data.list||[]} );
    },
    getListParam: function(){
        var data = this.data;
        return _.extend({
        	pageSize: data.limit,
        	pageNo: data.current
          }, this.getExtraParam(data));
    },
    url:'/personal/brand/list.html',
    xdrOption:{
    	method:'POST',
    	norest:true,
    	type:'json'
    },
    __getList: function(){
        var data = this.data;
        var option = {
          progress: true,
          data: this.getListParam(),
          onload: function(json){
        	if(json.retcode==200){
	            var result = json.result,
	              list = result.result||[];
	            _.mergeList(list, data.list,data.key||'id');
	            data.total = result.totalCount;
	            data.list = list;	            
                this.emitLoad();
        	} else{
                data.error = true;
                this.emitLoad();
        	}
          },
          onerror: function(json){
            data.error = true;
            this.emitLoad();
          }
        };
        if(this.xdrOption){
      	  _.extend(option, this.xdrOption);
        }
        if(option.norest&&!_ut._$isString(option.data)){
      	  option.data = _ut._$object2query(option.data);
        }
        if(option.method.toUpperCase()=='GET'){
      	  option.query = option.data ;
        }
        this.$request(this.url,option);
   },
   /**
    * 关注、取消关注ajax操作， action 为1时为关注，0 为取消关注
    */
   __brandFollowAjax: function(brandid, action, callback){
       var url = '/personal/brand/follow.html';
       request(url, {
           data: {id: brandid, status: action},
           method:"POST",
           type:"json",
           norest:true,
           onload: function(json){
               if (json.retcode==200 || json.retcode==491) {
                   callback(false, json);
               }else{
                   callback(true, json);
               }
           },
           onerror: function(json){
               callback(true, json);
           }
       });
   },
   __brandFollow: function (line, evt) {
       evt.preventDefault();
       var action = !!line._notfollowed? 1:0;
       
       if (action===0){
    	   var ask = BWin._$allocate({clazz:'m-brandwin',width:520, type:'ask',
               msg: '确定取消关注该品牌？',
               onok: function(evt){
                   this.__brandFollowAjax(line.brand.id, action, function(hasErr, json){
                       if (hasErr) {
                           this.__showConfrimMsg(action);
                       }else{
                           line._notfollowed = !line._notfollowed;
                           this.$update();
                       }
                   }._$bind(this));
               }._$bind(this),
               oncancel: function(evt){

               }._$bind(this)
          });
          ask._$show();
       }else{
    	   this.__brandFollowAjax(line.brand.id, action, function(hasErr, json){
               if (hasErr) {
                   this.__showConfrimMsg(action);
               }else{
                   line._notfollowed = !line._notfollowed;
                   this.$update();
               }
           }._$bind(this));
       }
       

   },
   __showConfrimMsg: function(action){
       var msg = action===1 ? '关注失败，请重新操作。':'取消关注失败，请重新操作。';
       var confirm = BWin._$allocate({clazz:'m-brandwin',width:520, type:'confirm',
        btns:['我知道了'],
        msg: msg
       });
       confirm._$show();
   },

   __filterHiddenGoods: function(list){
       if (!list || !list.length) {
           return [];
       }
       var newList=[];
       for (var i = 0; i < list.length; i++) {
           if (list[i] && list[i].isShow) {
               newList.push(list[i]);
           }
       }
       return newList;
   },

    _getList:function(filter){
        return this.data.list.filter(function(_item){
            return !!_item[filter];
        });
    },
    pagerNav: function(pageNo){
    	this.$emit('nav', pageNo);
    }
  });

  List.filter('toDiscount',function(num){
      if (typeof num === 'number') {
          var discount = (Math.ceil(100*num)/10)+'';
          if (discount.length===1) {
              discount += '.0';
          }
          return discount;
      }else{
          return num;
      }
  });

  return List;

},2,343,344,268,6,15);
I$(528,function (_k,_i,_t,_t1,_p, _o, _f, _r,_pro){
    // variable
    var _   = NEJ.P,
        _i  = _('nej.ui'),
        _pro,_sup;
    /**
     * 项目窗体基类
     *
     * @class   {nm.l._$$AWWindow}
     * @extends {nej.ui._$$WindowWrapper}
     *
     * @param   {}
     */
    _p._$$AWWindow = _k._$klass();
    _pro = _p._$$AWWindow._$extend(_i._$$WindowWrapper);
    _sup = _p._$$AWWindow._$supro;
    /**
     * 控件重置
     * @param {Object} _options
     */
    _pro.__reset = function(_options){
        _options.parent = _options.parent||document.body;
        _options.clazz = (_options.clazz||'') +  ' m-window';
        _options.mask = 'm-mask';
        this.__supReset(_options);
        var _layerHide = this.__layer._$hide;
        this.__layer._$hide = function(){
        	console.log('hide');
        	var _easeout  = _t1._$$AnimEaseOut._$allocate({
                from:{
                    offset:400
                },
                to:{
                    offset:0
                },
                duration:200,
                onupdate:function(_event){
                	this.__body.parentNode.parentNode.style.width = _event.offset + 'px';
                    this.__layer.__doPositionAlign();
                }._$bind(this),
                onstop:function(){
                	_easeout._$recycle();
                    _layerHide.apply(this.__layer);
                }._$bind(this)
            });
        	_easeout._$play();
        }._$bind(this)
        this.__layer._$setTitle(_options.title,true);
        this.__width = _options.width;
    };

    _pro.__doAnimation = function(){
    	var _easein  = _t._$$AnimEaseIn._$allocate({
            from:{
                offset:0
            },
            to:{
                offset:this.__width
            },
            duration:200,
            onupdate:function(_event){
                this.__body.parentNode.parentNode.style.width = _event.offset + 'px';
                this.__layer.__doPositionAlign();
            }._$bind(this),
            onstop:function(){
                this._$recycle();
            }
        });
        // 开始动画
        _easein._$play();
    };

    _pro._$hide = function(){
        this.__super()
    };
    _pro.__doHide = function(){
    	var _callback = this.__super.bind(this);
        var _easeout  = _t1._$$AnimEaseOut._$allocate({
            from:{
                offset:400
            },
            to:{
                offset:0
            },
            duration:1000,
            onupdate:function(_event){
            	this.__body.parentNode.parentNode.style.width = _event.offset + 'px';
                this.__layer.__doPositionAlign();
            },
            onstop:function(){
                this._$recycle();
                _callback();
            }
        });
        // 开始动画
        _easeout._$play();
    };

    /**
     * 显示窗体
     */
    _pro._$show = function(){
        _sup._$show.apply(this,arguments);
        this.__body.focus();
        this.__doAnimation();
        return this;
    };

    return _p._$$AWWindow;
},1,447,234,138);
I$(529,".#<uispace> .succ{width:auto}\n");
I$(530,"<div class=\"iDialogBody\">\n    <div class=\"iDialogMain\" style=\"height: 127px;\">\n        <div class=\"coupon-exchange-dialog\">\n            <p><i class=\"succ\"></i>恭喜，兑换码兑换成功啦!</p><a href=\"/\" target=\"_blank\">立即去逛逛&gt;</a></div>\n    </div>\n</div>");
I$(368,function (Window, _e,_v,_css, _html,_e1,_t,_p, _o, _f, _r,_pro) {
	
	var _seed_css = _e._$pushCSSText(_css),
	    _seed_html = _e1._$addNodeTemplate(_html);
	
	/*
	 * 或
	 * _html不是用textarea包括，纯的html代码如：<div class="cnt"></div>

	    var _seed_css = _e._$pushCSSText(_css),
			_seed_html= _e1._$addNodeTemplate(_html);
		_$$CouponWindow._$allocate({})._$show();
	 * 
	 */
    _p._$$CouponWindow = NEJ.C();
    _pro = _p._$$CouponWindow._$extend(Window);

    _pro.__reset = function(_options) {
    	_options.title='提示';
        this.__super(_options);
        
    };
    _pro.__destroy = function(_options) {
        this.__super(_options);
    };

    _pro.__initXGui = function() {
        this.__seed_css = _seed_css;
        this.__seed_html = _seed_html
    };

    _pro.__initNode = function() {
        this.__super();
        var _list = _e._$getByClassName(this.__body,'j-flag');
    };
    /**
     * 点击"确定"按钮事件响应
     * */
    _pro.__onOK = function(_event) {
    	_v._$stop(_event);
    	this._$dispatchEvent('onok');
		this._$hide();
    };

    
    return _p._$$CouponWindow;
},528,4,3,529,530,233,238);
I$(521,"<span ref=\"wrap\" class=\"nselect-wrap {wrapClass||''}\" style=\"width:{@(swidth)}px;display:{shownone?'inline-block':slist.length==0?'none':'inline-block'};\" on-click=\"{this.stopPropagation($event)}\">\n\t<div class=\"nselector\">\n\t\t<div class=\"result-wrap\" style=\"font-size:{@(sfontsize)}px; padding-left:16px; padding-right:16px; height:{@(sheight)}px; line-height:{@(sheight)}px;\" on-click=\"{active=!active}\">\n\t\t\t<div class=\"result ellipsis\" style=\"width:100%; \">{current.text || ''}</div>\n\t\t\t<div r-class=\"{{'cp-arrow':true, 'cp-arrow-down':!active,'cp-arrow-up':active}}\" style=\"top:{@(sheight/2-1.5)}px;\"></div>\n\t\t</div>\n\t\t<div class=\"options-wrap\" style=\"top:{@(sheight+2)}px;\">\n\t\t\t<div class=\"options\" r-style=\"{{display:active?'block':'none'}}\">\n\t\t\t\t<ul>\n\t\t\t\t\t{#list slist as itm}\n\t\t\t\t\t<li on-click=\"{this.onchange(itm)}\">\n\t\t\t\t\t\t<a hidefocus=\"true\" href=\"javascript:;\" class=\"option ellipsis {itm.value==current.value?'curr':''}\" title=\"{itm.text}\" value=\"{itm.value}\" style=\"font-size:{@(sfontsize)}px;padding-left:16px;padding-right:16px;width:100%;height:{@(sheight)}px;line-height:{@(sheight)}px;display:block;\">{itm.text}</a>\n\t\t\t\t\t</li>\n\t\t\t\t\t{/list}\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</span>");
I$(346,function (BaseComponent,_ut,_,_tpl,_v) {
	/**
	 * <rselect list="{itemObjArr}" current="{itemObj}" wrapClass=string width=number height=number fontsize=number shownone=boolean></rselect>
	 * itemObj {value:1000,text:'这个值是1000'}
	 * shownone list为空的时候，是否展示rselect，默认不展示
	 * 
	 * 外面通过修改current的值，可切换选中的option，可修改格式{value:1000,text:'这个值是1000'}or{value:1000}
	 */
	function getPure(val,def){
		//获得兼容的纯净的值
		return parseFloat(val||def);
	}
	var rSelect = BaseComponent.extend({
		name:'rselect',
		template:_tpl,
		config:function(data) {
			_.extend(data, {
				active:false,
				current:data.current || (data.list||[])[0] || {},
				slist:data.list||[],
				swidth:getPure(data.width,120),
				sheight:getPure(data.height,28),
				sfontsize:getPure(data.fontsize,12)
			});
			this.supr(data);
			//补全current
			this.$watch('current',function(newValue){
				newValue = newValue||{};
				if(newValue.value===undefined || newValue.text===undefined){
					var slist = data.slist,
						len = slist.length,
						key = newValue.value===undefined?'text':'value',
						noKey = newValue.value===undefined?'value':'text';
					for(var i=0;i<len;i++){
						if(slist[i][key]==newValue[key]){
							data.current[noKey] = slist[i][noKey];
							break;
						}
					}
					this.$update();
				}
			}._$bind(this));
		},
		init:function() {
			_v._$addEvent(document.body, 'click', function() {
				this.$update({
					active:false
				});
			}._$bind(this));
		},
		onchange:function(itm) {
			var data = this.data;
			data.active = false;
			if(data.current.value!=itm.value){
				data.current = itm;
				this.$emit('change',itm);
			}
		},
		stopPropagation:function(e) {
			e.stopPropagation && e.stopPropagation();
			e.cancelBubble && e.cancelBubble();
		},
		/**
		 * 获取当前选中的option
		 */
		$getCurrent: function(){
			return this.data.current||{};
		},
		/**
		 * 设置当前选中的option,参数 {value:'1111'} or {value:'1111',text:'value是1111'}
		 */
		$setCurrent: function(optionObj){
			if(!!optionObj){
				this.data.current = optionObj;
			}
		}

	});


	return rSelect;
},151,2,15,521,3);
I$(335,"{#if showAuthButtonType/1 == 0 }\n\t<span class=\"waitCertificate btn-gray30\" title=\"认证错误次数过多，请明天再试\">实名认证</span>\n{#else}\n\t<span class=\"waitCertificate btn-red30\" on-click=\"{this.certificate(gorder)}\">实名认证</span>\t\n{/if}");
I$(515,"<div class=\"iDialog commTipsPop {clazz} m-dialogVerify\" animate style=\"z-index:189;width:{width}px; height:{height}px;margin-left:-{width/2}px; left:50%; margin-top:-{height/2}px; top:50%; \">\n\t<table class=\"iDialogWrapTable\">\n\t\t<tbody>\n\t\t\t<tr>\n\t\t\t\t<td class=\"itd-mid-left\"></td>\n\t\t\t\t<td class=\"itd-mid-center\">\n\t\t\t\t\t<div class=\"iDialogContent\">\n\t\t\t\t\t\t<div class=\"iDialogHead\">\n\t\t\t\t\t\t\t<h1>实名认证</h1>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<a class=\"iDialogClose\" hidefocus=\"true\" href=\"javascript:;\" on-click=\"{this.onclose()}\"></a>\n\t\t\t\t\t\t<div class=\"iDialogBody\">\n\t\t\t\t\t\t\t<div class=\"iDialogMain\" style=\"padding-bottom:40px;\">\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<p class=\"notice\">根据海关要求，购买跨境商品需要对订购人进行实名认证</p>\n\t\t\t\t\t\t\t\t\t<div class=\"m_myaddress m_myaddress_verify\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"item clearfix\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"item-label\"><i>*</i>&nbsp;订购人姓名：</span>\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" name=\"fullname3\" r-class=\"{{'item-input':true, 'item-input-fullname':true, 'ztag':true, 'error':receiverError}}\" lenlimit r-model=\"{receiver}\" on-focus={this.onNameInputFocus($event)}/>\n\t\t\t\t\t\t\t\t\t\t\t<p class=\"i-error\" r-hide=\"{!receiverError}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<i r-html={\"&#xe606;\"}></i>{receiverErrorMsg}\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"item clearfix\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"item-label\"><i>*</i>&nbsp;身份证号码：</span>\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" name=\"identityCard1\" r-class=\"{{'item-input':true, 'ztag':true,'oIpt':true, 'c_999':!idno || idno == '请填写收货人本人的真实身份证号码', 'error':idnoError}}\" value=\"请填写收货人本人的真实身份证号码\" iplaceholder=\"请填写收货人本人的真实身份证号码\" r-model=\"{idno}\" idno  on-focus={this.onIdNumInputFocus($event)}/>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"m-idcardtip\">\n\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"iconfont w-icon-ask\" r-html={\"&#xe613;\"} on-mouseenter=\"{this.data.askhover = true}\" on-mouseleave=\"{this.data.askhover = false}\"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"m-notice m-notice-idcard\" r-hide=\"{!askhover}\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p class=\"para1\">根据海关要求，购买跨境商品需要对订购人进行实名认证，错误信息可能导致无法正常清关。</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p class=\"para2\">你的身份证信息将加密保管，考拉保证信息安全，绝不对外泄露！</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p class=\"para3\">有任何身份认证的问题请咨询我们<br/>400-088-8188<br/>09:00-24:00</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"arrow\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"arr\"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"arr1\"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<p class=\"i-error\" r-hide=\"{!idnoError}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<i r-html={\"&#xe606;\"}></i>{idnoErrorMsg}\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"iDialogFoot\">\n\t\t\t\t\t\t\t<a href=\"javascript:;\" rel=\"1\" class=\"iDialogBtn focusBtn\" on-click=\"{this.onok()}\">\n\t\t\t\t\t\t\t\t<span>认证</span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t<a href=\"javascript:;\" rel=\"0\" class=\"iDialogBtn\" on-click=\"{this.onclose()}\">\n\t\t\t\t\t\t\t\t<span>取消</span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t\t<td class=\"itd-mid-right\"></td>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n</div>\n<div class=\"iDialogLayout\" style=\"z-index:188;\"></div>");
I$(336,function (AnimateDialog, _e,_v, _, _tpl,Util) {
	var Dialog = AnimateDialog.extend({
		template:_tpl,
		config:function(data) {
			_.extend(data, {});
			this.supr(data);
		},
		init:function() {
			// 统计
			var userinfo = Util.getUserInfoFromCookie() || {};
        	window['_gaq'].push(['_trackEvent', '实名认证', '完成实名认证', '我的点击实名认证###'+ userinfo.base +'&'+new Date()]);
        	// 打点
        	_.daEvent('支付后实名认证','订购人实名认证浮层','出现');
		},
		onNameInputFocus:function(){
			// 打点
        	_.daEvent('支付后实名认证','订购人实名认证浮层','姓名');
		},
		onIdNumInputFocus:function(){
			// 打点
        	_.daEvent('支付后实名认证','订购人实名认证浮层','身份证');
		},
		onok:function() {
			var _data = this.data;
			var param = {
				"authType": 1,
				'realName':_data.receiver || '',
				'idCardNum':_data.idno || '',
				'gorderId':_data.gorderId
			};
			// 打点
        	_.daEvent('支付后实名认证','订购人实名认证浮层','提交认证');

			if ( _data.receiver.trim() == '' || _data.idno.trim() == '请填写收货人本人的真实身份证号码' || _data.idno.trim() == '' ) { return; }
			if ( _data.receiverError && _data.receiverErrorCode == 1 ) { return; }
			if ( _data.idnoError && _data.idnoErrorCode == 1 ) { return; }

			Util.afterLogin(function() {
				this.authreq(param);
			}._$bind(this));
		},
		requesting:false,
		authreq:function(_param) {
			if ( this.requesting ) { return; }
			this.requesting = true;

			var _url = '/personal/authenticate/doAuth.html',
				_opts= {
					data:_param,
					onload:function(_json) {
						var json = _json||{};
						var retcode = json.retcode;
						var retdesc = json.retdesc||'';
						// 打点
						if(retcode == 200){
							_.daEvent('支付后实名认证','订购人实名认证浮层','认证通过');
						}else{
							_.daEvent('支付后实名认证','订购人实名认证浮层','错误',{errorType:retdesc||'系统错误'});
						}
						if ( retcode == 200 ) {
							this.onclose();
							Util.showMsgTip('实名认证成功', function() {
								location.reload();
							}._$bind(this));

							// 统计
							var userinfo = Util.getUserInfoFromCookie() || {};
							window['_gaq'].push(['_trackEvent', '实名认证', '完成实名认证', '我的实名认证完成###'+ userinfo.base +'&'+new Date()+'&'+null+'&1']);
						} else {
							var _msg = '';
							switch(retcode) {
								case 2:
									_msg = retdesc ? ( retdesc + "，请重试" ) : "身份证号码与姓名不一致，请重试";
									this.data.idnoError    = true;
									this.data.idnoErrorMsg = _msg;
									this.data.idnoErrorCode= 2;
									break;
								case 439:
									_msg = retdesc ? ( retdesc + '，请明天再试，如有疑问请联系客服' ) : '认证服务超时，请明天再试，如有疑问请联系客服';
									this.data.idnoError    = true;
									this.data.idnoErrorMsg = _msg;
									this.data.idnoErrorCode= 439;
									break;
								case 412:
									_msg = retdesc;
									this.data.receiverError    = true;
									this.data.receiverErrorMsg = _msg;
									this.data.receiverErrorCode= 412;
									break; 
								default:
									_msg = retdesc || '身份证号码与姓名不一致，请重试';
									this.data.idnoError    = true;
									this.data.idnoErrorMsg = _msg;
									this.data.idnoErrorCode= 2;
									break;
							}
							this.$update();
							// 统计
							var userinfo = Util.getUserInfoFromCookie() || {};
							window['_gaq'].push(['_trackEvent', '实名认证', '完成实名认证', '我的实名认证完成###'+ userinfo.base +'&'+new Date()+'&'+null+'&0']);
						}	
						this.requesting = false;
					}._$bind(this),
					onerror:function() {
						this.requesting = false;
					}._$bind(this)
				};
			this.$request(_url, _opts);
		},
		onclose:function() {
			this.supr();
		}
	});

	Dialog.directive('lenlimit', function(ele) {
		_v._$addEvent(ele, 'blur', function() {
			//utf8中文=3个英文，需要处理成2个英文。进行长度判断
            var _val= ele.value,
            	len = _val.replace(/[^\x00-\xff]/g, "rr").length;
            this.data.receiverError = ( len < 2 || len > 24 );
            if ( this.data.receiverError ) {
            	this.data.receiverErrorMsg  = '长度不符合，请控制在2-24个字符，一个汉字为两个字符';
            	this.data.receiverErrorCode = 1;
            }
            this.$update();
		}._$bind(this));
	});

	Dialog.directive('idno', function(ele) {

		_v._$addEvent(ele, 'blur', function() {
			var _val    = ele.value,
				_regexp = /(^[0-9A-Za-z*]{15}$)|(^[0-9A-Za-z*]{18}$)/;
			this.data.idnoError = !_regexp.test(_val);
			if ( this.data.idnoError ) {
				this.data.idnoErrorMsg = '请输入正确的身份证号码';
				this.data.idnoErrorCode= 1;
				this.$update();
			} else {
				this.onok();
			}
			
		}._$bind(this));
	});

	Dialog.directive('iplaceholder', function(ele, _val) {
		if ( ele.value != _val ) {
			_e._$delClassName(ele, 'c_999');
		}

		_v._$addEvent(ele, 'focus', function() {
			if ( ele.value == _val ) {
				ele.value = '';
				_e._$delClassName(ele, 'c_999');
			}
		}._$bind(this));

		_v._$addEvent(ele, 'blur', function() {
			if ( ele.value == '' ) {
				ele.value = _val;
				_e._$addClassName(ele, 'c_999');
			}
		});
	});
	return Dialog;
},333,4,3,15,515,142);
I$(517,"<div class=\"iDialog commTipsPop {clazz} m-dialogVerify m-photoVerify\" animate style=\"z-index:10001;width:{width}px; height:{height}px;margin-left:-{width/2}px; left:50%; margin-top:-{height/2}px; top:50%; \">\n\t<table class=\"iDialogWrapTable\">\n\t\t<tbody>\n\t\t\t<tr>\n\t\t\t\t<td class=\"itd-mid-left\"></td>\n\t\t\t\t<td class=\"itd-mid-center\">\n\t\t\t\t\t<div class=\"iDialogContent\">\n\t\t\t\t\t\t<div class=\"iDialogHead\">\n\t\t\t\t\t\t\t<h1>实名认证</h1>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<a class=\"iDialogClose\" hidefocus=\"true\" href=\"javascript:;\" on-click=\"{this.onclose()}\"></a>\n\t\t\t\t\t\t<div class=\"iDialogBody\">\n\t\t\t\t\t\t\t<div class=\"iDialogMain\" style=\"padding-bottom:40px;\">\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<p class=\"notice\"><b class=\"iconfont\" r-html={\"&#xe609;\"}></b>应海关要求，请上传身份证照片，补充实名认证信息</p>\n\t\t\t\t\t\t\t\t\t<div class=\"m_myaddress m_myaddress_photo\">\n\t\t\t\t\t\t\t\t\t\t<p class=\"personalInfo\">实名者：<b class=\"name\">{receiver}</b>身份证：<b>{identityCard}</b></p>\n\t\t\t\t\t\t\t\t\t\t<p class=\"hint hint1\">注：1.需上传清晰的身份证正面、反面共2张照片</p>\n\t\t\t\t\t\t\t\t\t\t<p class=\"hint hint2\">2.照片不超过5MB，支持格式jpg，jpeg，png</p>\n\t\t\t\t\t\t\t\t\t\t<div ref=\"example\" class=\"hover-example clearfix\" r-hide=\"{hideExample}\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"image\"></span>\n\t\t\t\t\t\t\t\t\t\t\t<ul class=\"text\">\n\t\t\t\t\t\t\t\t\t\t\t\t<li class=\"tit\" r-html=\"{exampleTit}\">身份证正面照片</li>\n\t\t\t\t\t\t\t\t\t\t\t\t<li>1.拍照时保证身份证完整显示</li>\n\t\t\t\t\t\t\t\t\t\t\t\t<li>2.确保能清晰看见身份证上的信息</li>\n\t\t\t\t\t\t\t\t\t\t\t\t<li>3.防止拍照时身份证反光</li>\n\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t\t<b class=\"triangle\"></b>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div ref=\"photoWrap\" class=\"photoWrap clearfix\">\n\t\t\t\t\t\t\t\t\t\t\t<label class=\"photo front uploadLabel\" r-hide=\"{!!photoUrl.frontUrl}\" on-mouseenter={this.showExample(true)} on-mouseleave={this.hideExample()}>+ 添加正面</label>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"display frontDisplay\" r-hide=\"{!photoUrl.frontUrl}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"{photoUrl.frontUrl|noProtocol}\" width=\"100%\" on-load={this.photoLoad($event)}>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"photoOpe\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label class=\"uploadLabel front\">重新上传</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label on-click=\"{photoUrl.frontUrl=''}\">删除</label>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<label class=\"photo back uploadLabel\" r-hide=\"{!!photoUrl.backUrl}\" on-mouseenter={this.showExample(false)} on-mouseleave={this.hideExample()}>+ 添加反面</label>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"display backDisplay\" r-hide=\"{!photoUrl.backUrl}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"{photoUrl.backUrl|noProtocol}\" width=\"100%\" on-load={this.photoLoad($event)}>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"photoOpe\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label class=\"uploadLabel\">重新上传</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label on-click=\"{photoUrl.backUrl=''}\">删除</label>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<p class=\"err\" r-hide=\"{!photoErrorMsg}\">\n\t\t\t\t\t\t\t\t\t\t\t<i r-html={\"&#xe606;\"}></i>{photoErrorMsg}\n\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"iDialogFoot\"><a href=\"javascript:;\" rel=\"1\" class=\"iDialogBtn focusBtn\" on-click=\"{this.onok()}\"><span>认证</span></a><a href=\"javascript:;\" rel=\"0\" class=\"iDialogBtn\" on-click=\"{this.onclose()}\"><span>取消</span></a></div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t\t<td class=\"itd-mid-right\"></td>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n</div>\n<div class=\"iDialogLayout\" style=\"z-index:10000;\"></div>");
I$(337,function (AnimateDialog,_e,_v,_ut,_,_s,_j,_tpl,Util) {
	var Dialog = AnimateDialog.extend({
		template:_tpl,
		config:function(data) {
			_.extend(data, {
				hideExample : true,
				photoUrl : {
					frontUrl : null,
					backUrl : null
				},
				photoErrorMsg : "",
				imgOpt : "imageView&thumbnail=272x0&quality=95"
			});
			this.supr(data);
		},
		init:function() {
			//初始化上传事件
			this.initUpload();
		},
		photoLoad:function(e){
			var img = e.target,
				h = img.offsetHeight;
			img.style.marginTop = -h/2+"px";
		},
		showExample:function(isFront){
			this.data.hideExample=false;
			_e[isFront?"_$delClassName":"_$addClassName"](this.$refs.example,"hover-exampleBack");
			this.data.exampleTit = isFront?"身份证正面照片":"身份证反面照片";
		},
		hideExample:function(e){
			this.data.hideExample=true;
		},
		initUpload:function(){
			var self = this;
			_ut._$forEach(_e._$getByClassName(this.$refs.photoWrap,"uploadLabel"),function(btn){
		        _s._$bind(btn,{
		        	parent:btn.parentNode,
		        	accept:"image/jpg,image/jpeg,image/png",
		        	onchange:function(_event){
		        		var isFront = _e._$hasClassName(_event.target,'front');
		        	    var form = _event.form;
		        	    form.action='/uploadImageForNej.html?module=auth';
		        	    form.method ='POST';
		        	    _j._$upload(form,{
		        	      cookie:true,
		        	      name:'fileData',
		        	      accept:'image/jpg,image/jpeg,image/png',
		        	      onload:self.uploadSucCb._$bind(self,isFront,form),
		        	      onerror:self.uploadFailCb._$bind(self,isFront,form)
		        	    });
		        	}
		        });
	        });
		},
		uploadSucCb:function(isFront,form,json){
			var data = json || {imageUrl:[]},imageUrl;
		    form.reset();
			if(data.retcode==200){
				imageUrl = data.imageUrl[0];
				this.data.photoUrl[isFront?'frontUrl':'backUrl'] = imageUrl +(imageUrl.indexOf('?')>0?'&':'?')+ this.data.imgOpt;
				this.data.photoUrl[isFront?'frontFileKey':'oppositeFileKey'] = data.imageUrl[1] || '';
				this.showError('');
			}else if(data.retcode==403){
				this.showError('图片格式不正确');
			}else if(data.retcode==404){
				this.showError('图片大小不能超过5MB');
			}else if(data.retcode==461){
				Util.afterLogin(function() {
					location.reload();
				}._$bind(this));
			}else{
				this.showError(data.retdesc||'照片上传失败');
			}
		},
		uploadFailCb:function(isFront,form){
			form.reset();
			this.showError('照片上传失败');
		},
		onok:function() {
			var _data = this.data,
				param = {
					'frontFileKey':(_data.photoUrl.frontFileKey || '').trim(),
					'oppositeFileKey':(_data.photoUrl.oppositeFileKey || '').trim(),
					'gorderId':_data.gorderId
				};
			if ( !param.frontFileKey && !param.oppositeFileKey ) { return this.showError('请上传正/反面照片'); }
			if ( !param.frontFileKey ) { return this.showError('请上传正面照片'); }
			if ( !param.oppositeFileKey ) { return this.showError('请上传反面照片'); }

			Util.afterLogin(function() {
				this.authreq(param);
			}._$bind(this));
		},
		showError:function(errorMsg){
			this.data.photoErrorMsg = errorMsg;
			this.$update();
		},
		requesting:false,
		authreq:function(_param) {
			if ( this.requesting ) { return; }
			this.requesting = true;
			var _url = '/personal/authOrderWithPhoto.html',
				_opts= {
					data:_param,
					onload:function(_json) {
						var _code = _json.retcode;
						if ( _code == 200 ) {
							this.onclose();
							Util.showMsgTip('恭喜您已提交实名认证申请', function() {
								location.reload();
							}._$bind(this));
							//统计打点
            				!!window._dapush && window._dapush("_trackEvent","郑州保税仓实名认证","上传成功弹窗弹出","弹窗出现",{'userAccount':window.account,'userId':window.account});
						} else {
							this.showError('照片上传失败');
						}	
						this.requesting = false;
					}._$bind(this),
					onerror:function() {
						this.requesting = false;
					}._$bind(this)
				};
			this.$request(_url, _opts);
		},
		onclose:function() {
			this.supr();
		}
	});

	return Dialog;
},333,4,3,2,15,516,14,517,142);
I$(147,function (BaseComponent,_e, _ut, _tpl, CertificateDialog, CertiPhotoDialog, AuthPhotoDialog) {
	var Certificate = BaseComponent.extend({
		name:'certificate',
		template:_tpl,
		config:function(data) {
			_ut.extend(data, {});
			this.supr(data);
		},
		certificate:function(gorder) {
			var verifyStatus = gorder.verifyStatus||-1,
				needVerifyInfo = gorder.needVerifyInfo||{},
				hasAuthInfo = needVerifyInfo.hasAuthInfo||{};
			if(verifyStatus==3){
				// 需要上传身份证照片
				new CertiPhotoDialog({
					data:{
						width:520,
						height:340,
						receiver:gorder.receiverName,
						identityCard:gorder.identityCard,
						gorderId:gorder.gorderId
					}
				}).$inject(_e._$get('certificatedialog'));
				//统计打点
            	!!window._dapush && window._dapush("_trackEvent","郑州保税仓实名认证","订单列表页点击","身份证照片",{'userAccount':window.account,'userId':window.account});
			}else if(verifyStatus==11 || verifyStatus==12){
				new AuthPhotoDialog({
			        data:{
			          authId:hasAuthInfo.authId||'',
			          gorderId:gorder.gorderId,
			          authData:{
			            name:hasAuthInfo.realName||'',
			            idNum:hasAuthInfo.idCardNum||''
			          },
			          status:4
			        }
			      }).$inject(_e._$get('certificatedialog'));
			}else{
				//需要身份证号码
				new CertificateDialog({
					data:{
						width:520,
						height:340,
						receiver:hasAuthInfo.realName,
						gorderId:gorder.gorderId
					}
				}).$inject(_e._$get('certificatedialog'));
				//统计打点
            	!!window._dapush && window._dapush("_trackEvent","郑州保税仓实名认证","订单列表页点击","身份证号码",{'userAccount':window.account,'userId':window.account});
			}
		}
	});
	return Certificate;
},151,4,15,335,336,337,338);
I$(384,function (e) {
    /**
     * 控件基类，主要实现以下功能：
     * * 根据用户配置 完成大转盘元素位置属性计算
     *   结构举例
     *   根据已知列数行数生成 (列数+行数-2)×2个单元格 并返回中间空白区域 btn
     *
     * ```html
     *    <div id="turnplateCnt" style="position:relative;width:454px;height:334px"></div>
     * ```
     *   width: 454, height: 334, row:3, column:4  控件会计算好各元素的位置及样式信息 并生成绝对定位元素填充给定长宽且顺序如下
     *   \----454px-----\   -
     *    1 | 2 | 3 | 4     |
     *   ----------------  334px
     *   10 |  btn  | 5     |
     *   ________________   |
     *    9 | 8 | 7 | 6     _
     * ```javascript
     *   NEJ.define([
     *      'lib/base/event',
     *      'pro/components/lottery/turnplate'
     *   ],function(v, Turnplate){
     *       // 第一步
     *       // 定义控件类
     *       var turnplate = new Turnplate({
     *           row: 3,                                             // 行数
     *           column: 4,                                          // 列数
     *           margin: 2,                                          // 间隙
     *           width: 454,                                         // 容器宽度
     *           height: 334                                         // 容器高度
     *       });
     *       // 设置动画效果
     *       turnplate.$setAnimate({
     *           speed: 2,                                           // 抽奖转动速度(默认为5) 越大越慢
     *           noReset: true,                                      // 后续抽奖不从第一个开始
     *           endCycle: 3,                                        // 转动圈数
     *           slow: 4                                             // 停止转动前 转动到第slow个开始减速(默认值为3)
     *       });
     *       // 使用绝对定位生成的位置信息
     *       turnplate.$setBox(data.prizes).$inject(turnplateCnt);
     *
     *       // 第二步
     *       // 自定义中间btn
     *       turnplate.btn.innerHTML = '开始游戏';
     *
     *       // 第三步
     *       // 开始游戏
     *       v._$addEvent(turnplate.btn, 'click', function (_event) {
     *          v._$stop(_event);
     *          self.turnplate.$play({
     *              index: 1,                                       // 起始位置
     *              EndIndex: 6                                     // 停住的位置
     *           });
     *        }, false);
     * ```
     *  当用户点击开始按钮 转盘将开始转动 并停留在位置6
     *
     *    1 | 2 | 3 | 4
     *   ----------------
     *   10 |  btn  | 5
     *   ________________
     *    9 | 8 | 7 |[6]
     *
     */
    function Turnplate(config) {
        this.time = 0;                                                          // 标记抽奖次数
        this.length = 0;                                                        // 标记奖品数
        this.config = config;                                                   // 配置
        this.lastIndex = 0;                                                     // 标记上次抽奖停止位置
        this.animate = {};                                                      // 转动效果配置
        this.posArr = [];                                                       // 奖池位置数据 供使用者自己渲染新的模型
        this.container = document.createDocumentFragment();                     // 标记容器
        this._setPosArr();
        this._bindEvent(this);
    }

    var tp = Turnplate.prototype;

    // 自定义事件
    tp._bindEvent = function (context) {
        if (!context) return;
        // Handles custom event
        context.$on = function (event, fn) {
            if (typeof event === 'object') {
                var _on = arguments.callee;
                for (var key in event) {
                    if (event.hasOwnProperty(key)) _on(key, event[key]);
                }
            } else {
                var _handles = context._handles || (context._handles = {}),
                    _calls = _handles[event] || (_handles[event] = []);
                _calls.push(fn);
            }
            return context;
        };
        // Relieve custom event
        context.$off = function (event, fn) {
            if (!context._handles) return;
            if (!event) context._handles = {};
            var _handles = context._handles, _calls;

            if (_calls = _handles[event]) {
                if (!fn) {
                    _handles[event] = [];
                    return context;
                }
                for (var i = 0, l = _calls.length; i < l; i++) {
                    if (fn === _calls[i]) {
                        _calls.splice(i, 1);
                        return context;
                    }
                }
            }
            return context;
        };
        // Trigger custom events
        context.$emit = function (event) {
            var handles = context._handles, calls, args, type;
            if (!event) return;
            if (typeof event === "object") {
                type = event.type;
                args = event.data || [];
            } else {
                args = Array.prototype.slice.call(arguments);
                type = event;
            }
            if (!handles || !(calls = handles[type])) return context;
            for (var i = 0, len = calls.length; i < len; i++) {
                calls[i].apply(context, args)
            }
            return context;
        }
    };

    // 设定抽奖区域位置信息
    tp._setPosArr = function () {

        /* 基本属性计算
         ---------------------------------------------------------------------- */
        var config = this.config;
        var row = config.row;                                                   // 行数
        var column = config.column;                                             // 列数
        var margin = config.margin || 1;                                        // 奖品间隙
        // 为保证中间有btn区域 行数和列数不能小于3
        if (!row || !column || row < 3 || column < 3) {
            console.log('行数和列数必须不小于3!');
            return;
        }
        var cntWidth = config.width;                                            // 容器总宽度
        var cntHeight = config.height;                                          // 容器总高度
        // 容器总的长度必须大于0
        if (!cntWidth || !cntHeight || cntWidth < 0 || cntHeight < 0) {
            console.log('宽度和高度必须不小于0!');
            return;
        }
        // 横向共有(列数-1)个间隙
        var boxWidth = cntWidth - margin * (column - 1);                        // 容器去除间隙宽度
        // 纵向共有(列数-1)个间隙
        var boxHeight = cntHeight - margin * (row - 1);                         // 容器去除间隙高度
        // 保证长度为整数 先去除除不尽的部分(1像素的偏差可以接受  避免很长的小数位出现)
        var pieceWidth = (boxWidth - boxWidth % column) / column;               // 单个奖品区域宽度
        // 保证宽度为整数 先去除除不尽的部分(1像素的偏差可以接受  避免很长的小数位出现)
        var pieceHeight = (boxHeight - boxHeight % row ) / row;                 // 单个奖品区域高度

        /* 奖品位置属性设定
         ---------------------------------------------------------------------- */
        // 储存位置信息的二维数组
        var transit = [];
        for (var i = 0; i < row; i++) {
            // 载入第一行
            transit[i] = [];
            for (var j = 0; j < column; j++) {
                // 奖品样式属性赋值
                var piece = {};
                piece.x = j * pieceWidth + j * margin;
                piece.y = i * pieceHeight + i * margin;
                piece.width = pieceWidth;
                piece.height = pieceHeight;
                // 进入中间btn区域 继续循环
                if (i > 0 & i < row - 1 & j > 0 & j < column - 1) continue;
                // 存入奖品位置
                transit[i][j] = piece;
            }
        }
        /**
         * 此时transit数组储存的位置信息
         *    一 | 二 | 三 | 四
         *   ----------------
         *    五 |   btn   | 六
         *   ________________
         *    七 | 八 | 九 | 十
         */
        // 先把最后一行的元素倒序
        for (var i = 0; i < row; i++) {
            if (i == row - 1) transit[i].reverse()
        }
        /**
         * 此时transit数组储存的位置信息
         *    一 | 二 | 三 | 四
         *   ----------------
         *    五 |   btn   | 六
         *   ________________
         *    十 | 九 | 八 | 七
         */
        // 记录微信信息的一维数组 (从0~length-1)
        var array = [];
        // 第一行可以直接拿来用
        array = array.concat(transit[0]);
        /**
         * 此时array数组储存 (元素对应transit的位置属性)
         * [一,二,三,四]
         */
        // 除掉最后一排 夹在中间的行 开始入队 顺时针 先存右侧
        for (var i = 1; i < row - 1; i++) {
            array = array.concat(transit[i][column - 1])
        }
        /**
         * 此时array数组储存 (元素对应transit的位置属性)
         * [一,二,三,四,六]
         */
            // 加入最后一行
        array = array.concat(transit[row - 1]);
        /**
         * 此时array数组储存 (元素对应transit的位置属性)
         * [一,二,三,四,六,七,八,九,十]
         */
        // 除掉最后一排 夹在中间的行 开始入队 顺时针 轮到左侧数据
        for (var i = row - 2; i > 0; i--) {
            array = array.concat(transit[i][0])
        }
        /**
         * 此时array数组储存 (元素对应transit的位置属性)
         * [一,二,三,四,六,七,八,九,十,五]
         */
            // 奖品的个数就是现在数组的长度
        this.length = array.length;

        // 中间自定义区域 放到数组的最后位置上
        var btn = {};
        var btnWidth = (column - 2) * pieceWidth + (column - 3) * margin;
        var btnHeight = (row - 2) * pieceHeight + (row - 3) * margin;
        btn.x = pieceWidth + margin;
        btn.y = pieceHeight + margin;
        btn.width = btnWidth;
        btn.height = btnHeight;
        array.push(btn);
        /**
         * 此时array数组储存 (元素对应transit的位置属性)
         * [一,二,三,四,六,七,八,九,十,五,btn]
         * * 这时的顺序已经为顺时针的排序了
         * 拿着array存的位置 对照奖品信息组依次赋值 便可得到
         *    1 | 2 | 3 | 4
         *   ----------------
         *   10 |  btn  | 5
         *   ________________
         *    9 | 8 | 7 | 6
         */
            // 位置对象集合
        this.posArr = array;
    };

    /**
     * 抽奖区域渲染 调用此方法生成绝对定位 顺时针排序奖池 使用者也可通过this.posArr自行渲染
     * prizes: [{imgUrl:'xxx'},{imgUrl:'xxx',href:'http://xxx'},{text:'xxx'}]
     * prizes元素说明 渲染图片 {imgUrl:'xxx'}  带链接图片 {imgUrl:'xxx',href:'http://xxx'}
     *               渲染文字 {text:'xxx'}    带链接文字 {text:'xxx',href:'http://xxx'}
     */
    tp.$setBox = function (prizes) {
        prizes = prizes || [];
        /* 奖品信息 */
        // 标记奖品位置
        var index = 0;
        var array = this.posArr;
        for (var i = 0, l = this.length; i < l; i++) {
            index++;
            var div = document.createElement('div'), convert = '', prize = prizes[i], pos = array[i];
            // 中奖内容
            if (prize) {
                if (prize.imgUrl)  convert += '<img src="' + (prize.imgUrl).replace(/^http:/i,'') + '"/>';
                if (prize.text) convert += prize.text;
                if (prize.href) convert = '<a href="' + prize.href + '" target="_blank">' + convert + '</a>';
            }
            // 中奖光圈
            convert += '<div class="j-turnplate-halo j-turnplate-halo' + index + '"></div>';
            div.innerHTML = convert;
            div.className = 'j-turnplate-prize j-turnplate-prize' + index;
            // 设定绝对定位样式
            div.style.cssText = 'width:' + pos.width + 'px;height:' + pos.height + 'px;line-height:' + pos.height + 'px;top:' + pos.y + 'px;left:' + pos.x + 'px;';
            this.container.appendChild(div);
        }
        /* 抽奖按钮 */
        var btn = this.btn = document.createElement('div'), btnObj = array[this.length];
        btn.className = 'j-turnplate-btn';
        btn.style.cssText = 'width:' + btnObj.width + 'px;height:' + btnObj.height + 'px;top:' + btnObj.y + 'px;left:' + btnObj.x + 'px;';
        this.container.appendChild(btn);
        return this;
    };

    // 设置动画效果
    tp.$setAnimate = function (config) {
        config = config || {};
        if (!config.endCycle || config.endCycle < 2) {
            console.log('大转盘至少转动2圈!');
            return;
        }
        this.animate.slow = config.slow || 3;                                   // 减速位标识
        this.animate.quick = config.quick || 0;                                 // 加速位标识
        this.animate.speed = config.speed || 5;                                 // 抽奖转动速度(默认为5) 越大越慢
        this.animate.noReset = !!config.noReset;                                // åŽç»­æŠ½å¥–ä¸ä»Žç¬¬ä¸€ä¸ªå¼€å§‹
        this.animate.endCycle = config.endCycle;                                // è½¬åŠ¨åœˆæ•°
        return this;
    };

    // èŠ‚ç‚¹æ’å…¥
    tp.$inject = function (elem) {
        if (!elem) return;
        var node = e._$get(elem);
        node.innerHTML = '';
        node.appendChild(this.container);
        return this;
    };

    // å¯åŠ¨
    tp.$play = function (info) {
        var self = this;
        if (!self.animate.endCycle || !info.EndIndex) {
            console.log('å¿…é¡»æœ‰è½¬åŠ¨åœˆæ•°å’Œç»“æŸä½ç½®ï¼Œè‡³å°‘è½¬åŠ¨2åœˆ!');
            return;
        }
        // ç¼“å­˜è½¬åŠ¨å…‰åœˆèŠ‚ç‚¹
        if (!self.haloNodeArr) self.haloNodeArr = nes('.j-turnplate-halo');
        // èŽ·å–é…ç½®ä¿¡æ¯
        var index = info.index || 1,                                            // èµ·å§‹ä½ç½®
            arr_length = self.length,                                           // è·‘é©¬ç¯ä¸ªæ•°
            EndIndex = info.EndIndex,                                           // ç»“æŸä½ç½®
            quick = self.animate.quick,                                         // åŠ é€Ÿä½æ ‡è¯†
            slow = self.animate.slow;                                           // å‡é€Ÿä½æ ‡è¯†
        self.$emit('start');
        // å¼€å§‹å‰å‡†å¤‡
        var run = 0,                                                            // è½¬åŠ¨æ¬¡æ•°
            cycle = 0,                                                          // å½“å‰åœˆæ•°
            flag = false,                                                       // ç»“æŸè½¬åŠ¨æ ‡å¿—
            speed = self.animate.speed * 40,                                    // è½¬åŠ¨é€Ÿåº¦
            prevIndex = self.lastIndex || arr_length,                           // å‰ä¸€ä½ç½®
            timer = setInterval(play, speed);                                   // èµ·å§‹é€Ÿåº¦
        // å¢žåŠ æŠ½å¥–æ¬¡æ•°
        self.time++;
        // éªŒè¯åŠ é€Ÿä½æ˜¯å¦è¿‡ç•Œ
        slow = (EndIndex - slow) <= 0 ? (EndIndex - slow + arr_length) : (EndIndex - slow);
        if (!self.config.noReset) e._$delClassName(nes(".j-turnplate-halo" + prevIndex)[0], 'j-turnplate-current');

        // è·‘é©¬ç¯
        function play() {
            run++;
            //è½¬æ»¡1åœˆindexå½’1
            if (index > arr_length) {
                index = 1;
                cycle++;
            }
            if (flag == false) {
                // åŠ é€Ÿ
                if (quick == run) {
                    clearInterval(timer);
                    timer = setInterval(play, speed / 4);
                }
                // å‡é€Ÿå¹¶è§¦å‘ç»“æŸ
                if (cycle == self.animate.endCycle - 1 && index == slow) {
                    clearInterval(timer);
                    flag = true;
                    timer = setInterval(play, speed * 2.5);
                }
            }
            // ä¸ºå½“å‰å…‰åœˆåŠ é€‰ä¸­æ ·å¼ åŠ ä¸Šä¸€å…‰åœˆèŠ‚ç‚¹åŽ»é™¤é€‰ä¸­æ ·å¼
            e._$addClassName(self.haloNodeArr[index - 1], 'j-turnplate-current');
            if (index > 1) prevIndex = index - 1;
            else prevIndex = arr_length;
            e._$delClassName(self.haloNodeArr[prevIndex - 1], 'j-turnplate-current');
            // è½¬åŠ¨ç»“æŸ
            if (flag == true && index == EndIndex) {
                quick = 0;
                self.lastIndex = EndIndex;
                clearInterval(timer);
                self.$emit('end');
            }
            index++;
        }
    };
    return Turnplate;
},4);
I$(553,"{#if showArr.length}\n<ul class=\"j-marquee-wrap {className||''}\" ref=\"box\">\n  {#list showArr as item}\n  <li class=\"j-marquee-item f-toe {item.className||''}\">{#include this.content}</li>\n  {/list}\n</ul>\n{#else}\n<div class=\"j-marquee-empty \">\n  æš‚æ— æ•°æ®\n</div>\n{/if}");
I$(385,function (_t, _, BaseComponent, body) {
    /**
     * æŽ§ä»¶åŸºç±»ï¼Œä¸»è¦å®žçŽ°ä»¥ä¸‹åŠŸèƒ½ï¼š
     * * æ ¹æ®æ€»çš„ä¿¡æ¯é›†åˆ å®Œæˆä¿¡æ¯å±•ç¤ºåŠè½®æ’­æ»šåŠ¨
     *
     *  è®¾è®¡æ€è·¯ï¼š
     *  æ ¹æ®è®¾å®šè¦å±•ç¤ºä¿¡æ¯çš„æ¡æ•°showLengthåŠè¦å•æ¬¡æ»šåŠ¨çš„æ¡æ•°offsetç»´æŠ¤ä¸€ä¸ªé•¿åº¦ä¸ºshowLength+offsetçš„showArråˆ—è¡¨
     *  showArræ¯æ¬¡å˜åŒ–ä¼šè§¦å‘ä¸€æ¬¡æ»šåŠ¨åŠ¨ç”» showArrå±žæ€§ä¸Žé˜Ÿåˆ—ä¸€è‡´  è¿›offsetä¸ª å‡ºoffsetä¸ª æ€»é•¿åº¦ä¸å˜ å®šæ—¶æ›´æ–°showArrä¾¿ä¼šæœ‰ä¿¡æ¯æ»šåŠ¨çš„æ•ˆæžœ
     *
     * ```html
     *    <div id="marquee" style="position:relative;"></div>
     * ```
     * ```javascript
     *   NEJ.define([
     *      'pro/components/lottery/marquee'
     *   ],function(Marquee){
     *       // å®šä¹‰æŽ§ä»¶ç±»
     *      self.marquee = new Marquee({
     *           array: [1,2,3,4,5],
     *           content: "{item}",
     *           data: {
     *               scale: 10,                          // å•æ¡æ»šåŠ¨è·ç¦»
     *               showLength: 2,                      // å¯è§†æ¡æ•°
     *               offset: 1                           // å•æ¬¡æ»šåŠ¨æ¡æ•°
     *           }
     *       }).$inject(document.getElementById("marquee"));
     * ```
     * æ•ˆæžœå¦‚ä¸‹
     * ```html
     *    <div id="marquee" style="position:relative;">
     *      <ul>
     *          <li>1</li>
     *          <li>2</li>
     *          <li>3</li>
     *      </ul>
 *   *    </div>
     * ```
     * ç”¨æˆ·çŽ°åœ¨ä¼šçœ‹åˆ°1å’Œ2 -> 3æ»šåŠ¨ä¸Šæ¥ -> 1è¢«é¡¶ä¸ŠåŽ» æ»šåŠ¨è·ç¦»10px
     */
    return BaseComponent.extend({
        name: 'marquee',
        template: body,
        config: function (data) {
            _.extend(data, {
                _index: 0,                                          // æ ‡è®°ç›®æ ‡æ•°ç»„
                scale: 20,                                          // å•æ¬¡æ»šåŠ¨è·ç¦»
                unit: 'px',                                         // å•æ¬¡æ»šåŠ¨è·ç¦»å•ä½
                showArr: [],                                        // æ»šåŠ¨å†…å®¹é›†åˆ
                className: '',                                      // æ»šåŠ¨åŒºåŸŸè‡ªå®šä¹‰class
                showLength: 5,                                      // å•æ¬¡å¯è§†æ¡æ•°
                offset: 2,                                          // å•æ¬¡æ»šåŠ¨æ¡æ•°
                time: 3000,                                         // å•æ¬¡æ»šåŠ¨æ—¶é—´é—´éš”
                duration: 800                                       // å•æ¬¡æ»šåŠ¨åŠ¨ç”»æŒç»­æ—¶é—´
            });
            // é¿å…è„æ£€æŸ¥æºæ•°ç»„(å¯èƒ½ä¼šæœ‰å‡ åƒæ¡ è§¦å‘è„æ£€æŸ¥ä¼šå½±å“ç»„ä»·æ•ˆçŽ‡) å•ç‹¬èµ‹å€¼
            if (!this.content) throw new Error('å¿…é¡»æœ‰æ»šåŠ¨èŠ‚ç‚¹ç»“æž„ï¼');
            if (!Array.isArray(this.array)) throw new Error('å¿…é¡»æœ‰æºæ•°æ®ï¼');
            this._copy = _.clone(this.array);
            // è®¾ç½®æ»šåŠ¨æ•°æ®
            var data = this.data;
            // éœ€è¦åŠ è½½çš„æ¡æ•° ä¸ºshowLength+offset
            data.length = data.showLength + data.offset;
            // æ•°æ®ç®€å•éªŒè¯
            if (data.offset < 1) throw new Error('è¯·è‡³å°‘æ»šåŠ¨1æ¡ï¼');
            if (data.duration >= data.time) throw new Error('åŠ¨ç”»æŒç»­æ—¶é—´è¯·å°äºŽæ»šåŠ¨é—´éš”æ—¶é—´ï¼');
            if (this.array.length < data.length) {
                this.noScroll = true;
                console.log('marqueeï¼šåˆ—è¡¨é•¿åº¦å°äºŽå±•ç¤ºæ¡æ•°ï¼Œå·²åœæ­¢æ»šåŠ¨æ•ˆæžœï¼');
                return false;
            }
            // showArrå±•ç¤ºé›†åˆåˆå§‹åŒ–
            for (var i = 0; i < data.length; i++) {
                data._index++;
                data.showArr[i] = this.array[i];
            }
            // è§¦å‘æ»šåŠ¨æ•ˆæžœ
            this.$watch('showArr', function (now, old) {
                if (this.noScroll) return;
                var data = this.data, _box = this.$refs.box;
                // è®¾ç½®åŠ¨ç”»
                _box.style.top = 0;
                var _EaseInOut = _t._$$AnimEaseInOut._$allocate({
                    from: {offset: 0},
                    to: {offset: data.offset * data.scale},
                    duration: data.duration,
                    onupdate: function (_event) {
                        _box.style.top = -_event.offset + data.unit;
                    },
                    onstop: function () {
                        this._$recycle();
                    }
                });
                // 开始动画
                _EaseInOut._$play();
            });
        },
        init: function () {
            // 开始滚动
            if (!this.noScroll) setInterval(this.setShowArr._$bind(this), this.data.time);
        },
        // 重置滚动源数组
        resetArray: function () {
            this.array = _.clone(this._copy);
        },
        // 滚动过程中 插入最新一条数据
        addItem: function (item) {
            this.array.splice(this.data._index, 0, item);
        },
        // 更行滚动内容
        setShowArr: function () {
            var data = this.data;
            data.showArr.splice(0, data.offset);
            for (var i = 0; i < data.offset; i++) {
                if (data._index - this.array.length >= 0) {
                    data._index = 0;
                    this.$emit('top');
                }
                data.showArr.push(this.array[data._index]);
                data._index++;
            }
            this.$emit('roll', data._index);
            this.$update();
        }
    });
},180,15,151,553);
I$(248,function (_req) {
	return {
		sync:function(_callback) {
			var _url = '/personal/myPoint.html',
				_opts= {
					data:{},
					method:'post',
					onload:function(_json) {
						_callback && _callback(_json);
					}
				};
			_req(_url, _opts);
		}
	}
},6);
I$(552,"<div class=\"cnt\">\n  {#if showTip}\n    <div class=\"tipCnt\">\n      <div class=\"tip\">{tip}</div>\n      <div class=\"btns f-cb\">\n        {#if isError}\n          <a href=\"javascript:;\" class=\"btn u-btn u-btn-ok u-btn-medium\" on-click=\"{this.cancel()}\">\n            <span>我知道了</span>\n          </a>\n        {#else}\n          <a href=\"javascript:;\" class=\"btn u-btn u-btn-ok u-btn-medium\" on-click=\"{this.onok()}\">\n            <span r-html=\"{txtOk || '确认'}\"></span>\n          </a>\n          <a href=\"javascript:;\" class=\"btn u-btn u-btn-cancel u-btn-medium\" on-click=\"{this.cancel()}\" r-html=\"{txtCC || '取消'}\"></a>\n        {/if}\n      </div>\n    </div>\n  {#else}\n    <div class=\"resultCnt clearfix\">\n      {#if result.luckyType==3}\n        <a class=\"f-fl giftImg\" href=\"/product/{result.goodsId}.html\" target=\"_blank\">\n          <img src=\"{result.imgUrl|imgThumbnailUrl:160,160}\"/>\n          <div class=\"price\">\n            <div class=\"tip\">\n              <p>券后价</p>\n              <p>\n                <span>&yen;</span><span class=\"big\">{result.discountPrice}</span>\n              </p>\n            </div>\n          </div>\n          <div class=\"name f-toe\">{result.awardName}</div>\n        </a>\n        <div class=\"f-fl result gift\">\n          <div class=\"show\">\n            <div class=\"name\">\n              <p>恭喜您！获得了1次低价购的机会</p>\n            </div>\n            <p>我们送您一张该商品的单品优惠券，保证您可以低价购得该商品，<a href=\"/product/{result.goodsId}.html\" target=\"_blank\">快去下单啊~</a></p>\n            <div class=\"btns\">\n              <a href=\"javascript:;\" class=\"btn u-btn u-btn-go u-btn-medium\" on-click=\"{this.onok()}\">\n                <span>继续抽奖</span>\n              </a>\n              <a class=\"btn u-btn u-btn-ok u-btn-medium\" href=\"/product/{result.goodsId}.html\" target=\"_blank\">立即下单</a>\n            </div>\n          </div>\n        </div>\n      {#else}\n        <div class=\"f-fl brand {'brand-'+result.luckyType}\">\n          {#if result.luckyType==2}\n            <div class=\"coupon\">\n              <p style=\"line-height: 33px;\">\n                <span class=\"small\">&yen;</span><span class=\"price\">{result.couponAmount}</span>\n              </p>\n              <p class=\"type\">{couponName[result.couponType]}</p>\n            </div>\n          {/if}\n        </div>\n        <div class=\"f-fl result\">\n          <div class=\"show\">\n            {#if result.luckyType==1}\n            <p>恭喜您！抽中了！</p>\n            <div class=\"name\">\n              <p class=\"f-toe\">{result.awardName}</p>\n            </div>\n            {/if}\n            {#if result.luckyType==2}\n              <p>恭喜您！抽中了！</p>\n              <p class=\"name\">{result.awardName}</p>\n              <a href=\"/personal/my_coupon.html\" target=\"_blank\">查看我的优惠券 &gt;</a>\n            {/if}\n            {#if result.luckyType==4}\n            <p class=\"name\">{_loseTip[_loseCount]}</p>\n            {/if}\n            <div class=\"btns\">\n              <a href=\"javascript:;\" class=\"btn u-btn u-btn-ok u-btn-medium\" on-click=\"{this.onok()}\">\n                <span>继续抽奖</span>\n              </a>\n              <a href=\"javascript:;\" class=\"btn u-btn u-btn-cancel u-btn-medium\" on-click=\"{this.cancel()}\">取消</a>\n            </div>\n          </div>\n        </div>\n      {/if}\n    </div>\n  {/if}\n</div>");
I$(386,function (_, Modal, body) {
    // 未中奖计数
    var loseCount = 0;
    // 未中奖文案提示
    var loseTip = ['阿噢~差一点就中奖啦！', '要不换个姿势再试试？', '距离大奖只剩一点点了!', '我就不信中不了奖', '曾经，我离大奖咫尺之遥……'];
    return Modal.extend({
        config: function (data) {
            _.extend(data, {
                msg: body,                                              // 提示框内容
                clazz: 'm-lotteryModal',                                // 提示框class
                showTip: true,                                          // 标记是否是开始游戏前的提示
                isError: false,                                         // 标记能否开始游戏（考拉豆不足 或 网络原因）
                tip: '',                                                // 开始前的提示语
                couponName: {1: '满减', 2: '无门槛'},                    // 优惠券类型名称枚举
                result: {},                                             // 抽奖结果对象
                hideOkBtn: true,                                        // 隐藏父提示框的确认按钮
                hideCCBtn: true,                                        // 隐藏父提示框的取消按钮
                _loseTip: loseTip,                                      // 抽奖失败提示语集合
                _loseCount: loseCount                                   // 抽奖失败标记位（轮流提示失败语句）
            });
            this.supr(data);
            loseCount++;
            if (this.data.result.luckyType != 4 || loseCount == loseTip.length) loseCount = 0;
        }
    });
},15,187,552);
I$(323,"<div class=\"m-exchangecode m-{type}\">\n    {#if type === 'exchange'}\n        <p class=\"title\">\n            <span class=\"text\">\n                {#if code == 200}\n                    <i class=\"iconfont success\" r-html={'&#xe612;'}></i>\n                    兑换成功！\n                {#else}\n                    <i class=\"iconfont error\" r-html={'&#xe609;'}></i>\n                    {message}\n                {/if}\n            </span>\n        </p>\n    {/if}\n    {#if code == 200 || type == 'seeCode'}\n        <ul class=\"code\">\n            <li class=\"code-key\">\n                <span>兑换码/卡号：</span>\n                {redeemCode}\n            </li>\n            {#if pwd}\n            <li class=\"code-value\">\n                <span>密码：</span>\n                {pwd}\n            </li>\n            {/if}\n        </ul>\n        <p class=\"sendToPhone\">\n            <span class=\"from-label\">发送到手机：</span>\n            <div class=\"from-content\">\n                <p><input type=\"text\" r-model={submitData.mobile} maxlength=\"11\"></p>\n                <p class=\"send-tip\" r-class={ {'has-error': !!errorMsg} }>{errorMsg || '兑换码将会以短信的形式发送到填写的号码'}</p>\n            </div>\n        </p>\n    {#elseif code == 402}\n        <p class=\"error-tip\">您的考拉豆暂时不足，无法成功兑换。</p>\n        <p class=\"operation-tip\">去<a class=\"u-jump-url\" href={jumpUrl}>我的考拉豆</a>页面赚取更多考拉豆！</p>\n    {#else}\n        <p class=\"operation-tip\">去<a class=\"u-jump-url\" href={jumpUrl}>我的考拉豆</a>页面查看更多兑换！</p>\n    {/if}\n</div>");
I$(324,"@charset \"UTF-8\";\n\n/*查看兑换码*/\n.m-seeCodeModal .modal-body{\n    padding: 30px 59px;\n}\n\n.m-seeCodeModal .m-modal-message{\n    text-align: left;\n    padding-bottom: 18px;\n}\n\n.m-seeCodeModal .code{\n    margin-bottom: 15px;\n    padding: 8px 0 14px;\n    border-bottom: 1px solid #ddd;\n}\n\n.m-seeCodeModal .m-exchangecode{\n    line-height: 24px;\n}\n.m-seeCodeModal .from-label,\n.m-seeCodeModal .from-content{\n\n}\n.m-seeCodeModal .from-label{\n    float: left;\n    line-height: 36px;\n}\n\n.m-seeCodeModal .from-content{\n    padding-left: 90px;\n}\n\n.m-seeCodeModal .from-content input{\n    padding: 10px;\n    width: 218px;\n    height: 14px;\n    font-size: 12px;\n    color: inherit;\n    border: 1px solid #d5d5d5;\n}\n\n.m-seeCodeModal .send-tip{\n    line-height: 27px;\n    font-size: 12px;\n    color: #999;\n}\n\n.m-seeCodeModal .m-exchangecode .has-error{\n    color: #D22147;\n}\n\n.m-alert-modal{\n\n}\n\n.m-exchange .title .iconfont,\n.m-alert-modal .iconfont{\n    margin-right: 8px;\n    font-size: 24px;\n}\n\n.m-exchange .text,\n.m-exchange .title .iconfont,\n.m-alert-modal .text,\n.m-alert-modal .title .iconfont{\n    vertical-align: middle;\n}\n\n.m-exchange .title,\n.m-alert-modal .title{\n    font-size: 23px;\n}\n\n.m-seeCodeModal .iconfont.error,\n.m-alert-error .title .iconfont{\n    color: #c20d38;\n}\n\n.m-seeCodeModal .iconfont.success,\n.m-alert-success .title .iconfont{\n    color: #5dc540;\n}\n\n.m-exchange .title .iconfont{\n    margin-right: 12px;\n}\n\n.m-exchange .code,\n.m-exchange .error-tip,\n.m-exchange .operation-tip{\n    padding-left: 36px;\n}\n\n.m-exchange .code{\n    overflow: hidden;\n}\n\n.m-exchange .code li{\n    padding-right: 25px;\n    float: left;\n}\n\n.m-exchange .error-tip{\n    padding-top: 9px;\n    padding-bottom: 9px;\n    border-bottom: 1px solid #ddd;\n}\n\n.m-exchange .operation-tip{\n    margin-bottom: 2px;\n    padding-top: 7px;\n    padding-bottom: 7px;\n}\n\n.m-exchange .operation-tip .u-jump-url{\n    padding: 0 5px;\n}");
I$(129,"<div class=\"m-dialogmodal iDialogMain m-alert-modal {typeClass}\">\n    <div class=\"m-dlgcont cnt\">\n        <p class=\"title\">\n            <i class=\"iconfont main-icon {icon||'yes'}\" r-html=\"icon=='yes'?'&#xe612;':'&#xe609;'\"></i>\n            <span class=\"text\">{text}</span>\n        </p>\n        {#if !!detail}\n        <p class=\"detail\" r-html={detail}></p>\n        {/if}\n    </div>\n    {#if !!btnText}\n    <div class=\"btnbar f-tac\">\n        <a class=\"btn\" href=\"javascript:void(0)\" on-click={this.confirm()}>{btnText}</a>\n    </div>\n    {/if}\n</div>");
I$(127,function (_e, _v, _, request, Modal2, modal, template, style, alertTemplate) {
    'use strict';
    _e._$addStyle(style);
    return Modal2.extend({
        config: function (data) {
            _.extend(data, {
                modalName: 'm-seeCodeModal',
                msg: _.compressHtml(template),
                width: 518,
                /**
                 * seeCode 为查看兑换码发送到手机
                 * exchange 为兑换成功发送到手机
                 */
                type: 'seeCode',
                redeemCode: '',
                pwd: '',
                submitData:{
                    id:'',
                    mobile: ''
                },
                code: 0,
                message: '',
                hideCCBtn: true
            });
            this.setTitle();
            this.setBtnText();
            this.supr(data);
            this.getUserPhone();
        },
        setBtnText: function(){
            var data = this.data;
            var code = data.code;
            var txtOk = '';
            if (code !== 200 && data.type == 'exchange') {
                txtOk = '去看看';
                data.jumpUrl = '/personal/my_point/index.html';
            } else {
                txtOk = '发送';
            }
            data.txtOk = txtOk;

        },
        setTitle: function(){
            var data = this.data;
            var title = '';
            if (data.type == 'seeCode') {
                title = '兑换码';
            } else if (data.type == 'exchange') {
                title = '兑换结果';
            }
            data.title = title;
        },
        getUserPhone: function(){
            var url = '/integral/get_mobile.html';
            var submitData = this.data.submitData;
            this.ajax(url, {}, function(json){
                if(json && json.code == 200 && json.message){
                    submitData.mobile = json.message;
                }
            }, function(){
            });
        },
        validateMobile: function () {
            var testPhone = new RegExp("^1[3|4|5|7|8]\\d{9}$");
            var data = this.data;
            var submitData = data.submitData;
            var mobile = submitData.mobile;
            if (mobile.trim() == "") {
                data.errorMsg = "手机号码不能为空！";
                return false;
            }
            if (!testPhone.test(mobile)) {
                data.errorMsg = "手机号码格式错误！";
                return false;
            }
            data.errorMsg = '';
            return true;
        },
        send: function () {
            var url = '/integral/send_to_mobile.html';
            var data = this.data;
            var submitData = data.submitData;
            this.ajax(url, {
                data: submitData,
                method: 'post',
                norest: true
            }, function(json){
                var code = json ? json.code : '';
                this.destroy();
                this.showSendPrompt(code);
            }, function(){
                this.destroy();
                this.showSendPrompt();
            });
        },
        showSendPrompt: function (code) {
            var title = '发送到手机';
            var modalErrorClass = ' m-alert-error';
            var data = {
                title: title,
                width: 518,
                btnText: '确认'
            };
            if (code == 200) {
                _.extend(data, {
                    icon: 'yes',
                    text: '发送成功！',
                    typeClass: ' m-alert-success'
                });
            } else if (code == 403) {
                _.extend(data, {
                    icon: 'no',
                    text: '短信发送次数过多，请在24小时后再尝试',
                    typeClass: modalErrorClass
                });
            } else {
                _.extend(data, {
                    icon: 'no',
                    text: '发送失败！',
                    typeClass: modalErrorClass
                });
            }
            new modal({
                content: _.compressHtml(alertTemplate),
                data: data
            });
        },
        ajax: function(url, options, onloadCallback, onerrorCallback){
            this.sending = true;
            if(options.onload || options.onerror){
                delete options.onload;
                delete options.onerror;
            }
            var setting = {
                type: 'json',
                method: 'GET',
                onload: function (json) {
                    onloadCallback && onloadCallback.call(this, json);
                    this.sending = false;
                    this.$update();
                }._$bind(this),
                onerror: function () {
                    onerrorCallback && onerrorCallback.call(this);
                    this.sending = false;
                    this.$update();
                }._$bind(this)
            };
            _.extend(setting, options,true);
            request(url, setting);
        },
        onok: function () {
            var data = this.data;
            var code = data.code;
            if (this.sending) {
                return;
            }
            if(data.type == 'seeCode' || code == 200){
                if (!this.validateMobile()) {
                    return;
                }
            }
            if (code !== 200 && data.type == 'exchange') {
                location.href = data.jumpUrl;
            } else {
                this.send();
            }
        }
    });
},4,3,15,6,144,128,323,324,129);
I$(99,function (_k,_ut,_,_v,_e,_t0,$,request,LoginWindow,PromptWin,ErrorWin,
            ListAllBuy,ListGuess,ListRecent,BrandByLetter,CountDown,lz,gtm,_p,_o,_f,_r,_pro) {
        var pro;
        _p._$$SearchModule = _k._$klass();
        pro = _p._$$SearchModule._$extend(_t0._$$EventTarget);

        pro.__init = function(_options) {
            this.__supInit(_options);
            this.__initNode();
            this.__initPage();
            this.__initEvent();
            // 初始化品牌显示
            this.__initSelectTag('brandbox');
            // 初始化分类显示
            this.__initSelectTag('classify');
            // 初始化国家显示
            this.__initSelectTag('country');

            //属性-【展开】设置显示
            this.__setPropertyAction();

            this.__lazyImg = lz._$$LazyImage._$allocate({
                // parent:'searchbox',
                attr:'src',
                oncheck:this.__checkImg._$bind(this),
                onappend:this.__onAppend._$bind(this)
            });
            //方便通过regular渲染页面后主动触发lazyload判断
            window.lazyImgTrigger = this.__lazyImgTrigger._$bind(this);
            this.__gaText = _options.gaText||'搜索列表页';
            this.__gaFrom = _options.gaFrom||'search';
            this.__gaPosiiton = _options.gaPosiiton||'搜索';
            this.__dapushParam = _options.dapushParam;

            //init品牌内容
            if(!!nej.p._$KERNEL && nej.p._$KERNEL.browser=='ie' && (nej.p._$KERNEL.version=='6.0' || nej.p._$KERNEL.version=='7.0')){

            }else{
                this.__initBrandDetail();
            }

            this.__initRecommend();
            this.__countDownInit();
            if(!window.kl){
                window.kl = {};
            }
            //滚动到筛选模块
            if(location.search.indexOf('pageSize')>=0){
                //增加有pop店铺入口情况的定位
                // if(this.__gaFrom == 'search' && _e._$get('shopbox')){
                //     var _offsetY = _e._$offset(resultwrap).y - 45;
                //     window.scrollTo(0, _offsetY)
                // }else{
                //     _e._$scrollTo('topTab');
                // }
                
                // 品牌页如果有促销数据的锚点定位
                if(this.__gaFrom == 'brand' && (hasActive||hasCoupon||hasHotSaleGoods||hasNewsGoods)){
                    _e._$scrollTo('search_crumbs'); 
                } else {
                    _e._$scrollTo('topTab');
                }
            }
            //document.scrollingElement.scrollTop=130;
            kl.addFav = this.__addFav._$bind(this);
            kl.arrivalNotice = this.__arrivalNotice._$bind(this);
            kl.skumouseover = this.__onSkuMouseOver._$bind(this);
            kl.skumouseout = this.__onSkuMouseOut._$bind(this);
            kl.forwordclick = this.__onForwordSkuClick._$bind(this);
            // kl.delFav = this.__delFav._$bind(this);

            //如果搜内容是药品等站外商品, 需要自动跳转
            if(typeof redirectType !== 'undefined' && redirectType == 1) {
                this._startCountDownTimer()
            }
            var gtmGoods = window.__gtmGoods||[];
            // gtm数据收集
            this.__gtmCollect(this.__gaFrom,gtmGoods);
        };

        pro._startCountDownTimer = function(){
            var COUNTER = 5,
                timerID,
                $counterSpan = _e._$get('J_countDownTxt'),
                $counterSpanWrap = _e._$get('J_countDownTxtWrap'),
                $clearCountDown = _e._$get('J_clearCountDown'),
                URL

            if(typeof redirectUrl == 'undefined'){
                URL = 'http://www.kaola.com.hk'
            } else {
                URL = redirectUrl
            }

            $counterSpanWrap.style.display = 'block'
            timerID = setInterval(function(){
                if(COUNTER === 0){
                    clearInterval(timerID)
                    $counterSpanWrap.style.display = 'none'
                    window.open(URL)
                    return;
                }
                COUNTER --;
                $counterSpan.innerHTML = COUNTER;

            }, 1000)

            $clearCountDown.onclick = function(){
                $counterSpanWrap.style.display = 'none'
                clearInterval(timerID)
            }
        };

        pro.__initBrandDetail = function() {
            var brandTextBox = _e._$get('brandtext');
            if(!brandTextBox)   return;
            //获取文本高度offsetHeight
            var height = brandTextBox.children[0].offsetHeight;
            if(height < 60){
                return;
            }else{
            //增加dot样式
                _e._$addClassName(brandTextBox, 'dot');
            }
        };

        pro.__initNode = function() {
            var opertaions = _e._$getByClassName(document.body, 'opertaion');
            for (var j = 0; j < opertaions.length; j++) {
                var obj = opertaions[j];
                if(!/\w/.test(obj.innerHTML)){
                    obj.parentNode.removeChild(obj);
                }
            }
            var _ntmp = _e._$getByClassName(document.body, 'jtag'), i=0;

            this.__popularity = _ntmp[i++];
            this.__sales = _ntmp[i++];
            this.__newGoods = _ntmp[i++];
            this.__price = _ntmp[i++];
            this.__priceStartIpt=_ntmp[i++];
            this.__priceEndIpt=_ntmp[i++];
            this.__priceBoxBtn=_ntmp[i++];
            this.__isStock = _ntmp[i++];
            this.__isPromote = _ntmp[i++];

            this.__delBrandsBtn = _e._$get('delbrands');
            this.__followBtn = _e._$get('followBtn');
            this.__searchResultBox = _e._$get('searchresult');
            this.__focusCountCnt = _e._$get('focusCount');
        };

        pro.__initEvent = function() {
            _v._$addEvent(this.__popularity, 'click', this.__orderResult._$bind(this,0));
            _v._$addEvent(this.__sales, 'click', this.__orderResult._$bind(this,2));
            _v._$addEvent(this.__newGoods, 'click', this.__orderResult._$bind(this,6));
            _v._$addEvent(this.__price, 'click', this.__orderResult._$bind(this,1));
            _v._$addEvent(this.__priceBoxBtn, 'click', this.__priceRangeResult._$bind(this));
            _v._$addEvent(this.__priceStartIpt, 'keyup', this.__priceRangeKeyup._$bind(this));
            _v._$addEvent(this.__priceEndIpt, 'keyup', this.__priceRangeKeyup._$bind(this));

            _v._$addEvent(this.__isStock, 'click', this.__stockResult._$bind(this,1));
            _v._$addEvent(this.__isPromote, 'click', this.__promoteResult._$bind(this,1));

            _v._$addEvent(this.__delBrandsBtn, 'click', this.__delBrands._$bind(this,1));

            if(this.__followBtn){
                this.__brandId = Number(this.__followBtn.getAttribute('data-bid'));
                _v._$addEvent(this.__followBtn, 'click', this.__doFollow._$bind(this));
                _v._$addEvent(this.__followBtn, 'mouseover', this.__doFollowBtnHover._$bind(this, true));
                _v._$addEvent(this.__followBtn, 'mouseout', this.__doFollowBtnHover._$bind(this, false));
            }

            //绑定多SKU的节点事件KJDS-1697
            if(this.__searchResultBox){
                var list = _e._$getByClassName(this.__searchResultBox,'colorsku');
                if(list && list.length > 0){
                    var skuLiNodes = _e._$getByClassName(this.__searchResultBox,'skutag');

                    //绑定arrowClick事件
                    _v._$addEvent(this.__searchResultBox, 'click', function(event){
                        var target = _v._$getElement(event);
                        if(_e._$hasClassName(target, 'arrow-1')){
                            this.__onForwordSkuClick(target, 1);
                        }else if(_e._$hasClassName(target, 'arrow-2')){
                            this.__onForwordSkuClick(target, -1);
                        }
                    }._$bind(this));
                    //绑定sku hover事件
                    for(var i=0,l=skuLiNodes.length; i<l; i++){
                        _v._$addEvent(skuLiNodes[i], 'mouseover', this.__onSkuMouseOver._$bind(this,skuLiNodes[i]));
                    }
                }
            }
        };

        pro.__initSelectTag = function(id) {
            var _classifyBox = _e._$get(id);
            if(!_classifyBox)   return;

            var _ntmp = _e._$getByClassName(_classifyBox, 'ctag'), i=0;

            var brandIdsWrap = _ntmp[i++],
                brandIds = _ntmp[i++],
                morebtn = _ntmp[i++];

            //不是多选
            this.__brandsMultiple = false;
            if(id=='brandbox'){
                var param=_e._$dataset(morebtn,'param');
                var brandText=_e._$dataset(morebtn,'brandText')||_e._$dataset(morebtn,'brandtext');
                _v._$addEvent(morebtn, 'click', this.__showBrandsByLetter._$bind(this,param,brandText));
            }else{
                _v._$addEvent(morebtn, 'click', this.__showBrands._$bind(this));
            }

            var brOffsetHeight = brandIds.offsetHeight;
            if(brOffsetHeight > 60) {
                //品牌多行
                morebtn.style.display = '';
                _e._$replaceClassName(brandIdsWrap.parentNode,'autoheight','line2height');
            }else{
                _e._$replaceClassName(brandIdsWrap.parentNode,'line2height','autoheight');
            }


            if(!!nej.p._$KERNEL && nej.p._$KERNEL.browser=='ie' && (nej.p._$KERNEL.version=='6.0' || nej.p._$KERNEL.version=='7.0')){
                this.__isIE67 = true;
            }

            this.__fixIERepaintBug();
        };

        pro.__initPage = function() {
            //处理筛选条件的底部边框
            var classifyAry = _e._$getByClassName(document.body,'m-classify');
            if(classifyAry && classifyAry.length){
                _e._$replaceClassName(classifyAry.pop(),'z-cat3','nobottomline');
            }

            this.__tempLink = tempLink.replace(/&amp;/ig,'&');

            //获取排序相关的参数
            if(!!pageType && pageType >= 1) { //分类搜索页面
                this.__typeText = 'sortfield';
                this.__typeReg = new RegExp(/&sortfield=[^&]*/ig)
                this.__brandReg = new RegExp(/&b=[^&]*/ig)
            }else{  //默认搜索页面
                this.__typeText = 'type';
                this.__typeReg = new RegExp(/&type=[^&]*/ig)
                this.__brandReg = new RegExp(/&brandId=[^&]*/ig);
                var _input = _e._$get('topSearchInput'), placeholderLabel = _e._$getByClassName('topsearch','js-placeholder');
                var keyvalue = this.__getUrlParam(location.href, 'key').replace(/%2B/ig,'%20');
                _input.value = decodeURIComponent(decodeURIComponent(keyvalue));

                //对于不支持placeholder的浏览器，需要手动隐藏js-placeholder节点
                if(!!_input.value && placeholderLabel.length > 0) {
                    placeholderLabel[0].style.display = 'none';
                }
            }
            this.__defaultLink = this.__tempLink.replace(this.__typeReg,'&'+this.__typeText+'=0').replace(/&isDesc=[^&]*/ig,'&isDesc=true').replace(/&isStock=[^&]*/ig,'&isStock=false');

            this.__type = Number(this.__getUrlParam(this.__tempLink, this.__typeText));
            this.__isDesc = this.__getUrlParam(this.__tempLink, 'isDesc')=='true'?true:false;
            this.__stock = this.__getUrlParam(this.__tempLink, 'isStock');
            this.__promote = this.__getUrlParam(this.__tempLink, 'isPromote');

            //相关query模块，需要对中文进行encode转码
            var relativeWrap = _e._$get('relativeWrap');
            if(relativeWrap){
                var alinks = _e._$getByClassName(relativeWrap, 'relative'), link;
                for(var i=0, l=alinks.length; i<l; i++){
                    link = alinks[i];
                    link.href = '/search.html?key='+encodeURIComponent(encodeURIComponent(_e._$attr(link,'key')))+'&searchRefer=research&referPostion='+(i+1);
                }
            }
        };

        pro.__setPropertyAction = function(){
            var _properties = _e._$getByClassName(document.body, 'property'), _nodes, _index, _height;
            for(var i=0,l=_properties.length; i<l; i++) {
                _nodes = _e._$getByClassName(_properties[i], 'ptag');
                _index = 0;
                _brandIdsWrapPa = _nodes[_index++];
                _brandIdsWrap = _nodes[_index++];
                _brandIds = _nodes[_index++];
                _more = _nodes[_index++];

                _height = _brandIds.offsetHeight;
                if(_height > 60) {
                    //属性多行
                    _more.style.display = '';
                    _brandIdsWrap.parentNode.className = 'hdbrands line2height';
                    _v._$addEvent(_more, 'click', this.__showPro._$bind(this, _more, _brandIdsWrapPa));
                }else{
                    _brandIdsWrap.parentNode.className = 'hdbrands autoheight';
                }
            }
        };
        pro.__showPro = function(_more,_wrapPa,e) {
            var _isShowAll = !(_more.innerHTML.indexOf('收起') >= 0);
            _more.innerHTML = !_isShowAll?
                '展开<span></span>':'收起<span class="packup"></span>';
            _wrapPa.className = !!_isShowAll ? 'hdbrands autoheight' : 'hdbrands line2height';

            this.__fixIERepaintBug();
        };
        /*切换展开和收起按钮*/
        pro.__showBrands = function(evt) {
            var morebtn = _v._$getElement(evt);
            if(morebtn.tagName.toLowerCase()=='span'){
                morebtn = morebtn.parentNode;
            }
            var pnode = $(morebtn)._$parent('.j-box',true)._$children('.j-tagwrap',true)[0];
            var tagbox = $(morebtn)._$parent('.j-box',true)._$children('.ctag',true)[1];
            if(morebtn.innerHTML.indexOf('展开')>=0){
                morebtn.innerHTML = '收起<span class="packup"></span>';
                if(pnode){
                    _e._$replaceClassName(pnode,'line2height','autoheight');
                    pnode.style.height = tagbox.offsetHeight +'px';
                }
            }else{
                morebtn.innerHTML = '展开<span></span>';
                if(pnode){
                    _e._$replaceClassName(pnode,'autoheight','line2height');
                    pnode.style.height = '68px';
                }
            }

            this.__fixIERepaintBug();
        };
         /*切换品牌筛选项的展开和收起按钮，因为有字母筛选功能，独立出来*/
        pro.__showBrandsByLetter = function(baseUrl,brandText) {
            _e._$remove(_e._$get('brandboxwrap'));
            var brandFilterBoxByLetter=new BrandByLetter({data:{brandList:window.brandList,baseUrl:baseUrl,brandText:brandText}});
            brandFilterBoxByLetter.$inject(_e._$get('brandbox'));
        };

        pro.__orderResult = function(_type) {
            var url='';
            if(this.__type == _type) {  //点击相同规则，修改顺序
                var isDesc=_type==6?this.__isDesc:!this.__isDesc;
                url = this.__tempLink.replace(/&isDesc=[^&]*/ig,'&isDesc='+isDesc);
            } else {
                if(_type==1 || _type == 6) {  //价格默认是正序
                    url = this.__tempLink.replace(this.__typeReg,'&'+this.__typeText+'='+_type).replace(/&isDesc=[^&]*/ig,'&isDesc=false');
                } else {
                    url = this.__tempLink.replace(this.__typeReg,'&'+this.__typeText+'='+_type).replace(/&isDesc=[^&]*/ig,'&isDesc=true');
                }
            }
            location.href = (url+'&changeContent=type');
        };

        pro.__doFollow = function(e) {
            var status = 1;
            if(_e._$hasClassName(this.__followBtn, 'unfo')){    //已关注
                status = 0;
            }
            // var param = _ut._$object2query({id:this.__brandId, status: status})
            var param = {id:this.__brandId, status: status};

            request('/personal/brand/follow.html', {
                method: 'POST',
                data: param,
                type: 'json',
                norest: true,
                onload: function(json){
                    if(json.retcode == 200){
                        this.__changeFollowStatus(status);
                    }else if(json.retcode == 461){
                        this.__loginWin = LoginWindow._$allocate({logincallback: this.__getLoginOK._$bind(this)})._$show();
                    }else if(json.retcode == 491){  //已收藏
                        this.__changeFollowStatus(1);
                    }else{
                        PromptWin._$allocate({message: json.retdesc})._$show();
                    }
                }._$bind(this),
                onerror: function(json){
                    PromptWin._$allocate({message: '内部错误！'})._$show();
                }
            })
        };

        pro.__doFollowBtnHover = function(_type, e){
            var _text = pageType==1?'取消关注':'取消关注';
            if(_e._$hasClassName(this.__followBtn, 'unfo')){
                this.__followBtn.innerText = !!_type?_text:'已关注';
            }
        };

        pro.__changeFollowStatus = function(_status){
            var _text = pageType==1?'关注':'关注';
            var count=Number(this.__focusCountCnt.innerText);
            this.__focusCountCnt.innerText=_status==0? (count-1<0 ? 0 : count-1) : (count+1);
            this.__followBtn.className = _status==0?'follow':'follow unfo';
            this.__followBtn.innerHTML = _status==0?('<b>&#xe60a;</b>&nbsp;'+_text):'已关注';
        };

        pro.__getLoginOK = function(_state){
            if(_state==0){
                this.__doFollow();
                this._$dispatchEvent('cbloginOk');
            }
        };

        pro.__addFav = function(_event, gid, target){
            if(!target) return;

            var url = '/favoriteAjax/add.html', type=1;
            if(target.className.indexOf('favt') != -1){
                url = '/favoriteAjax/delete.html';
                type = -1;
            }
            request(url, {
                method: 'POST',
                data: {goodsId: gid},
                type: 'json',
                norest: true,
                onload: function(json){
                    if(json.retcode == 200){
                        //修改状态
                        this.__changeFavStatus(target);
                    }else if(json.retcode == 461){
                        this.__loginWin = LoginWindow._$allocate({logincallback: this.__getLoginOK2._$bind(this, gid, target)})._$show();
                    }else if(json.retcode == 491){
                        //已收藏,修改状态
                        this.__changeFavStatus(target);
                    }else{
                        //错误提示
                        PromptWin._$allocate({message: json.retdesc})._$show();
                    }
                }._$bind(this),
                onerror: function(json){
                    PromptWin._$allocate({message: '内部错误！'})._$show();
                }
            })
        };

        pro.__changeFavStatus = function(target){
            target.className = target.className.indexOf('favt')<0?'favbtn favt':'favbtn';
        };
        //收藏登录回调
        pro.__getLoginOK2 = function(gid, target, _state){
            if(_state==0){
                this.__addFav(null, gid, target);
                this._$dispatchEvent('cbloginOk');
            }
        };

        pro.__arrivalNotice = function(){
            if(!window.user){   //登录弹层
                this.__loginWin = LoginWindow._$allocate({logincallback: this.__getLoginOK3._$bind(this)})._$show();
            }else{
                // this.__noticeWin =
            }
        };

        pro.__getLoginOK3 = function(gid, target, _state){
            if(_state==0){
                // this.__addFav(null, gid, target);
                // this._$dispatchEvent('cbloginOk');
            }
        };
        //价格区间按钮
        pro.__priceRangeResult = function(e) {
            var priceStart=this.__priceStartIpt.value?parseFloat(this.__priceStartIpt.value):'-1';
            var priceEnd=this.__priceEndIpt.value?parseFloat(this.__priceEndIpt.value):'-1';
            var url=this.__tempLink;
            //如果开始大于结束，则交换
            if(priceStart!=-1&&priceEnd!=-1&&priceStart>priceEnd){
                priceStart=priceStart+priceEnd;
                priceEnd=priceStart-priceEnd;
                priceStart=priceStart-priceEnd;
            }
            if(/&lowerPrice=[^&]*/ig.test(url)){
                url = url.replace(/&lowerPrice=[^&]*/ig,'&lowerPrice='+priceStart);
            }else{
                url = url+'&lowerPrice='+priceStart;
            }
            if(/&upperPrice=[^&]*/ig.test(url)){
                url = url.replace(/&upperPrice=[^&]*/ig,'&upperPrice='+priceEnd);
            }else{
                url = url+'&upperPrice='+priceEnd;
            }
            location.href = (url+'&changeContent=price');
        };
        //用户输入价格
        pro.__priceRangeKeyup = function(e) {
            var target= e.target|| e.srcElement;
            if(e.keyCode==190&&/^\d+\.$/.test(target.value)){
                return ;
            }
            if(!/^\d+(\.\d+)?$/.test(target.value)){
                target.value=target.value.substr(0,target.value.length-1);
            }

        };

        pro.__stockResult = function() {
            var changetext = this.__stock == 'true'?false:true,
                url = this.__tempLink.replace(/&isStock=[^&]*/ig,'&isStock='+changetext);

            location.href = (url+'&changeContent=isStock');
        };

        pro.__promoteResult = function() {
            var changetext = this.__promote == 'true'?false:true,
                url = this.__tempLink.replace(/&isPromote=[^&]*/ig,'&isPromote='+changetext);

            location.href = (url+'&changeContent=isPromote');
        };

        pro.__delBrands = function() {
            var url = this.__defaultLink.replace(this.__brandReg,'&brandId=');
            url+='&changeContent=crumbs_b';
            location.href = url;
        };
        //多SKU Hover选中并替换对应的img和url功能
        pro.__onSkuMouseOver = function(target, event){
            if(target.className == 'cur'){
                return;
            }
            var parentUL = target.parentNode,
                curNode = _e._$getByClassName(parentUL,'cur'),
                propertyId = _e._$attr(target,'proId'),
                imgNode = target.children[0],
                imgUrl = imgNode.src||(_e._$attr(imgNode, 'data-src')),
                goodsWrap = parentUL.parentNode.parentNode.parentNode,
                imgNode = _e._$getByClassName(goodsWrap,'imgtag')[0],
                links = goodsWrap.getElementsByTagName('a');
            //设置SKU选中样式
            if(curNode && curNode.length>0){
                for(var i=0,l=curNode.length; i<l; i++){
                    _e._$delClassName(curNode[i], 'cur');
                }
            }
            _e._$addClassName(target, 'cur');
            if(!propertyId)
                return;
            //设置对应li中的链接和图片url
            imgNode.src = imgUrl.replace('thumbnail=30x30','thumbnail=262x262');
            for(var j=0,jl=links.length, hrefstring; j<jl; j++){
                hrefstring = links[j].href;
                //skupvs  商品详情页获取这个字段并默认选中sku
                if(hrefstring.indexOf('skupvs')>0){
                    links[j].href = hrefstring.replace(/skupvs=[^&]+/ig, ('skupvs=_'+propertyId))
                }else{
                	if(hrefstring.indexOf('?')!=-1){
                		links[j].href = hrefstring+'&skupvs=_'+propertyId
                	} else{
                		links[j].href = hrefstring+'?skupvs=_'+propertyId
                	}
                }
            }
        };

        pro.__onSkuMouseOut = function(event){

        };
        //多SKU左右滑动功能
        pro.__onForwordSkuClick = function(target, type, event){
            if(target.className.indexOf('arrowdis')>=0){
                return;
            }
            var parent = target.parentNode, arrowNodes = _e._$getByClassName(parent, 'arrow'),
                leftArrow = arrowNodes[0], rightArrow = arrowNodes[1],
                ulNode = parent.getElementsByTagName('ul')[0],
                skuNum = ulNode.getElementsByTagName('li').length,
                index = Number(ulNode.style.left.replace('px',''))/36;
            //设置按钮是否可用状态
            curIndex = index+type*5;
            _e._$delClassName(rightArrow, 'arrowdis-2');
            _e._$delClassName(leftArrow, 'arrowdis-1');
            if(curIndex >= 0){
                _e._$addClassName(leftArrow, 'arrowdis-1');
                curIndex = 0;
            }else if(curIndex <= (5-skuNum)){
                _e._$addClassName(rightArrow, 'arrowdis-2');
                // curIndex = (5-skuNum)
            }
            //设置sku滚动距离【动画用css3实现】
            ulNode.style.left = curIndex*36+'px';
        };

        pro.__getUrlParam = function(url, param) {
            if(url.indexOf(param+'=') < 0) {
                return '';
            }

            return (url+'&').split(param+'=')[1].split('&')[0]
        };

        pro.__checkImg = function(_obj){
            var dataSrc = nej.e._$attr(_obj.target, 'data-src');
            if(!dataSrc || dataSrc==_obj.target.src){
                _obj.value = 0;
            }
        };

        pro.__onAppend = function(obj){
            obj.stopped = true;
            obj.target.src = obj.config.src;
            nej.e._$attr(obj.target, 'data-src', '');
            _e._$delClassName(obj.target, 'img-lazyload');
        };

        pro.__lazyImgTrigger = function(){
            this.__lazyImg.__doCheckScrollPosition();
        };

        pro.__fixIERepaintBug = function(){
            //IE6/7 带有relative属性的节点没有进行重绘的bugfix
            if(!!this.__isIE67){
                document.body.className = document.body.className;
            }
        };

        //倒计时设置
        pro.__countDownInit = function(){
            var parent = _e._$get('countDown');
            if(parent){
                var dvalue = _e._$attr(parent, 'data-dvalue'),
                    textNode = _e._$getChildren(parent)[1],
                    deadline = _e._$attr(textNode, 'data-deadline');

                this.__countDown = CountDown._$allocate({
                    parentnode: parent,
                    dvalue: dvalue,
                    deadline: deadline,
                    nodeflag: 'ttag'
                });
            }
        };

        pro.__initRecommend = function(){
            var ids = [];
            $('.goods')._$forEach(function(goods){
                var title = $(goods)._$children(".title",true)[0]||{};
                var href = title.href || '';
                var result = /(\d+)/gi.exec(href);
                if(result && result[0]){
                    ids.push(result[0]);
                }
            });
            //KJDS-730  推荐组推荐相关商品
            var recommendWrap = _e._$get('recommendWrap');
            if(recommendWrap){
                var aAry = _e._$getByClassName(recommendWrap, 'retag'), link, key;
                for(var i=0,l=aAry.length; i<l; i++){
                    link = aAry[i];
                    key = _e._$attr(link,'searchkey');
                    if(key){
                        link.href = '/search.html?key='+encodeURIComponent(encodeURIComponent(key));
                    }
                }
            }
            var allbuyNode = _e._$get('recomGoodsWrap'),
                guessNode =  _e._$get('guess'),
                recentNode =  _e._$get('recent');
            if(allbuyNode){
                var recommondData ={
                    'strategy':'hot',//alsoBuy,alsoView,viewBuy,multi_items
                    'goods_ids':ids.join(','),
                    'limit':5,
                    'type':0,//0代表看过，1代表买过，2代表放购物车里
                    'account':window.account || '',
                    'ver':2,
                    'from':'pc',
                    'tongji':{
                        'category':'推荐区域展示',
                        'action':this.__gaText,
                        'lable':'大家都在买',
                        'position':this.__gaPosiiton+'：大家都在买',
                        'from':this.__gaFrom+'djdzm',
                        'query':'rp='+this.__gaFrom+'&zp=djdzm&zn=rec&recId='
                    }
                }
                var listAllBuy = new ListAllBuy({
                    data:{
                        url:'/recommend/getRecommendGoods.html',condition:recommondData,
                        //停留打点参数,若__dapushParam不存在，则由于缺少page值而不会打点
                        dapushParam: _.extend({id: "recomGoodsWrap", module: "大家都在买"}, this.__dapushParam)
                    }
                })
                listAllBuy.$inject(allbuyNode);
            }
            if(guessNode){
                var recommondData ={
                        'strategy':'multi_items',//alsoBuy,alsoView,viewBuy,multi_items
                        'goods_ids':ids.join(','),
                        'limit':5,
                        'type':0,//0代表看过，1代表买过，2代表放购物车里
                        'account':window.account || '',
                        'ver':2,
                        'from':'pc',
                        'tongji':{
                            'category':'推荐区域展示',
                            'action':this.__gaText,
                            'lable':'猜你喜欢',
                            'position':this.__gaPosiiton+'：猜你喜欢',
                            'from':this.__gaFrom+'cnxh',
                            'query':'rp='+this.__gaFrom+'&zp=cnxh&zn=rec&recId='
                        }
                    }
                var listGuess = new ListGuess({
                    data:{
                        url:'/recommend/getRecommendGoods.html',condition:recommondData,
                        //停留打点参数
                        dapushParam: _.extend({id: "guess", module: "猜你喜欢"}, this.__dapushParam)
                    }
                });
                listGuess.$inject(guessNode);
            }
            if(recentNode){
                var recommondData ={
                        'limit':5,
                        'from':this.__gaFrom+'zjll',
                        'query':'rp='+this.__gaFrom+'&zp=zjll&zn=rec&recId=',
                        'tongji':{
                            'category':'推荐区域展示',
                            'action':this.__gaText,
                            'lable':'最近浏览',
                            'position':this.__gaPosiiton+'：最近浏览'
                        }
                    };
                var listRecent = new ListRecent({
                    data:{
                        url:'/recentlyViewAjax.html',condition:recommondData,
                        //停留打点参数
                        dapushParam: _.extend({id: "recent", module: "最近浏览"}, this.__dapushParam)
                    }
                });
                listRecent.$inject(recentNode);
            }

        };
        /**
         * GTM 数据收集
         */
        pro.__gtmCollect = function(pageType,goodsList){
            if(pageType=='navigation'){ pageType='category';}
            gtm.gtmReady({
                com_data:{
                    page_type:pageType,
                    items:goodsList
                }
            });
        };

        return _p._$$SearchModule;
        // _$$SearchModule._$allocate();
    },1,2,15,3,4,23,25,6,7,8,28,81,82,159,300,49,51,44);